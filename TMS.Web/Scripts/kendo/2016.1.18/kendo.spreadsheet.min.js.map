{"version":3,"sources":["kendo.spreadsheet.js"],"names":["f","define","kendo","UndoRedoStack","Observable","extend","init","options","fn","call","this","clear","events","push","command","stack","slice","currentCommandIndex","undo","canUndo","trigger","redo","canRedo","length","deepExtend","util","amd","a1","a2","a3","defined","value","UNDEFINED","round","precision","power","pow","math","p","limitValue","min","max","rad","degrees","DEG_TO_RAD","deg","radians","isNumber","val","isNaN","valueOrDefault","defaultValue","sqr","objectKey","object","key","parts","sort","join","hashKey","str","i","hash","charCodeAt","hashObject","arrayLimits","arr","MAX_NUM","MIN_NUM","arrayMin","arrayMax","sparseArrayMin","sparseArrayLimits","sparseArrayMax","n","isFinite","undefined","last","array","append","first","second","apply","renderTemplate","text","template","useWithBlock","paramName","renderAttr","name","renderAllAttr","attrs","output","renderStyle","renderSize","size","renderPos","pos","result","toHyphens","split","isTransparent","color","arabicToRoman","literals",1,10,100,2,20,200,3,30,300,4,40,400,5,50,500,6,60,600,7,70,700,8,80,800,9,90,900,1000,"values","roman","shift","romanToArabic","r","digits","prev","v","toLowerCase","x","l","c","d","m","charAt","memoize","cache","Object","create","id","arguments","ucs2decode","string","extra","counter","ucs2encode","map","String","fromCharCode","Math","window","PI","Number","MAX_VALUE","now","Date","getTime","drawing","dataviz","$","measureText","style","measureBox","TextMetrics","current","measure","doc","document","Class","LRUCache","_size","_length","_map","put","lru","entry","_head","_tail","newer","older","get","defaultMeasureBox","_cache","_initOptions","baselineMarkerSize","box","baselineMarker","styleKey","cacheKey","cachedResult","width","height","baseline","_baselineMarker","cloneNode","appendChild","body","offsetWidth","offsetHeight","offsetTop","parentNode","removeChild","jQuery","CODE","out","UCS2","code","parse","data","callbacks","readChar","index","croak","msg","Error","readWhile","pred","a","readAsciiWhile","STRING","skipWhitespace","isWhitespace","eat","save","skip","isDigit","isHexDigit","isNameStart","isName","xmlComment","END_COMMENT","xmlTag","QUESTION_MARK","xmlDecl","START_COMMENT","xmlName","xmlAttrs","END_SHORT_TAG","GREATER_THAN","xmlContent","pop","END_TAG","START_CDATA","END_CDATA","LESS_THAN","AMPERSAND","xmlEntity","xmlString","quote","QUOTE","APOSTROPHE","SHARP","LOWERCASE_X","UPPERCASE_X","parseInt","ENTITIES","SEMICOLON","END_DECLARATION","$tag","EQUAL","what","thing","arg1","arg2","is","selector","j","exit","EXIT","amp","lt","gt","quot","nbsp","parseXML","ex","encodeBase64","input","chr1","chr2","chr3","enc1","enc2","enc3","enc4","encodeUTF8","KEY_STR","inArray","ObserversMixin","observers","_observers","addObserver","element","removeObserver","splice","methodName","event","observer","idx","_suspended","optionsChange","e","geometryChange","suspend","resume","_observerField","field","mixins","Command","PropertyChangeCommand","ApplyFilterCommand","DeleteCommand","AddCommand","support","browser","msie","version","spreadsheet","_workbook","workbook","_property","property","_state","range","_range","exec","setState","getState","_forEachCell","callback","ref","_ref","forEach","sheet","toRangeRef","bind","_value","ClearContentCommand","clearContent","EditCommand","rejectState","validationState","title","message","reason","type","_getValidationState","ex1","calc","ParseError","ex2","TextWrapCommand","rowHeight","forEachRow","topLeft","row","_rowHeight","AdjustDecimalsCommand","_decimals","decimals","formatting","batch","forEachCell","col","cell","format","adjustDecimals","BorderChangeCommand","_type","border","_style","noBorders","borderLeft","borderTop","borderRight","borderBottom","allBorders","leftBorder","leftColumn","rightBorder","rightColumn","topBorder","topRow","bottomBorder","bottomRow","outsideBorders","insideBorders","insideHorizontalBorders","insideVerticalBorders","MergeCellCommand","activate","activeCell","unmerge","cells","merge","horizontally","vertically","forEachColumn","FreezePanesCommand","_topLeft","panes","frozenColumns","frozenRows","rows","columns","unfreeze","PasteCommand","_clipboard","clipboard","activeSheet","pasteRef","status","canPaste","menuInvoked","paste","execute","pasteOnMerged","AdjustRowHeightCommand","_workingRange","rowIndex","state","mergedCells","maxHeight","colIndex","cellRange","totalWidth","intersects","columnWidth","getTextHeight","fontSize","wrap","ToolbarPasteCommand","_view","focus","select","execCommand","CopyCommand","noop","canCopy","copy","multiSelection","ToolbarCopyCommand","textarea","createElement","addClass","html","appendTo","remove","CutCommand","cut","AutoFillCommand","origin","_origin","fillFrom","ToolbarCutCommand","FilterCommand","filter","hasFilter","intersectingMerged","SortCommand","column","ascending","expandRange","Range","_sheetRef","clearFilter","filterRule","exists","valueFilter","ValueFilter","customFilter","CustomFilter","eq","ClearFilterCommand","HideLineCommand","axis","setAxisState","getAxisState","axisManager","hideSelectedRows","hideSelectedColumns","UnHideLineCommand","unhideSelectedRows","unhideSelectedColumns","DeleteRowCommand","deleteSelectedRows","DeleteColumnCommand","deleteSelectedColumns","AddColumnCommand","addColumnLeft","addColumnRight","AddRowCommand","canAddRow","addRowAbove","addRowBelow","EditValidationCommand","validation","OpenCommand","file","match","fromFile","SaveAsCommand","fileName","extension","saveAsExcel","saveAsPDF","pdf","classNames","FormulaBar","wrapper","ui","Widget","formulaInput","FormulaInput","destroy","isOpenParen","ch","isCloseParen","isMatchingParen","close","open","touches","target","begin","end","knownFunction","runtime","FUNCS","isEqualToken","tok1","tok2","ns","keys","styles","KEY_NAMES","PRIVATE_FORMULA_CHECK","listWrapper",27,37,39,35,36,32,"attr","autoScale","on","scale","_highlightedRefs","_staticTokens","_formulaSource","_formulaList","_popup","_tooltip","_keydown","_keyup","_blur","_input","_focus","filterOperator","scalePadding","minLength","enable","toggleClass","getPos","lookup","lookupNode","loop","node","nodeType","firstChild","nextSibling","nodeValue","div","tmp","sel","getSelection","focusNode","focusOffset","b","anchorNode","anchorOffset","collapsed","setPos","len","el","eiv","createRange","setStart","setEnd","removeAllRanges","addRange","home","test","toUpperCase","formulaSource","DataSource","list","StaticList","insertAfter","autoBind","selectable","change","_formulaListChange","dataSource","dataValueField","preventDefault","activeToken","completion","ctx","tokenCtx","_tokenContext","_mute","token","replace","nextToken","_replaceAt","popup","Popup","anchor","clearTimeout","_focusId","_isFormula","keyCode","_navigated","_move","_keyDownTimeout","setTimeout","_syntaxHighlight","view","visible","focusFirst","_focusTimeout","pressed","DOWN","focusNext","UP","focusPrev","focusLast","ENTER","TAB","PAGEUP","PAGEDOWN","tokens","tok","point","tokenize","_sync","_editorToSync","isActive","_textContainer","computedStyles","getComputedStyles","position","visibility","whiteSpace","top","left","_span","css","_cellTooltip","tooltip","toggleTooltip","show","toggle","_activeElement","operator","hide","rectangle","resize","canInsertRef","isKeyboardAction","_canInsertRef","afterPoint","canReplace","canInsertBetween","right","strictMode","refAtPoint","simplify","newValue","rest","substr","syncWith","eventName","off","highlightedRefs","refClasses","Pane","series","refIndex","parens","active","cls","colorClass","unshift","reverse","htmlEncode","substring","_setStaticTokens","Mac","isAlphaNum","keyName","EventListener",13,38,33,34,46,113,"navigator","platform","indexOf","handlers","_handlers","_observer","keyDownProxy","keyDown","mouseProxy","mouse","threshold","_pressLocation","documentElement","handleEvent","rightClick","dx","dy","distance","which","button","pageX","y","pageY","sqrt","catchAllHandler","handler","eventKey","mod","metaKey","ctrlKey","shiftKey","passThrough","skew","level","temp","insert","NilNode","RangeTreeNode","start","diff","heir","intersecting","ranges","tree","root","RangeTree","RangeList","Iterator","SparseRangeList","findrange","clone","firstRange","lastRange","rangeValue","rangeStart","rangeEnd","expandedValues","rangeIndex","sortedIndices","valueComparer","indices","comparer","sourceStart","sourceEnd","targetStart","iterator","unique","at","lastRangeStart","ValueRange","toExcelFormat","Property","JsonProperty","ValueProperty","set","dst","JSON","stringify","formats","validations","prototype","dateToNumber","culture","calendar","patterns","PropertyBag","specs","sortable","serializable","depends","cellCount","properties","lists","spec","fromJSON","si","iterators","forEachProperty","ALL_PROPERTIES","columnName","letter","floor","displaySheet","displayRef","rel","aa","Ref","NULL","NameRef","CellRef","RangeRef","UnionRef","hasSheet","_hasSheet","setSheet","absolute","relative","adjust","toString","print","obj","intersect","isCell","toRow","toColumn","rangeAt","nextRangeIndex","previousRangeIndex","reference","refs1","refs2","r1","r2","bottomRight","single","refs","concat","replaceAt","forEachColumnIndex","forEachAxisIndex","forEachRowIndex","sorted","method","valid","display","ret","trow","tcol","abs","arow","acol","forRow","delta","tl","br","endSheet","normalize","_containsRange","_containsCell","contains","Array","that","some","_intersectRange","a_left","a_top","a_right","a_bottom","b_left","b_top","b_right","b_bottom","c1","c2","rr1","rc1","rr2","rc2","changes","relTL","relBR","collapse","startRow","endRow","startCol","endCol","union","topLeftRow","topLeftCol","bottomRightRow","bottomRightCol","modified","num","limit","bottom","move","cols","tr","u","reduce","empty","theRef","newRefs","NULLREF","SHEETREF","Infinity","FIRSTREF","AutoFillCalculator","grid","_grid","rectIsVertical","startRect","endRect","autoFillDest","selection","cursor","quadrant","pivot","opposite","cornerResult","expanding","bottomLeft","topRight","lower","further","EdgeNavigator","SheetNavigator","rangeGetter","prevLeft","prevVisible","nextRight","nextVisible","nextLeft","prevRight","boundary","_sheet","_columns","autoFillCalculator","colEdge","columnRange","rowEdge","_rows","rowRange","_viewPortHeight","unionWithMerged","leftCol","rightCol","selectionIncludesMergedCells","_mergedCells","setSelectionValue","selectAll","mode","addToExisting","refForMode","rowRef","colRef","startSelection","startAutoFill","completeSelection","selectForContextMenu","modifySelection","action","scrollInto","newSelection","direction","determineDirection","viewPortHeight","originalSelection","currentOriginalSelectionRange","prevPage","nextPage","firstVisible","lastVisible","updateCurrentSelectionRange","moveActiveCell","originalActiveCell","navigateInSelection","currentNavigationRange","selTopLeft","selBottomRight","done","nextNavigationRange","previousNavigationRange","shouldSkip","singleCellSelection","extendSelection","resizeAutoFill","isMerged","forEachMergedCell","merged","hint","preview","props","_autoFillOrigin","dest","punch","_previewFillFrom","updateAutoFill","currentSelectionRange","leftMode","rightMode","topMode","bottomMode","originalSelect","selectionRangeIndex","subset","bottomCol","AxisManager","forEachSelectedColumn","layout","recalc","forEachSelectedRow","includesHiddenColumns","includesHidden","includesHiddenRows","selectionIncludesHiddenColumns","selectionIncludesHiddenRows","deleteColumn","deleteRow","hideColumn","hideRow","unhideColumn","unhideRow","insertColumn","rowCount","canInsertRow","insertRow","Clipboard","iframe","className","_external","_uid","guid","external","hasOwnProperty","intersectsMerged","stateRangeRef","contents","destination","originActiveCell","rowDelta","colDelta","address","_isInternal","triggerChange","plain","table","contentWindow","write","find","_parseHTML","_parseTSV","_cellState","tbody","each","td","ci","ri","rowspan","colspan","blankCell","after","cellState","internalHTML","internalPlain","getComputedStyle","borders","_borderObject","background","underline","italic","bold","_strippedStyle","textAlign","verticalAlign","prefixes","prefix","borderObject","looksLikeANumber","font-size","word-break","white-space","complement","_normalize","_set","noTrigger","_get","_resizedRef","_border","_collapsedBorder","collapsedBorderTop","collapsedBorderRight","collapsedBorderBottom","collapsedBorderLeft","formula","compile","editorChange","isInEditMode","numberToDate","_","toJSON","_validation","_merge","mergedRef","vi","_properties","setProp","line","propName","propValue","clearAll","contentsOnly","formatOnly","clearFormat","isSortable","_sortBy","isFilterable","clearFilters","_filterBy","_filter","propertyName","hasValue","flag","draw","CalcError","argmax","compileArgumentChecks","functionName","args","comp","allowError","isArray","arrayArgs","resolve","cond","force","canBeArrayArg","hasArrayArgs","typeCheck","forced","haveForced","err","main","Function","withErrorHandling","makeSyncFunction","check","doit","xargs","Matrix","arrays","makeAsyncFunction","count","makeCallback","defineFunction","func","log","console","kendoSpreadsheetArgs","argsAsync","dateToJulianDays","julianDaysToDate","jd","year","month","date","day","ord","ORDINAL_ADD_DAYS","isLeapYear","yr","daysInYear","daysInMonth","mo","DAYS_IN_MONTH","unpackDate","serial","BASE_DATE","packDate","unpackTime","ms","hours","minutes","seconds","frac","MS_IN_DAY","MS_IN_HOUR","MS_IN_MIN","milliseconds","serialToDate","t","packTime","dateToSerial","time","getHours","getMinutes","getSeconds","getMilliseconds","getFullYear","getMonth","getDate","parseDate","binaryCompare","exports","Context","Formula","ARGS_NUMERIC","ARGS_ANYVALUE","ss","parent","self","resolveCells","getRefData","_resolve","onFormula","fetch","context","pending","add","formulas","getRefCells","cellValues","fname","bool","asMatrix","h","isRange","hiddenInfo","getData","includeEmpty","eachRow","eachCol","mapRow","mapCol","transpose","unit","multiply","s","va","vb","adds","sign","determinant","C","L","k","inverse","imax","augment","printer","absrefs","onReady","lcsheet","parentContext","reset","renameSheet","oldSheetName","newSheetName","affectedSheet","operation","formulaRow","formulaCol","formulaSheet","formulaMoves","newFormulaRow","newFormulaCol","co","th","comatrix","thmatrix","elmatrix","defineAlias","alias","orig","kendoSpreadsheetAliases","compileValidation","validationHandler","parsedFromDate","parsedToDate","from","dataType","TRANSPOSE_FORMAT","DATE_FORMAT","fromIsDateValue","parseFormula","to","toIsDateValue","validationComparers","custom","comparerType","valueToCompare","toValue","allowNulls","_getListData","Validation","tooltipMessageTemplate","tooltipTitleTemplate","messageTemplate","titleTemplate","_formatMessages","fromFormula","toFormula","_setMessages","tooltipTitle","tooltipMessage","cube","_getOptions","compareValue","compareFormat","calculateFromCallBack","greaterThan","lessThan","between","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","notBetween","Color","Selection","Sheet","_activeCell","currentOriginalNavigationRange","expanded","changeActiveCell","columnCount","headerHeight","headerWidth","Axis","_frozenRows","_frozenColumns","_suspendChanges","Grid","_sorter","Sorter","_viewSelection","_editSelection","_formulaSelections","showGridLines","_selectionState","_inEdit","_navigator","_axisManager","_name","_sheetName","accessor","_field","suspendChanges","setDataSource","dataSourceBinder","SheetDataSourceBinder","columnIndex","unhide","isHiddenColumn","hidden","_copyRange","sourceRangeRef","targetRef","nextRefTopLeft","nextRefBottomRight","nextIndex","nextBottomIndex","targetIndex","_adjustReferences","_sheets","_forFormulas","_forValidations","adjustNames","nextRef","isEnabledRow","isEnabledColumn","isHiddenRow","numRows","numColumns","parseReference","forEachFilterHeader","columnRef","startCellIndex","endCellIndex","startResizing","initialPosition","_initialPosition","_resizeInProgress","_autoFillInProgress","_autoFillDest","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","resizingInProgress","completeResizing","hintPosition","handlePosition","resizeHintPosition","resizeHandlePosition","_resizeHandlePosition","location","_resizeHintPosition","removeResizeHandle","positionResizeHandle","_selectionInProgress","operatingRange","selectionInProgress","expandedRef","selectionState","isAxis","trim","trims","activeCellSelection","selectedHeaders","allCols","allRows","rowSelection","colSelection","rowState","colState","all","isInEdit","_setFormulaSelections","_viewActiveCell","json","positions","viewSelection","toHex","_sort","activeCellRef","_compileFormula","_compileValidation","Filter","_refreshFilter","logToConsole","cellRefIndex","resetFormulas","resetValidations","next","revalidate","cellRef","_copyValuesInRange","suspended","sortBy","prepare","matches","_clearFilter","ALL_REASONS","currentRef","DOT","EMPTYCHAR","sheetsBarClassNames","SheetsBar","sheetsBarWrapper","sheetsBarSheetsWrapper","sheetsBarActive","sheetsBarInactive","sheetsBarAdd","sheetsBarRemove","sheetsBarItems","sheetsBarEditor","sheetsBarScrollable","sheetsBarNext","sheetsBarPrev","sheetsBarKItem","sheetsBarKActive","sheetsBarKTextbox","sheetsBarKLink","sheetsBarKIcon","sheetsBarKFontIcon","sheetsBarKButton","sheetsBarKButtonBare","sheetsBarKArrowW","sheetsBarKArrowE","sheetsBarKReset","sheetsBarKIconX","sheetsBarKSprite","sheetsBarKIconPlus","sheetsBarHintWrapper","sheetsBarKResetItems","_tree","dom","Tree","render","_addButton","_createSheetsWrapper","_createSortable","_sortable","_onSheetReorderStart","_onSheetReorderEnd","_onSheetRemove","_onSheetSelect","_createEditor","_onAddSelect","scrollable","_editor","_renderSheets","_selectedIndex","_onEditorKeydown","_onEditorBlur","_destroyEditor","renderSheets","sheets","selectedIndex","wrapperOffsetWidth","sheetsGroupScrollWidth","scrollPrevButton","scrollNextButton","scrollPrevButtonWidth","sheetsWrapper","_sheetsWrapper","sheetsGroup","_sheetsGroup","addButtonWidth","outerWidth","_isRtl","isRtl","_scrollableAllowed","scrollWidth","_scrollableModeActive","_toggleScrollButtons","_renderHtml","_nowScrollingSheets","children","marginLeft","marginRight","_toggleScrollEvents","_scrollSheetsByDelta","renderScrollButtons","isSelectedSheet","elementContent","deleteIcon","sheetElements","maxlength","baseButtonClass","childrenElements","Sortable","container","animation","ignore","closest","_onSheetRename","oldIndex","newIndex","removedSheetName","editorValue","selectedSheetText","_scrollSheetsToItem","isAddButton","sheetIndex","item","currentScrollOffset","itemWidth","itemOffset","sheetsGroupWidth","sheetsGroupPadding","itemPosition","scrollLeft","ceil","parseFloat","finish","animate","scrLeft","ul","getcol","getrow","noThrow","stream","OUT","TokenStream","eof","addReference","peek","parseExpression","commas","maybeBinary","maybeIntersect","parseAtom","parseSymbol","upper","TRUE","FALSE","parseFuncall","fixReference","exp","parseArray","op","maybePercent","my_prec","his_prec","OPERATORS","ast","makePrinter","prec","withParens","parenthesize","arg","needParens","makeClosure","toCPS","cps","cpsAtom","cpsUnary","cpsBinary","cpsFunc","cpsLambda","cpsMatrix","cpsIf","makeContinuation","thenK","gensym","elseK","vars","cpsAnd","cpsOr","cont","elements","isMatrix","GENSYM","makeFormula","js","jsArray","FORMULA_CACHE","identity","readNext","ahead","refRange3D","refCell3D","refSheetRange","refSheetCell","refRange","refCell","funcall","toCell","isFirst","forEditor","fixCell","g","space","addPos","RawTokenStream","InputStream","startToken","endToken","isIdStart","isId","isOpChar","isPunc","readNumber","has_dot","number","symbol","getRC","negative","readSymbol","lookingAt","readString","readEscaped","readSheetName","readOperator","readPunc","EOF","forward","RegExp","escaped","predicate","rx","ops","readExcel","deferred","reader","FileReader","onload","zip","JSZip","readWorkbook","readAsArrayBuffer","strings","readStrings","relationships","readRelationships","theme","readTheme","byType","readStyles","items","enter","tag","relId","dim","SEL_SHEET","byId","sheetDimensions","SEL_VIEW","activeTab","integer","SEL_DEFINED_NAME","vbProcedure","defineName","loadSheets","then","recalcSheets","ready","Deferred","promise","insertSheet","queueSheet","progress","notify","readSheet","defaultColWidth","toColWidth","defaultRowHeight","toRowHeight","SEL_ROW","maximumDigitWidth","fraction","pts","formulaRange","nCols","_count","styleIndex","stop","acRef","SEL_CELL","applyStyle","SEL_MERGE","SEL_COL","ht","SEL_SELECTION","SEL_PANE","xSplit","ySplit","SEL_SHEET_VIEW","leave","_refresh","SEL_VALUE","SEL_STRING","SEL_FORMULA","setFormat","formatCode","setFill","setFont","fontFamily","setBorder","side","prop","BORDER_WIDTHS","shouldSet","applyName","xf","base","inlineStyles","xfId","namedStyles","fonts","fills","numFmts","DEFAULT_FORMATS","part","files","asUint8Array","SEL_SHARED_STRING","SEL_TEXT","entries","Id","Target","Type","getXf","addBool","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","getColor","themeColor","tint","rgb","toCSSColor","indexed","INDEXED_COLORS","colorScheme","parseColor","toHSL","toCssRgba","font","fill","closed","SEL_NUM_FMT","SEL_FONT","SEL_FILL","patternType","SEL_BORDER","SEL_NAMED_STYLE","SEL_INLINE_STYLE","horizontal","vertical","wrapText","swap","scheme","SEL_SCHEME_SYSCLR","SEL_SCHEME_RGBCLR","def","none","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantDashDot",0,11,12,14,15,16,17,18,19,21,22,45,47,48,49,"_readSheet","_readStrings","_readStyles","_readTheme","_readWorkbook","Workbook","_sheetsSearchCache","undoRedoStack","_onUndoRedo","_context","FormulaContext","_validationContext","ValidationFormulaContext","_names","unbind","_sheetChange","_inputForRef","commandOptions","editActiveCell","refresh","sheetByName","moveSheetToIndex","toIndex","fromIndex","sheetSelection","insertIndex","sheetName","getUniqueSheetName","sheetNameSuffix","sheetByIndex","removeSheet","newSheet","reject","excel","ooxml","saveAs","dataURI","toDataURL","proxyURL","forceProxy","group","undefineName","nameValue","PDFMixin","_drawPDF","exportPDF","proxyTarget","fail","area","states","currentFormula","toActionSelector","selectors","alphaNumRegExp","ACTIONS","ENTRY_ACTIONS","CONTAINER_EVENTS","CLIPBOARD_EVENTS","EDITOR_EVENTS","FORMULABAR_EVENTS","FORMULAINPUT_EVENTS","SELECTION_MODES","COMPOSITE_UNAVAILABLE_ACTION_SELECTORS","UNHIDE_ACTION_SELECTORS","ACTION_KEYS","SHIFT_ACTION_KEYS","ENTRY_ACTION_KEYS","Controller","up","down","ctrl+left","ctrl+right","ctrl+up","ctrl+down","ctrl+home","ctrl+end","pageup","pagedown","tab","shift+tab","shift+enter","delete","backspace","shift+:alphanum",":alphanum","ctrl+:alphanum",":edit","wheel","*+mousedown","contextmenu","*+mousedrag","*+mouseup","*+dblclick","mousemove","*+pageup","*+pagedown","mouseup","*+cut","*+paste","*+copy","esc","rowheader","columnheader","topcorner","autofill","clipboardElement","cellContextMenu","rowHeaderContextMenu","colHeaderContextMenu","scroller","tabstrip","sheetsbar","editor","onEditorChange","onEditorActivate","onEditorDeactivate","onEditorUpdate","onScroll","listener","keyListener","barKeyListener","barElement","inputKeyListener","cellElement","onSheetBarSelect","onSheetBarReorder","onSheetBarRename","onSheetBarRemove","onContextMenuSelect","onCommandRequest","onDialogRequest","_execute","editorClose","showError","openDialog","_activeTooltip","clientHeight","onWheel","deltaX","originalEvent","deltaY","deltaMode","scrollWith","onAction","onPageUp","scrollDown","onPageDown","onEntryAction","shouldPrevent","disabled","rect","activeCellRectangle","onShiftAction","appendSelection","onMouseMove","objectAt","onMouseDown","pane","originFrame","_selectionMode","deactivate","openFilterMenu","onContextMenu","menu","isComposite","showUnhide","showUnmerge","prevent","constrainResize","resizeHandle","onMouseDrag","frame","startAutoScroll","selectToLocation","scrollTop","onMouseUp","stopAutoScroll","activeEditor","onDblClick","onCut","detach","clipBoardValue","onPaste","hasHTML","hasPlainText","clipboardData","DOMStringList","types","onCopy","scrollRight","offset","coordinates","cellLocation","lastKnownCellLocation","autoScroll","_autoScrollTarget","boundaries","scrollStep","finalLocation","viewObject","_scrollInterval","setInterval","clearInterval","filterMenu","createFilterMenu","openFor","onEditorBarFocus","onEditorCellFocus","onEditorEsc","onEditorBlur","isFiltered","onEditorAction","onEditorShiftAction","exportOptions","pdfExport","excelExport","selectElementContents","selectNodeContents","cellBefore","trs","cellAbove","prevRow","cellBorder","drawCell","collection","hBorders","vBorders","showGrid","defaultBorder","shouldDrawCell","toHSV","backgroundColor","textDecoration","fontStyle","fontWeight","wordBreak","__dataType","paneClassNames","addCell","sibling","borderRightColor","borderBottomColor","borderLeftColor","borderTopColor","within","RESIZE_HANDLE_WIDTH","viewClassNames","VIEW_MESAGES","HtmlTable","CELL_CONTEXT_MENU","ROW_HEADER_CONTEXT_MENU","COL_HEADER_CONTEXT_MENU","VIEW_CONTENTS","View","fixedContainer","viewSize","cellEditor","barEditor","topCorner","filterHeadersWrapper","filterRange","filterButton","filterButtonActive","icon","iconFilterDefault","sheetsBar","messages","errors","openUnsupported","shiftingNonblankCells","filterRangeContainingMerges","sortRangeContainingMerges","validationError","tabs","_height","_width","addColumn","addRow","Node","toDomTree","ContextMenu","contextMenuConfig","scrollbar","_chrome","_dialogs","_formulaInput","clipboardContents","SheetEditor","_sheetsbar","showOn","clientWidth","_resize","tabstripHeight","outerHeight","formulaBarHeight","formulaBar","sheetsBarHeight","quickAccessAdjust","prependTo","toolbar","_tabstrip","content","TabStrip","dataTextField","dataContentField","toolbarOptions","_executeCommand","cellRectangle","_rectangle","boundingRectangle","isColumnResizer","handleWidth","_headerWidth","isRowResizer","_headerHeight","isFilterIcon","filterIconRect","isAutoFill","frozen","paneAt","containingPane","theGrid","refreshTools","totalHeight","_pane","_destroyFilterMenu","_filterMenu","FilterMenu","selectClipBoardContents","scrollIntoView","willScroll","scrollBoundaries","scrollBottom","_destroyDialog","dialog","dialogs","errorMessages","focusLastActive","_filterMenuColumn","renderResizeHint","renderClipboardContents","resizeHint","resizeHintVertical","resizeHintHandle","resizeHintMarker","selectionView","primaryMergedCells","secondaryMergedCells","rangeDimensions","mergedCell","vaxis","haxis","rowHeader","columnHeader","mergedCellsWrapper","selectionWrapper","autoFillWrapper","selectionHighlight","isVisible","paneClasses","_currentView","_currentRect","_selectedHeaders","renderData","renderSelection","renderAutoFill","renderEditorSelection","renderFilterHeaders","hasRowHeader","rowOffset","headerClassName","hasColumnHeader","columnOffset","renderResizeHandler","itemSelection","allHeaders","doLayout","forScreen","xCoords","yCoords","hb","BUTTON_SIZE","BUTTON_OFFSET","Rectangle","filtered","classes","data-column","_addDiv","selections","activeCellClasses","selectionClasses","activeFormulaColor","_activeFormulaColor","_directionClasses","_addTable","cssClass","autoFillRectangle","toDiv","activeFormulaSelection","colorClasses","cellClasses","mergedCellLeft","mergedCellTop","PaneGrid","sum","total","PaneAxis","rangeRef","headerSize","hasHeader","paneSegment","_viewSize","widthCompensation","heightCompensation","_hidden","scrollBarSize","overflow","pageSize","firstHidden","lastHidden","startOffset","startIndex","endOffset","endIndex","startSegment","endSegment","lastPage","_pixelValues","_axis","_start","quarter","sameYear","today","setFullYear","sameMonth","firstDayOfMonth","setMonth","sameWeek","firstWeek","secondWeek","dayOfWeek","constructor","_values","_dates","_blanks","blanks","dates","_logic","logic","criteria","_criteria","expression","Query","filterExpr","filters","_matches","criterionValue","criterionType","valueType","TopFilter","DynamicFilter","_predicate","_average","aboveAverage","belowAverage","tomorrow","addDays","isToday","yesterday","nextWeek","thisWeek","lastWeek","nextMonth","thisMonth","lastMonth","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","yearToDate","cultures","months","names","_lists","ascendingComparer","descendingComparer","li","typeA","typeB","localeCompare","addPlainText","sections","maybeColor","RX_COLORS","maybeCondition","RX_CONDITION","readFormat","sep","decimal","decimalPart","haveTimePart","am","pm","readSection","haveConditional","sec","printSection","printToken","padLeft","adjusted","restart","compileFormatPart","checkComma","scaleCount","hasDate","hasTime","hasAmpm","percentCount","separeThousands","declen","intFormat","decFormat","condition","preamble","CACHE","calendars","standard","days","namesAbbr","ampm","eltime","formatInt","numberFormat","iv","chf","toFixed","formatDec","span","textAndColor","_cosh","_sinh","_tanh","_gcd","_lcm","forIFS","chunks","matrix","parseCriteria","COL","_avg","numbers","_var_sp","divisor","avg","_stdev_sp","_percentrank","exc","nlt","ngt","found","_covariance","ax","ay","_percentile","rank","_percentile_inc","_percentile_exc","fetchValuesForAggregate","opt_ignore_hidden_rows","opt_ignore_errors","opt_use_aggregates","fetchValues","_binom_dist","cumulative","_combinations","weeksInYear","_days_360","d1","d2","numericPredicate","descending","ARGS_COUNTIFS","ARGS_SUMIFS","ARGS_SUMIF","ARGS_PERCENTRANK","_fact","AGGREGATE_FUNCS","RX_NON_PRINTABLE","cos","sin","atan","tan","mult","prod","coef","seen","m1","sumRange","nth","error","res","discard","bins","asc","variance","stddev","significance","fact","f1","f2","p1","p2","funcId","ignoreHidden","alpha","s2","approx","resultCol","cmp","resultRow","fw","sy","dow","wk","hh","mm","holidays","inc","random","rom","radix","minLen","dec","noCommas","newText","oldText","valueIfError","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","RXCACHE","ERF","S","an","f_abs","ERFC","GAMMALN","cof","ser","GAMMA","pi","BETALN","BETA","gamma_inc","g_series","g_contfrac","ap","gln","MAX_IT","EPS","FP_MIN","aj","bj","GAMMA_DIST","GAMMA_INV","M","ab","q","NORM_S_DIST","NORM_S_INV","plow","phigh","NORM_DIST","NORM_INV","betastd_pdf","betastd_cdf","beta_lentz","m2","del","qab","qap","qam","betastd_inv","BETADIST","BETA_DIST","cdf","BETA_INV","chisq_left","cds","chisq_right","chisq_left_inv","chisq_right_inv","chisq_test","obsv","expect","eij","expon","poisson","lnf","Fdist","Fdist_right","Finv_right","Finv","_mean","me","_var_sq","Ftest","arr1","arr2","n1","n2","va1","va2","fisher","fisherinv","e2","Tdist","Tdist_right","Tdist_2tail","Tdist_inv","Tdist_2tail_inv","Tdist_test","gr1","gr2","tail","t_st","df","md","v1","v2","u1","u2","q1","q2","confidence_t","confidence_norm","gauss","z","phi","lognorm_dist","lognorm_inv","prob","x_","p_","lw","slope","y_","mx","my","b1","b2","intercept","pearson","t1","t2","s1","s3","rsq","steyx","forecast","_mat_mean","Mat","_mat_devsq","mean","sq","linest","Y","X","konst","stats","Xt","B","line_1","Y1","y_y1","mp","SSreg","SSresid","line_5","R2","degfre","err_est","line_3","F_sta","line_4","SCP","line_2","logest","trend","W","growth","new_X","root_newton","guess","max_it","eps","f_d","FV","rate","nper","pmt","pv","h1","h2","PV","fv","PMT","NPER","RATE","xfd","IPMT","per","ipmt","PPMT","CUMPRINC","tn","ts","te","monthlyPayment","remainingBalanceAtStart","remainingBalanceAtEnd","CUMIPMT","cip","NPV","flows","npv","IRR","npv1","EFFECT","nominal_rate","npery","NOMINAL","effect_rate","XNPV","XIRR","ISPMT","DB","cost","salvage","life","period","db","DDB","factor","prior","dep","SLN","SYD","VDB","no_switch","_getGDA","gda","oldValue","interest","_interVDB","life1","term","remValue","intEnd","lia","vdb","nowLia","intStart","_edate","_daysBetween","basis","_borderCoupons","settlement","maturity","freq","sett","periods","_borderCoupons_fw","COUPDAYBS","frequency","COUPDAYS","settl","matur","COUPDAYSNC","COUPPCD","COUPNCD","COUPNUM","mat","ACCRINTM","issue","par","year_days","ACCRINT","_numCoupons","annual","brace","prev1","next1","nrc","accr","DISC","pr","redemption","INTRATE","investment","RECEIVED","discount","PRICE","yld","N","beg_settl","settl_end","beg_end","den","yf","PRICEDISC","dsm","COUPS_ARGS","ll","ac","BORDER_TYPES","BORDER_PALETTE_MESSAGES","ColorChooser","BorderPalette","borderPalette","customColor","cancel","_resetButton","_colorPalette","_customColorPalette","_customColorButton","resetButton","resetColor","customColorButton","colorPalette","flatColorPicker","_change","class","kendoColorPalette","palette","viewModel","kendoWindow","resizable","maximizable","modal","center","one","_hueSlider","kendoFlatColorPicker","observable","_borderTypePalette","_borderColorPalette","_click","colorChooser","buttons","_colorChange","currentTarget","ToolBar","MESSAGES","defaultTools","toolDefaults","SpreadsheetToolBar","DropDownTool","PopupTool","OverflowDialogButton","ColorPicker","ColorPickerButton","FONT_SIZES","DEFAULT_FONT_SIZE","FontSize","FontSizeButton","FONT_FAMILIES","DEFAULT_FONT_FAMILY","FontFamily","FontFamilyButton","defaultFormats","Format","FormatButton","BorderChangeTool","BorderChangeButton","AlignmentTool","AlignmentButton","MergeTool","MergeButton","FreezeTool","FreezeButton","Sort","SortButton","FilterButton","Open","alignment","alignmentButtons","justtifyLeft","justifyCenter","justifyRight","justifyFull","alignTop","alignMiddle","alignBottom","colorPicker","formatTypes","automatic","percent","financial","currency","dateTime","duration","moreFormats","formatDecreaseDecimal","formatIncreaseDecimal","freeze","freezeButtons","freezePanes","freezeRows","freezeColumns","mergeButtons","mergeCells","mergeHorizontally","mergeVertically","quickAccess","exportAs","sortAsc","sortDesc","sortButtons","sortSheetAsc","sortSheetDesc","sortRangeAsc","sortRangeDesc","textColor","textWrap","iconClass","dialogName","togglable","separator","formatCells","_expandTools","tools","toolbarName","handleClick","_addSeparators","click","groups","before","expandTool","toolName","isPlainObject","spriteCssClass","typeDefaults","splitButton","showText","toolIcon","tool","attributes","menuButtons","commandType","checked","setToggle","update","_tools","isFunction","toArray","_getItem","instance","Item","dropDownList","kendoDropDownList","addUidAttr","addOverflowAttr","_open","data-command","data-property","listWidth","ddl","_listWidth","sender","dataItem","popupName","kendoPopup","registerComponent","ToolBarButton","_dialogName","OverflowButton","iconName","comboBox","kendoComboBox","_valueChange","fontSizes","sizes","defaultSize","fontFamilies","defaultFont","_revertTitle","setOptions","dataValuePrimitive","valueTemplate","sample","_borderPalette","_action","_commandPalette","removeClass","_quickAccessButtons","quickAccessToolBar","toolbars","contentElements","_toolbar","buttonTemplate","insertBefore","tabGroup","formattedValue","uniqueBy","ObservableObject","registry","SpreadsheetDialog","FormatCellsViewModel","FormatCellsDialog","MessageDialog","FontFamilyDialog","FontSizeDialog","BordersDialog","ColorPickerDialog","CustomColorDialog","AlignmentDialog","MergeDialog","FreezeDialog","ValidationViewModel","ValidationDialog","ExportAsDialog","ModifyMergedDialog","UseKeyboardDialog","UnsupportedSelectionDialog","okText","formatCellsDialog","categories","fontFamilyDialog","fontSizeDialog","bordersDialog","alignmentDialog","mergeDialog","freezeDialog","validationDialog","hintMessage","hintTitle","any","comparers","comparerMessages","labels","onInvalidData","rejectInput","showWarning","showHint","ignoreBlank","placeholders","typeTitle","typeMessage","exportAsDialog","fit","saveAsType","exportArea","paperSize","margins","orientation","guidelines","modifyMergedDialog","errorMessage","useKeyboardDialog","forCopy","forCut","forPaste","unsupportedSelectionDialog","register","dialogClass","_dialog","_onDialogClose","_onDialogActivate","_onDialogDeactivate","useCategory","category","formatCurrency","currencies","allFormats","useFirstFormat","info","_currency","iso","convert","categoryFilter","repeat","pattern","abbr","_generateFormats","calendarPatterns","currenciesFrom","numberFormats","dateFormats","currencyFilter","roleSelector","description","_list","_colorPicker","ValidationCellsViewModel","criterion","setHintMessageTemplate","shouldBuild","buildMessages","hintTitleTemplate","hintMessageTemplate","setComparers","defaultHintTitle","text_comparers","defaultComparers","defaultHintMessage","isAny","showToForNumber","showTo","showToForDate","isDate","isText","isList","isCustom","showRemove","fromValidationObject","useCustomMessages","toValidationObject","errorTemplate","validatable","Validator","validateOnBlur","validate","fileFormats","author","subject","keywords","creator","fitWidth","areas","paperSizes","margin","landscape","hCenter","vCenter","_normalizeColumns","_dataSource","_header","_sheetChangeHandler","_sheetDeleteRowHandler","_sheetDeleteRow","_sheetInsertRowHandler","_sheetInsertRow","model","_skipRebind","record","_changeHandler","getters","getter","getterIdx","distinctValues","query","itemVisible","anyVisibleChildren","hasVisibleChildren","HierarchicalDataSource","uncheckAll","hasChildren","flattenOperators","operators","FILTERMENU_MESSAGES","Details","templates","FilterMenuViewModel","FilterMenuController","details","detailsSummary","detailsContent","iconCollapse","iconExpand","iconSearch","textbox","filterByCondition","filterByValue","valuesTreeViewWrapper","actionButtons","_summary","_toggle","_icon","_container","fx","expand","sortAscending","sortDescending","search","addToCurrent","operatorNone","and","or","doesnotcontain","startswith","endswith","neq","gte","lte","binders","spreadsheetFilterValue","Binder","bindings","proxy","widget","binding","menuItem","valuesChange","valuesDataSource","lastIndexOf","appendToSearch","valueSelect","hasActiveSearch","filterValues","operatorChange","isNone","isString","valuesTree","filterType","topValue","filterForColumn","allFilters","columnFilters","_filterInit","_filterByCondition","_filterByValue","_actionButtons","valuesTreeView","_active","activeFilter","copyAnchorStyles","dir","kendoMenu","_appendTemplate","compiledTemplate","_detailToggle","not","isExpanded","activeContainer","hasClass","notEqual","oldRect","newRect","barInput","cellInput","_triggerUpdate","lastActive","activeElement","_rect","inputType","linearRegression","findSeries","findStep","forEachSeries","formatType","getType","lst","findStringList","stringLists","strl","MSG_INCOMPATIBLE","MSG_NO_DIRECTION","srcRange","src","srcIdx","destRange","distributeCoords","heights","pageHeight","curr","getMergedCells","primary","secondary","pageWidth","scaleFactor","boxWidth","boxHeight","rowHeights","colWidths","maxRow","maxCol","nonEmpty","relrow","relcol","emptyCells","orlast","normalOrder","drawLayout","addPage","page","endbottom","endright","Group","clip","Path","fromRect","geo","Rect","multiplyCopy","translate","transform","moveTo","lineTo","stroke","GUIDELINE_WIDTH","ncols","nrows","r2d2","drawText","vtrans","rect_left","rect_top","rect_width","rect_height","makeFontDef","lines","text_height","lineBreak","Text","htrans","eol","sub","paper","getPaperOptions","multiPage","geometry","NS","Spreadsheet","_controller","_autoRefresh","_bindWorkbookEvents","_resizeHandler","_workbookChange","autoRefresh","blob","_workbookExcelExport","_workbookExcelImport","_initProgress","loading","pb","kendoProgressBar","chunkCount","always","_workbookPdfExport","plugin"],"mappings":"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","file":"kendo.spreadsheet.min.js","sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function (f, define) {\n    define('util/undoredostack', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var UndoRedoStack = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.clear();\n            },\n            events: [\n                'undo',\n                'redo'\n            ],\n            push: function (command) {\n                this.stack = this.stack.slice(0, this.currentCommandIndex + 1);\n                this.currentCommandIndex = this.stack.push(command) - 1;\n            },\n            undo: function () {\n                if (this.canUndo()) {\n                    var command = this.stack[this.currentCommandIndex--];\n                    command.undo();\n                    this.trigger('undo', { command: command });\n                }\n            },\n            redo: function () {\n                if (this.canRedo()) {\n                    var command = this.stack[++this.currentCommandIndex];\n                    command.redo();\n                    this.trigger('redo', { command: command });\n                }\n            },\n            clear: function () {\n                this.stack = [];\n                this.currentCommandIndex = -1;\n            },\n            canUndo: function () {\n                return this.currentCommandIndex >= 0;\n            },\n            canRedo: function () {\n                return this.currentCommandIndex != this.stack.length - 1;\n            }\n        });\n        kendo.deepExtend(kendo, { util: { UndoRedoStack: UndoRedoStack } });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/main', ['kendo.core'], f);\n}(function () {\n    (function () {\n        var math = Math, kendo = window.kendo, deepExtend = kendo.deepExtend;\n        var DEG_TO_RAD = math.PI / 180, MAX_NUM = Number.MAX_VALUE, MIN_NUM = -Number.MAX_VALUE, UNDEFINED = 'undefined';\n        function defined(value) {\n            return typeof value !== UNDEFINED;\n        }\n        function round(value, precision) {\n            var power = pow(precision);\n            return math.round(value * power) / power;\n        }\n        function pow(p) {\n            if (p) {\n                return math.pow(10, p);\n            } else {\n                return 1;\n            }\n        }\n        function limitValue(value, min, max) {\n            return math.max(math.min(value, max), min);\n        }\n        function rad(degrees) {\n            return degrees * DEG_TO_RAD;\n        }\n        function deg(radians) {\n            return radians / DEG_TO_RAD;\n        }\n        function isNumber(val) {\n            return typeof val === 'number' && !isNaN(val);\n        }\n        function valueOrDefault(value, defaultValue) {\n            return defined(value) ? value : defaultValue;\n        }\n        function sqr(value) {\n            return value * value;\n        }\n        function objectKey(object) {\n            var parts = [];\n            for (var key in object) {\n                parts.push(key + object[key]);\n            }\n            return parts.sort().join('');\n        }\n        function hashKey(str) {\n            var hash = 2166136261;\n            for (var i = 0; i < str.length; ++i) {\n                hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);\n                hash ^= str.charCodeAt(i);\n            }\n            return hash >>> 0;\n        }\n        function hashObject(object) {\n            return hashKey(objectKey(object));\n        }\n        var now = Date.now;\n        if (!now) {\n            now = function () {\n                return new Date().getTime();\n            };\n        }\n        function arrayLimits(arr) {\n            var length = arr.length, i, min = MAX_NUM, max = MIN_NUM;\n            for (i = 0; i < length; i++) {\n                max = math.max(max, arr[i]);\n                min = math.min(min, arr[i]);\n            }\n            return {\n                min: min,\n                max: max\n            };\n        }\n        function arrayMin(arr) {\n            return arrayLimits(arr).min;\n        }\n        function arrayMax(arr) {\n            return arrayLimits(arr).max;\n        }\n        function sparseArrayMin(arr) {\n            return sparseArrayLimits(arr).min;\n        }\n        function sparseArrayMax(arr) {\n            return sparseArrayLimits(arr).max;\n        }\n        function sparseArrayLimits(arr) {\n            var min = MAX_NUM, max = MIN_NUM;\n            for (var i = 0, length = arr.length; i < length; i++) {\n                var n = arr[i];\n                if (n !== null && isFinite(n)) {\n                    min = math.min(min, n);\n                    max = math.max(max, n);\n                }\n            }\n            return {\n                min: min === MAX_NUM ? undefined : min,\n                max: max === MIN_NUM ? undefined : max\n            };\n        }\n        function last(array) {\n            if (array) {\n                return array[array.length - 1];\n            }\n        }\n        function append(first, second) {\n            first.push.apply(first, second);\n            return first;\n        }\n        function renderTemplate(text) {\n            return kendo.template(text, {\n                useWithBlock: false,\n                paramName: 'd'\n            });\n        }\n        function renderAttr(name, value) {\n            return defined(value) && value !== null ? ' ' + name + '=\\'' + value + '\\' ' : '';\n        }\n        function renderAllAttr(attrs) {\n            var output = '';\n            for (var i = 0; i < attrs.length; i++) {\n                output += renderAttr(attrs[i][0], attrs[i][1]);\n            }\n            return output;\n        }\n        function renderStyle(attrs) {\n            var output = '';\n            for (var i = 0; i < attrs.length; i++) {\n                var value = attrs[i][1];\n                if (defined(value)) {\n                    output += attrs[i][0] + ':' + value + ';';\n                }\n            }\n            if (output !== '') {\n                return output;\n            }\n        }\n        function renderSize(size) {\n            if (typeof size !== 'string') {\n                size += 'px';\n            }\n            return size;\n        }\n        function renderPos(pos) {\n            var result = [];\n            if (pos) {\n                var parts = kendo.toHyphens(pos).split('-');\n                for (var i = 0; i < parts.length; i++) {\n                    result.push('k-pos-' + parts[i]);\n                }\n            }\n            return result.join(' ');\n        }\n        function isTransparent(color) {\n            return color === '' || color === null || color === 'none' || color === 'transparent' || !defined(color);\n        }\n        function arabicToRoman(n) {\n            var literals = {\n                1: 'i',\n                10: 'x',\n                100: 'c',\n                2: 'ii',\n                20: 'xx',\n                200: 'cc',\n                3: 'iii',\n                30: 'xxx',\n                300: 'ccc',\n                4: 'iv',\n                40: 'xl',\n                400: 'cd',\n                5: 'v',\n                50: 'l',\n                500: 'd',\n                6: 'vi',\n                60: 'lx',\n                600: 'dc',\n                7: 'vii',\n                70: 'lxx',\n                700: 'dcc',\n                8: 'viii',\n                80: 'lxxx',\n                800: 'dccc',\n                9: 'ix',\n                90: 'xc',\n                900: 'cm',\n                1000: 'm'\n            };\n            var values = [\n                1000,\n                900,\n                800,\n                700,\n                600,\n                500,\n                400,\n                300,\n                200,\n                100,\n                90,\n                80,\n                70,\n                60,\n                50,\n                40,\n                30,\n                20,\n                10,\n                9,\n                8,\n                7,\n                6,\n                5,\n                4,\n                3,\n                2,\n                1\n            ];\n            var roman = '';\n            while (n > 0) {\n                if (n < values[0]) {\n                    values.shift();\n                } else {\n                    roman += literals[values[0]];\n                    n -= values[0];\n                }\n            }\n            return roman;\n        }\n        function romanToArabic(r) {\n            r = r.toLowerCase();\n            var digits = {\n                i: 1,\n                v: 5,\n                x: 10,\n                l: 50,\n                c: 100,\n                d: 500,\n                m: 1000\n            };\n            var value = 0, prev = 0;\n            for (var i = 0; i < r.length; ++i) {\n                var v = digits[r.charAt(i)];\n                if (!v) {\n                    return null;\n                }\n                value += v;\n                if (v > prev) {\n                    value -= 2 * prev;\n                }\n                prev = v;\n            }\n            return value;\n        }\n        function memoize(f) {\n            var cache = Object.create(null);\n            return function () {\n                var id = '';\n                for (var i = arguments.length; --i >= 0;) {\n                    id += ':' + arguments[i];\n                }\n                if (id in cache) {\n                    return cache[id];\n                }\n                return f.apply(this, arguments);\n            };\n        }\n        function ucs2decode(string) {\n            var output = [], counter = 0, length = string.length, value, extra;\n            while (counter < length) {\n                value = string.charCodeAt(counter++);\n                if (value >= 55296 && value <= 56319 && counter < length) {\n                    extra = string.charCodeAt(counter++);\n                    if ((extra & 64512) == 56320) {\n                        output.push(((value & 1023) << 10) + (extra & 1023) + 65536);\n                    } else {\n                        output.push(value);\n                        counter--;\n                    }\n                } else {\n                    output.push(value);\n                }\n            }\n            return output;\n        }\n        function ucs2encode(array) {\n            return array.map(function (value) {\n                var output = '';\n                if (value > 65535) {\n                    value -= 65536;\n                    output += String.fromCharCode(value >>> 10 & 1023 | 55296);\n                    value = 56320 | value & 1023;\n                }\n                output += String.fromCharCode(value);\n                return output;\n            }).join('');\n        }\n        deepExtend(kendo, {\n            util: {\n                MAX_NUM: MAX_NUM,\n                MIN_NUM: MIN_NUM,\n                append: append,\n                arrayLimits: arrayLimits,\n                arrayMin: arrayMin,\n                arrayMax: arrayMax,\n                defined: defined,\n                deg: deg,\n                hashKey: hashKey,\n                hashObject: hashObject,\n                isNumber: isNumber,\n                isTransparent: isTransparent,\n                last: last,\n                limitValue: limitValue,\n                now: now,\n                objectKey: objectKey,\n                round: round,\n                rad: rad,\n                renderAttr: renderAttr,\n                renderAllAttr: renderAllAttr,\n                renderPos: renderPos,\n                renderSize: renderSize,\n                renderStyle: renderStyle,\n                renderTemplate: renderTemplate,\n                sparseArrayLimits: sparseArrayLimits,\n                sparseArrayMin: sparseArrayMin,\n                sparseArrayMax: sparseArrayMax,\n                sqr: sqr,\n                valueOrDefault: valueOrDefault,\n                romanToArabic: romanToArabic,\n                arabicToRoman: arabicToRoman,\n                memoize: memoize,\n                ucs2encode: ucs2encode,\n                ucs2decode: ucs2decode\n            }\n        });\n        kendo.drawing.util = kendo.util;\n        kendo.dataviz.util = kendo.util;\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/text-metrics', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    (function ($) {\n        var doc = document, kendo = window.kendo, Class = kendo.Class, util = kendo.util, defined = util.defined;\n        var LRUCache = Class.extend({\n            init: function (size) {\n                this._size = size;\n                this._length = 0;\n                this._map = {};\n            },\n            put: function (key, value) {\n                var lru = this, map = lru._map, entry = {\n                        key: key,\n                        value: value\n                    };\n                map[key] = entry;\n                if (!lru._head) {\n                    lru._head = lru._tail = entry;\n                } else {\n                    lru._tail.newer = entry;\n                    entry.older = lru._tail;\n                    lru._tail = entry;\n                }\n                if (lru._length >= lru._size) {\n                    map[lru._head.key] = null;\n                    lru._head = lru._head.newer;\n                    lru._head.older = null;\n                } else {\n                    lru._length++;\n                }\n            },\n            get: function (key) {\n                var lru = this, entry = lru._map[key];\n                if (entry) {\n                    if (entry === lru._head && entry !== lru._tail) {\n                        lru._head = entry.newer;\n                        lru._head.older = null;\n                    }\n                    if (entry !== lru._tail) {\n                        if (entry.older) {\n                            entry.older.newer = entry.newer;\n                            entry.newer.older = entry.older;\n                        }\n                        entry.older = lru._tail;\n                        entry.newer = null;\n                        lru._tail.newer = entry;\n                        lru._tail = entry;\n                    }\n                    return entry.value;\n                }\n            }\n        });\n        var defaultMeasureBox = $('<div style=\\'position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;' + 'padding: 0 !important; margin: 0 !important; border: 0 !important;' + 'line-height: normal !important; visibility: hidden !important; white-space: nowrap!important;\\' />')[0];\n        var TextMetrics = Class.extend({\n            init: function (options) {\n                this._cache = new LRUCache(1000);\n                this._initOptions(options);\n            },\n            options: { baselineMarkerSize: 1 },\n            measure: function (text, style, box) {\n                var styleKey = util.objectKey(style), cacheKey = util.hashKey(text + styleKey), cachedResult = this._cache.get(cacheKey);\n                if (cachedResult) {\n                    return cachedResult;\n                }\n                var size = {\n                    width: 0,\n                    height: 0,\n                    baseline: 0\n                };\n                var measureBox = box ? box : defaultMeasureBox;\n                var baselineMarker = this._baselineMarker().cloneNode(false);\n                for (var key in style) {\n                    var value = style[key];\n                    if (defined(value)) {\n                        measureBox.style[key] = value;\n                    }\n                }\n                $(measureBox).text(text);\n                measureBox.appendChild(baselineMarker);\n                doc.body.appendChild(measureBox);\n                if ((text + '').length) {\n                    size.width = measureBox.offsetWidth - this.options.baselineMarkerSize;\n                    size.height = measureBox.offsetHeight;\n                    size.baseline = baselineMarker.offsetTop + this.options.baselineMarkerSize;\n                }\n                if (size.width > 0 && size.height > 0) {\n                    this._cache.put(cacheKey, size);\n                }\n                measureBox.parentNode.removeChild(measureBox);\n                return size;\n            },\n            _baselineMarker: function () {\n                return $('<div class=\\'k-baseline-marker\\' ' + 'style=\\'display: inline-block; vertical-align: baseline;' + 'width: ' + this.options.baselineMarkerSize + 'px; height: ' + this.options.baselineMarkerSize + 'px;' + 'overflow: hidden;\\' />')[0];\n            }\n        });\n        TextMetrics.current = new TextMetrics();\n        function measureText(text, style, measureBox) {\n            return TextMetrics.current.measure(text, style, measureBox);\n        }\n        kendo.util.TextMetrics = TextMetrics;\n        kendo.util.LRUCache = LRUCache;\n        kendo.util.measureText = measureText;\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/parse-xml', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    var STRING = String.fromCharCode;\n    var ENTITIES = {\n        'amp': 38,\n        'lt': 60,\n        'gt': 62,\n        'quot': 34,\n        'nbsp': 160\n    };\n    function CODE(str) {\n        var out = [];\n        for (var i = 0; i < str.length; ++i) {\n            out.push(str.charCodeAt(i));\n        }\n        return out;\n    }\n    function UCS2(out, code) {\n        if (code > 65535) {\n            code -= 65536;\n            out.push(code >>> 10 & 1023 | 55296, 56320 | code & 1023);\n        } else {\n            out.push(code);\n        }\n    }\n    var START_CDATA = CODE('<![CDATA[');\n    var END_CDATA = CODE(']]>');\n    var END_COMMENT = CODE('-->');\n    var START_COMMENT = CODE('!--');\n    var END_SHORT_TAG = CODE('/>');\n    var END_TAG = CODE('</');\n    var END_DECLARATION = CODE('?>');\n    var QUESTION_MARK = CODE('?');\n    var LESS_THAN = CODE('<');\n    var GREATER_THAN = CODE('>');\n    var SEMICOLON = CODE(';');\n    var EQUAL = CODE('=');\n    var AMPERSAND = CODE('&');\n    var QUOTE = CODE('\"');\n    var APOSTROPHE = CODE('\\'');\n    var SHARP = CODE('#');\n    var LOWERCASE_X = CODE('x');\n    var UPPERCASE_X = CODE('X');\n    var EXIT = {};\n    function parse(data, callbacks) {\n        var index = 0;\n        var stack = [];\n        var object = {\n            is: function (selector) {\n                var i = stack.length, j = selector.length;\n                while (--i >= 0 && --j >= 0) {\n                    if (stack[i].$tag != selector[j] && selector[j] != '*') {\n                        return false;\n                    }\n                }\n                return j < 0 ? stack[stack.length - 1] : null;\n            },\n            exit: function () {\n                throw EXIT;\n            },\n            stack: stack\n        };\n        function readChar(body) {\n            var code = data[index++];\n            if (!(code & 240 ^ 240)) {\n                UCS2(body, (code & 3) << 18 | (data[index++] & 63) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 224 ^ 224)) {\n                UCS2(body, (code & 15) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 192 ^ 192)) {\n                UCS2(body, (code & 31) << 6 | data[index++] & 63);\n            } else {\n                body.push(code);\n            }\n        }\n        function croak(msg) {\n            throw new Error(msg + ', at ' + index);\n        }\n        function readWhile(pred) {\n            var a = [];\n            while (index < data.length && pred(data[index])) {\n                a.push(data[index++]);\n            }\n            return a;\n        }\n        function readAsciiWhile(pred) {\n            return STRING.apply(0, readWhile(pred));\n        }\n        function skipWhitespace() {\n            readWhile(isWhitespace);\n        }\n        function eat(a) {\n            var save = index;\n            for (var i = 0; i < a.length; ++i) {\n                if (data[index++] != a[i]) {\n                    index = save;\n                    return false;\n                }\n            }\n            return a;\n        }\n        function skip(code) {\n            if (!eat(code)) {\n                croak('Expecting ' + code.join(', '));\n            }\n        }\n        function isWhitespace(code) {\n            return code == 9 || code == 10 || code == 13 || code == 32;\n        }\n        function isDigit(code) {\n            return code >= 48 && code <= 57;\n        }\n        function isHexDigit(code) {\n            return code >= 48 && code <= 57 || (code |= 32) >= 97 && code <= 102;\n        }\n        function isNameStart(code) {\n            return code == 58 || code == 95 || (code |= 32) >= 97 && code <= 122;\n        }\n        function isName(code) {\n            return code == 45 || isDigit(code) || isNameStart(code);\n        }\n        function xmlComment() {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_COMMENT)) {\n                    return call('comment', STRING.apply(0, body));\n                }\n                readChar(body);\n            }\n        }\n        function xmlTag() {\n            var name, attrs;\n            if (eat(QUESTION_MARK)) {\n                xmlDecl();\n            } else if (eat(START_COMMENT)) {\n                xmlComment();\n            } else {\n                name = xmlName();\n                attrs = xmlAttrs(name);\n                stack.push(attrs);\n                if (eat(END_SHORT_TAG)) {\n                    call('enter', name, attrs, true);\n                } else {\n                    skip(GREATER_THAN);\n                    call('enter', name, attrs);\n                    xmlContent(name);\n                    if (name != xmlName()) {\n                        croak('Bad closing tag');\n                    }\n                    call('leave', name, attrs);\n                    skipWhitespace();\n                    skip(GREATER_THAN);\n                }\n                stack.pop();\n            }\n        }\n        function xmlContent(name) {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_TAG)) {\n                    return body.length && call('text', STRING.apply(0, body));\n                } else if (eat(START_CDATA)) {\n                    while (index < data.length && !eat(END_CDATA)) {\n                        readChar(body);\n                    }\n                } else if (eat(LESS_THAN)) {\n                    if (body.length) {\n                        call('text', STRING.apply(0, body));\n                    }\n                    xmlTag();\n                    body = [];\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unclosed tag ' + name);\n        }\n        function xmlName() {\n            if (!isNameStart(data[index])) {\n                croak('Expecting XML name');\n            }\n            return readAsciiWhile(isName);\n        }\n        function xmlString() {\n            var quote = eat(QUOTE) || eat(APOSTROPHE);\n            if (!quote) {\n                croak('Expecting string');\n            }\n            var body = [];\n            while (index < data.length) {\n                if (eat(quote)) {\n                    return STRING.apply(0, body);\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unfinished string');\n        }\n        function xmlEntity(body) {\n            var code;\n            if (eat(SHARP)) {\n                if (eat(LOWERCASE_X) || eat(UPPERCASE_X)) {\n                    code = parseInt(readAsciiWhile(isHexDigit), 16);\n                } else {\n                    code = parseInt(readAsciiWhile(isDigit), 10);\n                }\n                if (isNaN(code)) {\n                    croak('Bad numeric entity');\n                }\n            } else {\n                var name = xmlName();\n                code = ENTITIES[name];\n                if (code === undefined) {\n                    croak('Unknown entity ' + name);\n                }\n            }\n            UCS2(body, code);\n            skip(SEMICOLON);\n        }\n        function xmlDecl() {\n            call('decl', xmlName(), xmlAttrs());\n            skip(END_DECLARATION);\n        }\n        function xmlAttrs(name) {\n            var map = { $tag: name };\n            while (index < data.length) {\n                skipWhitespace();\n                var code = data[index];\n                if (code == 63 || code == 62 || code == 47) {\n                    break;\n                }\n                map[xmlName()] = (skip(EQUAL), xmlString());\n            }\n            return map;\n        }\n        function call(what, thing, arg1, arg2) {\n            var f = callbacks && callbacks[what];\n            if (f) {\n                f.call(object, thing, arg1, arg2);\n            }\n        }\n        while (index < data.length) {\n            skipWhitespace();\n            skip(LESS_THAN);\n            xmlTag();\n            skipWhitespace();\n        }\n    }\n    kendo.util.parseXML = function parseXML() {\n        try {\n            return parse.apply(this, arguments);\n        } catch (ex) {\n            if (ex !== EXIT) {\n                throw ex;\n            }\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/base64', ['util/main'], f);\n}(function () {\n    (function () {\n        var kendo = window.kendo, deepExtend = kendo.deepExtend, fromCharCode = String.fromCharCode;\n        var KEY_STR = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n        function encodeBase64(input) {\n            var output = '';\n            var chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n            var i = 0;\n            input = encodeUTF8(input);\n            while (i < input.length) {\n                chr1 = input.charCodeAt(i++);\n                chr2 = input.charCodeAt(i++);\n                chr3 = input.charCodeAt(i++);\n                enc1 = chr1 >> 2;\n                enc2 = (chr1 & 3) << 4 | chr2 >> 4;\n                enc3 = (chr2 & 15) << 2 | chr3 >> 6;\n                enc4 = chr3 & 63;\n                if (isNaN(chr2)) {\n                    enc3 = enc4 = 64;\n                } else if (isNaN(chr3)) {\n                    enc4 = 64;\n                }\n                output = output + KEY_STR.charAt(enc1) + KEY_STR.charAt(enc2) + KEY_STR.charAt(enc3) + KEY_STR.charAt(enc4);\n            }\n            return output;\n        }\n        function encodeUTF8(input) {\n            var output = '';\n            for (var i = 0; i < input.length; i++) {\n                var c = input.charCodeAt(i);\n                if (c < 128) {\n                    output += fromCharCode(c);\n                } else if (c < 2048) {\n                    output += fromCharCode(192 | c >>> 6);\n                    output += fromCharCode(128 | c & 63);\n                } else if (c < 65536) {\n                    output += fromCharCode(224 | c >>> 12);\n                    output += fromCharCode(128 | c >>> 6 & 63);\n                    output += fromCharCode(128 | c & 63);\n                }\n            }\n            return output;\n        }\n        deepExtend(kendo.util, {\n            encodeBase64: encodeBase64,\n            encodeUTF8: encodeUTF8\n        });\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('mixins/observers', ['kendo.core'], f);\n}(function () {\n    (function ($) {\n        var math = Math, kendo = window.kendo, deepExtend = kendo.deepExtend, inArray = $.inArray;\n        var ObserversMixin = {\n            observers: function () {\n                this._observers = this._observers || [];\n                return this._observers;\n            },\n            addObserver: function (element) {\n                if (!this._observers) {\n                    this._observers = [element];\n                } else {\n                    this._observers.push(element);\n                }\n                return this;\n            },\n            removeObserver: function (element) {\n                var observers = this.observers();\n                var index = inArray(element, observers);\n                if (index != -1) {\n                    observers.splice(index, 1);\n                }\n                return this;\n            },\n            trigger: function (methodName, event) {\n                var observers = this._observers;\n                var observer;\n                var idx;\n                if (observers && !this._suspended) {\n                    for (idx = 0; idx < observers.length; idx++) {\n                        observer = observers[idx];\n                        if (observer[methodName]) {\n                            observer[methodName](event);\n                        }\n                    }\n                }\n                return this;\n            },\n            optionsChange: function (e) {\n                this.trigger('optionsChange', e);\n            },\n            geometryChange: function (e) {\n                this.trigger('geometryChange', e);\n            },\n            suspend: function () {\n                this._suspended = (this._suspended || 0) + 1;\n                return this;\n            },\n            resume: function () {\n                this._suspended = math.max((this._suspended || 0) - 1, 0);\n                return this;\n            },\n            _observerField: function (field, value) {\n                if (this[field]) {\n                    this[field].removeObserver(this);\n                }\n                this[field] = value;\n                value.addObserver(this);\n            }\n        };\n        deepExtend(kendo, { mixins: { ObserversMixin: ObserversMixin } });\n    }(window.kendo.jQuery));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/commands', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.window',\n        'kendo.list',\n        'kendo.tabstrip'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Command = kendo.spreadsheet.Command = kendo.Class.extend({\n            init: function (options) {\n                this.options = options;\n                this._workbook = options.workbook;\n                this._property = options && options.property;\n                this._state = {};\n            },\n            range: function (range) {\n                if (range !== undefined) {\n                    this._range = range;\n                }\n                return this._range;\n            },\n            redo: function () {\n                this.exec();\n            },\n            undo: function () {\n                this.range().setState(this._state);\n            },\n            getState: function () {\n                this._state = this.range().getState(this._property);\n            },\n            _forEachCell: function (callback) {\n                var range = this.range();\n                var ref = range._ref;\n                ref.forEach(function (ref) {\n                    range.sheet().forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            }\n        });\n        var PropertyChangeCommand = kendo.spreadsheet.PropertyChangeCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                var range = this.range();\n                this.getState();\n                range[this._property](this._value);\n            }\n        });\n        kendo.spreadsheet.ClearContentCommand = Command.extend({\n            exec: function () {\n                this.getState();\n                this.range().clearContent();\n            }\n        });\n        kendo.spreadsheet.EditCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'input';\n                PropertyChangeCommand.fn.init.call(this, options);\n            },\n            rejectState: function (validationState) {\n                this.undo();\n                return {\n                    title: validationState.title,\n                    body: validationState.message,\n                    reason: 'error',\n                    type: 'validationError'\n                };\n            },\n            exec: function () {\n                var range = this.range();\n                var value = this._value;\n                this.getState();\n                try {\n                    range.input(value);\n                    var validationState = range._getValidationState();\n                    if (validationState) {\n                        return this.rejectState(validationState);\n                    }\n                } catch (ex1) {\n                    if (ex1 instanceof kendo.spreadsheet.calc.ParseError) {\n                        try {\n                            range.input(value + ')');\n                            var validationState = range._getValidationState();\n                            if (validationState) {\n                                return this.rejectState(validationState);\n                            }\n                        } catch (ex2) {\n                            if (ex2 instanceof kendo.spreadsheet.calc.ParseError) {\n                                range.input('\\'' + value);\n                                return {\n                                    title: 'Error in formula',\n                                    body: ex1 + '',\n                                    reason: 'error'\n                                };\n                            }\n                        }\n                    } else {\n                        throw ex1;\n                    }\n                }\n            }\n        });\n        kendo.spreadsheet.TextWrapCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'wrap';\n                PropertyChangeCommand.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            getState: function () {\n                var rowHeight = {};\n                this.range().forEachRow(function (range) {\n                    var index = range.topLeft().row;\n                    rowHeight[index] = range.sheet().rowHeight(index);\n                });\n                this._state = this.range().getState(this._property);\n                this._rowHeight = rowHeight;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                var rowHeight = this._rowHeight;\n                this.range().setState(this._state);\n                for (var row in rowHeight) {\n                    sheet.rowHeight(row, rowHeight[row]);\n                }\n            }\n        });\n        kendo.spreadsheet.AdjustDecimalsCommand = Command.extend({\n            init: function (options) {\n                this._decimals = options.value;\n                options.property = 'format';\n                Command.fn.init.call(this, options);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                var decimals = this._decimals;\n                var formatting = kendo.spreadsheet.formatting;\n                this.getState();\n                sheet.batch(function () {\n                    this.range().forEachCell(function (row, col, cell) {\n                        var format = cell.format;\n                        if (format || decimals > 0) {\n                            format = formatting.adjustDecimals(format || '#', decimals);\n                            sheet.range(row, col).format(format);\n                        }\n                    });\n                }.bind(this));\n            }\n        });\n        kendo.spreadsheet.BorderChangeCommand = Command.extend({\n            init: function (options) {\n                options.property = 'border';\n                Command.fn.init.call(this, options);\n                this._type = options.border;\n                this._style = options.style;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type](this._style);\n            },\n            noBorders: function () {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderLeft(null).borderTop(null).borderRight(null).borderBottom(null);\n                }.bind(this), {});\n            },\n            allBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderLeft(style).borderTop(style).borderRight(style).borderBottom(style);\n                }.bind(this), {});\n            },\n            leftBorder: function (style) {\n                this.range().leftColumn().borderLeft(style);\n            },\n            rightBorder: function (style) {\n                this.range().rightColumn().borderRight(style);\n            },\n            topBorder: function (style) {\n                this.range().topRow().borderTop(style);\n            },\n            bottomBorder: function (style) {\n                this.range().bottomRow().borderBottom(style);\n            },\n            outsideBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.leftColumn().borderLeft(style);\n                    range.topRow().borderTop(style);\n                    range.rightColumn().borderRight(style);\n                    range.bottomRow().borderBottom(style);\n                }.bind(this), {});\n            },\n            insideBorders: function (style) {\n                this.range().sheet().batch(function () {\n                    this.allBorders(style);\n                    this.outsideBorders(null);\n                }.bind(this), {});\n            },\n            insideHorizontalBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderBottom(style);\n                    range.bottomRow().borderBottom(null);\n                }.bind(this), {});\n            },\n            insideVerticalBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderRight(style);\n                    range.rightColumn().borderRight(null);\n                }.bind(this), {});\n            }\n        });\n        kendo.spreadsheet.MergeCellCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type]();\n            },\n            activate: function (ref) {\n                this.range().sheet().activeCell(ref);\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            undo: function () {\n                if (this._type !== 'unmerge') {\n                    this.range().unmerge();\n                    this.activate(this.range().topLeft());\n                }\n                this.range().setState(this._state);\n            },\n            cells: function () {\n                var range = this.range();\n                var ref = range._ref;\n                range.merge();\n                this.activate(ref);\n            },\n            horizontally: function () {\n                var ref = this.range().topRow()._ref;\n                this.range().forEachRow(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            vertically: function () {\n                var ref = this.range().leftColumn()._ref;\n                this.range().forEachColumn(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            unmerge: function () {\n                var range = this.range();\n                var ref = range._ref.topLeft;\n                range.unmerge();\n                this.activate(ref);\n            }\n        });\n        kendo.spreadsheet.FreezePanesCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this._topLeft = this.range().topLeft();\n                this[this._type]();\n            },\n            getState: function () {\n                this._state = this.range().sheet().getState();\n            },\n            undo: function () {\n                this.range().sheet().setState(this._state);\n            },\n            panes: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col).frozenRows(topLeft.row);\n            },\n            rows: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenRows(topLeft.row);\n            },\n            columns: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col);\n            },\n            unfreeze: function () {\n                var sheet = this.range().sheet();\n                sheet.frozenRows(0).frozenColumns(0);\n            }\n        });\n        kendo.spreadsheet.PasteCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = this._workbook.clipboard();\n            },\n            getState: function () {\n                this._range = this._workbook.activeSheet().range(this._clipboard.pasteRef());\n                this._state = this._range.getState();\n            },\n            exec: function () {\n                var status = this._clipboard.canPaste();\n                this._clipboard.menuInvoked = true;\n                if (!status.canPaste) {\n                    if (status.menuInvoked) {\n                        return { reason: 'useKeyboard' };\n                    }\n                    if (status.pasteOnMerged) {\n                        return { reason: 'modifyMerged' };\n                    }\n                    return;\n                }\n                this.getState();\n                this._clipboard.paste();\n                this._workbook.execute({\n                    command: 'AdjustRowHeightCommand',\n                    options: { range: this._workbook.activeSheet().range(this._clipboard.pasteRef()) }\n                });\n            }\n        });\n        kendo.spreadsheet.AdjustRowHeightCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                var sheet = this._workbook.activeSheet();\n                this._workingRange = options.range || sheet.range(options.rowIndex);\n            },\n            exec: function () {\n                var sheet = this._workbook.activeSheet();\n                var range = this._workingRange;\n                var state = range.getState();\n                var mergedCells = [];\n                for (var i = 0; i < state.mergedCells.length; i++) {\n                    mergedCells.push(sheet.range(state.mergedCells[i]));\n                }\n                range.forEachRow(function (row) {\n                    var maxHeight = row.sheet().rowHeight(row.topLeft().row);\n                    row.forEachCell(function (rowIndex, colIndex, cell) {\n                        var cellRange = sheet.range(rowIndex, colIndex);\n                        var totalWidth = 0;\n                        for (var i = 0; i < mergedCells.length; i++) {\n                            if (cellRange._ref.intersects(mergedCells[i]._ref)) {\n                                totalWidth += cell.width;\n                                break;\n                            }\n                        }\n                        var width = Math.max(sheet.columnWidth(colIndex), totalWidth);\n                        maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, cell.fontSize, cell.wrap));\n                    });\n                    sheet.rowHeight(row.topLeft().row, Math.max(sheet.rowHeight(row.topLeft().row), maxHeight));\n                });\n            }\n        });\n        kendo.spreadsheet.ToolbarPasteCommand = Command.extend({\n            exec: function () {\n                if (kendo.support.clipboard.paste) {\n                    this._workbook._view.clipboard.focus().select();\n                    document.execCommand('paste');\n                } else {\n                    return { reason: 'useKeyboard' };\n                }\n            }\n        });\n        kendo.spreadsheet.CopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function () {\n                var status = this._clipboard.canCopy();\n                this._clipboard.menuInvoked = true;\n                if (!status.canCopy) {\n                    if (status.menuInvoked) {\n                        return { reason: 'useKeyboard' };\n                    } else if (status.multiSelection) {\n                        return { reason: 'unsupportedSelection' };\n                    }\n                    return;\n                }\n                this._clipboard.copy();\n            }\n        });\n        kendo.spreadsheet.ToolbarCopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    var textarea = document.createElement('textarea');\n                    $(textarea).addClass('k-spreadsheet-clipboard').val(clipboard.html()).appendTo(document.body).focus().select();\n                    document.execCommand('copy');\n                    clipboard.trigger('copy');\n                    $(textarea).remove();\n                } else {\n                    return { reason: 'useKeyboard' };\n                }\n            }\n        });\n        kendo.spreadsheet.CutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function () {\n                if (this._clipboard.canCopy()) {\n                    this.getState();\n                    this._clipboard.cut();\n                }\n            }\n        });\n        kendo.spreadsheet.AutoFillCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n            },\n            origin: function (origin) {\n                this._origin = origin;\n            },\n            exec: function () {\n                this.getState();\n                this.range().fillFrom(this._origin);\n            }\n        });\n        kendo.spreadsheet.ToolbarCutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    var textarea = document.createElement('textarea');\n                    $(textarea).val(clipboard.html()).appendTo(document.body).focus().select();\n                    document.execCommand('copy');\n                    clipboard.trigger('cut');\n                    $(textarea).remove();\n                } else {\n                    return { reason: 'useKeyboard' };\n                }\n            }\n        });\n        kendo.spreadsheet.FilterCommand = Command.extend({\n            undo: function () {\n                this.range().filter(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                this._state = range.hasFilter();\n                if (range.hasFilter()) {\n                    range.filter(false);\n                } else if (!range.intersectingMerged().length) {\n                    range.filter(true);\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'filterRangeContainingMerges'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.SortCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                var sheet = range.sheet();\n                var activeCell = sheet.activeCell();\n                var col = this.options.sheet ? activeCell.topLeft.col : this.options.column || 0;\n                var ascending = this.options.value === 'asc' ? true : false;\n                this._state = sheet.getState();\n                if (this.options.sheet) {\n                    range = this.expandRange();\n                }\n                if (!range.intersectingMerged().length) {\n                    range.sort({\n                        column: col,\n                        ascending: ascending\n                    });\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'sortRangeContainingMerges'\n                    };\n                }\n            },\n            expandRange: function () {\n                var sheet = this.range().sheet();\n                return new kendo.spreadsheet.Range(sheet._sheetRef, sheet);\n            }\n        });\n        var ApplyFilterCommand = kendo.spreadsheet.ApplyFilterCommand = Command.extend({\n            column: function () {\n                return this.options.column || 0;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.clearFilter(this.column());\n                if (this._state.length) {\n                    this.range().filter(this._state);\n                }\n            },\n            getState: function () {\n                var sheet = this.range().sheet();\n                var current = sheet.filter();\n                if (current) {\n                    this._state = current.columns.filter(function (c) {\n                        return c.index == this.column();\n                    }.bind(this));\n                }\n            },\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                var current = range.sheet().filter();\n                var options;\n                var filterRule;\n                var exists = false;\n                if (this.options.valueFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.ValueFilter(this.options.valueFilter)\n                    };\n                } else if (this.options.customFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.CustomFilter(this.options.customFilter)\n                    };\n                }\n                this.getState();\n                if (current && current.ref.eq(range._ref) && current.columns.length) {\n                    current.columns.forEach(function (element) {\n                        if (element.index === column) {\n                            exists = true;\n                        }\n                    });\n                    options = current.columns.map(function (element) {\n                        return element.index === column ? filterRule : {\n                            column: element.index,\n                            filter: element.filter\n                        };\n                    });\n                    if (!exists) {\n                        options.push(filterRule);\n                    }\n                } else {\n                    options = filterRule;\n                }\n                range.filter(options);\n            }\n        });\n        kendo.spreadsheet.ClearFilterCommand = ApplyFilterCommand.extend({\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                this.getState();\n                range.clearFilter(column);\n            }\n        });\n        kendo.spreadsheet.HideLineCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this.axis = options.axis;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setAxisState(this._state);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().hideSelectedRows();\n                } else {\n                    sheet.axisManager().hideSelectedColumns();\n                }\n            }\n        });\n        kendo.spreadsheet.UnHideLineCommand = kendo.spreadsheet.HideLineCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().unhideSelectedRows();\n                } else {\n                    sheet.axisManager().unhideSelectedColumns();\n                }\n            }\n        });\n        var DeleteCommand = kendo.spreadsheet.DeleteCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.DeleteRowCommand = DeleteCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                sheet.axisManager().deleteSelectedRows();\n            }\n        });\n        kendo.spreadsheet.DeleteColumnCommand = DeleteCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                sheet.axisManager().deleteSelectedColumns();\n            }\n        });\n        var AddCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.AddColumnCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                if (this._value === 'left') {\n                    sheet.axisManager().addColumnLeft();\n                } else {\n                    sheet.axisManager().addColumnRight();\n                }\n            }\n        });\n        kendo.spreadsheet.AddRowCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                if (!sheet.axisManager().canAddRow()) {\n                    return {\n                        reason: 'error',\n                        type: 'shiftingNonblankCells'\n                    };\n                }\n                this._state = sheet.getState();\n                if (this._value === 'above') {\n                    sheet.axisManager().addRowAbove();\n                } else {\n                    sheet.axisManager().addRowBelow();\n                }\n            }\n        });\n        kendo.spreadsheet.EditValidationCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                this.range().validation(this._value);\n            }\n        });\n        kendo.spreadsheet.OpenCommand = Command.extend({\n            exec: function () {\n                var file = this.options.file;\n                if (file.name.match(/.xlsx$/i) === null) {\n                    return {\n                        reason: 'error',\n                        type: 'openUnsupported'\n                    };\n                }\n                this.options.workbook.fromFile(this.options.file);\n            }\n        });\n        kendo.spreadsheet.SaveAsCommand = Command.extend({\n            exec: function () {\n                var fileName = this.options.name + this.options.extension;\n                if (this.options.extension === '.xlsx') {\n                    this.options.workbook.saveAsExcel({ fileName: fileName });\n                } else if (this.options.extension === '.pdf') {\n                    this.options.workbook.saveAsPDF($.extend(this.options.pdf, {\n                        workbook: this.options.workbook,\n                        fileName: fileName\n                    }));\n                }\n            }\n        });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulabar', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var classNames = { wrapper: 'k-spreadsheet-formula-bar' };\n        var FormulaBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element.addClass(FormulaBar.classNames.wrapper);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput($('<div/>').appendTo(element));\n            },\n            destroy: function () {\n                if (this.formulaInput) {\n                    this.formulaInput.destroy();\n                }\n                this.formulaInput = null;\n            }\n        });\n        kendo.spreadsheet.FormulaBar = FormulaBar;\n        $.extend(true, FormulaBar, { classNames: classNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulainput', ['kendo.core'], f);\n}(function () {\n    (function (kendo, window) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var ns = '.kendoFormulaInput';\n        var keys = kendo.keys;\n        var classNames = {\n            wrapper: 'k-spreadsheet-formula-input',\n            listWrapper: 'k-spreadsheet-formula-list'\n        };\n        var styles = [\n            'font-family',\n            'font-size',\n            'font-stretch',\n            'font-style',\n            'font-weight',\n            'letter-spacing',\n            'text-transform',\n            'line-height'\n        ];\n        var KEY_NAMES = {\n            27: 'esc',\n            37: 'left',\n            39: 'right',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar'\n        };\n        var PRIVATE_FORMULA_CHECK = /(^_|[^a-z0-9]$)/i;\n        var FormulaInput = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(FormulaInput.classNames.wrapper).attr('contenteditable', true).attr('spellcheck', false);\n                if (this.options.autoScale) {\n                    element.on('input', this.scale.bind(this));\n                }\n                this._highlightedRefs = [];\n                this._staticTokens = [];\n                this._formulaSource();\n                this._formulaList();\n                this._popup();\n                this._tooltip();\n                element.on('keydown', this._keydown.bind(this)).on('keyup', this._keyup.bind(this)).on('blur', this._blur.bind(this)).on('input click', this._input.bind(this)).on('focus', this._focus.bind(this));\n            },\n            options: {\n                name: 'FormulaInput',\n                autoScale: false,\n                filterOperator: 'startswith',\n                scalePadding: 30,\n                minLength: 1\n            },\n            events: [\n                'keyup',\n                'focus'\n            ],\n            enable: function (enable) {\n                if (enable === undefined) {\n                    return this.element.attr('contenteditable') === 'false' ? false : true;\n                }\n                this.element.attr('contenteditable', enable).toggleClass('k-state-disabled', !enable);\n            },\n            getPos: function () {\n                var div = this.element[0];\n                var sel = window.getSelection();\n                var a = lookup(sel.focusNode, sel.focusOffset);\n                var b = lookup(sel.anchorNode, sel.anchorOffset);\n                if (a != null && b != null) {\n                    if (a > b) {\n                        var tmp = a;\n                        a = b;\n                        b = tmp;\n                    }\n                    return {\n                        begin: a,\n                        end: b,\n                        collapsed: a == b\n                    };\n                }\n                function lookup(lookupNode, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node === lookupNode) {\n                                throw pos;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            } else if (node.nodeType == 3) {\n                                pos += node.nodeValue.length;\n                            }\n                        }(div));\n                    } catch (index) {\n                        return index;\n                    }\n                }\n            },\n            setPos: function (begin, end) {\n                var eiv = this.element[0];\n                begin = lookup(eiv, begin);\n                if (end != null) {\n                    end = lookup(eiv, end);\n                } else {\n                    end = begin;\n                }\n                if (begin && end) {\n                    var r = document.createRange();\n                    r.setStart(begin.node, begin.pos);\n                    r.setEnd(end.node, end.pos);\n                    var sel = window.getSelection();\n                    sel.removeAllRanges();\n                    sel.addRange(r);\n                }\n                function lookup(node, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node.nodeType == 3) {\n                                var len = node.nodeValue.length;\n                                if (len >= pos) {\n                                    throw node;\n                                }\n                                pos -= len;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            }\n                        }(node));\n                    } catch (el) {\n                        return {\n                            node: el,\n                            pos: pos\n                        };\n                    }\n                }\n            },\n            end: function () {\n                this.setPos(this.length());\n            },\n            home: function () {\n                this.setPos(0);\n            },\n            length: function () {\n                return this.value().length;\n            },\n            _formulaSource: function () {\n                var result = [];\n                var value;\n                for (var key in kendo.spreadsheet.calc.runtime.FUNCS) {\n                    if (!PRIVATE_FORMULA_CHECK.test(key)) {\n                        value = key.toUpperCase();\n                        result.push({\n                            value: value,\n                            text: value\n                        });\n                    }\n                }\n                this.formulaSource = new kendo.data.DataSource({ data: result });\n            },\n            _formulaList: function () {\n                this.list = new kendo.ui.StaticList($('<ul />').addClass(FormulaInput.classNames.listWrapper).insertAfter(this.element), {\n                    autoBind: false,\n                    selectable: true,\n                    change: this._formulaListChange.bind(this),\n                    dataSource: this.formulaSource,\n                    dataValueField: 'value',\n                    template: '#:data.value#'\n                });\n                this.list.element.on('mousedown', function (e) {\n                    e.preventDefault();\n                });\n            },\n            _formulaListChange: function () {\n                var tokenCtx = this._tokenContext();\n                if (!tokenCtx || this._mute) {\n                    return;\n                }\n                var activeToken = tokenCtx.token;\n                var completion = this.list.value()[0];\n                var ctx = {\n                    replace: true,\n                    token: activeToken,\n                    end: activeToken.end\n                };\n                if (!tokenCtx.nextToken || tokenCtx.nextToken.value != '(') {\n                    completion += '(';\n                }\n                this._replaceAt(ctx, completion);\n                this.popup.close();\n            },\n            _popup: function () {\n                this.popup = new kendo.ui.Popup(this.list.element, { anchor: this.element });\n            },\n            _blur: function () {\n                this.popup.close();\n                clearTimeout(this._focusId);\n            },\n            _isFormula: function () {\n                return /^=/.test(this.value());\n            },\n            _keydown: function (e) {\n                var key = e.keyCode;\n                if (KEY_NAMES[key]) {\n                    this.popup.close();\n                    this._navigated = true;\n                } else if (this._move(key)) {\n                    this._navigated = true;\n                    e.preventDefault();\n                }\n                this._keyDownTimeout = setTimeout(this._syntaxHighlight.bind(this));\n            },\n            _keyup: function () {\n                var popup = this.popup;\n                var value;\n                if (this._isFormula() && !this._navigated) {\n                    value = ((this._tokenContext() || {}).token || {}).value;\n                    this.filter(value);\n                    if (!value || !this.formulaSource.view().length) {\n                        popup.close();\n                    } else {\n                        popup[popup.visible() ? 'position' : 'open']();\n                        this.list.focusFirst();\n                    }\n                }\n                this._navigated = false;\n                this._syntaxHighlight();\n                this.trigger('keyup');\n            },\n            _input: function () {\n                this._syntaxHighlight();\n            },\n            _focus: function () {\n                this._focusTimeout = setTimeout(this._syntaxHighlight.bind(this));\n                this.trigger('focus');\n            },\n            _move: function (key) {\n                var list = this.list;\n                var pressed = false;\n                var popup = this.popup;\n                if (key === keys.DOWN) {\n                    list.focusNext();\n                    if (!list.focus()) {\n                        list.focusFirst();\n                    }\n                    pressed = true;\n                } else if (key === keys.UP) {\n                    list.focusPrev();\n                    if (!list.focus()) {\n                        list.focusLast();\n                    }\n                    pressed = true;\n                } else if (key === keys.ENTER) {\n                    if (popup.visible()) {\n                        list.select(list.focus());\n                    }\n                    popup.close();\n                    pressed = true;\n                } else if (key === keys.TAB) {\n                    list.select(list.focus());\n                    popup.close();\n                    pressed = true;\n                } else if (key === keys.PAGEUP) {\n                    list.focusFirst();\n                    pressed = true;\n                } else if (key === keys.PAGEDOWN) {\n                    list.focusLast();\n                    pressed = true;\n                }\n                return pressed;\n            },\n            _tokenContext: function () {\n                var point = this.getPos();\n                var value = this.value();\n                if (!value || !point || !point.collapsed) {\n                    return null;\n                }\n                var tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                var tok;\n                for (var i = 0; i < tokens.length; ++i) {\n                    tok = tokens[i];\n                    if (touches(tok, point) && /^(?:str|sym|func)$/.test(tok.type)) {\n                        return {\n                            token: tok,\n                            nextToken: tokens[i + 1]\n                        };\n                    }\n                }\n                return null;\n            },\n            _sync: function () {\n                if (this._editorToSync && this.isActive()) {\n                    this._editorToSync.value(this.value());\n                }\n            },\n            _textContainer: function () {\n                var computedStyles = kendo.getComputedStyles(this.element[0], styles);\n                computedStyles.position = 'absolute';\n                computedStyles.visibility = 'hidden';\n                computedStyles.whiteSpace = 'pre';\n                computedStyles.top = -3333;\n                computedStyles.left = -3333;\n                this._span = $('<span/>').css(computedStyles).insertAfter(this.element);\n            },\n            _tooltip: function () {\n                this._cellTooltip = $('<div class=\"k-widget k-tooltip\" style=\"position:absolute; display:none\">A1</div>').insertAfter(this.element);\n            },\n            tooltip: function (value) {\n                this._cellTooltip.text(value);\n            },\n            toggleTooltip: function (show) {\n                this._cellTooltip.toggle(show);\n            },\n            isActive: function () {\n                return this.element[0] === kendo._activeElement();\n            },\n            filter: function (value) {\n                if (!value || value.length < this.options.minLength) {\n                    return;\n                }\n                this._mute = true;\n                this.list.select(-1);\n                this._mute = false;\n                this.formulaSource.filter({\n                    field: this.list.options.dataValueField,\n                    operator: this.options.filterOperator,\n                    value: value\n                });\n            },\n            hide: function () {\n                this.element.hide();\n                this._cellTooltip.hide();\n            },\n            show: function () {\n                this.element.show();\n            },\n            row: function () {\n                if (this.activeCell) {\n                    return this.activeCell.row;\n                }\n            },\n            col: function () {\n                if (this.activeCell) {\n                    return this.activeCell.col;\n                }\n            },\n            position: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.element.show().css({\n                    'top': rectangle.top + 1 + 'px',\n                    'left': rectangle.left + 1 + 'px'\n                });\n                this._cellTooltip.css({\n                    'top': rectangle.top - this._cellTooltip.height() - 10 + 'px',\n                    'left': rectangle.left\n                });\n            },\n            resize: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.element.css({\n                    width: rectangle.width - 1,\n                    height: rectangle.height - 1\n                });\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var result = this._canInsertRef(isKeyboardAction);\n                var token = result && result.token;\n                var idx;\n                if (token) {\n                    for (idx = 0; idx < this._staticTokens.length; idx++) {\n                        if (isEqualToken(token, this._staticTokens[idx])) {\n                            return null;\n                        }\n                    }\n                }\n                return result;\n            },\n            _canInsertRef: function (isKeyboardAction) {\n                if (this.popup.visible()) {\n                    return null;\n                }\n                var strictMode = isKeyboardAction;\n                var point = this.getPos();\n                var tokens, tok;\n                if (point && this._isFormula()) {\n                    if (point.begin === 0) {\n                        return null;\n                    }\n                    tokens = kendo.spreadsheet.calc.tokenize(this.value(), this.row(), this.col());\n                    for (var i = 0; i < tokens.length; ++i) {\n                        tok = tokens[i];\n                        if (touches(tok, point)) {\n                            return canReplace(tok);\n                        }\n                        if (afterPoint(tok)) {\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                    return canInsertBetween(tok, null);\n                }\n                return null;\n                function afterPoint(tok) {\n                    return tok.begin > point.begin;\n                }\n                function canReplace(tok) {\n                    if (tok) {\n                        if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                            return {\n                                replace: true,\n                                token: tok,\n                                end: tok.end\n                            };\n                        }\n                        if (/^(?:op|punc|startexp)$/.test(tok.type)) {\n                            if (tok.end == point.end) {\n                                return canInsertBetween(tok, tokens[i + 1]);\n                            }\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                }\n                function canInsertBetween(left, right) {\n                    if (left == null) {\n                        return null;\n                    }\n                    if (right == null) {\n                        if (/^(?:op|startexp)$/.test(left.type) || isOpenParen(left.value)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        return null;\n                    }\n                    if (strictMode) {\n                        if (left.type == 'op' && /^(?:punc|op)$/.test(right.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                    } else {\n                        if (left.type == 'startexp') {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:ref|op|punc)$/.test(left.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:punc|op)$/.test(left.type)) {\n                            return /^[,;({]$/.test(left.value) ? {\n                                token: left,\n                                end: point.end\n                            } : null;\n                        }\n                    }\n                    return false;\n                }\n            },\n            refAtPoint: function (ref) {\n                var x = this._canInsertRef();\n                if (x) {\n                    this._replaceAt(x, ref.simplify().toString());\n                }\n            },\n            _replaceAt: function (ctx, newValue) {\n                var value = this.value();\n                var tok = ctx.token;\n                var rest = value.substr(ctx.end);\n                value = value.substr(0, ctx.replace ? tok.begin : ctx.end) + newValue;\n                var point = value.length;\n                value += rest;\n                this._value(value);\n                this.setPos(point);\n                this.scale();\n                this._syntaxHighlight();\n                this._sync();\n            },\n            syncWith: function (formulaInput) {\n                var eventName = 'input' + ns;\n                this._editorToSync = formulaInput;\n                this.element.off(eventName).on(eventName, this._sync.bind(this));\n            },\n            scale: function () {\n                var element = this.element;\n                var width;\n                if (!this._span) {\n                    this._textContainer();\n                }\n                this._span.html(element.html());\n                width = this._span.width() + this.options.scalePadding;\n                if (width > element.width()) {\n                    element.width(width);\n                }\n            },\n            _value: function (value) {\n                this.element.text(value);\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    return this.element.text();\n                }\n                this._value(value);\n                this._syntaxHighlight();\n            },\n            highlightedRefs: function () {\n                return this._highlightedRefs.slice();\n            },\n            _syntaxHighlight: function () {\n                var pos = this.getPos();\n                var value = this.value();\n                var refClasses = kendo.spreadsheet.Pane.classNames.series;\n                var highlightedRefs = [];\n                var refIndex = 0;\n                var parens = [];\n                var tokens = [];\n                var activeToken;\n                if (pos && !pos.collapsed) {\n                    return;\n                }\n                if (!/^=/.test(value)) {\n                    this.element.text(value);\n                    if (this.popup) {\n                        this.popup.close();\n                    }\n                } else {\n                    tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                    tokens.forEach(function (tok) {\n                        tok.active = false;\n                        tok.cls = ['k-syntax-' + tok.type];\n                        if (tok.type == 'ref') {\n                            tok.colorClass = refClasses[refIndex++ % refClasses.length];\n                            tok.cls.push(tok.colorClass);\n                            highlightedRefs.push(tok);\n                        }\n                        if (pos && tok.type == 'punc') {\n                            if (isOpenParen(tok.value)) {\n                                parens.unshift(tok);\n                            } else if (isCloseParen(tok.value)) {\n                                var open = parens.shift();\n                                if (open) {\n                                    if (isMatchingParen(tok.value, open.value)) {\n                                        if (touches(tok, pos) || touches(open, pos)) {\n                                            tok.cls.push('k-syntax-paren-match');\n                                            open.cls.push('k-syntax-paren-match');\n                                        }\n                                    } else {\n                                        tok.cls.push('k-syntax-error');\n                                        open.cls.push('k-syntax-error');\n                                    }\n                                } else {\n                                    tok.cls.push('k-syntax-error');\n                                }\n                            }\n                        }\n                        if (pos && touches(tok, pos)) {\n                            tok.cls.push('k-syntax-at-point');\n                            tok.active = true;\n                            activeToken = tok;\n                        }\n                        if (tok.type == 'func' && !knownFunction(tok.value) && (!pos || !touches(tok, pos))) {\n                            tok.cls.push('k-syntax-error');\n                        }\n                    });\n                    tokens.reverse().forEach(function (tok) {\n                        var begin = tok.begin, end = tok.end;\n                        var text = kendo.htmlEncode(value.substring(begin, end));\n                        value = value.substr(0, begin) + '<span class=\\'' + tok.cls.join(' ') + '\\'>' + text + '</span>' + value.substr(end);\n                    });\n                    this.element.html(value);\n                }\n                if (pos) {\n                    this.setPos(pos.begin, pos.end);\n                }\n                if (activeToken && /^(?:startexp|op|punc)$/.test(activeToken.type)) {\n                    this._setStaticTokens(tokens);\n                }\n                this._highlightedRefs = highlightedRefs;\n            },\n            _setStaticTokens: function (tokens) {\n                var idx, tok;\n                this._staticTokens = [];\n                for (idx = 0; idx < tokens.length; idx++) {\n                    tok = tokens[idx];\n                    if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                        this._staticTokens.push(tok);\n                    }\n                }\n            },\n            destroy: function () {\n                this._editorToSync = null;\n                this.element.off(ns);\n                clearTimeout(this._focusTimeout);\n                clearTimeout(this._keyDownTimeout);\n                this._cellTooltip = null;\n                this._span = null;\n                this.popup.destroy();\n                this.popup = null;\n                Widget.fn.destroy.call(this);\n            }\n        });\n        function isOpenParen(ch) {\n            return ch == '(' || ch == '[' || ch == '{';\n        }\n        function isCloseParen(ch) {\n            return ch == ')' || ch == ']' || ch == '}';\n        }\n        function isMatchingParen(close, open) {\n            return open == '(' ? close == ')' : open == '[' ? close == ']' : open == '{' ? close == '}' : false;\n        }\n        function touches(pos, target) {\n            return pos.begin <= target.begin && pos.end >= target.end;\n        }\n        function knownFunction(name) {\n            return kendo.spreadsheet.calc.runtime.FUNCS[name.toLowerCase()];\n        }\n        function isEqualToken(tok1, tok2) {\n            if (!tok1 || !tok2) {\n                return false;\n            }\n            if (tok1.type == 'ref' && tok2.type == 'ref') {\n                return tok1.ref.eq(tok2.ref);\n            } else {\n                return tok1.value === tok2.value;\n            }\n        }\n        kendo.spreadsheet.FormulaInput = FormulaInput;\n        $.extend(true, FormulaInput, { classNames: classNames });\n    }(kendo, window));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/eventlistener', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var KEY_NAMES = {\n            8: 'backspace',\n            9: 'tab',\n            13: 'enter',\n            27: 'esc',\n            37: 'left',\n            38: 'up',\n            39: 'right',\n            40: 'down',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar',\n            33: 'pageup',\n            34: 'pagedown',\n            46: 'delete',\n            113: ':edit'\n        };\n        var Mac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n        var isAlphaNum = function (keyCode) {\n            if (keyCode > 47 && keyCode < 58 || keyCode > 64 && keyCode < 91 || keyCode > 95 && keyCode < 112 || keyCode > 185 && keyCode < 193 || keyCode > 218 && keyCode < 223) {\n                return true;\n            }\n            return false;\n        };\n        var keyName = function (keyCode) {\n            var name = KEY_NAMES[keyCode];\n            if (!name && isAlphaNum(keyCode)) {\n                name = ':alphanum';\n            }\n            return name;\n        };\n        var EventListener = kendo.Class.extend({\n            init: function (target, observer, handlers) {\n                this._handlers = {};\n                this.target = target;\n                this._observer = observer || window;\n                this.keyDownProxy = this.keyDown.bind(this);\n                this.mouseProxy = this.mouse.bind(this);\n                this.threshold = 5;\n                this._pressLocation = null;\n                target.on('keydown', this.keyDownProxy);\n                target.on('contextmenu mousedown cut copy paste scroll wheel click dblclick focus', this.mouseProxy);\n                $(document.documentElement).on('mousemove mouseup', this.mouseProxy);\n                if (handlers) {\n                    for (var key in handlers) {\n                        this.on(key, handlers[key]);\n                    }\n                }\n            },\n            keyDown: function (e) {\n                this.handleEvent(e, keyName(e.keyCode));\n            },\n            mouse: function (e) {\n                var rightClick;\n                if (e.which) {\n                    rightClick = e.which == 3;\n                } else if (e.button) {\n                    rightClick = e.button == 2;\n                }\n                var type = e.type;\n                if (type === 'mousedown') {\n                    if (rightClick) {\n                        type = 'rightmousedown';\n                    } else {\n                        this._pressLocation = {\n                            x: e.pageX,\n                            y: e.pageY\n                        };\n                    }\n                }\n                if (type === 'mouseup') {\n                    if (!rightClick) {\n                        this._pressLocation = null;\n                    }\n                }\n                if (type === 'mousemove' && this._pressLocation) {\n                    var dx = this._pressLocation.x - e.pageX;\n                    var dy = this._pressLocation.y - e.pageY;\n                    var distance = Math.sqrt(dx * dx + dy * dy);\n                    if (distance > this.threshold) {\n                        type = 'mousedrag';\n                    }\n                }\n                this.handleEvent(e, type);\n            },\n            handleEvent: function (e, name) {\n                var eventKey = '';\n                e.mod = Mac ? e.metaKey : e.ctrlKey;\n                if (e.shiftKey) {\n                    eventKey += 'shift+';\n                }\n                if (e.ctrlKey) {\n                    eventKey += 'ctrl+';\n                }\n                eventKey += name;\n                var catchAllHandler = this._handlers['*+' + name];\n                if (catchAllHandler) {\n                    catchAllHandler.call(this._observer, e, eventKey);\n                }\n                var handler = this._handlers[eventKey];\n                if (handler) {\n                    handler.call(this._observer, e, eventKey);\n                }\n            },\n            on: function (event, callback) {\n                var handlers = this._handlers;\n                if (typeof callback === 'string') {\n                    callback = this._observer[callback];\n                }\n                if (typeof event === 'string') {\n                    event = event.split(',');\n                }\n                event.forEach(function (e) {\n                    handlers[e] = callback;\n                });\n            },\n            destroy: function () {\n                this.target.off('keydown', this.keyDownProxy);\n                this.target.off('keydown', this.mouseProxy);\n                $(document.documentElement).off('mousemove mouseup', this.mouseProxy);\n            }\n        });\n        kendo.spreadsheet.EventListener = EventListener;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/rangelist', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeTreeNode = kendo.Class.extend({\n            init: function Node(level, value, left, right) {\n                this.level = level;\n                this.value = value;\n                this.left = left;\n                this.right = right;\n            }\n        });\n        var NilNode = new function NIL() {\n            this.left = this;\n            this.right = this;\n            this.level = 0;\n        }();\n        function passThrough(value) {\n            return value;\n        }\n        function skew(node) {\n            if (node.left.level === node.level) {\n                var temp = node;\n                node = node.left;\n                temp.left = node.right;\n                node.right = temp;\n            }\n            return node;\n        }\n        function split(node) {\n            if (node.right.right.level === node.level) {\n                var temp = node;\n                node = node.right;\n                temp.right = node.left;\n                node.left = temp;\n                node.level += 1;\n            }\n            return node;\n        }\n        function insert(node, value) {\n            if (node === NilNode) {\n                return new RangeTreeNode(1, value, NilNode, NilNode);\n            } else if (node.value.start - value.start > 0) {\n                node.left = insert(node.left, value);\n            } else {\n                node.right = insert(node.right, value);\n            }\n            return split(skew(node));\n        }\n        function remove(node, value) {\n            if (node === NilNode) {\n                return node;\n            }\n            var diff = node.value.start - value.start;\n            if (diff === 0) {\n                if (node.left !== NilNode && node.right !== NilNode) {\n                    var heir = node.left;\n                    while (heir.right !== NilNode) {\n                        heir = heir.right;\n                    }\n                    node.value = heir.value;\n                    node.left = remove(node.left, node.value);\n                } else if (node.left === NilNode) {\n                    node = node.right;\n                } else {\n                    node = node.left;\n                }\n            } else if (diff > 0) {\n                node.left = remove(node.left, value);\n            } else {\n                node.right = remove(node.right, value);\n            }\n            if (node.left.level < node.level - 1 || node.right.level < node.level - 1) {\n                node.level -= 1;\n                if (node.right.level > node.level) {\n                    node.right.level = node.level;\n                }\n                node = skew(node);\n                node.right = skew(node.right);\n                node.right.right = skew(node.right.right);\n                node = split(node);\n                node.right = split(node.right);\n            }\n            return node;\n        }\n        var Range = kendo.Class.extend({\n            init: function Value(start, end, value) {\n                this.start = start;\n                this.end = end;\n                this.value = value;\n            },\n            intersects: function (range) {\n                return range.start <= this.end && range.end >= this.start;\n            }\n        });\n        var RangeTree = kendo.Class.extend({\n            init: function () {\n                this.root = NilNode;\n            },\n            insert: function (value) {\n                this.root = insert(this.root, value);\n            },\n            remove: function (value) {\n                this.root = remove(this.root, value);\n            },\n            findrange: function (value) {\n                var node = this.root;\n                while (node != NilNode) {\n                    if (value < node.value.start) {\n                        node = node.left;\n                    } else if (value > node.value.end) {\n                        node = node.right;\n                    } else {\n                        return node.value;\n                    }\n                }\n                return null;\n            },\n            values: function () {\n                var result = [];\n                values(this.root, result);\n                return result;\n            },\n            intersecting: function (start, end) {\n                var ranges = [];\n                intersecting(this.root, new Range(start, end), ranges);\n                return ranges;\n            },\n            map: function (callback) {\n                var tree = new RangeTree();\n                map(tree, this.root, callback);\n                return tree;\n            },\n            clone: function () {\n                return this.map(passThrough);\n            },\n            first: function () {\n                var first = this.root;\n                while (first.left != NilNode) {\n                    first = first.left;\n                }\n                return first;\n            },\n            last: function () {\n                var last = this.root;\n                while (last.right != NilNode) {\n                    last = last.right;\n                }\n                return last;\n            }\n        });\n        function values(node, result) {\n            if (node === NilNode) {\n                return;\n            }\n            values(node.left, result);\n            result.push(node.value);\n            values(node.right, result);\n        }\n        function intersecting(node, range, ranges) {\n            if (node === NilNode) {\n                return;\n            }\n            var value = node.value;\n            if (range.start < value.start) {\n                intersecting(node.left, range, ranges);\n            }\n            if (value.intersects(range)) {\n                ranges.push(value);\n            }\n            if (range.end > value.end) {\n                intersecting(node.right, range, ranges);\n            }\n        }\n        function map(tree, root, callback) {\n            if (root === NilNode) {\n                return;\n            }\n            map(tree, root.left, callback);\n            tree.insert(callback(root.value));\n            map(tree, root.right, callback);\n        }\n        var RangeList = kendo.Class.extend({\n            init: function (start, end, value) {\n                if (end === undefined) {\n                    this.tree = start;\n                } else {\n                    this.tree = new RangeTree();\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            values: function () {\n                return this.tree.values();\n            },\n            map: function (callback) {\n                return new RangeList(this.tree.map(callback));\n            },\n            intersecting: function (start, end) {\n                return this.tree.intersecting(start, end);\n            },\n            first: function () {\n                return this.tree.first().value;\n            },\n            last: function () {\n                return this.tree.last().value;\n            },\n            insert: function (start, end, value) {\n                return this.tree.insert(new Range(start, end, value));\n            },\n            value: function (start, end, value) {\n                if (value === undefined) {\n                    if (end === undefined) {\n                        end = start;\n                    }\n                    return this.intersecting(start, end)[0].value;\n                }\n                var ranges = this.tree.intersecting(start - 1, end + 1);\n                if (ranges.length) {\n                    var firstRange = ranges[0], lastRange = ranges[ranges.length - 1];\n                    if (firstRange.end < start) {\n                        if (firstRange.value === value) {\n                            start = firstRange.start;\n                        } else {\n                            ranges.shift();\n                        }\n                    }\n                    if (lastRange.start > end) {\n                        if (lastRange.value === value) {\n                            end = lastRange.end;\n                        } else {\n                            ranges.pop();\n                        }\n                    }\n                    for (var i = 0, length = ranges.length; i < length; i++) {\n                        var range = ranges[i];\n                        var rangeValue = range.value;\n                        var rangeStart = range.start;\n                        var rangeEnd = range.end;\n                        this.tree.remove(range);\n                        if (rangeStart < start) {\n                            if (rangeValue !== value) {\n                                this.insert(rangeStart, start - 1, rangeValue);\n                            } else {\n                                start = rangeStart;\n                            }\n                        }\n                        if (rangeEnd > end) {\n                            if (rangeValue !== value) {\n                                this.insert(end + 1, rangeEnd, rangeValue);\n                            } else {\n                                end = rangeEnd;\n                            }\n                        }\n                    }\n                }\n                this.insert(start, end, value);\n            },\n            expandedValues: function (start, end) {\n                var ranges = this.intersecting(start, end);\n                var result = [];\n                var rangeIndex = 0;\n                for (var i = start; i <= end; i++) {\n                    if (ranges[rangeIndex].end < i) {\n                        rangeIndex++;\n                    }\n                    result.push({\n                        index: i - start,\n                        value: ranges[rangeIndex].value\n                    });\n                }\n                return result;\n            },\n            sortedIndices: function (start, end, valueComparer, indices) {\n                var result = this.expandedValues(start, end);\n                var comparer = function (a, b) {\n                    if (a.value === b.value) {\n                        return a.index - b.index;\n                    }\n                    return valueComparer(a.value, b.value);\n                };\n                if (indices) {\n                    comparer = function (a, b) {\n                        var x = indices[a.index];\n                        var y = indices[b.index];\n                        if (x.value === y.value) {\n                            return valueComparer(a.value, b.value);\n                        }\n                        return a.index - b.index;\n                    };\n                }\n                result.sort(comparer);\n                return result;\n            },\n            sort: function (start, end, indices) {\n                if (this.intersecting(start, end).length === 1) {\n                    return;\n                }\n                var values = this.expandedValues(start, end);\n                for (var i = 0, len = indices.length; i < len; i++) {\n                    this.value(i + start, i + start, values[indices[i].index].value);\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                var values = this.intersecting(sourceStart, sourceEnd);\n                var start = targetStart;\n                var end;\n                for (var i = 0, len = values.length; i < len; i++) {\n                    var rangeStart = values[i].start;\n                    if (rangeStart < sourceStart) {\n                        rangeStart = sourceStart;\n                    }\n                    var rangeEnd = values[i].end;\n                    if (rangeEnd > sourceEnd) {\n                        rangeEnd = sourceEnd;\n                    }\n                    end = start + (rangeEnd - rangeStart);\n                    this.value(start, end, values[i].value);\n                    start = ++end;\n                }\n            },\n            iterator: function (start, end) {\n                return new Iterator(start, end, this.intersecting(start, end));\n            },\n            getState: function () {\n                return this.tree.clone();\n            },\n            setState: function (state) {\n                this.tree = state;\n            }\n        });\n        var Iterator = kendo.Class.extend({\n            init: function (start, end, ranges) {\n                this.start = start;\n                this.end = end;\n                this.index = 0;\n                this.ranges = ranges;\n            },\n            unique: function () {\n                return this.ranges.map(function (range) {\n                    return range.value;\n                });\n            },\n            at: function (index) {\n                while (this.ranges[this.index].end < index) {\n                    this.index++;\n                }\n                return this.ranges[this.index].value;\n            },\n            forEach: function (callback) {\n                for (var i = this.start; i <= this.end; i++) {\n                    callback(this.at(i), i);\n                }\n                this.index = 0;\n            }\n        });\n        var SparseRangeList = RangeList.extend({\n            init: function (start, end, value) {\n                this.tree = new RangeTree();\n                this.range = new Range(start, end, value);\n            },\n            intersecting: function (start, end) {\n                var ranges = this.tree.intersecting(start, end);\n                var result = [];\n                var range;\n                if (!ranges.length) {\n                    return [this.range];\n                }\n                for (var i = 0, len = ranges.length; i < len; i++) {\n                    range = ranges[i];\n                    if (range.start > start) {\n                        result.push(new Range(start, range.start - 1, this.range.value));\n                    }\n                    result.push(range);\n                    start = range.end + 1;\n                }\n                if (range.end < end) {\n                    result.push(new Range(range.end + 1, end, this.range.value));\n                }\n                return result;\n            },\n            insert: function (start, end, value) {\n                if (value !== this.range.value) {\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            lastRangeStart: function () {\n                var node = this.tree.root;\n                if (node === NilNode) {\n                    return this.range.start;\n                }\n                while (node.right !== NilNode) {\n                    node = node.right;\n                }\n                return node.value.end + 1;\n            }\n        });\n        kendo.spreadsheet.RangeTree = RangeTree;\n        kendo.spreadsheet.RangeList = RangeList;\n        kendo.spreadsheet.SparseRangeList = SparseRangeList;\n        kendo.spreadsheet.ValueRange = Range;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/propertybag', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Property = kendo.Class.extend({\n            init: function (list) {\n                this.list = list;\n            },\n            get: function (index) {\n                return this.parse(this.list.value(index, index));\n            },\n            set: function (start, end, value) {\n                if (value === undefined) {\n                    value = end;\n                    end = start;\n                }\n                this.list.value(start, end, value);\n            },\n            parse: function (value) {\n                return value;\n            },\n            copy: function (start, end, dst) {\n                this.list.copy(start, end, dst);\n            },\n            iterator: function (start, end) {\n                return this.list.iterator(start, end);\n            }\n        });\n        var JsonProperty = Property.extend({\n            set: function (start, end, value) {\n                this.list.value(start, end, JSON.stringify(value));\n            },\n            parse: function (value) {\n                return JSON.parse(value);\n            }\n        });\n        var ValueProperty = Property.extend({\n            init: function (values, formats, validations) {\n                Property.prototype.init.call(this, values);\n                this.validations = validations;\n                this.formats = formats;\n            },\n            set: function (start, end, value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                    this.formats.value(start, end, toExcelFormat(kendo.culture().calendar.patterns.d));\n                }\n                this.list.value(start, end, value);\n            }\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        kendo.spreadsheet.PropertyBag = kendo.Class.extend({\n            specs: [\n                {\n                    property: ValueProperty,\n                    name: 'value',\n                    value: null,\n                    sortable: true,\n                    serializable: true,\n                    depends: 'format'\n                },\n                {\n                    property: Property,\n                    name: 'format',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'formula',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'background',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderBottom',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderRight',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderLeft',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderTop',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'color',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontFamily',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'underline',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontSize',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'italic',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'bold',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'textAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'verticalAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'wrap',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'validation',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'enable',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                }\n            ],\n            init: function (cellCount) {\n                this.properties = {};\n                this.lists = {};\n                this.specs.forEach(function (spec) {\n                    this.lists[spec.name] = new kendo.spreadsheet.SparseRangeList(0, cellCount, spec.value);\n                }, this);\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name] = new spec.property(this.lists[spec.name], this.lists[spec.depends]);\n                }, this);\n            },\n            getState: function () {\n                var state = {};\n                this.specs.forEach(function (spec) {\n                    state[spec.name] = this.lists[spec.name].getState();\n                }, this);\n                return state;\n            },\n            setState: function (state) {\n                this.specs.forEach(function (spec) {\n                    this.lists[spec.name].setState(state[spec.name]);\n                }, this);\n            },\n            get: function (name, index) {\n                if (index === undefined) {\n                    return this.lists[name];\n                }\n                return this.properties[name].get(index);\n            },\n            set: function (name, start, end, value) {\n                this.properties[name].set(start, end, value);\n            },\n            fromJSON: function (index, value) {\n                for (var si = 0; si < this.specs.length; si++) {\n                    var spec = this.specs[si];\n                    if (spec.serializable) {\n                        if (value[spec.name] !== undefined) {\n                            this.set(spec.name, index, index, value[spec.name], false);\n                        }\n                    }\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name].copy(sourceStart, sourceEnd, targetStart);\n                }, this);\n            },\n            iterator: function (name, start, end) {\n                return this.properties[name].iterator(start, end);\n            },\n            sortable: function () {\n                return this.specs.filter(function (spec) {\n                    return spec.sortable;\n                }).map(function (spec) {\n                    return this.lists[spec.name];\n                }, this);\n            },\n            iterators: function (start, end) {\n                var specs = this.specs.filter(function (spec) {\n                    return spec.serializable;\n                });\n                return specs.map(function (spec) {\n                    var iterator = this.iterator(spec.name, start, end);\n                    return {\n                        name: spec.name,\n                        value: spec.value,\n                        at: function (index) {\n                            return spec.property.fn.parse(iterator.at(index));\n                        }\n                    };\n                }, this);\n            },\n            forEach: function (start, end, callback) {\n                var iterators = this.iterators(start, end);\n                for (var index = start; index <= end; index++) {\n                    var values = {};\n                    for (var i = 0; i < iterators.length; i++) {\n                        var iterator = iterators[i];\n                        var value = iterator.at(index);\n                        if (value !== iterator.value) {\n                            values[iterator.name] = value;\n                        }\n                    }\n                    callback(values);\n                }\n            },\n            forEachProperty: function (callback) {\n                for (var name in this.properties) {\n                    callback(this.properties[name]);\n                }\n            }\n        });\n        kendo.spreadsheet.ALL_PROPERTIES = $.map(kendo.spreadsheet.PropertyBag.prototype.specs, function (spec) {\n            return spec.name;\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/references', ['kendo.core'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Class = kendo.Class;\n    function columnName(colIndex) {\n        var letter = Math.floor(colIndex / 26) - 1;\n        return (letter >= 0 ? columnName(letter) : '') + String.fromCharCode(65 + colIndex % 26);\n    }\n    function displaySheet(sheet) {\n        if (/^[a-z0-9_]*$/i.test(sheet)) {\n            return sheet;\n        }\n        return '\\'' + sheet.replace(/\\x27/g, '\\\\\\'') + '\\'';\n    }\n    function displayRef(sheet, row, col, rel) {\n        var aa = '';\n        ++row;\n        if (!isFinite(row)) {\n            row = '';\n        } else if (rel != null && !(rel & 2)) {\n            row = '$' + row;\n        }\n        if (!isFinite(col)) {\n            col = '';\n        } else {\n            aa = columnName(col);\n            if (rel != null && !(rel & 1)) {\n                aa = '$' + aa;\n            }\n        }\n        if (sheet) {\n            return displaySheet(sheet) + '!' + aa + row;\n        } else {\n            return aa + row;\n        }\n    }\n    var Ref = Class.extend({\n        type: 'ref',\n        hasSheet: function () {\n            return this._hasSheet;\n        },\n        simplify: function () {\n            return this;\n        },\n        setSheet: function (sheet, hasSheet) {\n            this.sheet = sheet;\n            if (hasSheet != null) {\n                this._hasSheet = hasSheet;\n            }\n            return this;\n        },\n        absolute: function () {\n            return this;\n        },\n        relative: function () {\n            return this;\n        },\n        adjust: function () {\n            return this;\n        },\n        toString: function () {\n            return this.relative(0, 0, 3, 3).print(0, 0);\n        },\n        forEach: function (callback, obj) {\n            callback.call(obj, this);\n        },\n        map: function (callback, obj) {\n            return callback.call(obj, this);\n        },\n        intersects: function (ref) {\n            return this.intersect(ref) !== NULL;\n        },\n        isCell: function () {\n            return false;\n        },\n        toRow: function () {\n            return this;\n        },\n        toColumn: function () {\n            return this;\n        },\n        first: function () {\n            return this;\n        },\n        lastRange: function () {\n            return this;\n        },\n        size: function () {\n            return 1;\n        },\n        rangeAt: function () {\n            return this;\n        },\n        nextRangeIndex: function () {\n            return 0;\n        },\n        previousRangeIndex: function () {\n            return 0;\n        },\n        eq: function (reference) {\n            var r1 = this;\n            var r2 = reference;\n            if (r1 === NULL || r2 === NULL) {\n                return r1 === r2;\n            }\n            if (r2 instanceof CellRef || r2 instanceof RangeRef && !(r1 instanceof CellRef)) {\n                r1 = reference;\n                r2 = this;\n            }\n            if (r1 instanceof CellRef) {\n                r2 = r2.simplify();\n                return r2 instanceof CellRef && r1.row == r2.row && r1.col == r2.col && r1.sheet == r2.sheet;\n            } else if (r1 instanceof RangeRef) {\n                if (r2 instanceof RangeRef) {\n                    return r2.topLeft.eq(r1.topLeft) && r2.bottomRight.eq(r1.bottomRight);\n                }\n                if (r2 instanceof UnionRef) {\n                    return r2.single() && r1.eq(r2.refs[0]);\n                }\n            } else if (r1 instanceof UnionRef && r2 instanceof UnionRef) {\n                var refs1 = r1.refs;\n                var refs2 = r2.refs;\n                if (refs1.length != refs2.length) {\n                    return false;\n                }\n                for (var i = 0, len = refs1.length; i < len; i++) {\n                    if (!refs1[i].eq(refs2[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            return r1 === r2;\n        },\n        concat: function (ref) {\n            return new UnionRef([\n                this,\n                ref\n            ]);\n        },\n        replaceAt: function (index, ref) {\n            return ref;\n        },\n        forEachColumnIndex: function (callback) {\n            this.forEachAxisIndex('col', callback);\n        },\n        forEachRowIndex: function (callback) {\n            this.forEachAxisIndex('row', callback);\n        },\n        forEachAxisIndex: function (axis, callback) {\n            var sorted = [];\n            var method = axis === 'row' ? 'forEachRow' : 'forEachColumn';\n            this[method](function (ref) {\n                var index = ref.first()[axis];\n                if (sorted.indexOf(index) === -1) {\n                    sorted.push(index);\n                }\n            });\n            sorted.sort(function (a, b) {\n                return a > b ? 1 : a < b ? -1 : 0;\n            }).forEach(callback);\n        },\n        valid: function () {\n            return false;\n        }\n    });\n    Ref.display = displayRef;\n    var NULL = new (Ref.extend({\n        init: function NullRef() {\n        },\n        print: function () {\n            return '#NULL!';\n        },\n        clone: function () {\n            return this;\n        },\n        eq: function (ref) {\n            return ref === this;\n        },\n        forEach: function () {\n        }\n    }))();\n    var NameRef = Ref.extend({\n        ref: 'name',\n        init: function NameRef(name) {\n            this.name = name;\n        },\n        print: function () {\n            var ret = displaySheet(this.name);\n            if (this.hasSheet()) {\n                ret = displaySheet(this.sheet) + '!' + ret;\n            }\n            return ret;\n        }\n    });\n    var CellRef = Ref.extend({\n        ref: 'cell',\n        init: function CellRef(row, col, rel) {\n            this.row = row;\n            this.col = col;\n            this.rel = rel || 0;\n        },\n        clone: function () {\n            return new CellRef(this.row, this.col, this.rel).setSheet(this.sheet, this.hasSheet());\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                if (this.eq(ref)) {\n                    return this;\n                } else {\n                    return NULL;\n                }\n            }\n            return ref.intersect(this);\n        },\n        print: function (trow, tcol) {\n            var col = this.col, row = this.row, rel = this.rel, abs;\n            if (trow == null) {\n                if (isFinite(col)) {\n                    col = rel & 1 ? 'C[' + col + ']' : 'C' + (col + 1);\n                } else {\n                    col = '';\n                }\n                if (isFinite(row)) {\n                    row = rel & 2 ? 'R[' + row + ']' : 'R' + (row + 1);\n                } else {\n                    row = '';\n                }\n                return row + col;\n            } else {\n                abs = this.absolute(trow, tcol);\n                return abs.valid() ? displayRef(this._hasSheet && this.sheet, abs.row, abs.col, rel) : '#REF!';\n            }\n        },\n        absolute: function (arow, acol) {\n            var ret = this.clone();\n            if (ret.rel & 3 === 0) {\n                return ret;\n            }\n            if (ret.rel & 1) {\n                ret.col += acol;\n            }\n            if (ret.rel & 2) {\n                ret.row += arow;\n            }\n            ret.rel = 0;\n            return ret;\n        },\n        toRangeRef: function () {\n            return new RangeRef(this, this);\n        },\n        relative: function (arow, acol, rel) {\n            if (rel == null) {\n                rel = this.rel;\n            }\n            var row = rel & 2 ? this.row - arow : this.row;\n            var col = rel & 1 ? this.col - acol : this.col;\n            return new CellRef(row, col, rel).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            return 1;\n        },\n        width: function () {\n            return 1;\n        },\n        toString: function () {\n            return displayRef(null, this.row, this.col, 3);\n        },\n        isCell: function () {\n            return true;\n        },\n        leftColumn: function () {\n            return this;\n        },\n        rightColumn: function () {\n            return this;\n        },\n        topRow: function () {\n            return this;\n        },\n        bottomRow: function () {\n            return this;\n        },\n        forEachRow: function (callback) {\n            callback(this.toRangeRef());\n        },\n        forEachColumn: function (callback) {\n            callback(this.toRangeRef());\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var ref = this.absolute(row, col);\n            if (forRow) {\n                if (ref.row >= start) {\n                    if (delta < 0 && ref.row < start - delta) {\n                        return NULL;\n                    }\n                    ref.row += delta;\n                }\n            } else {\n                if (ref.col >= start) {\n                    if (delta < 0 && ref.col < start - delta) {\n                        return NULL;\n                    }\n                    ref.col += delta;\n                }\n            }\n            if (trow != null && tcol != null) {\n                ref = ref.relative(trow, tcol, this.rel);\n            }\n            return ref;\n        },\n        valid: function () {\n            if (this.rel) {\n                throw new Error('valid() called on relative reference');\n            }\n            var col = this.col, row = this.row;\n            return !(isFinite(col) && col < 0 || isFinite(row) && row < 0);\n        }\n    });\n    var RangeRef = Ref.extend({\n        ref: 'range',\n        init: function RangeRef(tl, br) {\n            if (tl._hasSheet && br._hasSheet && tl.sheet.toLowerCase() != br.sheet.toLowerCase()) {\n                this.endSheet = br.sheet;\n            }\n            this.topLeft = new CellRef(tl.row, tl.col, tl.rel);\n            this.bottomRight = new CellRef(br.row, br.col, br.rel);\n            this.normalize();\n        },\n        clone: function () {\n            return new RangeRef(this.topLeft.clone(), this.bottomRight.clone()).setSheet(this.sheet, this.hasSheet());\n        },\n        _containsRange: function (range) {\n            return this._containsCell(range.topLeft) && this._containsCell(range.bottomRight);\n        },\n        _containsCell: function (cell) {\n            return cell.sheet == this.sheet && cell.row >= this.topLeft.row && cell.col >= this.topLeft.col && cell.row <= this.bottomRight.row && cell.col <= this.bottomRight.col;\n        },\n        contains: function (ref) {\n            if (ref instanceof Array) {\n                var that = this;\n                return ref.some(function (_ref) {\n                    return that.contains(_ref);\n                });\n            }\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref);\n            }\n            if (ref instanceof RangeRef) {\n                return this._containsRange(ref);\n            }\n            return false;\n        },\n        _intersectRange: function (ref) {\n            if (this.sheet != ref.sheet) {\n                return NULL;\n            }\n            var a_left = this.topLeft.col;\n            var a_top = this.topLeft.row;\n            var a_right = this.bottomRight.col;\n            var a_bottom = this.bottomRight.row;\n            var b_left = ref.topLeft.col;\n            var b_top = ref.topLeft.row;\n            var b_right = ref.bottomRight.col;\n            var b_bottom = ref.bottomRight.row;\n            if (a_left <= b_right && b_left <= a_right && a_top <= b_bottom && b_top <= a_bottom) {\n                return new RangeRef(new CellRef(Math.max(a_top, b_top), Math.max(a_left, b_left)), new CellRef(Math.min(a_bottom, b_bottom), Math.min(a_right, b_right))).setSheet(this.sheet, this.hasSheet());\n            } else {\n                return NULL;\n            }\n        },\n        intersect: function (ref) {\n            if (ref === NULL) {\n                return ref;\n            }\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref) ? ref : NULL;\n            }\n            if (ref instanceof RangeRef) {\n                return this._intersectRange(ref).simplify();\n            }\n            if (ref instanceof UnionRef) {\n                return ref.intersect(this);\n            }\n            throw new Error('Unknown reference');\n        },\n        simplify: function () {\n            if (this.isCell()) {\n                return new CellRef(this.topLeft.row, this.topLeft.col, this.topLeft.rel).setSheet(this.sheet, this.hasSheet());\n            }\n            return this;\n        },\n        normalize: function () {\n            var a = this.topLeft, b = this.bottomRight;\n            var r1 = a.row, c1 = a.col, r2 = b.row, c2 = b.col;\n            var rr1 = a.rel & 2, rc1 = a.rel & 1;\n            var rr2 = b.rel & 2, rc2 = b.rel & 1;\n            var tmp, changes = false;\n            if (r1 > r2) {\n                changes = true;\n                tmp = r1;\n                r1 = r2;\n                r2 = tmp;\n                tmp = rr1;\n                rr1 = rr2;\n                rr2 = tmp;\n            }\n            if (c1 > c2) {\n                changes = true;\n                tmp = c1;\n                c1 = c2;\n                c2 = tmp;\n                tmp = rc1;\n                rc1 = rc2;\n                rc2 = tmp;\n            }\n            if (changes) {\n                this.topLeft = new CellRef(r1, c1, rc1 | rr1);\n                this.bottomRight = new CellRef(r2, c2, rc2 | rr2);\n            }\n            return this;\n        },\n        print: function (trow, tcol) {\n            var abs = this.absolute(trow, tcol);\n            if (abs.valid()) {\n                var ret = this.topLeft.print(trow, tcol) + ':' + this.bottomRight.print(trow, tcol);\n                if (this.hasSheet()) {\n                    ret = displaySheet(this.sheet) + (this.endSheet ? ':' + displaySheet(this.endSheet) : '') + '!' + ret;\n                }\n                return ret;\n            }\n            return '#REF!';\n        },\n        absolute: function (arow, acol) {\n            return new RangeRef(this.topLeft.absolute(arow, acol), this.bottomRight.absolute(arow, acol)).setSheet(this.sheet, this.hasSheet());\n        },\n        relative: function (arow, acol, relTL, relBR) {\n            if (relBR == null) {\n                relBR = relTL;\n            }\n            return new RangeRef(this.topLeft.relative(arow, acol, relTL), this.bottomRight.relative(arow, acol, relBR)).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.row - this.topLeft.row + 1;\n        },\n        width: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.col - this.topLeft.col + 1;\n        },\n        collapse: function () {\n            return this.topLeft.toRangeRef();\n        },\n        leftColumn: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.bottomRight.row, this.topLeft.col));\n        },\n        rightColumn: function () {\n            return new RangeRef(new CellRef(this.topLeft.row, this.bottomRight.col), this.bottomRight);\n        },\n        topRow: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.topLeft.row, this.bottomRight.col));\n        },\n        bottomRow: function () {\n            return new RangeRef(new CellRef(this.bottomRight.row, this.topLeft.col), this.bottomRight);\n        },\n        toRangeRef: function () {\n            return this;\n        },\n        toRow: function (row) {\n            return new RangeRef(new CellRef(this.topLeft.row + row, this.topLeft.col), new CellRef(this.topLeft.row + row, this.bottomRight.col));\n        },\n        toColumn: function (col) {\n            return new RangeRef(new CellRef(this.topLeft.row, this.topLeft.col + col), new CellRef(this.bottomRight.row, this.topLeft.col + col));\n        },\n        forEachRow: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startRow; i <= endRow; i++) {\n                callback(new RangeRef(new CellRef(i, startCol), new CellRef(i, endCol)));\n            }\n        },\n        forEachColumn: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startCol; i <= endCol; i++) {\n                callback(new RangeRef(new CellRef(startRow, i), new CellRef(endRow, i)));\n            }\n        },\n        intersecting: function (refs) {\n            return refs.filter(function (ref) {\n                return ref.toRangeRef().intersects(this);\n            }, this);\n        },\n        union: function (refs, callback) {\n            var intersecting = this.intersecting(refs);\n            var topLeftRow = this.topLeft.row;\n            var topLeftCol = this.topLeft.col;\n            var bottomRightRow = this.bottomRight.row;\n            var bottomRightCol = this.bottomRight.col;\n            var modified = false;\n            intersecting.forEach(function (ref) {\n                ref = ref.toRangeRef();\n                if (ref.topLeft.row < topLeftRow) {\n                    modified = true;\n                    topLeftRow = ref.topLeft.row;\n                }\n                if (ref.topLeft.col < topLeftCol) {\n                    modified = true;\n                    topLeftCol = ref.topLeft.col;\n                }\n                if (ref.bottomRight.row > bottomRightRow) {\n                    modified = true;\n                    bottomRightRow = ref.bottomRight.row;\n                }\n                if (ref.bottomRight.col > bottomRightCol) {\n                    modified = true;\n                    bottomRightCol = ref.bottomRight.col;\n                }\n                if (callback) {\n                    callback(ref);\n                }\n            });\n            var result = new RangeRef(new CellRef(topLeftRow, topLeftCol), new CellRef(bottomRightRow, bottomRightCol));\n            if (modified) {\n                return result.union(refs, callback);\n            } else {\n                return result;\n            }\n        },\n        resize: function (options) {\n            var limit = Math.max.bind(Math, 0);\n            function num(value) {\n                return value || 0;\n            }\n            var top = this.topLeft.row + num(options.top);\n            var left = this.topLeft.col + num(options.left);\n            var bottom = this.bottomRight.row + num(options.bottom);\n            var right = this.bottomRight.col + num(options.right);\n            if (left < 0 && right < 0 || top < 0 && bottom < 0) {\n                return NULL;\n            } else if (top <= bottom && left <= right) {\n                return new RangeRef(new CellRef(limit(top), limit(left)), new CellRef(limit(bottom), limit(right)));\n            } else {\n                return NULL;\n            }\n        },\n        move: function (rows, cols) {\n            return new RangeRef(new CellRef(this.topLeft.row + rows, this.topLeft.col + cols), new CellRef(this.bottomRight.row + rows, this.bottomRight.col + cols));\n        },\n        first: function () {\n            return this.topLeft;\n        },\n        isCell: function () {\n            return !this.endSheet && this.topLeft.eq(this.bottomRight);\n        },\n        toString: function () {\n            return this.topLeft + ':' + this.bottomRight;\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var tl = this.topLeft.adjust(row, col, trow, tcol, forRow, start, delta);\n            var tr = this.bottomRight.adjust(row, col, trow, tcol, forRow, start, delta);\n            if (tl === NULL && tr === NULL) {\n                return NULL;\n            }\n            if (tl === NULL) {\n                tl = this.topLeft.absolute(row, col);\n                if (forRow) {\n                    tl.row = start;\n                } else {\n                    tl.col = start;\n                }\n                if (trow != null && tcol != null) {\n                    tl = tl.relative(trow, tcol, this.topLeft.rel);\n                }\n            } else if (tr === NULL) {\n                tr = this.bottomRight.absolute(row, col);\n                if (forRow) {\n                    tr.row = start - 1;\n                } else {\n                    tr.col = start - 1;\n                }\n                if (trow != null && tcol != null) {\n                    tr = tr.relative(trow, tcol, this.bottomRight.rel);\n                }\n            }\n            return new RangeRef(tl, tr).setSheet(this.sheet, this.hasSheet()).simplify();\n        },\n        valid: function () {\n            return this.topLeft.valid() && this.bottomRight.valid();\n        }\n    });\n    var UnionRef = Ref.extend({\n        init: function UnionRef(refs) {\n            this.refs = refs;\n            this.length = this.refs.length;\n        },\n        intersect: function (ref) {\n            var a = [];\n            for (var i = 0; i < this.length; ++i) {\n                var x = ref.intersect(this.refs[i]);\n                if (x !== NULL) {\n                    a.push(x);\n                }\n            }\n            if (a.length > 0) {\n                return new UnionRef(a).simplify();\n            }\n            return NULL;\n        },\n        simplify: function () {\n            var u = new UnionRef(this.refs.reduce(function (a, ref) {\n                ref = ref.simplify();\n                if (ref !== NULL) {\n                    a.push(ref);\n                }\n                return a;\n            }, []));\n            if (u.empty()) {\n                return NULL;\n            }\n            if (u.single()) {\n                return u.refs[0];\n            }\n            return u;\n        },\n        absolute: function (arow, acol) {\n            return new UnionRef(this.refs.map(function (ref) {\n                return ref.absolute(arow, acol);\n            }));\n        },\n        forEach: function (callback, obj) {\n            this.refs.forEach(callback, obj);\n        },\n        toRangeRef: function () {\n            return this.refs[0].toRangeRef();\n        },\n        contains: function (theRef) {\n            return this.refs.some(function (ref) {\n                return ref.contains(theRef);\n            });\n        },\n        map: function (callback, obj) {\n            return new UnionRef(this.refs.map(callback, obj));\n        },\n        first: function () {\n            return this.refs[0].first();\n        },\n        lastRange: function () {\n            return this.refs[this.length - 1];\n        },\n        size: function () {\n            return this.length;\n        },\n        single: function () {\n            return this.length == 1;\n        },\n        empty: function () {\n            return this.length === 0;\n        },\n        isCell: function () {\n            return this.single() && this.refs[0].isCell();\n        },\n        rangeAt: function (index) {\n            return this.refs[index];\n        },\n        nextRangeIndex: function (index) {\n            if (index === this.length - 1) {\n                return 0;\n            } else {\n                return index + 1;\n            }\n        },\n        previousRangeIndex: function (index) {\n            if (index === 0) {\n                return this.length - 1;\n            } else {\n                return index - 1;\n            }\n        },\n        concat: function (ref) {\n            return new UnionRef(this.refs.concat([ref]));\n        },\n        print: function (row, col) {\n            return this.refs.map(function (ref) {\n                return ref.print(row, col);\n            }).join(',');\n        },\n        replaceAt: function (index, ref) {\n            var newRefs = this.refs.slice();\n            newRefs.splice(index, 1, ref);\n            return new UnionRef(newRefs);\n        },\n        leftColumn: function () {\n            return this.map(function (ref) {\n                return ref.leftColumn();\n            });\n        },\n        rightColumn: function () {\n            return this.map(function (ref) {\n                return ref.rightColumn();\n            });\n        },\n        topRow: function () {\n            return this.map(function (ref) {\n                return ref.topRow();\n            });\n        },\n        bottomRow: function () {\n            return this.map(function (ref) {\n                return ref.bottomRow();\n            });\n        },\n        forEachRow: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachRow(callback);\n            });\n        },\n        forEachColumn: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachColumn(callback);\n            });\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            return this.map(function (ref) {\n                return ref.adjust(row, col, trow, tcol, forRow, start, delta);\n            }).simplify();\n        },\n        toString: function () {\n            return this.refs.map(function (ref) {\n                return ref.toString();\n            }).join(', ');\n        },\n        valid: function () {\n            for (var i = this.refs.length; --i >= 0;) {\n                if (this.refs[i].valid()) {\n                    return false;\n                }\n            }\n            return true;\n        }\n    });\n    spreadsheet.NULLREF = NULL;\n    spreadsheet.SHEETREF = new RangeRef(new CellRef(0, 0), new CellRef(Infinity, Infinity));\n    spreadsheet.FIRSTREF = new CellRef(0, 0);\n    spreadsheet.Ref = Ref;\n    spreadsheet.NameRef = NameRef;\n    spreadsheet.CellRef = CellRef;\n    spreadsheet.RangeRef = RangeRef;\n    spreadsheet.UnionRef = UnionRef;\n    spreadsheet.SHEETREF.print = function () {\n        return '#SHEET';\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofillcalculator', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var AutoFillCalculator = kendo.Class.extend({\n            init: function (grid) {\n                this._grid = grid;\n            },\n            rectIsVertical: function (start, end, x, y) {\n                var startRect = this._grid.rectangle(start.toRangeRef());\n                var endRect = this._grid.rectangle(end.toRangeRef());\n                return Math.abs(endRect[y] - startRect[y]) > Math.abs(startRect[x] - endRect[x]);\n            },\n            autoFillDest: function (selection, cursor) {\n                var topLeft = selection.topLeft;\n                var bottomRight = selection.bottomRight;\n                var quadrant;\n                var lower = cursor.row >= topLeft.row;\n                var further = cursor.col >= topLeft.col;\n                if (lower) {\n                    quadrant = further ? 4 : 3;\n                } else {\n                    quadrant = further ? 2 : 1;\n                }\n                var pivot, opposite, cornerResult, expanding;\n                if (quadrant === 4) {\n                    pivot = topLeft;\n                    opposite = bottomRight;\n                    expanding = cursor.row > opposite.row || cursor.col > opposite.col;\n                    if (expanding) {\n                        cursor = new CellRef(Math.max(cursor.row, opposite.row), Math.max(cursor.col, opposite.col));\n                    }\n                    if (this.rectIsVertical(opposite, cursor, 'right', 'bottom')) {\n                        cornerResult = new CellRef(cursor.row, opposite.col);\n                    } else {\n                        cornerResult = new CellRef(opposite.row, cursor.col);\n                    }\n                } else if (quadrant === 3) {\n                    var bottomLeft = new CellRef(topLeft.col, bottomRight.row);\n                    if (cursor.row > bottomRight.row && this.rectIsVertical(bottomLeft, cursor, 'left', 'bottom')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(cursor.row, bottomRight.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                } else if (quadrant === 2) {\n                    var topRight = new CellRef(topLeft.row, bottomRight.col);\n                    if (cursor.col > bottomRight.col && !this.rectIsVertical(topRight, cursor, 'right', 'top')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(bottomRight.row, cursor.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    }\n                } else {\n                    pivot = bottomRight;\n                    if (this.rectIsVertical(topLeft, cursor, 'left', 'top')) {\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    } else {\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                }\n                return this._grid.normalize(new RangeRef(pivot, cornerResult));\n            }\n        });\n        kendo.spreadsheet.AutoFillCalculator = AutoFillCalculator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/navigator', [\n        'kendo.core',\n        'spreadsheet/autofillcalculator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var EdgeNavigator = kendo.Class.extend({\n            init: function (field, axis, rangeGetter, union) {\n                this.rangeGetter = rangeGetter;\n                this.prevLeft = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.prevVisible(current.topLeft[field]));\n                    return union(range).topLeft[field];\n                };\n                this.nextRight = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.nextVisible(current.bottomRight[field]));\n                    return union(range).bottomRight[field];\n                };\n                this.nextLeft = function (index) {\n                    var range = union(this.range(index));\n                    return axis.nextVisible(range.bottomRight[field]);\n                };\n                this.prevRight = function (index) {\n                    var range = union(this.range(index));\n                    return axis.prevVisible(range.topLeft[field]);\n                };\n            },\n            boundary: function (top, bottom) {\n                this.top = top;\n                this.bottom = bottom;\n            },\n            range: function (index) {\n                return this.rangeGetter(index, this.top, this.bottom);\n            }\n        });\n        var SheetNavigator = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.columns = this._sheet._grid._columns;\n                this.autoFillCalculator = new kendo.spreadsheet.AutoFillCalculator(sheet._grid);\n                this.colEdge = new EdgeNavigator('col', this._sheet._grid._columns, this.columnRange.bind(this), this.union.bind(this));\n                this.rowEdge = new EdgeNavigator('row', this._sheet._grid._rows, this.rowRange.bind(this), this.union.bind(this));\n            },\n            height: function (height) {\n                this._viewPortHeight = height;\n            },\n            union: function (ref) {\n                return this._sheet.unionWithMerged(ref);\n            },\n            columnRange: function (col, topRow, bottomRow) {\n                return this._sheet._ref(topRow, col, bottomRow - topRow, 1);\n            },\n            rowRange: function (row, leftCol, rightCol) {\n                return this._sheet._ref(row, leftCol, 1, rightCol - leftCol);\n            },\n            selectionIncludesMergedCells: function () {\n                return this._sheet.select().contains(this._sheet._mergedCells);\n            },\n            setSelectionValue: function (value) {\n                var selection = this._sheet.selection();\n                setTimeout(function () {\n                    selection.value(value());\n                });\n            },\n            selectAll: function () {\n                this._sheet.select(this._sheet._sheetRef);\n            },\n            select: function (ref, mode, addToExisting) {\n                ref = this.refForMode(ref, mode);\n                if (addToExisting) {\n                    ref = this._sheet.select().concat(ref);\n                }\n                this._sheet.select(ref);\n            },\n            refForMode: function (ref, mode) {\n                var grid = this._sheet._grid;\n                switch (mode) {\n                case 'range':\n                    ref = grid.normalize(ref);\n                    break;\n                case 'row':\n                    ref = grid.rowRef(ref.row);\n                    break;\n                case 'column':\n                    ref = grid.colRef(ref.col);\n                    break;\n                case 'sheet':\n                    ref = this._sheet._sheetRef;\n                    break;\n                }\n                return ref;\n            },\n            startSelection: function (ref, mode, addToExisting) {\n                if (mode == 'autofill') {\n                    this._sheet.startAutoFill();\n                } else {\n                    this._sheet.startSelection();\n                    this.select(ref, mode, addToExisting);\n                }\n            },\n            completeSelection: function () {\n                this._sheet.completeSelection();\n            },\n            selectForContextMenu: function (ref, mode) {\n                var sheet = this._sheet;\n                if (!sheet.select().contains(this.refForMode(ref, mode))) {\n                    this.select(ref, mode);\n                }\n            },\n            modifySelection: function (action) {\n                var direction = this.determineDirection(action);\n                var sheet = this._sheet;\n                var viewPortHeight = this._viewPortHeight;\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var originalSelection = sheet.currentOriginalSelectionRange();\n                var selection = sheet.select().toRangeRef();\n                var activeCell = sheet.activeCell();\n                var topLeft = originalSelection.topLeft.clone();\n                var bottomRight = originalSelection.bottomRight.clone();\n                var scrollInto;\n                this.colEdge.boundary(selection.topLeft.row, selection.bottomRight.row);\n                this.rowEdge.boundary(selection.topLeft.col, selection.bottomRight.col);\n                switch (direction) {\n                case 'expand-left':\n                    topLeft.col = this.colEdge.prevLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-right':\n                    topLeft.col = this.colEdge.nextLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-right':\n                    bottomRight.col = this.colEdge.nextRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-left':\n                    bottomRight.col = this.colEdge.prevRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-up':\n                    topLeft.row = this.rowEdge.prevLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-down':\n                    topLeft.row = this.rowEdge.nextLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-down':\n                    bottomRight.row = this.rowEdge.nextRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-up':\n                    bottomRight.row = this.rowEdge.prevRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-page-up':\n                    topLeft.row = rows.prevPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'shrink-page-up':\n                    bottomRight.row = rows.prevPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'expand-page-down':\n                    bottomRight.row = rows.nextPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'shrink-page-down':\n                    topLeft.row = rows.nextPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'first-col':\n                    topLeft.col = columns.firstVisible();\n                    bottomRight.col = activeCell.bottomRight.col;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-col':\n                    bottomRight.col = columns.lastVisible();\n                    topLeft.col = activeCell.topLeft.col;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first-row':\n                    topLeft.row = rows.firstVisible();\n                    bottomRight.row = activeCell.bottomRight.row;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-row':\n                    bottomRight.row = rows.lastVisible();\n                    topLeft.row = activeCell.topLeft.row;\n                    scrollInto = bottomRight;\n                    break;\n                case 'last':\n                    bottomRight.row = rows.lastVisible();\n                    bottomRight.col = columns.lastVisible();\n                    topLeft = activeCell.topLeft;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first':\n                    topLeft.row = rows.firstVisible();\n                    topLeft.col = columns.firstVisible();\n                    bottomRight = activeCell.bottomRight;\n                    scrollInto = topLeft;\n                    break;\n                }\n                var newSelection = new RangeRef(topLeft, bottomRight);\n                if (!this.union(newSelection).intersects(activeCell)) {\n                    this.modifySelection(direction.replace('shrink', 'expand'));\n                    return;\n                }\n                if (scrollInto) {\n                    sheet.focus(scrollInto);\n                }\n                this.updateCurrentSelectionRange(newSelection);\n            },\n            moveActiveCell: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var bottomRight = activeCell.bottomRight;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                switch (direction) {\n                case 'left':\n                    column = columns.prevVisible(topLeft.col);\n                    break;\n                case 'up':\n                    row = rows.prevVisible(topLeft.row);\n                    break;\n                case 'right':\n                    column = columns.nextVisible(bottomRight.col);\n                    break;\n                case 'down':\n                    row = rows.nextVisible(bottomRight.row);\n                    break;\n                case 'first-col':\n                    column = columns.firstVisible();\n                    break;\n                case 'last-col':\n                    column = columns.lastVisible();\n                    break;\n                case 'first-row':\n                    row = rows.firstVisible();\n                    break;\n                case 'last-row':\n                    row = rows.lastVisible();\n                    break;\n                case 'last':\n                    row = rows.lastVisible();\n                    column = columns.lastVisible();\n                    break;\n                case 'first':\n                    row = rows.firstVisible();\n                    column = columns.firstVisible();\n                    break;\n                case 'next-page':\n                    row = rows.nextPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                case 'prev-page':\n                    row = rows.prevPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                }\n                sheet.select(new CellRef(row, column));\n            },\n            navigateInSelection: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                var selection = sheet.currentNavigationRange();\n                var selTopLeft = selection.topLeft;\n                var selBottomRight = selection.bottomRight;\n                var done = false;\n                var topLeftCol = topLeft.col;\n                var topLeftRow = topLeft.row;\n                while (!done) {\n                    var current = new CellRef(row, column);\n                    switch (direction) {\n                    case 'next':\n                        if (selBottomRight.eq(current)) {\n                            selection = sheet.nextNavigationRange();\n                            row = selection.topLeft.row;\n                            column = selection.topLeft.col;\n                        } else {\n                            column = columns.nextVisible(topLeftCol, true);\n                            if (column > selBottomRight.col) {\n                                column = selTopLeft.col;\n                                row = rows.nextVisible(row, true);\n                            }\n                        }\n                        break;\n                    case 'previous':\n                        if (selTopLeft.eq(current)) {\n                            selection = sheet.previousNavigationRange();\n                            row = selection.bottomRight.row;\n                            column = selection.bottomRight.col;\n                        } else {\n                            column = columns.prevVisible(topLeftCol, true);\n                            if (column < selTopLeft.col) {\n                                column = selBottomRight.col;\n                                row = rows.prevVisible(row, true);\n                            }\n                        }\n                        break;\n                    case 'lower':\n                        if (selBottomRight.eq(current)) {\n                            selection = sheet.nextNavigationRange();\n                            row = selection.topLeft.row;\n                            column = selection.topLeft.col;\n                        } else {\n                            row = rows.nextVisible(topLeftRow, true);\n                            if (row > selBottomRight.row) {\n                                row = selTopLeft.row;\n                                column = columns.nextVisible(column, true);\n                            }\n                        }\n                        break;\n                    case 'upper':\n                        if (selTopLeft.eq(current)) {\n                            selection = sheet.previousNavigationRange();\n                            row = selection.bottomRight.row;\n                            column = selection.bottomRight.col;\n                        } else {\n                            row = rows.prevVisible(topLeftRow, true);\n                            if (row < selTopLeft.row) {\n                                row = selBottomRight.row;\n                                column = columns.prevVisible(column, true);\n                            }\n                        }\n                        break;\n                    default:\n                        throw new Error('Unknown entry navigation: ' + direction);\n                    }\n                    done = !this.shouldSkip(row, column);\n                    topLeftCol = column;\n                    topLeftRow = row;\n                }\n                if (sheet.singleCellSelection()) {\n                    sheet.select(new CellRef(row, column));\n                } else {\n                    sheet.activeCell(new CellRef(row, column));\n                }\n            },\n            extendSelection: function (ref, mode) {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                if (mode === 'autofill') {\n                    this.resizeAutoFill(ref);\n                    return;\n                }\n                if (mode === 'range') {\n                    ref = grid.normalize(ref);\n                } else if (mode === 'row') {\n                    ref = grid.rowRef(ref.row).bottomRight;\n                } else if (mode === 'column') {\n                    ref = grid.colRef(ref.col).bottomRight;\n                }\n                var activeCell = sheet.originalActiveCell().toRangeRef();\n                this.updateCurrentSelectionRange(new RangeRef(activeCell.topLeft, ref));\n            },\n            shouldSkip: function (row, col) {\n                var ref = new CellRef(row, col);\n                var isMerged = false;\n                this._sheet.forEachMergedCell(function (merged) {\n                    if (merged.intersects(ref) && !merged.collapse().eq(ref)) {\n                        isMerged = true;\n                    }\n                });\n                return isMerged;\n            },\n            resizeAutoFill: function (ref) {\n                var sheet = this._sheet;\n                var selection = sheet.select();\n                var origin = sheet._autoFillOrigin;\n                var dest = this.autoFillCalculator.autoFillDest(selection, ref);\n                var punch = this.punch(selection, dest);\n                var hint, direction, row;\n                if (!punch) {\n                    var preview = sheet.range(dest)._previewFillFrom(sheet.range(origin));\n                    if (preview) {\n                        direction = preview.direction;\n                        var props = preview.props;\n                        if (direction === 0 || direction == 1) {\n                            row = props[props.length - 1];\n                            hint = row[row.length - 1].value;\n                        } else if (direction === 2) {\n                            row = props[0];\n                            hint = row[row.length - 1].value;\n                        } else if (direction === 3) {\n                            row = props[props.length - 1];\n                            hint = row[0].value;\n                        }\n                    }\n                }\n                sheet.updateAutoFill(dest, punch, hint, direction);\n            },\n            determineDirection: function (action) {\n                var selection = this._sheet.currentSelectionRange();\n                var activeCell = this._sheet.activeCell();\n                var leftMode = activeCell.topLeft.col == selection.topLeft.col;\n                var rightMode = activeCell.bottomRight.col == selection.bottomRight.col;\n                var topMode = activeCell.topLeft.row == selection.topLeft.row;\n                var bottomMode = activeCell.bottomRight.row == selection.bottomRight.row;\n                switch (action) {\n                case 'left':\n                    action = rightMode ? 'expand-left' : 'shrink-left';\n                    break;\n                case 'right':\n                    action = leftMode ? 'expand-right' : 'shrink-right';\n                    break;\n                case 'up':\n                    action = bottomMode ? 'expand-up' : 'shrink-up';\n                    break;\n                case 'down':\n                    action = topMode ? 'expand-down' : 'shrink-down';\n                    break;\n                case 'prev-page':\n                    action = bottomMode ? 'expand-page-up' : 'shrink-page-up';\n                    break;\n                case 'next-page':\n                    action = topMode ? 'expand-page-down' : 'shrink-page-down';\n                    break;\n                }\n                return action;\n            },\n            updateCurrentSelectionRange: function (ref) {\n                var sheet = this._sheet;\n                sheet.select(sheet.originalSelect().replaceAt(sheet.selectionRangeIndex(), ref), false);\n            },\n            punch: function (selection, subset) {\n                var punch;\n                if (subset.topLeft.eq(selection.topLeft)) {\n                    if (subset.bottomRight.row < selection.bottomRight.row) {\n                        var bottomRow = this.rowEdge.nextRight(subset.bottomRight.row);\n                        punch = new RangeRef(new CellRef(bottomRow, selection.topLeft.col), selection.bottomRight);\n                    } else if (subset.bottomRight.col < selection.bottomRight.col) {\n                        var bottomCol = this.colEdge.nextRight(subset.bottomRight.col);\n                        punch = new RangeRef(new CellRef(selection.topLeft.row, bottomCol), selection.bottomRight);\n                    }\n                }\n                return punch;\n            }\n        });\n        kendo.spreadsheet.SheetNavigator = SheetNavigator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axismanager', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var AxisManager = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n            },\n            forEachSelectedColumn: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            forEachSelectedRow: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            includesHiddenColumns: function (ref) {\n                return this._sheet._grid._columns.includesHidden(ref.topLeft.col, ref.bottomRight.col);\n            },\n            includesHiddenRows: function (ref) {\n                return this._sheet._grid._rows.includesHidden(ref.topLeft.row, ref.bottomRight.row);\n            },\n            selectionIncludesHiddenColumns: function () {\n                return this.includesHiddenColumns(this._sheet.select());\n            },\n            selectionIncludesHiddenRows: function () {\n                return this.includesHiddenRows(this._sheet.select());\n            },\n            deleteSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.deleteColumn(index - i);\n                });\n            },\n            deleteSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.deleteRow(index - i);\n                });\n            },\n            hideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.hideColumn(index);\n                });\n            },\n            hideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.hideRow(index);\n                });\n            },\n            unhideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.unhideColumn(index);\n                });\n            },\n            unhideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.unhideRow(index);\n                });\n            },\n            addColumnLeft: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.insertColumn(index - i);\n                });\n            },\n            addColumnRight: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.insertColumn(index + (i + 1));\n                });\n            },\n            canAddRow: function () {\n                var range = this._sheet.select().toRangeRef();\n                var rowCount = range.height();\n                return this._sheet.canInsertRow(0, rowCount);\n            },\n            addRowAbove: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.insertRow(index - i);\n                });\n            },\n            addRowBelow: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.insertRow(index + (i + 1));\n                });\n            }\n        });\n        kendo.spreadsheet.AxisManager = AxisManager;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/clipboard', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Clipboard = kendo.Class.extend({\n            init: function (workbook) {\n                this.workbook = workbook;\n                this.origin = kendo.spreadsheet.NULLREF;\n                this.iframe = document.createElement('iframe');\n                this.iframe.className = 'k-spreadsheet-clipboard-paste';\n                this.menuInvoked = true;\n                this._external = {};\n                this._uid = kendo.guid();\n                document.body.appendChild(this.iframe);\n            },\n            canCopy: function () {\n                var status = { canCopy: true };\n                var selection = this.workbook.activeSheet().select();\n                if (selection === kendo.spreadsheet.NULLREF) {\n                    status.canCopy = false;\n                }\n                if (selection instanceof kendo.spreadsheet.UnionRef) {\n                    status.canCopy = false;\n                    status.multiSelection = true;\n                }\n                if (this.menuInvoked) {\n                    status.canCopy = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n            canPaste: function () {\n                var sheet = this.workbook.activeSheet();\n                var ref = this.pasteRef();\n                var status = { canPaste: true };\n                if (ref === kendo.spreadsheet.NULLREF) {\n                    var external = this._external.hasOwnProperty('html') || this._external.hasOwnProperty('plain');\n                    status.pasteOnMerged = this.intersectsMerged();\n                    status.canPaste = status.pasteOnMerged ? false : external;\n                    return status;\n                }\n                if (!ref.eq(sheet.unionWithMerged(ref))) {\n                    status.canPaste = false;\n                    status.pasteOnMerged = true;\n                }\n                if (this.menuInvoked) {\n                    status.canPaste = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n            intersectsMerged: function () {\n                var sheet = this.workbook.activeSheet();\n                var state = this.parse(this._external);\n                this.origin = this.stateRangeRef(state);\n                var ref = this.pasteRef();\n                return !ref.eq(sheet.unionWithMerged(ref));\n            },\n            copy: function () {\n                var sheet = this.workbook.activeSheet();\n                this.origin = sheet.select();\n                this.contents = sheet.selection().getState();\n            },\n            cut: function () {\n                var sheet = this.workbook.activeSheet();\n                this.copy();\n                sheet.range(sheet.select()).clear();\n            },\n            pasteRef: function () {\n                var sheet = this.workbook.activeSheet();\n                var destination = sheet.activeCell().first();\n                var originActiveCell = this.origin.first();\n                var rowDelta = originActiveCell.row - destination.row;\n                var colDelta = originActiveCell.col - destination.col;\n                return this.origin.relative(rowDelta, colDelta, 3);\n            },\n            stateRangeRef: function (state) {\n                var rows = [];\n                var cols = [];\n                for (var key in state) {\n                    if (key === 'mergedCells' || key === 'ref') {\n                        continue;\n                    }\n                    var address = key.split(',');\n                    rows.push(address[0]);\n                    cols.push(address[1]);\n                }\n                var topLeft = new CellRef(Math.min.apply(null, rows), Math.min.apply(null, cols));\n                var bottomRight = new CellRef(Math.max.apply(null, rows), Math.max.apply(null, cols));\n                return new RangeRef(topLeft, bottomRight);\n            },\n            destroy: function () {\n                document.body.removeChild(this.iframe);\n            },\n            paste: function () {\n                var state = {};\n                var sheet = this.workbook.activeSheet();\n                if (this._isInternal()) {\n                    state = this.contents;\n                } else {\n                    state = this.parse(this._external);\n                    this.origin = this.stateRangeRef(state);\n                }\n                var pasteRef = this.pasteRef();\n                sheet.range(pasteRef).clear().setState(state);\n                sheet.triggerChange({ recalc: true });\n            },\n            external: function (data) {\n                if (data.html || data.plain) {\n                    this._external = data;\n                } else {\n                    return this._external;\n                }\n            },\n            parse: function (data) {\n                var state = {\n                    ref: new CellRef(0, 0, 0),\n                    mergedCells: []\n                };\n                if (data.html) {\n                    var doc = this.iframe.contentWindow.document;\n                    doc.open();\n                    doc.write(data.html);\n                    doc.close();\n                    var table = $(doc).find('table:first');\n                    if (table.length) {\n                        state = this._parseHTML(table.find('tbody:first'));\n                    } else {\n                        if (!data.plain) {\n                            var element = $(doc.body).find(':not(style)');\n                            state['0,0'] = this._cellState(element.text());\n                        } else {\n                            state = this._parseTSV(data.plain);\n                        }\n                    }\n                } else {\n                    state = this._parseTSV(data.plain);\n                }\n                return state;\n            },\n            _parseHTML: function (tbody) {\n                var that = this;\n                var state = {\n                    ref: new CellRef(0, 0, 0),\n                    mergedCells: []\n                };\n                tbody.find('tr').each(function (rowIndex, tr) {\n                    $(tr).find('td').each(function (colIndex, td) {\n                        var rowspan = parseInt($(td).attr('rowspan'), 10) - 1 || 0;\n                        var colspan = parseInt($(td).attr('colspan'), 10) - 1 || 0;\n                        var blankCell = '<td/>';\n                        var ci;\n                        if (rowspan) {\n                            var endRow = rowIndex + rowspan;\n                            for (var ri = rowIndex; ri <= endRow; ri++) {\n                                var row = tbody.find('tr').eq(ri);\n                                if (ri > rowIndex) {\n                                    blankCell = '<td class=\\'rowspan\\'></td>';\n                                    if (colIndex === 0) {\n                                        row.find('td').eq(colIndex).after(blankCell);\n                                    } else {\n                                        var last = Math.min(row.find('td').length, colIndex);\n                                        row.find('td').eq(last - 1).after(blankCell);\n                                    }\n                                }\n                                if (colspan) {\n                                    for (ci = colIndex; ci < colspan + colIndex; ci++) {\n                                        blankCell = '<td class=\\'rowspan colspan\\'></td>';\n                                        row.find('td').eq(ci).after(blankCell);\n                                    }\n                                }\n                            }\n                        } else {\n                            if (colspan) {\n                                for (ci = colIndex; ci < colspan + colIndex; ci++) {\n                                    blankCell = '<td class=\\'colspan\\'></td>';\n                                    $(tr).find('td').eq(ci).after(blankCell);\n                                }\n                            }\n                        }\n                    });\n                });\n                tbody.find('tr').each(function (rowIndex, tr) {\n                    $(tr).find('td').each(function (colIndex, td) {\n                        var key = rowIndex + ',' + colIndex;\n                        var rowspan = parseInt($(td).attr('rowspan'), 10) - 1 || 0;\n                        var colspan = parseInt($(td).attr('colspan'), 10) - 1 || 0;\n                        var cellState = that._cellState($(td));\n                        state[key] = cellState;\n                        if (rowspan || colspan) {\n                            var startCol = String.fromCharCode(65 + colIndex);\n                            var endCol = String.fromCharCode(65 + colIndex + colspan);\n                            var address = startCol + (rowIndex + 1) + ':' + endCol + (rowIndex + 1 + rowspan);\n                            state.mergedCells.push(address);\n                        }\n                    });\n                });\n                return state;\n            },\n            _parseTSV: function (data) {\n                var state = {\n                    ref: new CellRef(0, 0, 0),\n                    mergedCells: []\n                };\n                if (data.indexOf('\\t') === -1 && data.indexOf('\\n') == -1) {\n                    state['0,0'] = { value: data };\n                } else {\n                    var rows = data.split('\\n');\n                    for (var ri = 0; ri < rows.length; ri++) {\n                        var cols = rows[ri].split('\\t');\n                        for (var ci = 0; ci < cols.length; ci++) {\n                            state[ri + ',' + ci] = { value: cols[ci] };\n                        }\n                    }\n                }\n                return state;\n            },\n            _isInternal: function () {\n                if (this._external.html === undefined) {\n                    return true;\n                }\n                var internalHTML = $('<div/>').html(this._external.html).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                var internalPlain = $('<div/>').html(this._external.plain).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                if (internalHTML || internalPlain) {\n                    return true;\n                }\n                return false;\n            },\n            _cellState: function (element) {\n                var styles = window.getComputedStyle(element[0]);\n                var text = element.text();\n                var borders = this._borderObject(styles);\n                var state = {\n                    value: text === '' ? null : text,\n                    borderBottom: borders.borderBottom,\n                    borderRight: borders.borderRight,\n                    borderLeft: borders.borderLeft,\n                    borderTop: borders.borderTop,\n                    fontSize: parseInt(styles['font-size'], 10)\n                };\n                if (styles['background-color'] !== 'rgb(0, 0, 0)' && styles['background-color'] !== 'rgba(0, 0, 0, 0)') {\n                    state.background = styles['background-color'];\n                }\n                if (styles.color !== 'rgb(0, 0, 0)' && styles.color !== 'rgba(0, 0, 0, 0)') {\n                    state.color = styles.color;\n                }\n                if (styles['text-decoration'] == 'underline') {\n                    state.underline = true;\n                }\n                if (styles['font-style'] == 'italic') {\n                    state.italic = true;\n                }\n                if (styles['font-weight'] == 'bold') {\n                    state.bold = true;\n                }\n                if (this._strippedStyle(styles['text-align']) !== 'right') {\n                    state.textAlign = this._strippedStyle(styles['text-align']);\n                }\n                if (styles['vertical-align'] !== 'middle') {\n                    state.verticalAlign = styles['vertical-align'];\n                }\n                if (styles['word-wrap'] !== 'normal') {\n                    state.wrap = true;\n                }\n                return state;\n            },\n            _strippedStyle: function (style) {\n                var prefixes = [\n                    '-ms-',\n                    '-moz-',\n                    '-webkit-'\n                ];\n                prefixes.forEach(function (prefix) {\n                    style = style.replace(prefix, '');\n                });\n                return style;\n            },\n            _borderObject: function (styles) {\n                var borderObject = {};\n                var borders = [\n                    'borderBottom',\n                    'borderRight',\n                    'borderLeft',\n                    'borderTop'\n                ];\n                borders.forEach(function (key) {\n                    if (styles[key + 'Style'] == 'none') {\n                        borderObject[key] = null;\n                        return;\n                    }\n                    borderObject[key] = {\n                        size: 1,\n                        color: styles[key + 'Color']\n                    };\n                });\n                return borderObject;\n            }\n        });\n        kendo.spreadsheet.Clipboard = Clipboard;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/range', [\n        'kendo.core',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var styles = [\n            'color',\n            'fontFamily',\n            'underline',\n            'italic',\n            'bold',\n            'textAlign',\n            'verticalAlign',\n            'background'\n        ];\n        var borders = {\n            borderTop: {\n                complement: 'borderBottom',\n                direction: {\n                    top: -1,\n                    bottom: -1\n                }\n            },\n            borderLeft: {\n                complement: 'borderRight',\n                direction: {\n                    left: -1,\n                    right: -1\n                }\n            },\n            borderRight: {\n                complement: 'borderLeft',\n                direction: {\n                    left: 1,\n                    right: 1\n                }\n            },\n            borderBottom: {\n                complement: 'borderTop',\n                direction: {\n                    top: 1,\n                    bottom: 1\n                }\n            }\n        };\n        var Range = kendo.Class.extend({\n            init: function (ref, sheet) {\n                this._sheet = sheet;\n                this._ref = ref;\n            },\n            _normalize: function (ref) {\n                return this._sheet._grid.normalize(ref);\n            },\n            _set: function (name, value, noTrigger) {\n                var sheet = this._sheet;\n                this._ref.forEach(function (ref) {\n                    sheet._set(ref.toRangeRef(), name, value);\n                });\n                if (!noTrigger) {\n                    sheet.triggerChange({\n                        recalc: name == 'formula' || name == 'value' || name == 'validation',\n                        value: value,\n                        ref: this._ref\n                    });\n                }\n                return this;\n            },\n            _get: function (name) {\n                return this._sheet._get(this._ref.toRangeRef(), name);\n            },\n            _property: function (name, value) {\n                if (value === undefined) {\n                    return this._get(name);\n                } else {\n                    return this._set(name, value);\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this._set('formula', null, true);\n                }\n                return this._property('value', value);\n            },\n            resize: function (direction) {\n                var ref = this._resizedRef(direction);\n                return new Range(ref, this._sheet);\n            },\n            _resizedRef: function (direction) {\n                return this._ref.map(function (ref) {\n                    return ref.toRangeRef().resize(direction);\n                });\n            },\n            _border: function (property, value) {\n                var result;\n                var complement = borders[property].complement;\n                var direction = borders[property].direction;\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    result = this._property(property, value);\n                    if (value !== undefined) {\n                        this._resizedRef(direction).forEach(function (ref) {\n                            if (ref !== kendo.spreadsheet.NULLREF) {\n                                new Range(ref, sheet)._property(complement, null);\n                            }\n                        });\n                    }\n                }.bind(this), {});\n                return result;\n            },\n            _collapsedBorder: function (property) {\n                var result = this._property(property);\n                var complement = borders[property].complement;\n                var direction = borders[property].direction;\n                this._resizedRef(direction).forEach(function (ref) {\n                    if (!result && ref !== kendo.spreadsheet.NULLREF) {\n                        var range = new Range(ref, this._sheet);\n                        result = range._property(complement);\n                    }\n                }.bind(this));\n                return result;\n            },\n            borderTop: function (value) {\n                return this._border('borderTop', value);\n            },\n            borderRight: function (value) {\n                return this._border('borderRight', value);\n            },\n            borderBottom: function (value) {\n                return this._border('borderBottom', value);\n            },\n            borderLeft: function (value) {\n                return this._border('borderLeft', value);\n            },\n            collapsedBorderTop: function () {\n                return this._collapsedBorder('borderTop');\n            },\n            collapsedBorderRight: function () {\n                return this._collapsedBorder('borderRight');\n            },\n            collapsedBorderBottom: function () {\n                return this._collapsedBorder('borderBottom');\n            },\n            collapsedBorderLeft: function () {\n                return this._collapsedBorder('borderLeft');\n            },\n            input: function (value) {\n                if (value !== undefined) {\n                    var tl = this._ref.toRangeRef().topLeft;\n                    var x = kendo.spreadsheet.calc.parse(this._sheet.name(), tl.row, tl.col, value);\n                    this._sheet.batch(function () {\n                        var formula = null;\n                        if (x.type == 'exp') {\n                            formula = kendo.spreadsheet.calc.compile(x);\n                        } else if (x.type == 'date') {\n                            this.format(toExcelFormat(kendo.culture().calendar.patterns.d));\n                        } else if (x.type == 'percent') {\n                            this.format(x.value * 100 == (x.value * 100 | 0) ? '0%' : '0.00%');\n                        }\n                        this.formula(formula);\n                        if (!formula) {\n                            this.value(x.value);\n                        }\n                    }.bind(this), {\n                        recalc: true,\n                        value: value,\n                        ref: this._ref,\n                        editorChange: this._sheet.isInEditMode()\n                    });\n                    return this;\n                } else {\n                    value = this._get('value');\n                    var format = this._get('format');\n                    var formula = this._get('formula');\n                    var type = format && !formula && kendo.spreadsheet.formatting.type(value, format);\n                    if (formula) {\n                        value = '=' + formula;\n                    } else if (type === 'date') {\n                        value = kendo.toString(kendo.spreadsheet.numberToDate(value), kendo.culture().calendar.patterns.d);\n                    } else if (type === 'percent') {\n                        value = value * 100 + '%';\n                    } else if (typeof value == 'string' && (/^[=']/.test(value) || /^(?:true|false)$/i.test(value) || looksLikeANumber(value))) {\n                        value = '\\'' + value;\n                    }\n                    return value;\n                }\n            },\n            enable: function (value) {\n                if (value === undefined) {\n                    value = true;\n                    this._sheet.forEach(this._ref.toRangeRef(), function (_, _, data) {\n                        if (data.enable === false) {\n                            value = false;\n                        }\n                    });\n                    return value;\n                }\n                this._property('enable', value);\n            },\n            format: function (value) {\n                return this._property('format', value);\n            },\n            formula: function (value) {\n                if (value === undefined) {\n                    var f = this._get('formula');\n                    return f ? '' + f : null;\n                }\n                return this._property('formula', value);\n            },\n            validation: function (value) {\n                if (value === undefined) {\n                    var f = this._get('validation');\n                    return f ? f.toJSON() : null;\n                }\n                return this._property('validation', value);\n            },\n            _getValidationState: function () {\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                    for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                        var validation = this._sheet._validation(ri, ci);\n                        if (validation && validation.type === 'reject' && validation.value === false) {\n                            return validation;\n                        }\n                    }\n                }\n                return false;\n            },\n            merge: function () {\n                this._ref = this._sheet._merge(this._ref);\n                return this;\n            },\n            unmerge: function () {\n                var mergedCells = this._sheet._mergedCells;\n                this._ref.forEach(function (ref) {\n                    ref.toRangeRef().intersecting(mergedCells).forEach(function (mergedRef) {\n                        mergedCells.splice(mergedCells.indexOf(mergedRef), 1);\n                    });\n                });\n                this._sheet.triggerChange({});\n                return this;\n            },\n            select: function () {\n                this._sheet.select(this._ref);\n                return this;\n            },\n            values: function (values) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (values !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                if (values === undefined) {\n                    values = new Array(ref.height());\n                    for (var vi = 0; vi < values.length; vi++) {\n                        values[vi] = new Array(ref.width());\n                    }\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            values[ri - topLeftRow][ci - topLeftCol] = this._sheet._value(ri, ci);\n                        }\n                    }\n                    return values;\n                } else {\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = values[ri - topLeftRow];\n                            if (row) {\n                                var value = row[ci - topLeftCol];\n                                if (value !== undefined) {\n                                    this._sheet._value(ri, ci, value);\n                                }\n                            }\n                        }\n                    }\n                    this._sheet.triggerChange({ recalc: true });\n                    return this;\n                }\n            },\n            _properties: function (props) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (props !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                var sheet = this._sheet;\n                if (props === undefined) {\n                    props = new Array(ref.height());\n                    sheet.forEach(ref, function (row, col, data) {\n                        row -= topLeftRow;\n                        col -= topLeftCol;\n                        var line = props[row] || (props[row] = []);\n                        line[col] = data;\n                    });\n                    return props;\n                } else {\n                    var data;\n                    ref = ref.clone();\n                    var setProp = function (propName) {\n                        var propValue = data[propName];\n                        ref.topLeft.row = ref.bottomRight.row = ri;\n                        ref.topLeft.col = ref.bottomRight.col = ci;\n                        sheet._set(ref, propName, propValue);\n                    };\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = props[ri - topLeftRow];\n                            if (row) {\n                                data = row[ci - topLeftCol];\n                                if (data) {\n                                    Object.keys(data).forEach(setProp);\n                                }\n                            }\n                        }\n                    }\n                    sheet.triggerChange({\n                        recalc: true,\n                        ref: ref\n                    });\n                    return this;\n                }\n            },\n            clear: function (options) {\n                var clearAll = !options || !Object.keys(options).length;\n                var sheet = this._sheet;\n                var reason = {\n                    recalc: clearAll || options && options.contentsOnly === true,\n                    ref: this._ref\n                };\n                sheet.batch(function () {\n                    if (reason.recalc) {\n                        this.formula(null);\n                    }\n                    if (clearAll) {\n                        this.validation(null);\n                    }\n                    if (clearAll || options && options.formatOnly === true) {\n                        styles.forEach(function (x) {\n                            this[x](null);\n                        }.bind(this));\n                        this.format(null);\n                        this.unmerge();\n                    }\n                }.bind(this), reason);\n                return this;\n            },\n            clearContent: function () {\n                return this.clear({ contentsOnly: true });\n            },\n            clearFormat: function () {\n                return this.clear({ formatOnly: true });\n            },\n            isSortable: function () {\n                return !(this._ref instanceof UnionRef || this._ref === kendo.spreadsheet.NULLREF);\n            },\n            sort: function (spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    throw new Error('Unsupported for NULLREF.');\n                }\n                if (spec === undefined) {\n                    spec = { column: 0 };\n                }\n                spec = spec instanceof Array ? spec : [spec];\n                this._sheet._sortBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                    if (typeof spec === 'number') {\n                        spec = { column: spec };\n                    }\n                    return {\n                        index: spec.column === undefined ? index : spec.column,\n                        ascending: spec.ascending === undefined ? true : spec.ascending\n                    };\n                }));\n                return this;\n            },\n            isFilterable: function () {\n                return !(this._ref instanceof UnionRef);\n            },\n            filter: function (spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (spec === false) {\n                    this.clearFilters();\n                } else {\n                    spec = spec === true ? [] : spec instanceof Array ? spec : [spec];\n                    this._sheet._filterBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                        return {\n                            index: spec.column === undefined ? index : spec.column,\n                            filter: spec.filter\n                        };\n                    }));\n                }\n                return this;\n            },\n            clearFilter: function (spec) {\n                this._sheet.clearFilter(spec);\n            },\n            clearFilters: function () {\n                var filter = this._sheet.filter();\n                var spec = [];\n                if (filter) {\n                    for (var i = 0; i < filter.columns.length; i++) {\n                        spec.push(i);\n                    }\n                    this._sheet.batch(function () {\n                        this.clearFilter(spec);\n                        this._filter = null;\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            hasFilter: function () {\n                var filter = this._sheet.filter();\n                return !!filter;\n            },\n            leftColumn: function () {\n                return new Range(this._ref.leftColumn(), this._sheet);\n            },\n            rightColumn: function () {\n                return new Range(this._ref.rightColumn(), this._sheet);\n            },\n            topRow: function () {\n                return new Range(this._ref.topRow(), this._sheet);\n            },\n            bottomRow: function () {\n                return new Range(this._ref.bottomRow(), this._sheet);\n            },\n            column: function (column) {\n                return new Range(this._ref.toColumn(column), this._sheet);\n            },\n            row: function (row) {\n                return new Range(this._ref.toRow(row), this._sheet);\n            },\n            forEachRow: function (callback) {\n                this._ref.forEachRow(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            forEachColumn: function (callback) {\n                this._ref.forEachColumn(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            sheet: function () {\n                return this._sheet;\n            },\n            topLeft: function () {\n                return this._ref.toRangeRef().topLeft;\n            },\n            intersectingMerged: function () {\n                var sheet = this._sheet;\n                var mergedCells = [];\n                sheet._mergedCells.forEach(function (ref) {\n                    if (ref.intersects(this._ref)) {\n                        mergedCells.push(ref.toString());\n                    }\n                }.bind(this));\n                return mergedCells;\n            },\n            getState: function (propertyName) {\n                var state = { ref: this._ref.first() };\n                var properties;\n                if (!propertyName) {\n                    properties = kendo.spreadsheet.ALL_PROPERTIES;\n                    state.mergedCells = this.intersectingMerged();\n                } else if (propertyName === 'input') {\n                    properties = [\n                        'value',\n                        'formula'\n                    ];\n                } else if (propertyName === 'border') {\n                    properties = [\n                        'borderLeft',\n                        'borderTop',\n                        'borderRight',\n                        'borderBottom'\n                    ];\n                } else {\n                    properties = [propertyName];\n                }\n                this.forEachCell(function (row, col, cell) {\n                    var cellState = state[row + ',' + col] = {};\n                    properties.forEach(function (property) {\n                        cellState[property] = cell[property] || null;\n                    });\n                });\n                return state;\n            },\n            setState: function (state) {\n                var sheet = this._sheet;\n                var origin = this._ref.first();\n                var rowDelta = state.ref.row - origin.row;\n                var colDelta = state.ref.col - origin.col;\n                sheet.batch(function () {\n                    if (state.mergedCells) {\n                        this.unmerge();\n                    }\n                    this.forEachCell(function (row, col) {\n                        var cellState = state[row + rowDelta + ',' + (col + colDelta)];\n                        var range = sheet.range(row, col);\n                        for (var property in cellState) {\n                            if (property != 'value') {\n                                range._set(property, cellState[property]);\n                            }\n                        }\n                        if (!cellState.formula) {\n                            range._set('value', cellState.value);\n                        }\n                    });\n                    if (state.mergedCells) {\n                        state.mergedCells.forEach(function (merged) {\n                            merged = sheet._ref(merged).relative(rowDelta, colDelta, 3);\n                            sheet.range(merged).merge();\n                        }, this);\n                    }\n                }.bind(this), { recalc: true });\n            },\n            forEachCell: function (callback) {\n                this._ref.forEach(function (ref) {\n                    this._sheet.forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n            hasValue: function () {\n                var result = false;\n                this.forEachCell(function (row, col, cell) {\n                    if (Object.keys(cell).length !== 0) {\n                        result = true;\n                    }\n                });\n                return result;\n            },\n            wrap: function (flag) {\n                if (flag === undefined) {\n                    return !!this._property('wrap');\n                }\n                this.forEachRow(function (range) {\n                    var maxHeight = range.sheet().rowHeight(range.topLeft().row);\n                    range.forEachCell(function (row, col, cell) {\n                        var width = this._sheet.columnWidth(col);\n                        if (cell.value !== null && cell.value !== undefined) {\n                            maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, cell.fontSize, true));\n                        }\n                    });\n                    range.sheet().rowHeight(range.topLeft().row, maxHeight);\n                }.bind(this));\n                this._property('wrap', flag);\n                return this;\n            },\n            fontSize: function (size) {\n                if (size === undefined) {\n                    return this._property('fontSize');\n                }\n                this.forEachRow(function (range) {\n                    var maxHeight = range.sheet().rowHeight(range.topLeft().row);\n                    range.forEachCell(function (row, col, cell) {\n                        var width = this._sheet.columnWidth(col);\n                        if (cell.value !== null && cell.value !== undefined) {\n                            maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, size, cell.wrap));\n                        }\n                    });\n                    range.sheet().rowHeight(range.topLeft().row, maxHeight);\n                }.bind(this));\n                this._property('fontSize', size);\n                return this;\n            },\n            draw: function (options, callback) {\n                this._sheet.draw(this, options, callback);\n            }\n        });\n        $.each(styles, function (i, property) {\n            Range.prototype[property] = function (value) {\n                return this._property(property, value);\n            };\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        function looksLikeANumber(str) {\n            return !/^=/.test(str) && /number|percent/.test(kendo.spreadsheet.calc.parse(null, 0, 0, str).type);\n        }\n        var measureBox = $('<div style=\"position: absolute !important; top: -4000px !important; height: auto !important;' + 'padding: 1px !important; margin: 0 !important; border: 1px solid black !important;' + 'line-height: normal !important; visibility: hidden !important;' + 'white-space: pre-wrap !important; word-break: break-all !important;\" />')[0];\n        function getTextHeight(text, width, fontSize, wrap) {\n            var styles = {\n                'baselineMarkerSize': 0,\n                'width': width + 'px',\n                'font-size': (fontSize || 12) + 'px',\n                'word-break': wrap === true ? 'break-all' : 'normal',\n                'white-space': wrap === true ? 'pre-wrap' : 'pre'\n            };\n            return kendo.util.measureText(text, styles, measureBox).height;\n        }\n        kendo.spreadsheet.util = { getTextHeight: getTextHeight };\n        kendo.spreadsheet.Range = Range;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime', ['spreadsheet/references'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = {};\n    var spreadsheet = kendo.spreadsheet;\n    spreadsheet.calc = calc;\n    var exports = calc.runtime = {};\n    var Class = kendo.Class;\n    var Ref = spreadsheet.Ref;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NULL = spreadsheet.NULLREF;\n    function CalcError(code) {\n        if (code instanceof CalcError) {\n            return code;\n        }\n        this.code = code;\n    }\n    CalcError.prototype.toString = function () {\n        return '#' + this.code + (this.code == 'NAME' ? '?' : '!');\n    };\n    var Context = Class.extend({\n        init: function Context(callback, formula, ss, parent) {\n            this.callback = callback;\n            this.formula = formula;\n            this.ss = ss;\n            this.parent = parent;\n        },\n        resolve: function (val) {\n            var self = this;\n            if (val instanceof Ref) {\n                self.resolveCells([val], function () {\n                    val = self.getRefData(val);\n                    if (Array.isArray(val)) {\n                        val = val[0];\n                    }\n                    self._resolve(val);\n                });\n            } else {\n                self._resolve(val);\n            }\n        },\n        _resolve: function (val) {\n            if (val === undefined) {\n                val = null;\n            }\n            var f = this.formula;\n            f.value = val;\n            if (this.ss.onFormula(f) && this.callback) {\n                this.callback.call(f, val);\n            }\n        },\n        resolveCells: function (a, f) {\n            var context = this, formulas = [];\n            (function loop(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var x = a[i];\n                    if (x instanceof Ref) {\n                        add(context.getRefCells(x));\n                    }\n                    if (Array.isArray(x)) {\n                        loop(x);\n                    }\n                }\n            }(a));\n            if (!formulas.length) {\n                return f.call(context);\n            }\n            for (var pending = formulas.length, i = 0; i < formulas.length; ++i) {\n                fetch(formulas[i]);\n            }\n            function fetch(cell) {\n                cell.formula.exec(context.ss, function () {\n                    if (!--pending) {\n                        f.call(context);\n                    }\n                }, context);\n            }\n            function add(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var cell = a[i];\n                    if (cell.formula) {\n                        formulas.push(cell);\n                    }\n                }\n                return true;\n            }\n        },\n        cellValues: function (a, f) {\n            var ret = [];\n            for (var i = 0; i < a.length; ++i) {\n                var val = a[i];\n                if (val instanceof Ref) {\n                    val = this.getRefData(val);\n                    ret = ret.concat(val);\n                } else if (Array.isArray(val)) {\n                    ret = ret.concat(this.cellValues(val));\n                } else if (val instanceof Matrix) {\n                    ret = ret.concat(this.cellValues(val.data));\n                } else {\n                    ret.push(val);\n                }\n            }\n            if (f) {\n                return f.apply(this, ret);\n            }\n            return ret;\n        },\n        force: function (val) {\n            if (val instanceof Ref) {\n                return this.getRefData(val);\n            }\n            return val;\n        },\n        func: function (fname, callback, args) {\n            fname = fname.toLowerCase();\n            var f = FUNCS[fname];\n            if (f) {\n                return f.call(this, callback, args);\n            }\n            callback(new CalcError('NAME'));\n        },\n        bool: function (val) {\n            if (val instanceof Ref) {\n                val = this.getRefData(val);\n            }\n            if (typeof val == 'string') {\n                return val.toLowerCase() == 'true';\n            }\n            if (typeof val == 'number') {\n                return val !== 0;\n            }\n            if (typeof val == 'boolean') {\n                return val;\n            }\n            return val != null;\n        },\n        asMatrix: function (range) {\n            if (range instanceof Matrix) {\n                return range;\n            }\n            var self = this;\n            if (range instanceof RangeRef) {\n                var tl = range.topLeft;\n                var top = tl.row, left = tl.col;\n                var cells = self.getRefCells(range);\n                var m = new Matrix(self);\n                if (isFinite(range.width())) {\n                    m.width = range.width();\n                }\n                if (isFinite(range.height())) {\n                    m.height = range.height();\n                }\n                if (!isFinite(top)) {\n                    top = 0;\n                }\n                if (!isFinite(left)) {\n                    left = 0;\n                }\n                cells.forEach(function (cell) {\n                    m.set(cell.row - top, cell.col - left, cell.value);\n                });\n                return m;\n            }\n            if (Array.isArray(range) && range.length > 0) {\n                var m = new Matrix(self), row = 0;\n                range.forEach(function (line) {\n                    var col = 0;\n                    var h = 1;\n                    line.forEach(function (el) {\n                        var isRange = el instanceof RangeRef;\n                        if (el instanceof Ref && !isRange) {\n                            el = self.getRefData(el);\n                        }\n                        if (isRange || Array.isArray(el)) {\n                            el = self.asMatrix(el);\n                        }\n                        if (el instanceof Matrix) {\n                            el.each(function (el, r, c) {\n                                m.set(row + r, col + c, el);\n                            });\n                            h = Math.max(h, el.height);\n                            col += el.width;\n                        } else {\n                            m.set(row, col++, el);\n                        }\n                    });\n                    row += h;\n                });\n                return m;\n            }\n        },\n        getRefCells: function (refs, hiddenInfo) {\n            return this.ss.getRefCells(refs, hiddenInfo);\n        },\n        getRefData: function (ref) {\n            return this.ss.getData(ref);\n        },\n        workbook: function () {\n            return this.ss.workbook;\n        }\n    });\n    var Matrix = Class.extend({\n        init: function Matrix(context) {\n            this.context = context;\n            this.height = 0;\n            this.width = 0;\n            this.data = [];\n        },\n        clone: function () {\n            var m = new Matrix(this.context);\n            m.height = this.height;\n            m.width = this.width;\n            m.data = this.data.map(function (row) {\n                return row.slice();\n            });\n            return m;\n        },\n        get: function (row, col) {\n            var line = this.data[row];\n            var val = line ? line[col] : null;\n            return val instanceof Ref ? this.context.getRefData(val) : val;\n        },\n        set: function (row, col, data) {\n            var line = this.data[row];\n            if (line == null) {\n                line = this.data[row] = [];\n            }\n            line[col] = data;\n            if (row >= this.height) {\n                this.height = row + 1;\n            }\n            if (col >= this.width) {\n                this.width = col + 1;\n            }\n        },\n        each: function (f, includeEmpty) {\n            for (var row = 0; row < this.height; ++row) {\n                for (var col = 0; col < this.width; ++col) {\n                    var val = this.get(row, col);\n                    if (includeEmpty || val != null) {\n                        val = f.call(this.context, val, row, col);\n                        if (val !== undefined) {\n                            return val;\n                        }\n                    }\n                }\n            }\n        },\n        map: function (f, includeEmpty) {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(row, col, f.call(this, el, row, col));\n            }, includeEmpty);\n            return m;\n        },\n        eachRow: function (f) {\n            for (var row = 0; row < this.height; ++row) {\n                var val = f.call(this.context, row);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        eachCol: function (f) {\n            for (var col = 0; col < this.width; ++col) {\n                var val = f.call(this.context, col);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        mapRow: function (f) {\n            var m = new Matrix(this.context);\n            this.eachRow(function (row) {\n                m.set(row, 0, f.call(this.context, row));\n            });\n            return m;\n        },\n        mapCol: function (f) {\n            var m = new Matrix(this.context);\n            this.eachCol(function (col) {\n                m.set(0, col, f.call(this.context, col));\n            });\n            return m;\n        },\n        toString: function () {\n            return JSON.stringify(this.data);\n        },\n        transpose: function () {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(col, row, el);\n            });\n            return m;\n        },\n        unit: function (n) {\n            this.width = this.height = n;\n            var a = this.data = new Array(n);\n            for (var i = n; --i >= 0;) {\n                var row = a[i] = new Array(n);\n                for (var j = n; --j >= 0;) {\n                    row[j] = i == j ? 1 : 0;\n                }\n            }\n            return this;\n        },\n        multiply: function (b) {\n            var a = this, m = new Matrix(a.context);\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < b.width; ++col) {\n                    var s = 0;\n                    for (var i = 0; i < a.width; ++i) {\n                        var va = a.get(row, i);\n                        var vb = b.get(i, col);\n                        if (typeof va != 'number' || typeof vb != 'number') {\n                            throw new CalcError('VALUE');\n                        }\n                        s += va * vb;\n                    }\n                    m.set(row, col, s);\n                }\n            }\n            return m;\n        },\n        adds: function (b, s) {\n            var a = this, m = new Matrix(a.context);\n            var sign = s ? -1 : 1;\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < a.width; ++col) {\n                    var x = a.get(row, col), y = b.get(row, col);\n                    m.set(row, col, x + sign * y);\n                }\n            }\n            return m;\n        },\n        determinant: function () {\n            var a = this.clone().data;\n            var n = a.length;\n            var d = 1, C, L, i, k;\n            for (C = 0; C < n; C++) {\n                for (L = C; L < n && !a[L][C]; L++) {\n                }\n                if (L == n) {\n                    return 0;\n                }\n                if (L != C) {\n                    d = -d;\n                    for (k = C; k < n; k++) {\n                        var t = a[C][k];\n                        a[C][k] = a[L][k];\n                        a[L][k] = t;\n                    }\n                }\n                for (i = C + 1; i < n; i++) {\n                    for (k = C + 1; k < n; k++) {\n                        a[i][k] -= a[C][k] * a[i][C] / a[C][C];\n                    }\n                }\n                d *= a[C][C];\n            }\n            return d;\n        },\n        inverse: function () {\n            var n = this.width;\n            var m = this.augment(new Matrix(this.context).unit(n));\n            var a = m.data;\n            var tmp;\n            for (var k = 0; k < n; ++k) {\n                var imax = argmax(k, n, function (i) {\n                    return a[i][k];\n                });\n                if (!a[imax][k]) {\n                    return null;\n                }\n                if (k != imax) {\n                    tmp = a[k];\n                    a[k] = a[imax];\n                    a[imax] = tmp;\n                }\n                for (var i = k + 1; i < n; ++i) {\n                    for (var j = k + 1; j < 2 * n; ++j) {\n                        a[i][j] -= a[k][j] * a[i][k] / a[k][k];\n                    }\n                    a[i][k] = 0;\n                }\n            }\n            for (var i = 0; i < n; ++i) {\n                for (var f = a[i][i], j = 0; j < 2 * n; ++j) {\n                    a[i][j] /= f;\n                }\n            }\n            for (var k = n; --k >= 0;) {\n                for (var i = k; --i >= 0;) {\n                    if (a[i][k]) {\n                        for (var j = 2 * n; --j >= n;) {\n                            a[i][j] -= a[k][j] * a[i][k];\n                        }\n                    }\n                }\n            }\n            return m.slice(0, n, n, n);\n        },\n        augment: function (m) {\n            var ret = this.clone(), n = ret.width;\n            m.each(function (val, row, col) {\n                ret.set(row, col + n, val);\n            });\n            return ret;\n        },\n        slice: function (row, col, height, width) {\n            var m = new Matrix(this.context);\n            for (var i = 0; i < height; ++i) {\n                for (var j = 0; j < width; ++j) {\n                    m.set(i, j, this.get(row + i, col + j));\n                }\n            }\n            return m;\n        }\n    });\n    function argmax(i, end, f) {\n        var max = f(i), pos = i;\n        while (++i < end) {\n            var v = f(i);\n            if (v > max) {\n                max = v;\n                pos = i;\n            }\n        }\n        return pos;\n    }\n    var Formula = Class.extend({\n        init: function Formula(refs, handler, printer, sheet, row, col) {\n            this.refs = refs;\n            this.handler = handler;\n            this.print = printer;\n            this.absrefs = null;\n            this.sheet = sheet;\n            this.row = row;\n            this.col = col;\n            this.onReady = [];\n            this.pending = false;\n        },\n        clone: function (sheet, row, col) {\n            var lcsheet = sheet.toLowerCase();\n            var refs = this.refs;\n            if (lcsheet != this.sheet.toLowerCase()) {\n                refs = refs.map(function (ref) {\n                    if (!ref.hasSheet() && ref.sheet.toLowerCase() != lcsheet) {\n                        ref = ref.clone().setSheet(sheet);\n                    }\n                    return ref;\n                });\n            }\n            return new Formula(refs, this.handler, this.print, sheet, row, col);\n        },\n        resolve: function (val) {\n            this.pending = false;\n            this.onReady.forEach(function (callback) {\n                callback(val);\n            });\n        },\n        exec: function (ss, callback, parentContext) {\n            if ('value' in this) {\n                if (callback) {\n                    callback(this.value);\n                }\n            } else {\n                if (callback) {\n                    this.onReady.push(callback);\n                }\n                var ctx = new Context(this.resolve, this, ss, parentContext);\n                while (parentContext) {\n                    if (parentContext.formula === this) {\n                        this.pending = false;\n                        ctx.resolve(new CalcError('CIRCULAR'));\n                        return;\n                    }\n                    parentContext = parentContext.parent;\n                }\n                if (this.pending) {\n                    return;\n                }\n                this.pending = true;\n                if (!this.absrefs) {\n                    this.absrefs = this.refs.map(function (ref) {\n                        return ref.absolute(this.row, this.col);\n                    }, this);\n                }\n                this.handler.call(ctx);\n            }\n        },\n        reset: function () {\n            this.onReady = [];\n            this.pending = false;\n            delete this.value;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            oldSheetName = oldSheetName.toLowerCase();\n            this.absrefs = null;\n            if (this.sheet.toLowerCase() == oldSheetName) {\n                this.sheet = newSheetName;\n            }\n            this.refs.forEach(function (ref) {\n                if (ref.sheet.toLowerCase() == oldSheetName) {\n                    ref.sheet = newSheetName;\n                }\n            });\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            affectedSheet = affectedSheet.toLowerCase();\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            var formulaSheet = this.sheet.toLowerCase();\n            var formulaMoves = false;\n            if (formulaSheet == affectedSheet) {\n                if (operation == 'row' && formulaRow >= start) {\n                    this.row += delta;\n                    formulaMoves = true;\n                }\n                if (operation == 'col' && formulaCol >= start) {\n                    this.col += delta;\n                    formulaMoves = true;\n                }\n            }\n            var newFormulaRow = this.row;\n            var newFormulaCol = this.col;\n            this.absrefs = null;\n            this.refs = this.refs.map(function (ref) {\n                if (ref === NULL) {\n                    return ref;\n                }\n                if (ref.sheet.toLowerCase() != affectedSheet) {\n                    if (formulaMoves) {\n                        if (operation == 'row' && formulaRow >= start) {\n                            ref = ref.relative(delta, 0);\n                        }\n                        if (operation == 'col' && formulaCol >= start) {\n                            ref = ref.relative(0, delta);\n                        }\n                    }\n                    return ref;\n                }\n                return ref.adjust(formulaRow, formulaCol, newFormulaRow, newFormulaCol, operation == 'row', start, delta);\n            }, this);\n        },\n        toString: function () {\n            return this.print(this.row, this.col);\n        }\n    });\n    var FUNCS = Object.create(null);\n    FUNCS['if'] = function (callback, args) {\n        var self = this;\n        var co = args[0], th = args[1], el = args[2];\n        this.resolveCells([co], function () {\n            var comatrix = self.asMatrix(co);\n            if (comatrix) {\n                th(function (th) {\n                    el(function (el) {\n                        var thmatrix = self.asMatrix(th);\n                        var elmatrix = self.asMatrix(el);\n                        callback(comatrix.map(function (val, row, col) {\n                            if (self.bool(val)) {\n                                return thmatrix ? thmatrix.get(row, col) : th;\n                            } else {\n                                return elmatrix ? elmatrix.get(row, col) : el;\n                            }\n                        }));\n                    });\n                });\n            } else {\n                if (self.bool(co)) {\n                    th(callback);\n                } else {\n                    el(callback);\n                }\n            }\n        });\n    };\n    FUNCS[''] = function (callback) {\n        callback((1 + Math.sqrt(5)) / 2);\n    };\n    function compileArgumentChecks(functionName, args) {\n        var arrayArgs = 'function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; ';\n        var resolve = 'function resolve(args, callback) { var toResolve = [], i = 0; ';\n        var name, forced, main = '\\'use strict\\'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = \\'VALUE\\'; ', haveForced = false;\n        var canBeArrayArg = false, hasArrayArgs = false;\n        main += args.map(comp).join('');\n        main += 'if (i < args.length) return new CalcError(\\'N/A\\'); ';\n        main += 'return xargs; } ';\n        arrayArgs += 'return { args: xargs, width: width, height: height, arrays: arrays }; } ';\n        var f;\n        if (haveForced) {\n            resolve += 'this.resolveCells(toResolve, callback); } ';\n            f = new Function('CalcError', main + resolve + arrayArgs + ' return { resolve: resolve, check: check, arrayArgs: arrayArgs };');\n        } else {\n            f = new Function('CalcError', main + ' return { check: check };');\n        }\n        f = f(CalcError);\n        if (!hasArrayArgs) {\n            delete f.arrayArgs;\n        }\n        return f;\n        function comp(x) {\n            name = x[0];\n            var code = '{ ';\n            if (Array.isArray(name)) {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'while (i < args.length) { ';\n                code += x.map(comp).join('');\n                code += '} ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '+') {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'do { ';\n                code += x.slice(1).map(comp).join('');\n                code += '} while (i < args.length); ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '?') {\n                code += 'if (!(' + cond(x[1]) + ')) return new CalcError(err); ';\n            } else {\n                var type = x[1];\n                if (Array.isArray(type) && /^#?collect/.test(type[0])) {\n                    var n = type[2];\n                    force();\n                    code += 'try {' + 'var $' + name + ' = this.cellValues(args.slice(i';\n                    if (n) {\n                        code += ', i + ' + n;\n                    }\n                    code += ')).filter(function($' + name + '){ ';\n                    if (type[0] == 'collect') {\n                        code += 'if ($' + name + ' instanceof CalcError) throw $' + name + '; ';\n                    }\n                    code += 'return ' + cond(type[1]) + '; }, this); ';\n                    if (n) {\n                        code += 'i += ' + n + '; ';\n                    } else {\n                        code += 'i = args.length; ';\n                    }\n                    code += 'xargs.push($' + name + ')' + '} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } ';\n                    resolve += 'toResolve.push(args.slice(i)); ';\n                } else if (type == 'rest') {\n                    code += 'xargs.push(args.slice(i)); i = args.length; ';\n                } else {\n                    if (canBeArrayArg = /^\\*/.test(name)) {\n                        hasArrayArgs = true;\n                        name = name.substr(1);\n                    }\n                    code += 'var $' + name + ' = args[i++]; ';\n                    var allowError = false;\n                    if (/!$/.test(type)) {\n                        type = type.substr(0, type.length - 1);\n                        allowError = true;\n                    } else {\n                        code += 'if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n                    }\n                    code += typeCheck(type, allowError) + 'xargs.push($' + name + '); ';\n                }\n            }\n            code += '} ';\n            return code;\n        }\n        function force() {\n            if (forced) {\n                return '$' + name + '';\n            }\n            haveForced = true;\n            forced = true;\n            resolve += 'toResolve.push(args[i++]); ';\n            return '($' + name + ' = this.force($' + name + '))';\n        }\n        function typeCheck(type, allowError) {\n            forced = false;\n            var ret = 'if (!(' + cond(type) + ')) { ';\n            if (forced && !allowError) {\n                ret += ' if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n            }\n            ret += 'return new CalcError(err); } ';\n            if (!forced) {\n                resolve += 'i++; ';\n            }\n            if (canBeArrayArg) {\n                arrayArgs += 'var $' + name + ' = this.asMatrix(args[i]); ' + 'if ($' + name + ') { ' + 'xargs.push($' + name + '); ' + 'width = Math.max(width, $' + name + '.width); ' + 'height = Math.max(height, $' + name + '.height); ' + 'arrays.push(true) } else { ' + 'xargs.push(args[i]); ' + 'arrays.push(false); } i++; ';\n            } else {\n                arrayArgs += 'xargs.push(args[i++]); arrays.push(false); ';\n            }\n            return ret;\n        }\n        function cond(type) {\n            if (Array.isArray(type)) {\n                if (type[0] == 'or') {\n                    return '(' + type.slice(1).map(cond).join(') || (') + ')';\n                }\n                if (type[0] == 'and') {\n                    return '(' + type.slice(1).map(cond).join(') && (') + ')';\n                }\n                if (type[0] == 'values') {\n                    return '(' + type.slice(1).map(function (val) {\n                        return force() + ' === ' + val;\n                    }).join(') || (') + ')';\n                }\n                if (type[0] == 'null') {\n                    return '(' + cond('null') + ' ? (($' + name + ' = ' + type[1] + '), true) : false)';\n                }\n                if (type[0] == 'between' || type[0] == '[between]') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between)') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between]') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '[between)') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == 'assert') {\n                    var err = type[2] || 'N/A';\n                    return '((' + type[1] + ') ? true : (err = ' + JSON.stringify(err) + ', false))';\n                }\n                if (type[0] == 'not') {\n                    return '!(' + cond(type[1]) + ')';\n                }\n                throw new Error('Unknown array type condition: ' + type[0]);\n            }\n            if (type == 'number') {\n                return '(typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\')';\n            }\n            if (type == 'integer') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') ? ($' + name + ' |= 0, true) : false)';\n            }\n            if (type == 'date') {\n                return '((typeof ' + force() + ' == \\'number\\') ? ($' + name + ' |= 0, true) : false)';\n            }\n            if (type == 'datetime') {\n                return '(typeof ' + force() + ' == \\'number\\')';\n            }\n            if (type == 'divisor') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') && ' + '($' + name + ' == 0 ? ((err = \\'DIV/0\\'), false) : true))';\n            }\n            if (type == 'number+') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') && ($' + name + ' >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer+') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') && (($' + name + ' |= 0) >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'number++') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') && ($' + name + ' > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer++') {\n                return '((typeof ' + force() + ' == \\'number\\' || typeof $' + name + ' == \\'boolean\\') && (($' + name + ' |= 0 ) > 0) ? true : ((err = \\'NUM\\'), false))';\n            }\n            if (type == 'string') {\n                return '(typeof ' + force() + ' == \\'string\\')';\n            }\n            if (type == 'boolean') {\n                return '(typeof ' + force() + ' == \\'boolean\\')';\n            }\n            if (type == 'logical') {\n                return '(typeof ' + force() + ' == \\'boolean\\' || (typeof $' + name + ' == \\'number\\' ? ($' + name + ' = !!$' + name + ', true) : false))';\n            }\n            if (type == 'matrix') {\n                force();\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == '#matrix') {\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == 'ref') {\n                return '($' + name + ' instanceof kendo.spreadsheet.Ref)';\n            }\n            if (type == 'area') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef || $' + name + ' instanceof kendo.spreadsheet.RangeRef)';\n            }\n            if (type == 'cell') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef)';\n            }\n            if (type == 'null') {\n                return '(' + force() + ' == null)';\n            }\n            if (type == 'anyvalue') {\n                return '(' + force() + ' != null && i <= args.length)';\n            }\n            if (type == 'forced') {\n                return '(' + force() + ', i <= args.length)';\n            }\n            if (type == 'anything') {\n                return '(i <= args.length)';\n            }\n            if (type == 'blank') {\n                return '(' + force() + ' == null || $' + name + ' === \\'\\')';\n            }\n            throw new Error('Can\\'t check for type: ' + type);\n        }\n    }\n    function withErrorHandling(obj, f, args) {\n        if (args instanceof CalcError) {\n            return args;\n        }\n        try {\n            return f.apply(obj, args);\n        } catch (ex) {\n            if (ex instanceof CalcError) {\n                return ex;\n            } else {\n                throw ex;\n            }\n        }\n    }\n    function makeSyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        for (var row = 0; row < x.height; ++row) {\n                            for (var col = 0; col < x.width; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        xargs[i] = args[i].get(row, col);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                result.set(row, col, withErrorHandling(this, handler, xargs));\n                            }\n                        }\n                        return callback(result);\n                    }\n                }\n                var xargs = check.call(this, args);\n                callback(withErrorHandling(this, handler, xargs));\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function makeAsyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        var count = x.width * x.height;\n                        var makeCallback = function (row, col) {\n                            return function (value) {\n                                result.set(row, col, value);\n                                --count;\n                                if (count === 0) {\n                                    return callback(result);\n                                }\n                            };\n                        };\n                        for (var row = 0; row < x.height && count > 0; ++row) {\n                            for (var col = 0; col < x.width && count > 0; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        xargs[i] = args[i].get(row, col);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                if (xargs instanceof CalcError) {\n                                    result.set(row, col, xargs);\n                                    --count;\n                                    if (count === 0) {\n                                        return callback(result);\n                                    }\n                                } else {\n                                    xargs.unshift(makeCallback(row, col));\n                                    handler.apply(this, xargs);\n                                }\n                            }\n                        }\n                        return;\n                    }\n                }\n                var x = check.call(this, args);\n                if (x instanceof CalcError) {\n                    callback(x);\n                } else {\n                    x.unshift(callback);\n                    handler.apply(this, x);\n                }\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function defineFunction(name, func) {\n        name = name.toLowerCase();\n        FUNCS[name] = func;\n        return {\n            args: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeSyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            },\n            argsAsync: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeAsyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            }\n        };\n    }\n    function dateToJulianDays(y, m, d) {\n        m++;\n        return (1461 * (y + 4800 + ((m - 14) / 12 | 0)) / 4 | 0) + (367 * (m - 2 - 12 * ((m - 14) / 12 | 0)) / 12 | 0) - (3 * ((y + 4900 + ((m - 14) / 12 | 0)) / 100 | 0) / 4 | 0) + d - 32075;\n    }\n    function julianDaysToDate(jd) {\n        var l, n, j, i, m, d, y;\n        l = jd + 68569;\n        n = 4 * l / 146097 | 0;\n        l = l - ((146097 * n + 3) / 4 | 0);\n        i = 4000 * (l + 1) / 1461001 | 0;\n        l = l - (1461 * i / 4 | 0) + 31;\n        j = 80 * l / 2447 | 0;\n        d = l - (2447 * j / 80 | 0);\n        l = j / 11 | 0;\n        m = j + 2 - 12 * l;\n        y = 100 * (n - 49) + i + l;\n        m--;\n        return {\n            year: y,\n            month: m,\n            date: d,\n            day: (jd + 1) % 7,\n            ord: ORDINAL_ADD_DAYS[isLeapYear(y)][m] + d\n        };\n    }\n    var BASE_DATE = dateToJulianDays(1900, 0, -1);\n    var DAYS_IN_MONTH = [\n        31,\n        28,\n        31,\n        30,\n        31,\n        30,\n        31,\n        31,\n        30,\n        31,\n        30,\n        31\n    ];\n    var ORDINAL_ADD_DAYS = [\n        [\n            0,\n            31,\n            59,\n            90,\n            120,\n            151,\n            181,\n            212,\n            243,\n            273,\n            304,\n            334\n        ],\n        [\n            0,\n            31,\n            60,\n            91,\n            121,\n            152,\n            182,\n            213,\n            244,\n            274,\n            305,\n            335\n        ]\n    ];\n    function isLeapYear(yr) {\n        if (yr % 4) {\n            return 0;\n        }\n        if (yr % 100) {\n            return 1;\n        }\n        if (yr % 400) {\n            return 0;\n        }\n        return 1;\n    }\n    function daysInYear(yr) {\n        return isLeapYear(yr) ? 366 : 365;\n    }\n    function daysInMonth(yr, mo) {\n        return isLeapYear(yr) && mo == 1 ? 29 : DAYS_IN_MONTH[mo];\n    }\n    function unpackDate(serial) {\n        return julianDaysToDate((serial | 0) + BASE_DATE);\n    }\n    function packDate(year, month, date) {\n        return dateToJulianDays(year, month, date) - BASE_DATE;\n    }\n    var MS_IN_MIN = 60 * 1000;\n    var MS_IN_HOUR = 60 * MS_IN_MIN;\n    var MS_IN_DAY = 24 * MS_IN_HOUR;\n    function unpackTime(serial) {\n        var frac = serial - (serial | 0);\n        if (frac < 0) {\n            frac++;\n        }\n        var ms = Math.round(MS_IN_DAY * frac);\n        var hours = Math.floor(ms / MS_IN_HOUR);\n        ms -= hours * MS_IN_HOUR;\n        var minutes = Math.floor(ms / MS_IN_MIN);\n        ms -= minutes * MS_IN_MIN;\n        var seconds = Math.floor(ms / 1000);\n        ms -= seconds * 1000;\n        return {\n            hours: hours,\n            minutes: minutes,\n            seconds: seconds,\n            milliseconds: ms\n        };\n    }\n    function serialToDate(serial) {\n        var d = unpackDate(serial), t = unpackTime(serial);\n        return new Date(d.year, d.month, d.date, t.hours, t.minutes, t.seconds, t.milliseconds);\n    }\n    function packTime(hours, minutes, seconds, ms) {\n        return (hours + minutes / 60 + seconds / 3600 + ms / 3600000) / 24;\n    }\n    function dateToSerial(date) {\n        var time = packTime(date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());\n        date = packDate(date.getFullYear(), date.getMonth(), date.getDate());\n        if (date < 0) {\n            return date - 1 + time;\n        } else {\n            return date + time;\n        }\n    }\n    function parseDate(str) {\n        return kendo.parseDate(str, [\n            'MM/dd/yyyy',\n            'MM-dd-yyyy',\n            'MM/dd/yy',\n            'MM-dd-yy',\n            'MMMM dd yyyy',\n            'MMMM dd yy',\n            'MMM dd yyyy',\n            'MMM dd yy',\n            'dd MMMM yyyy',\n            'dd MMMM yy',\n            'dd MMM yyyy',\n            'dd MMM yy',\n            'MMMM dd, yyyy',\n            'MMMM dd, yy',\n            'MMM dd, yyyy',\n            'MMM dd, yy',\n            'MMMM dd',\n            'MMM dd',\n            'MMMM yyyy',\n            'MMM yyyy',\n            'dd MMMM',\n            'dd MMM',\n            'MM-dd',\n            'MM/dd'\n        ]) || kendo.parseDate(str);\n    }\n    exports.CalcError = CalcError;\n    exports.Formula = Formula;\n    exports.Matrix = Matrix;\n    exports.packDate = packDate;\n    exports.unpackDate = unpackDate;\n    exports.packTime = packTime;\n    exports.unpackTime = unpackTime;\n    exports.serialToDate = serialToDate;\n    exports.dateToSerial = dateToSerial;\n    exports.daysInMonth = daysInMonth;\n    exports.isLeapYear = isLeapYear;\n    exports.daysInYear = daysInYear;\n    exports.parseDate = parseDate;\n    spreadsheet.dateToNumber = dateToSerial;\n    spreadsheet.numberToDate = serialToDate;\n    spreadsheet.defineFunction = defineFunction;\n    spreadsheet.CalcError = CalcError;\n    exports.defineFunction = defineFunction;\n    exports.defineAlias = function (alias, name) {\n        var orig = FUNCS[name];\n        if (!orig) {\n            throw new Error('Function ' + name + ' is not yet defined');\n        }\n        if (!orig.kendoSpreadsheetAliases) {\n            orig.kendoSpreadsheetAliases = [name];\n        }\n        orig.kendoSpreadsheetAliases.push(alias);\n        FUNCS[alias] = orig;\n    };\n    exports.FUNCS = FUNCS;\n    var ARGS_NUMERIC = [\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'number'\n        ]\n    ];\n    var ARGS_ANYVALUE = [\n        [\n            '*a',\n            'anyvalue'\n        ],\n        [\n            '*b',\n            'anyvalue'\n        ]\n    ];\n    defineFunction('binary+', function (a, b) {\n        return a + b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary-', function (a, b) {\n        return a - b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary*', function (a, b) {\n        return a * b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary/', function (a, b) {\n        return a / b;\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('binary^', function (a, b) {\n        return Math.pow(a, b);\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary&', function (a, b) {\n        if (a == null) {\n            a = '';\n        }\n        if (b == null) {\n            b = '';\n        }\n        return '' + a + b;\n    }).args([\n        [\n            '*a',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('binary=', function (a, b) {\n        return a === b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<>', function (a, b) {\n        return a !== b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<', binaryCompare(function (a, b) {\n        return a < b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary<=', binaryCompare(function (a, b) {\n        return a <= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>', binaryCompare(function (a, b) {\n        return a > b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>=', binaryCompare(function (a, b) {\n        return a >= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('unary+', function (a) {\n        return a;\n    }).args([[\n            '*a',\n            'number'\n        ]]);\n    defineFunction('unary-', function (a) {\n        return -a;\n    }).args([[\n            '*a',\n            'number'\n        ]]);\n    defineFunction('unary%', function (a) {\n        return a / 100;\n    }).args([[\n            '*a',\n            'number'\n        ]]);\n    defineFunction('binary:', function (a, b) {\n        return new RangeRef(a, b).setSheet(a.sheet || this.formula.sheet, a.hasSheet());\n    }).args([\n        [\n            'a',\n            'cell'\n        ],\n        [\n            'b',\n            'cell'\n        ]\n    ]);\n    defineFunction('binary,', function (a, b) {\n        return new UnionRef([\n            a,\n            b\n        ]);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('binary ', function (a, b) {\n        return a.intersect(b);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('not', function (a) {\n        return !this.bool(a);\n    }).args([[\n            '*a',\n            'anyvalue'\n        ]]);\n    defineFunction('isblank', function (val) {\n        if (val instanceof CellRef) {\n            val = this.getRefData(val);\n            return val == null;\n        }\n        return false;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    defineFunction('iserror', function (val) {\n        return val instanceof CalcError;\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('iserr', function (val) {\n        return val instanceof CalcError && val.code != 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isna', function (val) {\n        return val instanceof CalcError && val.code == 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('islogical', function (val) {\n        return typeof val == 'boolean';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnontext', function (val) {\n        return typeof val != 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('istext', function (val) {\n        return typeof val == 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnumber', function (val) {\n        return typeof val == 'number';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isref', function (val) {\n        return val instanceof CellRef || val instanceof RangeRef;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    function binaryCompare(func) {\n        return function (left, right) {\n            if (typeof left == 'string' && typeof right != 'string') {\n                right = right == null ? '' : right + '';\n            }\n            if (typeof left != 'string' && typeof right == 'string') {\n                left = left == null ? '' : left + '';\n            }\n            if (typeof left == 'number' && right == null) {\n                right = 0;\n            }\n            if (typeof right == 'number' && left == null) {\n                left = 0;\n            }\n            if (typeof left == 'string' && typeof right == 'string') {\n                left = left.toLowerCase();\n                right = right.toLowerCase();\n            }\n            if (typeof right == typeof left) {\n                return func(left, right);\n            } else {\n                return new CalcError('VALUE');\n            }\n        };\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/validation', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var exports = {};\n    spreadsheet.validation = exports;\n    var calc = spreadsheet.calc;\n    var Class = kendo.Class;\n    var TRANSPOSE_FORMAT = '_matrix({0})';\n    var DATE_FORMAT = 'DATEVALUE(\"{0}\")';\n    calc.runtime.defineFunction('_matrix', function (m) {\n        return m;\n    }).args([[\n            'm',\n            'matrix'\n        ]]);\n    function compileValidation(sheet, row, col, validation) {\n        var validationHandler;\n        var comparer;\n        var parsedFromDate;\n        var parsedToDate;\n        if (typeof validation === 'string') {\n            validation = JSON.parse(validation);\n        }\n        if (validation.from) {\n            if (validation.dataType === 'list') {\n                validation.from = kendo.format(TRANSPOSE_FORMAT, validation.from);\n            }\n            if (validation.dataType === 'date') {\n                parsedFromDate = calc.runtime.parseDate(validation.from);\n                if (parsedFromDate) {\n                    validation.from = kendo.format(DATE_FORMAT, validation.from);\n                    validation.fromIsDateValue = true;\n                }\n            }\n            validation.from = calc.compile(calc.parseFormula(sheet, row, col, validation.from));\n        }\n        if (validation.to) {\n            if (validation.dataType === 'date') {\n                parsedToDate = calc.runtime.parseDate(validation.to);\n                if (parsedToDate) {\n                    validation.to = kendo.format(DATE_FORMAT, validation.to);\n                    validation.toIsDateValue = true;\n                }\n            }\n            validation.to = calc.compile(calc.parseFormula(sheet, row, col, validation.to));\n        }\n        if (validation.dataType == 'custom') {\n            comparer = exports.validationComparers.custom;\n        } else if (validation.dataType == 'list') {\n            comparer = exports.validationComparers.list;\n        } else {\n            comparer = exports.validationComparers[validation.comparerType];\n        }\n        if (!comparer) {\n            throw kendo.format('\\'{0}\\' comparer is not implemented.', validation.comparerType);\n        }\n        validationHandler = function (valueToCompare) {\n            var toValue = this.to && this.to.value ? this.to.value : undefined;\n            if (valueToCompare === null || valueToCompare === '') {\n                if (this.allowNulls) {\n                    this.value = true;\n                } else {\n                    this.value = false;\n                }\n            } else if (this.dataType == 'custom') {\n                this.value = comparer(valueToCompare, this.from.value, toValue);\n            } else if (this.dataType == 'list') {\n                var data = this._getListData();\n                this.value = comparer(valueToCompare, data, toValue);\n            } else {\n                this.value = comparer(valueToCompare, this.from.value, toValue);\n            }\n            return this.value;\n        };\n        return new kendo.spreadsheet.validation.Validation($.extend(validation, {\n            handler: validationHandler,\n            sheet: sheet,\n            row: row,\n            col: col\n        }));\n    }\n    var Validation = Class.extend({\n        init: function Validation(options) {\n            this.handler = options.handler;\n            this.from = options.from;\n            this.to = options.to;\n            this.dataType = options.dataType;\n            this.comparerType = options.comparerType;\n            this.type = options.type ? options.type : 'warning';\n            this.allowNulls = options.allowNulls ? true : false;\n            this.fromIsDateValue = options.fromIsDateValue ? true : false;\n            this.toIsDateValue = options.toIsDateValue ? true : false;\n            this.sheet = options.sheet;\n            this.row = options.row;\n            this.col = options.col;\n            if (options.tooltipMessageTemplate) {\n                this.tooltipMessageTemplate = options.tooltipMessageTemplate;\n            }\n            if (options.tooltipTitleTemplate) {\n                this.tooltipTitleTemplate = options.tooltipTitleTemplate;\n            }\n            if (options.messageTemplate) {\n                this.messageTemplate = options.messageTemplate;\n            }\n            if (options.titleTemplate) {\n                this.titleTemplate = options.titleTemplate;\n            }\n        },\n        _formatMessages: function (format) {\n            var from = this.from ? this.from.value : '';\n            var to = this.to ? this.to.value : '';\n            var fromFormula = this.from ? this.from.toString() : '';\n            var toFormula = this.to ? this.to.toString() : '';\n            var dataType = this.dataType;\n            var type = this.type;\n            var comparerType = this.comparerType;\n            return kendo.format(format, from, to, fromFormula, toFormula, dataType, type, comparerType);\n        },\n        _setMessages: function () {\n            this.title = '';\n            this.message = '';\n            if (this.tooltipTitleTemplate) {\n                this.tooltipTitle = this._formatMessages(this.tooltipTitleTemplate);\n            }\n            if (this.tooltipMessageTemplate) {\n                this.tooltipMessage = this._formatMessages(this.tooltipMessageTemplate);\n            }\n            if (this.titleTemplate) {\n                this.title = this._formatMessages(this.titleTemplate);\n            }\n            if (this.messageTemplate) {\n                this.message = this._formatMessages(this.messageTemplate);\n            }\n        },\n        _getListData: function () {\n            if (!this.from.value || !this.from.value.data) {\n                return [];\n            }\n            var cube = this.from.value.data;\n            var i;\n            var y;\n            var data = [];\n            for (i = 0; i < cube.length; i++) {\n                var array = cube[i];\n                if (array) {\n                    for (y = 0; y < array.length; y++) {\n                        data.push(array[y]);\n                    }\n                }\n            }\n            return data;\n        },\n        clone: function (sheet, row, col) {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.clone(sheet, row, col);\n            }\n            if (options.to) {\n                options.to = options.to.clone(sheet, row, col);\n            }\n            return new Validation($.extend(options, { handler: this.handler }, {\n                sheet: sheet,\n                row: row,\n                col: col\n            }));\n        },\n        exec: function (ss, compareValue, compareFormat, callback) {\n            var self = this;\n            var calculateFromCallBack = function () {\n                self.value = self.handler.call(self, compareValue, compareFormat);\n                self._setMessages();\n                if (callback) {\n                    callback(self.value);\n                }\n            };\n            if (self.to) {\n                self.to.exec(ss, function () {\n                    self.from.exec(ss, calculateFromCallBack);\n                });\n            } else {\n                self.from.exec(ss, calculateFromCallBack);\n            }\n        },\n        reset: function () {\n            if (this.from) {\n                this.from.reset();\n            }\n            if (this.to) {\n                this.to.reset();\n            }\n            delete this.value;\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            if (this.from) {\n                this.from.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.to) {\n                this.to.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.sheet.toLowerCase() == affectedSheet.toLowerCase()) {\n                var formulaRow = this.row;\n                var formulaCol = this.col;\n                switch (operation) {\n                case 'row':\n                    if (formulaRow >= start) {\n                        this.row += delta;\n                    }\n                    break;\n                case 'col':\n                    if (formulaCol >= start) {\n                        this.col += delta;\n                    }\n                    break;\n                }\n            }\n        },\n        toJSON: function () {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.toString();\n                if (options.dataType === 'list') {\n                    options.from = options.from.replace(/^_matrix\\((.*)\\)$/i, '$1');\n                }\n                if (options.dataType === 'date') {\n                    if (this.fromIsDateValue) {\n                        options.from = options.from.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                    }\n                }\n            }\n            if (options.to) {\n                options.to = options.to.toString();\n                if (options.dataType === 'date') {\n                    if (this.toIsDateValue) {\n                        options.to = options.to.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                    }\n                }\n            }\n            return options;\n        },\n        _getOptions: function () {\n            return {\n                from: this.from,\n                to: this.to,\n                dataType: this.dataType,\n                type: this.type,\n                comparerType: this.comparerType,\n                row: this.row,\n                col: this.col,\n                sheet: this.sheet,\n                allowNulls: this.allowNulls,\n                tooltipMessageTemplate: this.tooltipMessageTemplate,\n                tooltipTitleTemplate: this.tooltipTitleTemplate,\n                messageTemplate: this.messageTemplate,\n                titleTemplate: this.titleTemplate\n            };\n        }\n    });\n    exports.compile = compileValidation;\n    exports.validationComparers = {\n        greaterThan: function (valueToCompare, from) {\n            return valueToCompare > from;\n        },\n        lessThan: function (valueToCompare, from) {\n            return valueToCompare < from;\n        },\n        between: function (valueToCompare, from, to) {\n            return valueToCompare > from && valueToCompare < to;\n        },\n        equalTo: function (valueToCompare, from) {\n            return valueToCompare == from;\n        },\n        notEqualTo: function (valueToCompare, from) {\n            return valueToCompare != from;\n        },\n        greaterThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare >= from;\n        },\n        lessThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare <= from;\n        },\n        notBetween: function (valueToCompare, from, to) {\n            return valueToCompare < from || valueToCompare > to;\n        },\n        custom: function (valueToCompare, from) {\n            return from;\n        },\n        list: function (valueToCompare, data) {\n            return data.indexOf(valueToCompare) > -1;\n        }\n    };\n    exports.Validation = Validation;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheet', [\n        'kendo.core',\n        'kendo.color',\n        'spreadsheet/runtime',\n        'spreadsheet/validation',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Range = kendo.spreadsheet.Range;\n        var Color = kendo.Color;\n        var Selection = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.selection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalSelection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this._activeCell = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalActiveCell = kendo.spreadsheet.FIRSTREF;\n            },\n            currentSelectionRange: function () {\n                return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentOriginalNavigationRange: function () {\n                return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentNavigationRange: function () {\n                if (this.singleCellSelection()) {\n                    return this._sheet._sheetRef;\n                } else {\n                    return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n                }\n            },\n            nextNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            previousNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            activeCell: function (ref) {\n                if (ref) {\n                    this.originalActiveCell = ref;\n                    this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n                    this._sheet.focus(ref);\n                    this._sheet.triggerChange({\n                        activeCell: true,\n                        selection: true\n                    });\n                }\n                return this._activeCell;\n            },\n            select: function (ref, expanded, changeActiveCell) {\n                if (ref) {\n                    if (ref.eq(this.originalSelection)) {\n                        return;\n                    }\n                    this.originalSelection = ref;\n                    this.selection = expanded;\n                    if (changeActiveCell !== false) {\n                        if (ref.isCell()) {\n                            this.activeCell(ref);\n                        } else {\n                            this.activeCell(this.selection.lastRange().first());\n                        }\n                        this.selectionRangeIndex = this.selection.size() - 1;\n                    } else {\n                        this._sheet.triggerChange({ selection: true });\n                    }\n                }\n                return this.selection;\n            },\n            singleCellSelection: function () {\n                return this._activeCell.eq(this.selection);\n            }\n        });\n        var Sheet = kendo.Observable.extend({\n            init: function (rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth) {\n                kendo.Observable.prototype.init.call(this);\n                var cellCount = rowCount * columnCount - 1;\n                this._rows = new kendo.spreadsheet.Axis(rowCount, rowHeight);\n                this._columns = new kendo.spreadsheet.Axis(columnCount, columnWidth);\n                this._mergedCells = [];\n                this._frozenRows = 0;\n                this._frozenColumns = 0;\n                this._suspendChanges = false;\n                this._filter = null;\n                this._grid = new kendo.spreadsheet.Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n                this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n                this._properties = new kendo.spreadsheet.PropertyBag(cellCount);\n                this._sorter = new kendo.spreadsheet.Sorter(this._grid, this._properties.sortable());\n                this._viewSelection = new Selection(this);\n                this._editSelection = new Selection(this);\n                this._formulaSelections = [];\n                this.options = { showGridLines: true };\n            },\n            _selectionState: function () {\n                return this._inEdit ? this._editSelection : this._viewSelection;\n            },\n            navigator: function () {\n                if (!this._navigator) {\n                    this._navigator = new kendo.spreadsheet.SheetNavigator(this);\n                }\n                return this._navigator;\n            },\n            axisManager: function () {\n                if (!this._axisManager) {\n                    this._axisManager = new kendo.spreadsheet.AxisManager(this);\n                }\n                return this._axisManager;\n            },\n            _name: function (value) {\n                if (!value) {\n                    return this._sheetName;\n                }\n                this._sheetName = value;\n                return this;\n            },\n            name: function () {\n                return this._name();\n            },\n            _property: function (accessor, value, reason) {\n                if (value === undefined) {\n                    return accessor();\n                } else {\n                    accessor(value);\n                    return this.triggerChange(reason);\n                }\n            },\n            _field: function (name, value, reason) {\n                if (value === undefined) {\n                    return this[name];\n                } else {\n                    this[name] = value;\n                    return this.triggerChange(reason);\n                }\n            },\n            suspendChanges: function (value) {\n                if (value === undefined) {\n                    return this._suspendChanges;\n                }\n                this._suspendChanges = value;\n                return this;\n            },\n            triggerChange: function (reason) {\n                if (!this._suspendChanges) {\n                    this.trigger('change', reason);\n                }\n                return this;\n            },\n            setDataSource: function (dataSource, columns) {\n                if (this.dataSourceBinder) {\n                    this.dataSourceBinder.destroy();\n                }\n                this.dataSourceBinder = new kendo.spreadsheet.SheetDataSourceBinder({\n                    dataSource: dataSource,\n                    sheet: this,\n                    columns: columns\n                });\n            },\n            hideColumn: function (columnIndex) {\n                return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n            },\n            unhideColumn: function (columnIndex) {\n                return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n            },\n            isHiddenColumn: function (columnIndex) {\n                return this._grid._columns.hidden(columnIndex);\n            },\n            _copyRange: function (sourceRangeRef, targetRef) {\n                var grid = this._grid;\n                var rowCount = grid.rowCount;\n                var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n                var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n                var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n                var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n                var targetIndex = targetRef.col * rowCount + targetRef.row;\n                this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n            },\n            _adjustReferences: function (operation, start, delta, mergedCells) {\n                this._mergedCells = mergedCells.reduce(function (a, ref) {\n                    ref = ref.adjust(null, null, null, null, operation == 'row', start, delta);\n                    if (ref !== kendo.spreadsheet.NULLREF) {\n                        a.push(ref);\n                    }\n                    return a;\n                }, []);\n                if (this._workbook) {\n                    var affectedSheet = this._name();\n                    this._workbook._sheets.forEach(function (sheet) {\n                        sheet._forFormulas(function (formula) {\n                            formula.adjust(affectedSheet, operation, start, delta);\n                        });\n                        sheet._forValidations(function (validation) {\n                            validation.adjust(affectedSheet, operation, start, delta);\n                        });\n                    });\n                    this._workbook.adjustNames(affectedSheet, operation == 'row', start, delta);\n                }\n                var selection = this.select();\n                selection = selection.adjust(null, null, null, null, operation == 'row', start, delta);\n                if (selection !== kendo.spreadsheet.NULLREF) {\n                    this.select(selection);\n                }\n            },\n            _forFormulas: function (callback) {\n                var props = this._properties;\n                var formulas = props.get('formula').values();\n                var n = formulas.length;\n                formulas.forEach(function (f, i) {\n                    callback.call(this, f.value, i, n);\n                }, this);\n            },\n            _forValidations: function (callback) {\n                var props = this._properties;\n                props.get('validation').values().forEach(function (v) {\n                    callback.call(this, v.value);\n                }, this);\n            },\n            canInsertRow: function (rowIndex, count) {\n                count = count || 1;\n                var grid = this._grid;\n                var range = this.range(grid.rowCount - count, 0, count, grid.columnCount);\n                return !range.hasValue();\n            },\n            insertRow: function (rowIndex) {\n                if (!this.canInsertRow(rowIndex)) {\n                    throw new Error('Shifting nonblank cells off the worksheet is not supported!');\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var rowCount = grid.rowCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col), new CellRef(rowCount - 2, bottomRight.col));\n                        this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n                        new Range(ref, this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                this.trigger('insertRow', { index: rowIndex });\n                return this;\n            },\n            isEnabledRow: function (rowIndex) {\n                var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n                return new Range(ref, this).enable();\n            },\n            deleteRow: function (rowIndex) {\n                if (!this.isEnabledRow(rowIndex)) {\n                    return this;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        new Range(ref, this).clear();\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row + 1, topLeft.col), new CellRef(Infinity, bottomRight.col));\n                        this._copyRange(nextRef, topLeft);\n                        var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n                        new Range(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                this.trigger('deleteRow', { index: rowIndex });\n                return this;\n            },\n            insertColumn: function (columnIndex) {\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnCount; ci >= columnIndex; ci--) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear();\n                        if (ci == columnIndex) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col - 1), new CellRef(bottomRight.row, bottomRight.col - 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return this;\n            },\n            isEnabledColumn: function (columnIndex) {\n                var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n                return new Range(ref, this).enable();\n            },\n            deleteColumn: function (columnIndex) {\n                if (!this.isEnabledColumn(columnIndex)) {\n                    return this;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnIndex; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear();\n                        if (ci == columnCount - 1) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col + 1), new CellRef(bottomRight.row, bottomRight.col + 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return this;\n            },\n            hideRow: function (rowIndex) {\n                return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n            },\n            unhideRow: function (rowIndex) {\n                return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n            },\n            isHiddenRow: function (rowIndex) {\n                return this._grid._rows.hidden(rowIndex);\n            },\n            columnWidth: function (columnIndex, width) {\n                return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n            },\n            rowHeight: function (rowIndex, height) {\n                return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n            },\n            frozenRows: function (value) {\n                return this._field('_frozenRows', value, { layout: true });\n            },\n            frozenColumns: function (value) {\n                return this._field('_frozenColumns', value, { layout: true });\n            },\n            _ref: function (row, column, numRows, numColumns) {\n                var ref = null;\n                if (row instanceof kendo.spreadsheet.Ref) {\n                    return row;\n                }\n                if (row instanceof kendo.spreadsheet.Range) {\n                    return row._ref.toRangeRef();\n                }\n                if (typeof row === 'string') {\n                    ref = kendo.spreadsheet.calc.parseReference(row);\n                } else {\n                    if (!numRows) {\n                        numRows = 1;\n                    }\n                    if (!numColumns) {\n                        numColumns = 1;\n                    }\n                    ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n                }\n                return ref;\n            },\n            range: function (row, column, numRows, numColumns) {\n                return new Range(this._ref(row, column, numRows, numColumns), this);\n            },\n            forEachMergedCell: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                this._mergedCells.forEach(function (merged) {\n                    if (selectAll || merged.intersects(ref)) {\n                        callback(merged);\n                    }\n                });\n            },\n            forEachFilterHeader: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                if (this._filter) {\n                    var refs = [];\n                    this._filter.ref.forEachColumn(function (columnRef) {\n                        if (selectAll || columnRef.intersects(ref)) {\n                            refs.push(columnRef.topLeft);\n                        }\n                    });\n                    this._mergedCells.forEach(function (merged) {\n                        refs = refs.map(function (ref) {\n                            if (merged.intersects(ref)) {\n                                return merged;\n                            }\n                            return ref;\n                        });\n                    });\n                    refs.reduce(function unique(result, element) {\n                        if (result.indexOf(element) < 0) {\n                            result.push(element);\n                        }\n                        return result;\n                    }, []).forEach(callback);\n                }\n            },\n            forEach: function (ref, callback) {\n                if (!(ref instanceof RangeRef)) {\n                    ref = this._ref(ref);\n                }\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var ri = topLeft.row;\n                    var startCellIndex = this._grid.index(ri, ci);\n                    var endCellIndex = this._grid.index(bottomRight.row, ci);\n                    this._properties.forEach(startCellIndex, endCellIndex, function (value) {\n                        callback(ri++, ci, value);\n                    });\n                }\n            },\n            startResizing: function (initialPosition) {\n                this._initialPosition = initialPosition;\n                this._resizeInProgress = true;\n            },\n            startAutoFill: function () {\n                this._autoFillInProgress = true;\n                var selection = this.select();\n                this._autoFillOrigin = selection;\n                this._autoFillDest = selection;\n                this.triggerChange({ selection: true });\n            },\n            updateAutoFill: function (dest, punch, hint, direction) {\n                this._autoFillDest = dest;\n                this._autoFillPunch = punch;\n                this._autoFillHint = hint;\n                this._autoFillDirection = direction;\n                this.triggerChange({ selection: true });\n            },\n            autoFillRef: function () {\n                return this._autoFillDest;\n            },\n            autoFillPunch: function () {\n                return this._autoFillPunch;\n            },\n            autoFillInProgress: function () {\n                return this._autoFillInProgress;\n            },\n            resizingInProgress: function () {\n                return this._resizeInProgress;\n            },\n            completeResizing: function () {\n                if (this._resizeInProgress) {\n                    this._resizeInProgress = false;\n                    var hintPosition = this.resizeHintPosition();\n                    if (this._initialPosition && hintPosition) {\n                        var handlePosition = this.resizeHandlePosition();\n                        if (handlePosition.col !== -Infinity) {\n                            this.columnWidth(handlePosition.col, this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x));\n                        } else {\n                            this.rowHeight(handlePosition.row, this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y));\n                        }\n                    } else {\n                        this.trigger('change', { resize: true });\n                    }\n                }\n            },\n            resizeHandlePosition: function () {\n                return this._resizeHandlePosition;\n            },\n            resizeHintPosition: function (location) {\n                if (location !== undefined) {\n                    this._resizeHintPosition = location;\n                    this.trigger('change', { resize: true });\n                }\n                return this._resizeHintPosition;\n            },\n            removeResizeHandle: function () {\n                if (this._resizeHandlePosition) {\n                    this._resizeHintPosition = undefined;\n                    this._resizeHandlePosition = undefined;\n                    this._initialPosition = undefined;\n                    this.trigger('change', { resize: true });\n                }\n            },\n            positionResizeHandle: function (ref) {\n                this._resizeHandlePosition = ref;\n                this.trigger('change', { resize: true });\n            },\n            startSelection: function () {\n                this._selectionInProgress = true;\n            },\n            completeSelection: function () {\n                if (this._selectionInProgress) {\n                    this._selectionInProgress = false;\n                    this._resizeHintPosition = undefined;\n                    this.trigger('change', { selection: true });\n                }\n                if (this._autoFillInProgress) {\n                    this._autoFillInProgress = false;\n                    var dest = this._autoFillDest;\n                    var origin = this._autoFillOrigin;\n                    if (this._autoFillPunch) {\n                        this._workbook.execute({\n                            command: 'ClearContentCommand',\n                            options: { operatingRange: this.range(this._autoFillPunch) }\n                        });\n                    } else {\n                        if (!dest.eq(origin)) {\n                            this._workbook.execute({\n                                command: 'AutoFillCommand',\n                                options: {\n                                    operatingRange: this.range(dest),\n                                    origin: this.range(origin)\n                                }\n                            });\n                        } else {\n                            this.triggerChange({ selection: true });\n                        }\n                    }\n                    this._autoFillDest = null;\n                    this._autoFillPunch = null;\n                    this._autoFillOrigin = null;\n                    this.select(dest);\n                }\n            },\n            selectionInProgress: function () {\n                return this._selectionInProgress;\n            },\n            select: function (ref, changeActiveCell) {\n                var selectionState = this._selectionState();\n                var expandedRef;\n                if (ref) {\n                    ref = this._ref(ref);\n                    expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n                }\n                return selectionState.select(ref, expandedRef, changeActiveCell);\n            },\n            originalSelect: function () {\n                return this._selectionState().originalSelection;\n            },\n            currentSelectionRange: function () {\n                return this._selectionState().currentSelectionRange();\n            },\n            currentOriginalSelectionRange: function () {\n                return this._selectionState().currentOriginalNavigationRange();\n            },\n            currentNavigationRange: function () {\n                return this._selectionState().currentNavigationRange();\n            },\n            nextNavigationRange: function () {\n                return this._selectionState().nextNavigationRange();\n            },\n            previousNavigationRange: function () {\n                return this._selectionState().previousNavigationRange();\n            },\n            selectionRangeIndex: function () {\n                return this._selectionState().selectionRangeIndex;\n            },\n            activeCell: function (ref) {\n                return this._selectionState().activeCell(ref);\n            },\n            originalActiveCell: function () {\n                return this._selectionState().originalActiveCell;\n            },\n            singleCellSelection: function () {\n                return this._selectionState().singleCellSelection();\n            },\n            unionWithMerged: function (ref) {\n                var mergedCells = this._mergedCells;\n                return ref.map(function (ref) {\n                    return ref.toRangeRef().union(mergedCells);\n                });\n            },\n            trim: function (ref) {\n                var trims = [];\n                var grid = this._grid;\n                this._properties.forEachProperty(function (property) {\n                    trims.push(grid.trim(ref, property.list));\n                });\n                return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n            },\n            focus: function (ref) {\n                if (ref) {\n                    this._focus = ref.toRangeRef();\n                } else {\n                    var focus = this._focus;\n                    this._focus = null;\n                    return focus;\n                }\n            },\n            activeCellSelection: function () {\n                return new Range(this._grid.normalize(this.activeCell()), this);\n            },\n            selection: function () {\n                return new Range(this._grid.normalize(this._selectionState().selection), this);\n            },\n            selectedHeaders: function () {\n                var selection = this.select();\n                var rows = {};\n                var cols = {};\n                var allCols = false;\n                var allRows = false;\n                selection.forEach(function (ref) {\n                    var i;\n                    var rowState = 'partial';\n                    var colState = 'partial';\n                    ref = ref.toRangeRef();\n                    var bottomRight = ref.bottomRight;\n                    var rowSelection = bottomRight.col === Infinity;\n                    var colSelection = bottomRight.row === Infinity;\n                    if (colSelection) {\n                        allRows = true;\n                        colState = 'full';\n                    }\n                    if (rowSelection) {\n                        allCols = true;\n                        rowState = 'full';\n                    }\n                    if (!colSelection) {\n                        for (i = ref.topLeft.row; i <= bottomRight.row; i++) {\n                            if (rows[i] !== 'full') {\n                                rows[i] = rowState;\n                            }\n                        }\n                    }\n                    if (!rowSelection) {\n                        for (i = ref.topLeft.col; i <= bottomRight.col; i++) {\n                            if (cols[i] !== 'full') {\n                                cols[i] = colState;\n                            }\n                        }\n                    }\n                });\n                return {\n                    rows: rows,\n                    cols: cols,\n                    allRows: allRows,\n                    allCols: allCols,\n                    all: allRows && allCols\n                };\n            },\n            isInEditMode: function (isInEdit) {\n                if (isInEdit === undefined) {\n                    return this._inEdit;\n                }\n                this._inEdit = isInEdit;\n                if (isInEdit) {\n                    this._editSelection.selection = this._viewSelection.selection.clone();\n                    this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n                    this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n                    this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n                }\n            },\n            _setFormulaSelections: function (selection) {\n                this._formulaSelections = (selection || []).slice();\n                this.triggerChange({ selection: true });\n            },\n            _viewActiveCell: function () {\n                return this._viewSelection._activeCell.toRangeRef();\n            },\n            toJSON: function () {\n                var positions = {};\n                var rows = this._rows.toJSON('height', positions);\n                var columns = this._columns.toJSON('width', {});\n                var viewSelection = this._viewSelection;\n                this.forEach(kendo.spreadsheet.SHEETREF, function (row, col, cell) {\n                    if (Object.keys(cell).length === 0) {\n                        return;\n                    }\n                    var position = positions[row];\n                    if (position === undefined) {\n                        position = rows.length;\n                        rows.push({ index: row });\n                        positions[row] = position;\n                    }\n                    row = rows[position];\n                    cell.index = col;\n                    if (row.cells === undefined) {\n                        row.cells = [];\n                    }\n                    if (cell.formula) {\n                        cell.formula = cell.formula.toString();\n                    }\n                    if (cell.validation) {\n                        cell.validation = cell.validation.toJSON();\n                    }\n                    if (cell.color) {\n                        cell.color = new Color(cell.color).toHex();\n                    }\n                    if (cell.background) {\n                        cell.background = new Color(cell.background).toHex();\n                    }\n                    if (cell.borderTop && cell.borderTop.color) {\n                        cell.borderTop.color = new Color(cell.borderTop.color).toHex();\n                    }\n                    if (cell.borderBottom && cell.borderBottom.color) {\n                        cell.borderBottom.color = new Color(cell.borderBottom.color).toHex();\n                    }\n                    if (cell.borderRight && cell.borderRight.color) {\n                        cell.borderRight.color = new Color(cell.borderRight.color).toHex();\n                    }\n                    if (cell.borderLeft && cell.borderLeft.color) {\n                        cell.borderLeft.color = new Color(cell.borderLeft.color).toHex();\n                    }\n                    row.cells.push(cell);\n                });\n                var json = {\n                    name: this._name(),\n                    rows: rows,\n                    columns: columns,\n                    selection: viewSelection.selection.toString(),\n                    activeCell: viewSelection.activeCell().toString(),\n                    frozenRows: this.frozenRows(),\n                    frozenColumns: this.frozenColumns(),\n                    mergedCells: this._mergedCells.map(function (ref) {\n                        return ref.toString();\n                    })\n                };\n                if (this._sort) {\n                    json.sort = {\n                        ref: this._sort.ref.toString(),\n                        columns: this._sort.columns.map(function (column) {\n                            return {\n                                index: column.index,\n                                ascending: column.ascending\n                            };\n                        })\n                    };\n                }\n                if (this._filter) {\n                    json.filter = {\n                        ref: this._filter.ref.toString(),\n                        columns: this._filter.columns.map(function (column) {\n                            var filter = column.filter.toJSON();\n                            filter.index = column.index;\n                            return filter;\n                        })\n                    };\n                }\n                return json;\n            },\n            fromJSON: function (json) {\n                this.batch(function () {\n                    if (json.name !== undefined) {\n                        this._name(json.name);\n                    }\n                    if (json.frozenColumns !== undefined) {\n                        this.frozenColumns(json.frozenColumns);\n                    }\n                    if (json.frozenRows !== undefined) {\n                        this.frozenRows(json.frozenRows);\n                    }\n                    if (json.columns !== undefined) {\n                        this._columns.fromJSON('width', json.columns);\n                    }\n                    if (json.rows !== undefined) {\n                        this._rows.fromJSON('height', json.rows);\n                        for (var ri = 0; ri < json.rows.length; ri++) {\n                            var row = json.rows[ri];\n                            var rowIndex = row.index;\n                            if (rowIndex === undefined) {\n                                rowIndex = ri;\n                            }\n                            if (row.cells) {\n                                for (var ci = 0; ci < row.cells.length; ci++) {\n                                    var cell = row.cells[ci];\n                                    var columnIndex = cell.index;\n                                    if (columnIndex === undefined) {\n                                        columnIndex = ci;\n                                    }\n                                    if (cell.formula) {\n                                        cell.formula = this._compileFormula(rowIndex, columnIndex, cell.formula);\n                                    }\n                                    if (cell.validation) {\n                                        cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                                    }\n                                    this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                                }\n                            }\n                        }\n                    }\n                    if (json.selection) {\n                        this._viewSelection.selection = this._viewSelection.originalSelection = this._ref(json.selection);\n                    }\n                    if (json.activeCell) {\n                        var activeCellRef = this._ref(json.activeCell);\n                        this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                        this._viewSelection.originalActiveCell = activeCellRef;\n                    }\n                    if (json.mergedCells) {\n                        json.mergedCells.forEach(function (ref) {\n                            this.range(ref).merge();\n                        }, this);\n                    }\n                    if (json.sort) {\n                        this._sort = {\n                            ref: this._ref(json.sort.ref),\n                            columns: json.sort.columns.slice(0)\n                        };\n                    }\n                    if (json.filter) {\n                        var ref = json.filter.ref;\n                        var columns = json.filter.columns === undefined ? [] : json.filter.columns;\n                        if (!ref) {\n                            kendo.logToConsole('Dropping filter for sheet \\'' + json.name + '\\' due to missing ref');\n                        } else {\n                            this._filter = {\n                                ref: this._ref(ref),\n                                columns: columns.map(function (column) {\n                                    return {\n                                        index: column.index,\n                                        filter: kendo.spreadsheet.Filter.create(column)\n                                    };\n                                })\n                            };\n                            this._refreshFilter();\n                        }\n                    }\n                });\n            },\n            formula: function (ref) {\n                return this._properties.get('formula', this._grid.cellRefIndex(ref));\n            },\n            validation: function (ref) {\n                return this._properties.get('validation', this._grid.cellRefIndex(ref));\n            },\n            resetFormulas: function () {\n                this._forFormulas(function (formula) {\n                    formula.reset();\n                });\n            },\n            resetValidations: function () {\n                this._forValidations(function (validation) {\n                    validation.reset();\n                });\n            },\n            recalc: function (context, callback) {\n                var formulas = this._properties.get('formula').values();\n                var count = formulas.length, pending = 0, i = 0;\n                if (!count && callback) {\n                    return callback();\n                }\n                function next() {\n                    pending--;\n                    if (i == count && !pending) {\n                        callback();\n                    }\n                }\n                while (i < count) {\n                    pending++;\n                    formulas[i++].value.exec(context, callback ? next : null);\n                }\n            },\n            revalidate: function (context) {\n                var self = this;\n                this._forValidations(function (validation) {\n                    var cellRef = new CellRef(validation.row, validation.col);\n                    var ref = new RangeRef(cellRef, cellRef);\n                    validation.exec(context, self._get(ref, 'value'), self._get(ref, 'format'));\n                });\n            },\n            _value: function (row, col, value) {\n                var index = this._grid.index(row, col);\n                if (value !== undefined) {\n                    this._properties.set('value', index, index, value);\n                } else {\n                    return this._properties.get('value', index);\n                }\n            },\n            _validation: function (row, col) {\n                var index = this._grid.index(row, col);\n                return this._properties.get('validation', index);\n            },\n            _compileValidation: function (row, col, validation) {\n                if (validation.from) {\n                    validation.from = (validation.from + '').replace(/^=/, '');\n                }\n                if (validation.to) {\n                    validation.to = (validation.to + '').replace(/^=/, '');\n                }\n                return kendo.spreadsheet.validation.compile(this._name(), row, col, validation);\n            },\n            _compileFormula: function (row, col, f) {\n                f = f.replace(/^=/, '');\n                f = kendo.spreadsheet.calc.parseFormula(this._name(), row, col, f);\n                return kendo.spreadsheet.calc.compile(f);\n            },\n            _copyValuesInRange: function (topLeft, bottomRight, value, property) {\n                var ci, start, end;\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    start = this._grid.index(topLeft.row, ci);\n                    end = this._grid.index(bottomRight.row, ci);\n                    for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                        value = value.clone(this._name(), row, ci);\n                        this._properties.set(property, index, index, value);\n                    }\n                }\n                return value;\n            },\n            _set: function (ref, name, value) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                var ci, start, end;\n                if (value && name == 'formula') {\n                    if (typeof value == 'string') {\n                        value = this._compileFormula(topLeft.row, topLeft.col, value);\n                    }\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'formula');\n                } else if (value && name == 'validation') {\n                    value = this._compileValidation(topLeft.row, topLeft.col, value);\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'validation');\n                } else {\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        start = this._grid.index(topLeft.row, ci);\n                        end = this._grid.index(bottomRight.row, ci);\n                        this._properties.set(name, start, end, value);\n                        if (name == 'formula') {\n                            this._properties.set('value', start, end, null);\n                        }\n                    }\n                }\n            },\n            _get: function (ref, name) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var index = this._grid.index(topLeft.row, topLeft.col);\n                return this._properties.get(name, index);\n            },\n            batch: function (callback, reason) {\n                var suspended = this.suspendChanges();\n                this.suspendChanges(true);\n                callback.call(this);\n                return this.suspendChanges(suspended).triggerChange(reason);\n            },\n            _sortBy: function (ref, columns) {\n                var indices = null;\n                columns.forEach(function (column) {\n                    indices = this._sorter.sortBy(ref, column.index, this._properties.get('value'), column.ascending, indices);\n                }, this);\n                this._sort = {\n                    ref: ref,\n                    columns: columns\n                };\n                this._refreshFilter();\n                this.triggerChange({ recalc: true });\n            },\n            _refreshFilter: function () {\n                if (this._filter) {\n                    this._filterBy(this._filter.ref, this._filter.columns);\n                }\n            },\n            _filterBy: function (ref, columns) {\n                this.batch(function () {\n                    for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                        if (this._rows.hidden(ri)) {\n                            this._rows.unhide(ri);\n                        }\n                    }\n                    columns.forEach(function (column) {\n                        var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n                        var cells = [];\n                        if (columnRef === kendo.spreadsheet.NULLREF) {\n                            return;\n                        }\n                        this.forEach(columnRef, function (row, col, cell) {\n                            cell.row = row;\n                            cells.push(cell);\n                        });\n                        column.filter.prepare(cells);\n                        for (var ci = 0; ci < cells.length; ci++) {\n                            var cell = cells[ci];\n                            var value = column.filter.value(cell);\n                            if (column.filter.matches(value) === false) {\n                                this.hideRow(cell.row);\n                            }\n                        }\n                    }, this);\n                    this._filter = {\n                        ref: ref,\n                        columns: columns\n                    };\n                }, {\n                    layout: true,\n                    filter: true\n                });\n            },\n            filter: function () {\n                return this._filter;\n            },\n            clearFilter: function (spec) {\n                this._clearFilter(spec instanceof Array ? spec : [spec]);\n            },\n            _clearFilter: function (indices) {\n                if (this._filter) {\n                    this.batch(function () {\n                        this._filter.columns = this._filter.columns.filter(function (column) {\n                            return indices.indexOf(column.index) < 0;\n                        });\n                        this._refreshFilter();\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            getAxisState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState()\n                };\n            },\n            setAxisState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this.triggerChange({ layout: true });\n            },\n            getState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState(),\n                    mergedCells: this._mergedCells.map(function (cell) {\n                        return cell.clone();\n                    }),\n                    properties: this._properties.getState()\n                };\n            },\n            setState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this._mergedCells = state.mergedCells;\n                this._properties.setState(state.properties);\n                this.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            _merge: function (ref) {\n                var mergedCells = this._mergedCells;\n                var sheet = this;\n                var mergedRef;\n                this.batch(function () {\n                    mergedRef = ref.map(function (ref) {\n                        if (ref instanceof kendo.spreadsheet.CellRef) {\n                            return ref;\n                        }\n                        var currentRef = ref.toRangeRef().union(mergedCells, function (ref) {\n                            mergedCells.splice(mergedCells.indexOf(ref), 1);\n                        });\n                        var range = new Range(currentRef, sheet);\n                        var formula = range._get('formula');\n                        var value = range.value();\n                        var format = range.format();\n                        var background = range.background();\n                        range.value(null);\n                        range.format(null);\n                        range.background(null);\n                        var topLeft = new Range(currentRef.collapse(), sheet);\n                        if (formula) {\n                            topLeft._set('formula', formula);\n                        } else {\n                            topLeft.value(value);\n                        }\n                        topLeft.format(format);\n                        topLeft.background(background);\n                        mergedCells.push(currentRef);\n                        return currentRef;\n                    });\n                    var viewSelection = sheet._viewSelection;\n                    viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n                    viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n                }, {\n                    activeCell: true,\n                    selection: true\n                });\n                return mergedRef;\n            }\n        });\n        kendo.spreadsheet.Sheet = Sheet;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetsbar', [\n        'kendo.core',\n        'kendo.sortable'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var DOT = '.';\n        var EMPTYCHAR = ' ';\n        var sheetsBarClassNames = {\n            sheetsBarWrapper: 'k-widget k-header',\n            sheetsBarSheetsWrapper: 'k-tabstrip k-floatwrap k-tabstrip-bottom',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            sheetsBarAdd: 'k-spreadsheet-sheets-bar-add',\n            sheetsBarRemove: 'k-spreadsheet-sheets-remove',\n            sheetsBarItems: 'k-spreadsheet-sheets-items',\n            sheetsBarEditor: 'k-spreadsheet-sheets-editor',\n            sheetsBarScrollable: 'k-tabstrip-scrollable',\n            sheetsBarNext: 'k-tabstrip-next',\n            sheetsBarPrev: 'k-tabstrip-prev',\n            sheetsBarKItem: 'k-item k-state-default',\n            sheetsBarKActive: 'k-state-active k-state-tab-on-top',\n            sheetsBarKTextbox: 'k-textbox',\n            sheetsBarKLink: 'k-link',\n            sheetsBarKIcon: 'k-icon',\n            sheetsBarKFontIcon: 'k-font-icon',\n            sheetsBarKButton: 'k-button k-button-icon',\n            sheetsBarKButtonBare: 'k-button-bare',\n            sheetsBarKArrowW: 'k-i-arrow-w',\n            sheetsBarKArrowE: 'k-i-arrow-e',\n            sheetsBarKReset: 'k-reset k-tabstrip-items',\n            sheetsBarKIconX: 'k-i-x',\n            sheetsBarKSprite: 'k-sprite',\n            sheetsBarKIconPlus: 'k-i-plus',\n            sheetsBarHintWrapper: 'k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint',\n            sheetsBarKResetItems: 'k-reset k-tabstrip-items'\n        };\n        var SheetsBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                var classNames = SheetsBar.classNames;\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(classNames.sheetsBarWrapper);\n                this._tree = new kendo.dom.Tree(element[0]);\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper([])\n                ]);\n                this._createSortable();\n                this._sortable.bind('start', this._onSheetReorderStart.bind(this));\n                this._sortable.bind('end', this._onSheetReorderEnd.bind(this));\n                element.on('click', DOT + classNames.sheetsBarRemove, this._onSheetRemove.bind(this));\n                element.on('click', 'li', this._onSheetSelect.bind(this));\n                element.on('dblclick', 'li' + DOT + classNames.sheetsBarActive, this._createEditor.bind(this));\n                element.on('click', DOT + classNames.sheetsBarAdd, this._onAddSelect.bind(this));\n            },\n            options: {\n                name: 'SheetsBar',\n                scrollable: { distance: 200 }\n            },\n            events: [\n                'select',\n                'reorder',\n                'rename'\n            ],\n            _createEditor: function () {\n                if (this._editor) {\n                    return;\n                }\n                this._renderSheets(this._sheets, this._selectedIndex, true);\n                this._editor = this.element.find(kendo.format('input{0}{1}', DOT, SheetsBar.classNames.sheetsBarEditor)).focus().on('keydown', this._onEditorKeydown.bind(this)).on('blur', this._onEditorBlur.bind(this));\n            },\n            _destroyEditor: function () {\n                this._editor.off();\n                this._editor = null;\n                this._renderSheets(this._sheets, this._selectedIndex, false);\n            },\n            renderSheets: function (sheets, selectedIndex) {\n                if (!sheets || selectedIndex < 0) {\n                    return;\n                }\n                this._renderSheets(sheets, selectedIndex, false);\n            },\n            _renderSheets: function (sheets, selectedIndex, isInEditMode) {\n                var that = this;\n                var wrapperOffsetWidth;\n                var sheetsGroupScrollWidth;\n                var scrollPrevButton;\n                var scrollNextButton;\n                var sheetsWrapper = that._sheetsWrapper();\n                var sheetsGroup = that._sheetsGroup();\n                var classNames = SheetsBar.classNames;\n                var addButtonWidth = $(DOT + classNames.sheetsBarAdd).outerWidth() + 11;\n                that._isRtl = kendo.support.isRtl(that.element);\n                that._sheets = sheets;\n                that._selectedIndex = selectedIndex;\n                if (!that._scrollableAllowed()) {\n                    that._renderHtml(isInEditMode, false);\n                    return;\n                }\n                sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n                wrapperOffsetWidth = sheetsWrapper[0].offsetWidth;\n                sheetsGroupScrollWidth = sheetsGroup[0].scrollWidth + addButtonWidth + 11;\n                if (sheetsGroupScrollWidth > wrapperOffsetWidth) {\n                    if (!that._scrollableModeActive) {\n                        var scrollPrevButtonWidth;\n                        that._nowScrollingSheets = false;\n                        that._renderHtml(isInEditMode, true);\n                        scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                        scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                        scrollPrevButtonWidth = scrollPrevButton.outerWidth();\n                        scrollPrevButton.css({ marginLeft: scrollPrevButtonWidth + 4 });\n                        that._sheetsGroup().css({\n                            marginLeft: scrollPrevButtonWidth + addButtonWidth,\n                            marginRight: scrollNextButton.outerWidth() + 12\n                        });\n                        that._scrollableModeActive = true;\n                        that._toggleScrollEvents(true);\n                        that._toggleScrollButtons();\n                    } else {\n                        that._toggleScrollButtons();\n                        that._renderHtml(isInEditMode, true);\n                    }\n                } else if (that._scrollableModeActive && sheetsGroupScrollWidth <= wrapperOffsetWidth) {\n                    that._scrollableModeActive = false;\n                    that._toggleScrollEvents(false);\n                    that._renderHtml(isInEditMode, false);\n                    that._sheetsGroup().css({\n                        marginLeft: addButtonWidth,\n                        marginRight: ''\n                    });\n                } else {\n                    that._renderHtml(isInEditMode, false);\n                    that._sheetsGroup().css({ marginLeft: addButtonWidth });\n                }\n            },\n            _toggleScrollEvents: function (toggle) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n                var options = that.options;\n                var scrollPrevButton;\n                var scrollNextButton;\n                var sheetsWrapper = that._sheetsWrapper();\n                scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                if (toggle) {\n                    scrollPrevButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                    });\n                    scrollNextButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                    });\n                    scrollPrevButton.add(scrollNextButton).on('mouseup', function () {\n                        that._nowScrollingSheets = false;\n                    });\n                } else {\n                    scrollPrevButton.off();\n                    scrollNextButton.off();\n                }\n            },\n            _renderHtml: function (isInEditMode, renderScrollButtons) {\n                var idx;\n                var sheetElements = [];\n                var dom = kendo.dom;\n                var element = dom.element;\n                var sheets = this._sheets;\n                var selectedIndex = this._selectedIndex;\n                var classNames = SheetsBar.classNames;\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var sheet = sheets[idx];\n                    var isSelectedSheet = idx === selectedIndex;\n                    var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR };\n                    var elementContent = [];\n                    if (isSelectedSheet) {\n                        attr.className += classNames.sheetsBarKActive + EMPTYCHAR + classNames.sheetsBarActive;\n                    } else {\n                        attr.className += classNames.sheetsBarInactive;\n                    }\n                    if (isSelectedSheet && isInEditMode) {\n                        elementContent.push(element('input', {\n                            type: 'text',\n                            value: sheet.name(),\n                            className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                            maxlength: 50\n                        }, []));\n                    } else {\n                        elementContent.push(element('span', {\n                            className: classNames.sheetsBarKLink,\n                            title: sheet.name()\n                        }, [dom.text(sheet.name())]));\n                        var deleteIcon = element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconX }, []);\n                        elementContent.push(element('span', { className: classNames.sheetsBarKLink + EMPTYCHAR + classNames.sheetsBarRemove }, [deleteIcon]));\n                    }\n                    sheetElements.push(element('li', attr, elementContent));\n                }\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper(sheetElements, renderScrollButtons)\n                ]);\n            },\n            _createSheetsWrapper: function (sheetElements, renderScrollButtons) {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                var childrenElements = [element('ul', { className: classNames.sheetsBarKReset }, sheetElements)];\n                if (renderScrollButtons) {\n                    var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarPrev }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowW }, [])]));\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarNext }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowE }, [])]));\n                }\n                return element('div', { className: classNames.sheetsBarItems }, childrenElements);\n            },\n            _createSortable: function () {\n                var classNames = SheetsBar.classNames;\n                this._sortable = new kendo.ui.Sortable(this.element, {\n                    filter: kendo.format('ul li.{0},ul li.{1}', classNames.sheetsBarActive, classNames.sheetsBarInactive),\n                    container: DOT + classNames.sheetsBarItems,\n                    axis: 'x',\n                    animation: false,\n                    ignore: 'input',\n                    hint: function (element) {\n                        var hint = $(element).clone();\n                        return hint.wrap('<div class=\\'' + classNames.sheetsBarHintWrapper + '\\'><ul class=\\'' + classNames.sheetsBarKResetItems + '\\'></ul></div>').closest('div');\n                    }\n                });\n            },\n            _onEditorKeydown: function (e) {\n                if (this._editor) {\n                    if (e.which === 13) {\n                        this._destroyEditor();\n                        this._onSheetRename($(e.target).val());\n                    }\n                    if (e.which === 27) {\n                        this._destroyEditor();\n                        this._onSheetRename();\n                    }\n                }\n            },\n            _onEditorBlur: function (e) {\n                if (this._editor) {\n                    this._destroyEditor();\n                    this._onSheetRename($(e.target).val());\n                }\n            },\n            _onSheetReorderEnd: function (e) {\n                e.preventDefault();\n                this.trigger('reorder', {\n                    oldIndex: e.oldIndex,\n                    newIndex: e.newIndex\n                });\n            },\n            _onSheetReorderStart: function (e) {\n                if (this._editor) {\n                    e.preventDefault();\n                }\n            },\n            _onSheetRemove: function (e) {\n                var removedSheetName = $(e.target).closest('li').text();\n                if (this._editor) {\n                    this._destroyEditor();\n                    this._onSheetRename(this._editor.val());\n                }\n                this.trigger('remove', { name: removedSheetName });\n            },\n            _onSheetSelect: function (e) {\n                var selectedSheetText = $(e.target).text();\n                if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                    e.preventDefault();\n                    return;\n                }\n                if (this._editor) {\n                    var editorValue = this._editor.val();\n                    this._destroyEditor();\n                    this._onSheetRename(editorValue);\n                }\n                this._scrollSheetsToItem($(e.target).closest('li'));\n                this.trigger('select', {\n                    name: selectedSheetText,\n                    isAddButton: false\n                });\n            },\n            _onSheetRename: function (newSheetName) {\n                this.trigger('rename', {\n                    name: newSheetName,\n                    sheetIndex: this._selectedIndex\n                });\n            },\n            _onAddSelect: function () {\n                this.trigger('select', { isAddButton: true });\n            },\n            _addButton: function () {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                return element('a', { className: classNames.sheetsBarAdd + EMPTYCHAR + classNames.sheetsBarKButton }, [element('span', { className: classNames.sheetsBarKSprite + EMPTYCHAR + classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconPlus }, [])]);\n            },\n            destroy: function () {\n                this._sortable.destroy();\n            },\n            _scrollableAllowed: function () {\n                var options = this.options;\n                return options.scrollable && !isNaN(options.scrollable.distance);\n            },\n            _scrollSheetsToItem: function (item) {\n                var that = this;\n                if (!that._scrollableModeActive) {\n                    return;\n                }\n                var sheetsGroup = that._sheetsGroup();\n                var currentScrollOffset = sheetsGroup.scrollLeft();\n                var itemWidth = item.outerWidth();\n                var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                var sheetsGroupPadding = Math.ceil(parseFloat(sheetsGroup.css('padding-left')));\n                var itemPosition;\n                if (that._isRtl) {\n                    if (itemOffset < 0) {\n                        itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset) - sheetsGroupPadding;\n                    } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                        itemPosition = currentScrollOffset + itemOffset - itemWidth + sheetsGroupPadding * 2;\n                    }\n                } else {\n                    if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                        itemPosition = itemOffset + itemWidth - sheetsGroupWidth + sheetsGroupPadding * 2;\n                    } else if (currentScrollOffset > itemOffset) {\n                        itemPosition = itemOffset - sheetsGroupPadding;\n                    }\n                }\n                sheetsGroup.finish().animate({ 'scrollLeft': itemPosition }, 'fast', 'linear', function () {\n                    that._toggleScrollButtons();\n                });\n            },\n            _sheetsGroup: function () {\n                return this._sheetsWrapper().children('ul');\n            },\n            _sheetsWrapper: function () {\n                return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n            },\n            _scrollSheetsByDelta: function (delta) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var scrLeft = sheetsGroup.scrollLeft();\n                sheetsGroup.finish().animate({ 'scrollLeft': scrLeft + delta }, 'fast', 'linear', function () {\n                    if (that._nowScrollingSheets) {\n                        that._scrollSheetsByDelta(delta);\n                    } else {\n                        that._toggleScrollButtons();\n                    }\n                });\n            },\n            _toggleScrollButtons: function () {\n                var that = this;\n                var ul = that._sheetsGroup();\n                var wrapper = that._sheetsWrapper();\n                var scrollLeft = ul.scrollLeft();\n                wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev).toggle(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0);\n                wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext).toggle(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1);\n            }\n        });\n        kendo.spreadsheet.SheetsBar = SheetsBar;\n        $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/calc', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var NameRef = spreadsheet.NameRef;\n    var exports = spreadsheet.calc;\n    var runtime = exports.runtime;\n    var OPERATORS = Object.create(null);\n    var ParseError = kendo.Class.extend({\n        init: function ParseError(message, pos) {\n            this.message = message;\n            this.pos = pos;\n        },\n        toString: function () {\n            return this.message;\n        }\n    });\n    (function (ops) {\n        ops.forEach(function (cls, i) {\n            cls.forEach(function (op) {\n                OPERATORS[op] = ops.length - i;\n            });\n        });\n    }([\n        [':'],\n        [' '],\n        [','],\n        ['%'],\n        ['^'],\n        [\n            '*',\n            '/'\n        ],\n        [\n            '+',\n            '-'\n        ],\n        ['&'],\n        [\n            '=',\n            '<',\n            '>',\n            '<=',\n            '>=',\n            '<>'\n        ]\n    ]));\n    var TRUE = {\n        type: 'bool',\n        value: true\n    };\n    var FALSE = {\n        type: 'bool',\n        value: false\n    };\n    function getcol(str) {\n        str = str.toUpperCase();\n        for (var col = 0, i = 0; i < str.length; ++i) {\n            col = col * 26 + str.charCodeAt(i) - 64;\n        }\n        return col - 1;\n    }\n    function getrow(str) {\n        return parseInt(str, 10) - 1;\n    }\n    function parseReference(name, noThrow) {\n        if (name.toLowerCase() == '#sheet') {\n            return spreadsheet.SHEETREF;\n        }\n        OUT: {\n            var m;\n            if (m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name)) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row <= 1048576 && col <= 16383) {\n                    return new CellRef(getrow(m[4]), getcol(m[2]));\n                }\n                break OUT;\n            }\n            var stream = TokenStream(name, {});\n            var a = [];\n            while (true) {\n                var ref = stream.next();\n                if (ref instanceof CellRef) {\n                    ref.rel = 0;\n                } else if (ref instanceof RangeRef) {\n                    ref.topLeft.rel = 0;\n                    ref.bottomRight.rel = 0;\n                } else {\n                    break OUT;\n                }\n                a.push(ref);\n                if (stream.eof()) {\n                    break;\n                }\n                if (!stream.is('op', ',')) {\n                    break OUT;\n                }\n                stream.next();\n            }\n            return a.length == 1 ? a[0] : new spreadsheet.UnionRef(a);\n        }\n        if (!noThrow) {\n            throw new Error('Cannot parse reference: ' + name);\n        }\n    }\n    function parseFormula(sheet, row, col, input) {\n        var refs = [];\n        input = TokenStream(input, {\n            row: row,\n            col: col\n        });\n        var is = input.is;\n        return {\n            type: 'exp',\n            ast: parseExpression(true),\n            refs: refs,\n            sheet: sheet,\n            row: row,\n            col: col\n        };\n        function addReference(ref) {\n            ref.index = refs.length;\n            refs.push(ref);\n            return ref;\n        }\n        function skip(type, value) {\n            if (is(type, value)) {\n                return input.next();\n            } else {\n                var tok = input.peek();\n                if (tok) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB but found ' + tok.type + ' \\xAB' + tok.value + '\\xBB');\n                } else {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB');\n                }\n            }\n        }\n        function parseExpression(commas) {\n            return maybeBinary(maybeIntersect(parseAtom(commas)), 0, commas);\n        }\n        function parseSymbol(tok) {\n            if (tok.upper == 'TRUE' || tok.upper == 'FALSE') {\n                return tok.upper == 'TRUE' ? TRUE : FALSE;\n            }\n            return addReference(new NameRef(tok.value));\n        }\n        function parseFuncall() {\n            var fname = input.next();\n            fname = fname.value;\n            skip('punc', '(');\n            var args = [];\n            if (!is('punc', ')')) {\n                while (1) {\n                    if (is('op', ',')) {\n                        args.push({ type: 'null' });\n                        input.next();\n                        continue;\n                    }\n                    args.push(parseExpression(false));\n                    if (input.eof() || is('punc', ')')) {\n                        break;\n                    }\n                    skip('op', ',');\n                }\n            }\n            skip('punc', ')');\n            return {\n                type: 'func',\n                func: fname,\n                args: args\n            };\n        }\n        function fixReference(ref) {\n            if (!ref.hasSheet()) {\n                ref.setSheet(sheet);\n            }\n            return addReference(ref);\n        }\n        function parseAtom(commas) {\n            var exp;\n            if (is('ref')) {\n                exp = fixReference(input.next());\n            } else if (is('func')) {\n                exp = parseFuncall();\n            } else if (is('punc', '(')) {\n                input.next();\n                exp = parseExpression(true);\n                skip('punc', ')');\n            } else if (is('punc', '{')) {\n                input.next();\n                exp = parseArray();\n                skip('punc', '}');\n            } else if (is('num') || is('str')) {\n                exp = input.next();\n            } else if (is('sym')) {\n                exp = parseSymbol(input.next());\n            } else if (is('op', '+') || is('op', '-')) {\n                exp = {\n                    type: 'prefix',\n                    op: input.next().value,\n                    exp: parseExpression(commas)\n                };\n            } else if (!input.peek()) {\n                input.croak('Incomplete expression');\n            } else {\n                input.croak('Parse error');\n            }\n            return maybePercent(exp);\n        }\n        function parseArray() {\n            var row = [], value = [row], first = true;\n            while (!input.eof() && !is('punc', '}')) {\n                if (first) {\n                    first = false;\n                } else if (is('punc', ';')) {\n                    value.push(row = []);\n                    input.next();\n                } else {\n                    skip('op', ',');\n                }\n                row.push(parseExpression(false));\n            }\n            return {\n                type: 'matrix',\n                value: value\n            };\n        }\n        function maybeIntersect(exp) {\n            if (is('punc', '(') || is('ref') || is('num') || is('func')) {\n                return {\n                    type: 'binary',\n                    op: ' ',\n                    left: exp,\n                    right: parseExpression(false)\n                };\n            } else {\n                return exp;\n            }\n        }\n        function maybePercent(exp) {\n            if (is('op', '%')) {\n                input.next();\n                return maybePercent({\n                    type: 'postfix',\n                    op: '%',\n                    exp: exp\n                });\n            } else {\n                return exp;\n            }\n        }\n        function maybeBinary(left, my_prec, commas) {\n            var tok = is('op');\n            if (tok && (commas || tok.value != ',')) {\n                var his_prec = OPERATORS[tok.value];\n                if (his_prec > my_prec) {\n                    input.next();\n                    var right = maybeBinary(parseAtom(commas), his_prec, commas);\n                    return maybeBinary({\n                        type: 'binary',\n                        op: tok.value,\n                        left: left,\n                        right: right\n                    }, my_prec, commas);\n                }\n            }\n            return left;\n        }\n    }\n    function makePrinter(exp) {\n        return makeClosure('function(row, col){return(' + print(exp.ast, 0) + ')}');\n        function print(node, prec) {\n            switch (node.type) {\n            case 'num':\n            case 'bool':\n                return JSON.stringify(node.value);\n            case 'str':\n                return JSON.stringify(JSON.stringify(node.value));\n            case 'ref':\n                return 'this.refs[' + node.index + '].print(row, col)';\n            case 'prefix':\n                return withParens(node.op, prec, function () {\n                    return JSON.stringify(node.op) + ' + ' + print(node.exp, OPERATORS[node.op]);\n                });\n            case 'postfix':\n                return withParens(node.op, prec, function () {\n                    return print(node.exp, OPERATORS[node.op]) + ' + ' + JSON.stringify(node.op);\n                });\n            case 'binary':\n                return withParens(node.op, prec, function () {\n                    var left = parenthesize(print(node.left, OPERATORS[node.op]), node.left instanceof NameRef && node.op == ':');\n                    var right = parenthesize(print(node.right, OPERATORS[node.op]), node.right instanceof NameRef && node.op == ':');\n                    return left + ' + ' + JSON.stringify(node.op) + ' + ' + right;\n                });\n            case 'func':\n                return JSON.stringify(node.func + '(') + ' + ' + (node.args.length > 0 ? node.args.map(function (arg) {\n                    return print(arg, 0);\n                }).join(' + \\', \\' + ') : '\\'\\'') + ' + \\')\\'';\n            case 'matrix':\n                return '\\'{ \\' + ' + node.value.map(function (el) {\n                    return el.map(function (el) {\n                        return print(el, 0);\n                    }).join(' + \\', \\' + ');\n                }).join(' + \\'; \\' + ') + '+ \\' }\\'';\n            case 'null':\n                return '\\'\\'';\n            }\n            throw new Error('Cannot make printer for node ' + node.type);\n        }\n        function parenthesize(code, cond) {\n            return cond ? '\\'(\\' + ' + code + ' + \\')\\'' : code;\n        }\n        function withParens(op, prec, f) {\n            var needParens = OPERATORS[op] < prec || !prec && op == ',';\n            return parenthesize(f(), needParens);\n        }\n    }\n    function toCPS(ast, k) {\n        var GENSYM = 0;\n        return cps(ast, k);\n        function cps(node, k) {\n            switch (node.type) {\n            case 'ref':\n            case 'num':\n            case 'str':\n            case 'null':\n            case 'bool':\n                return cpsAtom(node, k);\n            case 'prefix':\n            case 'postfix':\n                return cpsUnary(node, k);\n            case 'binary':\n                return cpsBinary(node, k);\n            case 'func':\n                return cpsFunc(node, k);\n            case 'lambda':\n                return cpsLambda(node, k);\n            case 'matrix':\n                return cpsMatrix(node.value, k, true);\n            }\n            throw new Error('Cannot CPS ' + node.type);\n        }\n        function cpsAtom(node, k) {\n            return k(node);\n        }\n        function cpsUnary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'unary' + node.op,\n                args: [node.exp]\n            }, k);\n        }\n        function cpsBinary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'binary' + node.op,\n                args: [\n                    node.left,\n                    node.right\n                ]\n            }, k);\n        }\n        function cpsIf(co, th, el, k) {\n            return cps(co, function (co) {\n                var rest = makeContinuation(k);\n                var thenK = gensym('T');\n                var elseK = gensym('E');\n                return {\n                    type: 'func',\n                    func: 'if',\n                    args: [\n                        rest,\n                        co,\n                        {\n                            type: 'lambda',\n                            vars: [thenK],\n                            body: cps(th || TRUE, function (th) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: thenK\n                                    },\n                                    args: [th]\n                                };\n                            })\n                        },\n                        {\n                            type: 'lambda',\n                            vars: [elseK],\n                            body: cps(el || FALSE, function (el) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: elseK\n                                    },\n                                    args: [el]\n                                };\n                            })\n                        }\n                    ]\n                };\n            });\n        }\n        function cpsAnd(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(TRUE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    {\n                        type: 'func',\n                        func: 'AND',\n                        args: args.slice(1)\n                    },\n                    FALSE\n                ]\n            }, k);\n        }\n        function cpsOr(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(FALSE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    TRUE,\n                    {\n                        type: 'func',\n                        func: 'OR',\n                        args: args.slice(1)\n                    }\n                ]\n            }, k);\n        }\n        function cpsFunc(node, k) {\n            switch (node.func.toLowerCase()) {\n            case 'if':\n                return cpsIf(node.args[0], node.args[1], node.args[2], k);\n            case 'and':\n                return cpsAnd(node.args, k);\n            case 'or':\n                return cpsOr(node.args, k);\n            case 'true':\n                return k(TRUE);\n            case 'false':\n                return k(FALSE);\n            }\n            return function loop(args, i) {\n                if (i == node.args.length) {\n                    return {\n                        type: 'func',\n                        func: node.func,\n                        args: args\n                    };\n                } else {\n                    return cps(node.args[i], function (value) {\n                        return loop(args.concat([value]), i + 1);\n                    });\n                }\n            }([makeContinuation(k)], 0);\n        }\n        function cpsLambda(node, k) {\n            var cont = gensym('K');\n            var body = cps(node.body, function (body) {\n                return {\n                    type: 'call',\n                    func: {\n                        type: 'var',\n                        value: cont\n                    },\n                    args: [body]\n                };\n            });\n            return k({\n                type: 'lambda',\n                vars: [cont].concat(node.vars),\n                body: body\n            });\n        }\n        function cpsMatrix(elements, k, isMatrix) {\n            var a = [];\n            return function loop(i) {\n                if (i == elements.length) {\n                    return k({\n                        type: 'matrix',\n                        value: a\n                    });\n                } else {\n                    return (isMatrix ? cpsMatrix : cps)(elements[i], function (val) {\n                        a[i] = val;\n                        return loop(i + 1);\n                    });\n                }\n            }(0);\n        }\n        function makeContinuation(k) {\n            var cont = gensym('R');\n            return {\n                type: 'lambda',\n                vars: [cont],\n                body: k({\n                    type: 'var',\n                    name: cont\n                })\n            };\n        }\n        function gensym(name) {\n            if (!name) {\n                name = '';\n            }\n            name = '_' + name;\n            return name + ++GENSYM;\n        }\n    }\n    var makeClosure = function (cache) {\n        return function (code) {\n            var f = cache[code];\n            if (!f) {\n                f = cache[code] = new Function('\\'use strict\\';return(' + code + ')')();\n            }\n            return f;\n        };\n    }(Object.create(null));\n    var FORMULA_CACHE = Object.create(null);\n    function makeFormula(exp) {\n        var printer = makePrinter(exp);\n        var hash = printer.call(exp);\n        var formula = FORMULA_CACHE[hash];\n        if (formula) {\n            return formula.clone(exp.sheet, exp.row, exp.col);\n        }\n        var code = js(toCPS(exp.ast, function (ret) {\n            return {\n                type: 'return',\n                value: ret\n            };\n        }));\n        code = [\n            'function(){',\n            'var context = this, refs = context.formula.absrefs',\n            code,\n            '}'\n        ].join(';\\n');\n        formula = new runtime.Formula(exp.refs, makeClosure(code), printer, exp.sheet, exp.row, exp.col);\n        FORMULA_CACHE[hash] = formula;\n        return formula;\n        function js(node) {\n            var type = node.type;\n            if (type == 'num') {\n                return node.value + '';\n            } else if (type == 'str') {\n                return JSON.stringify(node.value);\n            } else if (type == 'return') {\n                return 'context.resolve(' + js(node.value) + ')';\n            } else if (type == 'func') {\n                return 'context.func(' + JSON.stringify(node.func) + ', ' + js(node.args[0]) + ', ' + jsArray(node.args.slice(1)) + ')';\n            } else if (type == 'call') {\n                return js(node.func) + '(' + node.args.map(js).join(', ') + ')';\n            } else if (type == 'ref') {\n                return 'refs[' + node.index + ']';\n            } else if (type == 'bool') {\n                return '' + node.value;\n            } else if (type == 'if') {\n                return '(context.bool(' + js(node.co) + ') ? ' + js(node.th) + ' : ' + js(node.el) + ')';\n            } else if (type == 'lambda') {\n                return '(function(' + node.vars.join(', ') + '){ return(' + js(node.body) + ') })';\n            } else if (type == 'var') {\n                return node.name;\n            } else if (type == 'matrix') {\n                return jsArray(node.value);\n            } else if (type == 'null') {\n                return 'null';\n            } else {\n                throw new Error('Cannot compile expression ' + type);\n            }\n        }\n        function jsArray(a) {\n            return '[ ' + a.map(js).join(', ') + ' ]';\n        }\n    }\n    function identity(x) {\n        return x;\n    }\n    function TokenStream(input, options) {\n        input = RawTokenStream(InputStream(input), options);\n        var ahead = input.ahead;\n        var skip = input.skip;\n        var token = null;\n        var fixCell = options.row != null && options.col != null ? function (cell) {\n            if (cell.rel & 1) {\n                cell.col -= options.col;\n            }\n            if (cell.rel & 2) {\n                cell.row -= options.row;\n            }\n            return cell;\n        } : identity;\n        var addPos = options.forEditor ? function (thing, startToken, endToken) {\n            thing.begin = startToken.begin;\n            thing.end = endToken.end;\n            return thing;\n        } : identity;\n        return {\n            peek: peek,\n            next: next,\n            croak: input.croak,\n            eof: input.eof,\n            is: is\n        };\n        function is(type, value) {\n            var tok = peek();\n            return tok != null && (type == null || tok.type === type) && (value == null || tok.value === value) ? tok : null;\n        }\n        function peek() {\n            if (token == null) {\n                token = readNext();\n            }\n            return token;\n        }\n        function next() {\n            if (token != null) {\n                var tmp = token;\n                token = null;\n                return tmp;\n            }\n            return readNext();\n        }\n        function readNext() {\n            var ret;\n            var t = input.peek();\n            if (t) {\n                if (t.type == 'sym' || t.type == 'rc' || t.type == 'num') {\n                    ret = ahead(8, refRange3D) || ahead(6, refCell3D) || ahead(6, refSheetRange) || ahead(4, refSheetCell) || ahead(4, refRange) || ahead(2, refCell) || ahead(2, funcall);\n                }\n                if (!ret) {\n                    ret = input.next();\n                }\n            }\n            return ret;\n        }\n        function toCell(tok, isFirst) {\n            if (tok.type == 'rc') {\n                if (tok.rel && !options.forEditor && (options.row == null || options.col == null)) {\n                    input.croak('Cannot read relative cell in RC notation');\n                }\n                return new CellRef(tok.row, tok.col, tok.rel);\n            }\n            if (tok.type == 'num') {\n                if (tok.value <= 1048577) {\n                    return fixCell(new CellRef(getrow(tok.value), isFirst ? -Infinity : +Infinity, 2));\n                } else {\n                    return null;\n                }\n            }\n            var name = tok.value;\n            var m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name);\n            if (m) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row <= 1048576 && col <= 16383) {\n                    return fixCell(new CellRef(getrow(m[4]), getcol(m[2]), (m[1] ? 0 : 1) | (m[3] ? 0 : 2)));\n                } else {\n                    return null;\n                }\n            }\n            var abs = name.charAt(0) == '$';\n            if (abs) {\n                name = name.substr(1);\n            }\n            if (/^\\d+$/.test(name)) {\n                var row = getrow(name);\n                if (row <= 1048576) {\n                    return fixCell(new CellRef(getrow(name), isFirst ? -Infinity : +Infinity, abs ? 0 : 2));\n                }\n            } else {\n                var col = getcol(name);\n                if (col <= 16383) {\n                    return fixCell(new CellRef(isFirst ? -Infinity : +Infinity, getcol(name), abs ? 0 : 1));\n                }\n            }\n        }\n        function refRange3D(a, b, c, d, e, f, g, h) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && f.type == 'op' && f.value == ':' && (g.type == 'sym' || g.type == 'rc' || g.type == 'num' && g.value == g.value | 0) && g.type == e.type && !(h.type == 'punc' && h.value == '(' && !g.space)) {\n                var tl = toCell(e, true), br = toCell(g, false);\n                if (tl && br) {\n                    skip(7);\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, g);\n                }\n            }\n        }\n        function refCell3D(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(e);\n                if (tl) {\n                    skip(5);\n                    var br = tl.clone();\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetRange(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && d.type == 'op' && d.value == ':' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(c, true), br = toCell(e, false);\n                if (tl && br) {\n                    skip(5);\n                    return addPos(new RangeRef(tl, br).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetCell(a, b, c, d) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                skip(3);\n                var x = toCell(c);\n                if (!x) {\n                    x = new NameRef(c.value);\n                }\n                return addPos(x.setSheet(a.value, true), a, c);\n            }\n        }\n        function refRange(a, b, c, d) {\n            if ((a.type == 'sym' || a.type == 'rc' || a.type == 'num' && a.value == a.value | 0) && (b.type == 'op' && b.value == ':') && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                var tl = toCell(a, true), br = toCell(c, false);\n                if (tl && br) {\n                    skip(3);\n                    return addPos(new RangeRef(tl, br), a, c);\n                }\n            }\n        }\n        function refCell(a, b) {\n            if ((a.type == 'sym' || a.type == 'rc') && !(b.type == 'punc' && b.value == '(' && !a.space)) {\n                var x = toCell(a);\n                if (x && isFinite(x.row) && isFinite(x.col)) {\n                    skip(1);\n                    return addPos(x, a, a);\n                }\n            }\n        }\n        function funcall(a, b) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '(' && !a.space) {\n                a.type = 'func';\n                skip(1);\n                return a;\n            }\n        }\n    }\n    function RawTokenStream(input, options) {\n        var tokens = [], index = 0;\n        var readWhile = input.readWhile;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: input.croak,\n            ahead: ahead,\n            skip: skip\n        };\n        function isDigit(ch) {\n            return /[0-9]/i.test(ch);\n        }\n        function isIdStart(ch) {\n            return /[a-z$_]/i.test(ch) || ch.toLowerCase() != ch.toUpperCase();\n        }\n        function isId(ch) {\n            return isIdStart(ch) || isDigit(ch) || ch == '.';\n        }\n        function isOpChar(ch) {\n            return ch in OPERATORS;\n        }\n        function isPunc(ch) {\n            return '!;(){}[]'.indexOf(ch) >= 0;\n        }\n        function isWhitespace(ch) {\n            return ' \\t\\n\\xA0'.indexOf(ch) >= 0;\n        }\n        function readNumber() {\n            var has_dot = false;\n            var number = readWhile(function (ch) {\n                if (ch == '.') {\n                    if (has_dot) {\n                        return false;\n                    }\n                    has_dot = true;\n                    return true;\n                }\n                return isDigit(ch);\n            });\n            return {\n                type: 'num',\n                value: parseFloat(number)\n            };\n        }\n        function symbol(id, quote) {\n            return {\n                type: 'sym',\n                value: id,\n                upper: id.toUpperCase(),\n                space: isWhitespace(input.peek()),\n                quote: quote\n            };\n        }\n        function getRC(a, b, c) {\n            if (!a && !c || a && c) {\n                var negative = a && /-$/.test(a);\n                var num = parseInt(b, 10);\n                if (negative) {\n                    num = -num;\n                }\n                if (!a) {\n                    num--;\n                }\n                return num;\n            }\n        }\n        function readSymbol() {\n            var m = input.lookingAt(/^R(\\[-?)?([0-9]+)(\\])?C(\\[-?)?([0-9]+)(\\])?/i);\n            if (m) {\n                var row = getRC(m[1], m[2], m[3]);\n                var col = getRC(m[4], m[5], m[6]);\n                if (row != null && col != null) {\n                    input.skip(m);\n                    return {\n                        type: 'rc',\n                        row: row,\n                        col: col,\n                        rel: (m[4] ? 1 : 0) | (m[1] ? 2 : 0)\n                    };\n                }\n            }\n            return symbol(readWhile(isId));\n        }\n        function readString() {\n            input.next();\n            return {\n                type: 'str',\n                value: input.readEscaped('\"')\n            };\n        }\n        function readSheetName() {\n            input.next();\n            return symbol(input.readEscaped('\\''), true);\n        }\n        function readOperator() {\n            return {\n                type: 'op',\n                value: readWhile(function (ch, op) {\n                    return op + ch in OPERATORS;\n                })\n            };\n        }\n        function readPunc() {\n            return {\n                type: 'punc',\n                value: input.next()\n            };\n        }\n        function readNext() {\n            if (input.eof()) {\n                return null;\n            }\n            var ch = input.peek(), m;\n            if (ch == '\"') {\n                return readString();\n            }\n            if (ch == '\\'') {\n                return readSheetName();\n            }\n            if (isDigit(ch)) {\n                return readNumber();\n            }\n            if (isIdStart(ch)) {\n                return readSymbol();\n            }\n            if (isOpChar(ch)) {\n                return readOperator();\n            }\n            if (isPunc(ch)) {\n                return readPunc();\n            }\n            if (m = input.lookingAt(/^#([a-z\\/]+)[?!]/i)) {\n                input.skip(m);\n                return {\n                    type: 'error',\n                    value: m[1]\n                };\n            }\n            if (!options.forEditor) {\n                input.croak('Can\\'t handle character: ' + ch);\n            }\n            return {\n                type: 'error',\n                value: input.next()\n            };\n        }\n        function peek() {\n            while (tokens.length <= index) {\n                readWhile(isWhitespace);\n                var begin = input.pos();\n                var tok = readNext();\n                if (options.forEditor && tok) {\n                    tok.begin = begin;\n                    tok.end = input.pos();\n                }\n                tokens.push(tok);\n            }\n            return tokens[index];\n        }\n        function next() {\n            var tok = peek();\n            if (tok) {\n                index++;\n            }\n            return tok;\n        }\n        function ahead(n, f) {\n            var pos = index, a = [];\n            while (n-- > 0) {\n                a.push(next() || EOF);\n            }\n            index = pos;\n            return f.apply(a, a);\n        }\n        function skip(n) {\n            index += n;\n        }\n        function eof() {\n            return peek() == null;\n        }\n    }\n    var EOF = { type: 'eof' };\n    function InputStream(input) {\n        var pos = 0, line = 1, col = 0;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: croak,\n            readWhile: readWhile,\n            readEscaped: readEscaped,\n            lookingAt: lookingAt,\n            skip: skip,\n            forward: forward,\n            pos: location\n        };\n        function location() {\n            return pos;\n        }\n        function next() {\n            var ch = input.charAt(pos++);\n            if (ch == '\\n') {\n                line++;\n                col = 0;\n            } else {\n                col++;\n            }\n            return ch;\n        }\n        function peek() {\n            return input.charAt(pos);\n        }\n        function eof() {\n            return peek() === '';\n        }\n        function croak(msg) {\n            throw new ParseError(msg, pos);\n        }\n        function skip(ch) {\n            if (typeof ch == 'string') {\n                if (input.substr(pos, ch.length) != ch) {\n                    croak('Expected ' + ch);\n                }\n                forward(ch.length);\n            } else if (ch instanceof RegExp) {\n                var m = ch.exec(input.substr(pos));\n                if (m) {\n                    forward(m[0].length);\n                    return m;\n                }\n            } else {\n                forward(ch[0].length);\n            }\n        }\n        function forward(n) {\n            while (n-- > 0) {\n                next();\n            }\n        }\n        function readEscaped(end) {\n            var escaped = false, str = '';\n            while (!eof()) {\n                var ch = next();\n                if (escaped) {\n                    str += ch;\n                    escaped = false;\n                } else if (ch == '\\\\') {\n                    escaped = true;\n                } else if (ch == end) {\n                    break;\n                } else {\n                    str += ch;\n                }\n            }\n            return str;\n        }\n        function readWhile(predicate) {\n            var str = '';\n            while (!eof() && predicate(peek(), str)) {\n                str += next();\n            }\n            return str;\n        }\n        function lookingAt(rx) {\n            return rx.exec(input.substr(pos));\n        }\n    }\n    exports.parse = function (sheet, row, col, input) {\n        if (input instanceof Date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(input)\n            };\n        }\n        if (typeof input == 'number') {\n            return {\n                type: 'number',\n                value: input\n            };\n        }\n        if (typeof input == 'boolean') {\n            return {\n                type: 'boolean',\n                value: input\n            };\n        }\n        input += '';\n        if (/^'/.test(input)) {\n            return {\n                type: 'string',\n                value: input.substr(1)\n            };\n        }\n        if (/^[0-9.]+%$/.test(input)) {\n            var str = input.substr(0, input.length - 1);\n            var num = parseFloat(str);\n            if (!isNaN(num) && num == str) {\n                return {\n                    type: 'percent',\n                    value: num / 100\n                };\n            }\n        }\n        if (/^=/.test(input)) {\n            input = input.substr(1);\n            if (/\\S/.test(input)) {\n                return parseFormula(sheet, row, col, input);\n            } else {\n                return {\n                    type: 'string',\n                    value: '=' + input\n                };\n            }\n        }\n        if (input.toLowerCase() == 'true') {\n            return {\n                type: 'boolean',\n                value: true\n            };\n        }\n        if (input.toLowerCase() == 'false') {\n            return {\n                type: 'boolean',\n                value: false\n            };\n        }\n        var date = runtime.parseDate(input);\n        if (date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(date)\n            };\n        }\n        var num = parseFloat(input);\n        if (!isNaN(num) && input.length > 0 && num == input) {\n            return {\n                type: 'number',\n                value: num\n            };\n        }\n        return {\n            type: 'string',\n            value: input\n        };\n    };\n    function tokenize(input, row, col) {\n        var tokens = [];\n        input = TokenStream(input, {\n            forEditor: true,\n            row: row,\n            col: col\n        });\n        while (!input.eof()) {\n            tokens.push(next());\n        }\n        var tok = tokens[0];\n        if (tok.type == 'op' && tok.value == '=') {\n            tok.type = 'startexp';\n        }\n        return tokens;\n        function next() {\n            var tok = input.next();\n            if (tok.type == 'sym') {\n                if (tok.upper == 'TRUE') {\n                    tok.type = 'bool';\n                    tok.value = true;\n                } else if (tok.upper == 'FALSE') {\n                    tok.type = 'bool';\n                    tok.value = false;\n                }\n            } else if (tok.type == 'ref') {\n                tok = {\n                    type: 'ref',\n                    ref: row != null && col != null ? tok.absolute(row, col) : tok,\n                    begin: tok.begin,\n                    end: tok.end\n                };\n            }\n            return tok;\n        }\n    }\n    exports.parseFormula = parseFormula;\n    exports.parseReference = parseReference;\n    exports.compile = makeFormula;\n    exports.InputStream = InputStream;\n    exports.ParseError = ParseError;\n    exports.tokenize = tokenize;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/excel-reader', [\n        'kendo.core',\n        'kendo.color',\n        'util/parse-xml',\n        'spreadsheet/calc'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var $ = kendo.jQuery;\n    var parseXML = kendo.util.parseXML;\n    var parseReference = kendo.spreadsheet.calc.parseReference;\n    function readExcel(file, workbook, deferred) {\n        var reader = new FileReader();\n        reader.onload = function (e) {\n            var zip = new JSZip(e.target.result);\n            readWorkbook(zip, workbook, deferred);\n        };\n        reader.readAsArrayBuffer(file);\n    }\n    var SEL_CELL = [\n        'sheetData',\n        'row',\n        'c'\n    ];\n    var SEL_COL = [\n        'cols',\n        'col'\n    ];\n    var SEL_DEFINED_NAME = [\n        'definedNames',\n        'definedName'\n    ];\n    var SEL_FORMULA = [\n        'sheetData',\n        'row',\n        'c',\n        'f'\n    ];\n    var SEL_MERGE = [\n        'mergeCells',\n        'mergeCell'\n    ];\n    var SEL_PANE = [\n        'sheetViews',\n        'sheetView',\n        'pane'\n    ];\n    var SEL_ROW = [\n        'sheetData',\n        'row'\n    ];\n    var SEL_SELECTION = [\n        'sheetViews',\n        'sheetView',\n        'selection'\n    ];\n    var SEL_SHEET = [\n        'sheets',\n        'sheet'\n    ];\n    var SEL_STRING = [\n        'sheetData',\n        'row',\n        'c',\n        'is'\n    ];\n    var SEL_TEXT = ['t'];\n    var SEL_SHARED_STRING = ['si'];\n    var SEL_VALUE = [\n        'sheetData',\n        'row',\n        'c',\n        'v'\n    ];\n    var SEL_VIEW = [\n        'bookViews',\n        'workbookView'\n    ];\n    var SEL_SHEET_VIEW = [\n        'sheetViews',\n        'sheetView'\n    ];\n    function readWorkbook(zip, workbook, deferred) {\n        var strings = readStrings(zip);\n        var relationships = readRelationships(zip, 'workbook.xml');\n        var theme = readTheme(zip, relationships.byType.theme[0]);\n        var styles = readStyles(zip, theme);\n        var items = [];\n        var activeSheet = 0;\n        parse(zip, 'xl/workbook.xml', {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_SHEET)) {\n                    var relId = attrs['r:id'];\n                    var file = relationships.byId[relId];\n                    var name = attrs.name;\n                    var dim = sheetDimensions(zip, file);\n                    items.push({\n                        workbook: workbook,\n                        zip: zip,\n                        strings: strings,\n                        styles: styles,\n                        file: file,\n                        options: {\n                            name: name,\n                            rows: Math.max(workbook.options.rows || 0, dim.rows),\n                            columns: Math.max(workbook.options.columns || 0, dim.cols),\n                            columnWidth: dim.columnWidth,\n                            rowHeight: dim.rowHeight\n                        }\n                    });\n                } else if (this.is(SEL_VIEW)) {\n                    if (attrs.activeTab) {\n                        activeSheet = integer(attrs.activeTab);\n                    }\n                }\n            },\n            text: function (text) {\n                var attrs = this.is(SEL_DEFINED_NAME);\n                if (attrs && !(bool(attrs['function']) || bool(attrs.vbProcedure))) {\n                    var ref = parseReference(text, true);\n                    workbook.defineName(attrs.name, ref, bool(attrs.hidden));\n                }\n            }\n        });\n        loadSheets(items, workbook, deferred).then(function () {\n            var sheets = workbook.sheets();\n            recalcSheets(sheets);\n            workbook.activeSheet(sheets[activeSheet]);\n        });\n    }\n    function loadSheets(items, workbook, deferred) {\n        var ready = new $.Deferred().resolve();\n        for (var i = 0; i < items.length; i++) {\n            (function (entry, i) {\n                ready = ready.then(function () {\n                    var sheet = workbook.insertSheet(entry.options);\n                    sheet.suspendChanges(true);\n                    var promise = queueSheet(sheet, entry);\n                    if (deferred) {\n                        var args = {\n                            sheet: sheet,\n                            progress: i / (items.length - 1)\n                        };\n                        promise.then(function () {\n                            deferred.notify(args);\n                        });\n                    }\n                    return promise;\n                });\n            }(items[i], i));\n        }\n        if (deferred) {\n            ready.then(function () {\n                deferred.resolve();\n            });\n        }\n        return ready;\n    }\n    function queueSheet(sheet, ctx) {\n        var deferred = new $.Deferred();\n        setTimeout(function () {\n            readSheet(ctx.zip, ctx.file, sheet, ctx.strings, ctx.styles);\n            deferred.resolve();\n        }, 0);\n        return deferred;\n    }\n    function recalcSheets(sheets) {\n        for (var i = 0; i < sheets.length; i++) {\n            sheets[i].suspendChanges(false).triggerChange({ recalc: true });\n        }\n    }\n    function sheetDimensions(zip, file) {\n        var dim = {\n            rows: 0,\n            cols: 0\n        };\n        parse(zip, 'xl/' + file, {\n            enter: function (tag, attrs) {\n                if (tag == 'dimension') {\n                    var ref = parseReference(attrs.ref);\n                    if (ref.bottomRight) {\n                        dim.cols = ref.bottomRight.col + 1;\n                        dim.rows = ref.bottomRight.row + 1;\n                    }\n                } else if (tag === 'sheetFormatPr') {\n                    if (attrs.defaultColWidth) {\n                        dim.columnWidth = toColWidth(parseFloat(attrs.defaultColWidth));\n                    }\n                    if (attrs.defaultRowHeight) {\n                        dim.rowHeight = toRowHeight(parseFloat(attrs.defaultRowHeight));\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    this.exit();\n                }\n            }\n        });\n        return dim;\n    }\n    function toColWidth(size) {\n        var maximumDigitWidth = 7;\n        var fraction = (256 * size + Math.floor(128 / maximumDigitWidth)) / 256;\n        return Math.floor(fraction) * maximumDigitWidth;\n    }\n    function toRowHeight(pts) {\n        return pts * 1.5625;\n    }\n    function readSheet(zip, file, sheet, strings, styles) {\n        var ref, type, value, formula, formulaRange;\n        var nCols = sheet._columns._count;\n        parse(zip, 'xl/' + file, {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_CELL)) {\n                    value = null;\n                    formula = null;\n                    formulaRange = null;\n                    ref = attrs.r;\n                    type = attrs.t;\n                    var styleIndex = attrs.s;\n                    if (styleIndex != null) {\n                        applyStyle(sheet, ref, styles, styleIndex);\n                    }\n                } else if (this.is(SEL_MERGE)) {\n                    sheet.range(attrs.ref).merge();\n                } else if (this.is(SEL_COL)) {\n                    var start = integer(attrs.min) - 1;\n                    var stop = Math.min(nCols, integer(attrs.max)) - 1;\n                    if (attrs.width) {\n                        var width = toColWidth(parseFloat(attrs.width));\n                        sheet._columns.values.value(start, stop, width);\n                    }\n                    if (attrs.hidden === '1') {\n                        for (var ci = start; ci <= stop; ci++) {\n                            sheet.hideColumn(ci);\n                        }\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    var row = integer(attrs.r) - 1;\n                    if (attrs.ht) {\n                        var height = toRowHeight(parseFloat(attrs.ht));\n                        sheet._rows.values.value(row, row, height);\n                    }\n                    if (attrs.hidden === '1') {\n                        sheet.hideRow(row);\n                    }\n                } else if (this.is(SEL_SELECTION)) {\n                    if (attrs.activeCell) {\n                        var acRef = parseReference(attrs.activeCell);\n                        sheet.select(acRef, true);\n                    }\n                } else if (this.is(SEL_PANE)) {\n                    if (attrs.state == 'frozen') {\n                        if (attrs.xSplit) {\n                            sheet.frozenColumns(integer(attrs.xSplit));\n                        }\n                        if (attrs.ySplit) {\n                            sheet.frozenRows(integer(attrs.ySplit));\n                        }\n                    }\n                } else if (this.is(SEL_SHEET_VIEW)) {\n                    sheet.options.showGridLines = bool(attrs.showGridLines, true);\n                }\n            },\n            leave: function (tag) {\n                if (this.is(SEL_CELL)) {\n                    if (formula != null) {\n                        try {\n                            sheet.range(formulaRange || ref).formula(formula);\n                        } catch (ex) {\n                            sheet.range(formulaRange || ref).value(formula).background('#ffaaaa');\n                        }\n                    } else if (value != null) {\n                        var range = sheet.range(ref);\n                        if (type == 'str') {\n                            range.formula(value);\n                        } else if (!range._get('formula')) {\n                            if (!type || type == 'n') {\n                                value = parseFloat(value);\n                            } else if (type == 's') {\n                                value = strings[integer(value)];\n                            } else if (type == 'b') {\n                                value = value === '1';\n                            } else if (type == 'd') {\n                                value = kendo.parseDate(value);\n                            }\n                            range.value(value);\n                        }\n                    }\n                } else if (tag == 'cols') {\n                    sheet._columns._refresh();\n                } else if (tag == 'sheetData') {\n                    sheet._rows._refresh();\n                }\n            },\n            text: function (text) {\n                var attrs;\n                if (this.is(SEL_VALUE) || this.is(SEL_STRING)) {\n                    value = text;\n                } else if (attrs = this.is(SEL_FORMULA)) {\n                    formula = text;\n                    if (attrs.t == 'shared') {\n                        formulaRange = attrs.ref;\n                    }\n                }\n            }\n        });\n    }\n    var BORDER_WIDTHS = {\n        'none': 0,\n        'thin': 1,\n        'medium': 2,\n        'dashed': 1,\n        'dotted': 1,\n        'thick': 3,\n        'double': 3,\n        'hair': 1,\n        'mediumDashed': 2,\n        'dashDot': 1,\n        'mediumDashDot': 2,\n        'dashDotDot': 1,\n        'mediumDashDotDot': 2,\n        'slantDashDot': 1\n    };\n    var DEFAULT_FORMATS = {\n        0: 'General',\n        1: '0',\n        2: '0.00',\n        3: '#,##0',\n        4: '#,##0.00',\n        9: '0%',\n        10: '0.00%',\n        11: '0.00E+00',\n        12: '# ?/?',\n        13: '# ??/??',\n        14: 'mm-dd-yy',\n        15: 'd-mmm-yy',\n        16: 'd-mmm',\n        17: 'mmm-yy',\n        18: 'h:mm AM/PM',\n        19: 'h:mm:ss AM/PM',\n        20: 'h:mm',\n        21: 'h:mm:ss',\n        22: 'm/d/yy h:mm',\n        37: '#,##0 ;(#,##0)',\n        38: '#,##0 ;[Red](#,##0)',\n        39: '#,##0.00;(#,##0.00)',\n        40: '#,##0.00;[Red](#,##0.00)',\n        45: 'mm:ss',\n        46: '[h]:mm:ss',\n        47: 'mmss.0',\n        48: '##0.0E+0',\n        49: '@'\n    };\n    function applyStyle(sheet, ref, styles, styleIndex) {\n        var range = sheet.range(ref);\n        var xf = styles.inlineStyles[styleIndex], base, value;\n        if (xf.xfId) {\n            base = styles.namedStyles[xf.xfId];\n        }\n        if (shouldSet('applyBorder', 'borderId')) {\n            setBorder(styles.borders[value]);\n        }\n        if (shouldSet('applyFont', 'fontId')) {\n            setFont(styles.fonts[value]);\n        }\n        if (shouldSet('applyAlignment', 'textAlign')) {\n            range.textAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'verticalAlign')) {\n            range.verticalAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'wrapText')) {\n            range._property('wrap', value);\n        }\n        if (shouldSet('applyFill', 'fillId')) {\n            setFill(styles.fills[value]);\n        }\n        if (shouldSet('applyNumberFormat', 'numFmtId')) {\n            setFormat(styles.numFmts[value] || DEFAULT_FORMATS[value]);\n        }\n        function setFormat(f) {\n            var format = typeof f == 'string' ? f : f.formatCode;\n            if (format != null && !/^general$/i.test(format)) {\n                format = format.replace(/^\\[\\$-[0-9]+\\]/, '');\n                range.format(format);\n            }\n        }\n        function setFill(f) {\n            if (f.type == 'solid') {\n                range.background(f.color);\n            }\n        }\n        function setFont(f) {\n            range.fontFamily(f.name);\n            range._property('fontSize', f.size);\n            if (f.bold) {\n                range.bold(true);\n            }\n            if (f.italic) {\n                range.italic(true);\n            }\n        }\n        function setBorder(b) {\n            function set(side, prop) {\n                var border = b[side];\n                if (!border) {\n                    return;\n                }\n                var width = BORDER_WIDTHS[border.style];\n                if (width === 0) {\n                    return;\n                }\n                var color = border.color;\n                if (color == null) {\n                    color = '#000';\n                }\n                range._property(prop, {\n                    size: width,\n                    color: color\n                });\n            }\n            set('left', 'borderLeft');\n            set('top', 'borderTop');\n            set('right', 'borderRight');\n            set('bottom', 'borderBottom');\n        }\n        function shouldSet(applyName, propName) {\n            var t = xf[applyName];\n            if (t != null && !t) {\n                return false;\n            }\n            value = xf[propName];\n            if (base && value == null) {\n                t = base[applyName];\n                if (t != null && !t) {\n                    return false;\n                }\n                value = base[propName];\n            }\n            return value != null;\n        }\n    }\n    function parse(zip, file, callbacks) {\n        var part = zip.files[file];\n        if (part) {\n            parseXML(part.asUint8Array(), callbacks);\n        }\n    }\n    function readStrings(zip) {\n        var strings = [];\n        var current;\n        parse(zip, 'xl/sharedStrings.xml', {\n            enter: function () {\n                if (this.is(SEL_SHARED_STRING)) {\n                    current = '';\n                }\n            },\n            leave: function () {\n                if (this.is(SEL_SHARED_STRING)) {\n                    strings.push(current);\n                }\n            },\n            text: function (text) {\n                if (this.is(SEL_TEXT)) {\n                    current += text;\n                }\n            }\n        });\n        return strings;\n    }\n    function readRelationships(zip, file) {\n        var map = {\n            byId: {},\n            byType: { theme: [] }\n        };\n        parse(zip, 'xl/_rels/' + file + '.rels', {\n            enter: function (tag, attrs) {\n                if (tag == 'Relationship') {\n                    map.byId[attrs.Id] = attrs.Target;\n                    var type = attrs.Type.match(/\\w+$/)[0];\n                    var entries = map.byType[type] || [];\n                    entries.push(attrs.Target);\n                    map.byType[type] = entries;\n                }\n            }\n        });\n        return map;\n    }\n    var SEL_BORDER = [\n        'borders',\n        'border'\n    ];\n    var SEL_FILL = [\n        'fills',\n        'fill'\n    ];\n    var SEL_FONT = [\n        'fonts',\n        'font'\n    ];\n    var SEL_INLINE_STYLE = [\n        'cellXfs',\n        'xf'\n    ];\n    var SEL_NAMED_STYLE = [\n        'cellStyleXfs',\n        'xf'\n    ];\n    var SEL_NUM_FMT = [\n        'numFmts',\n        'numFmt'\n    ];\n    var INDEXED_COLORS = [\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008000'),\n        toCSSColor('FF000080'),\n        toCSSColor('FF808000'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF008080'),\n        toCSSColor('FFC0C0C0'),\n        toCSSColor('FF808080'),\n        toCSSColor('FF9999FF'),\n        toCSSColor('FF993366'),\n        toCSSColor('FFFFFFCC'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FF660066'),\n        toCSSColor('FFFF8080'),\n        toCSSColor('FF0066CC'),\n        toCSSColor('FFCCCCFF'),\n        toCSSColor('FF000080'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008080'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FF00CCFF'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FFCCFFCC'),\n        toCSSColor('FFFFFF99'),\n        toCSSColor('FF99CCFF'),\n        toCSSColor('FFFF99CC'),\n        toCSSColor('FFCC99FF'),\n        toCSSColor('FFFFCC99'),\n        toCSSColor('FF3366FF'),\n        toCSSColor('FF33CCCC'),\n        toCSSColor('FF99CC00'),\n        toCSSColor('FFFFCC00'),\n        toCSSColor('FFFF9900'),\n        toCSSColor('FFFF6600'),\n        toCSSColor('FF666699'),\n        toCSSColor('FF969696'),\n        toCSSColor('FF003366'),\n        toCSSColor('FF339966'),\n        toCSSColor('FF003300'),\n        toCSSColor('FF333300'),\n        toCSSColor('FF993300'),\n        toCSSColor('FF993366'),\n        toCSSColor('FF333399'),\n        toCSSColor('FF333333'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF')\n    ];\n    function readStyles(zip, theme) {\n        var styles = {\n            fonts: [],\n            numFmts: {},\n            fills: [],\n            borders: [],\n            namedStyles: [],\n            inlineStyles: []\n        };\n        var font = null;\n        var fill = null;\n        var border = null;\n        var xf = null;\n        parse(zip, 'xl/styles.xml', {\n            enter: function (tag, attrs, closed) {\n                if (this.is(SEL_NUM_FMT)) {\n                    styles.numFmts[attrs.numFmtId] = attrs;\n                } else if (this.is(SEL_FONT)) {\n                    styles.fonts.push(font = {});\n                } else if (font) {\n                    if (tag == 'sz') {\n                        font.size = parseFloat(attrs.val);\n                    } else if (tag == 'name') {\n                        font.name = attrs.val;\n                    } else if (tag == 'b') {\n                        font.bold = bool(attrs.val, true);\n                    } else if (tag == 'i') {\n                        font.italic = bool(attrs.val, true);\n                    }\n                } else if (this.is(SEL_FILL)) {\n                    styles.fills.push(fill = {});\n                } else if (fill) {\n                    if (tag == 'patternFill') {\n                        fill.type = attrs.patternType;\n                    } else if (tag == 'fgColor' && fill.type === 'solid') {\n                        fill.color = getColor(attrs);\n                    } else if (tag == 'bgColor' && fill.type !== 'solid') {\n                        fill.color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_BORDER)) {\n                    styles.borders.push(border = {});\n                } else if (border) {\n                    if (/^(?:left|top|right|bottom)$/.test(tag) && attrs.style) {\n                        border[tag] = { style: attrs.style };\n                    }\n                    if (tag == 'color') {\n                        var side = this.stack[this.stack.length - 2].$tag;\n                        border[side].color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_NAMED_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.namedStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (this.is(SEL_INLINE_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.inlineStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (xf) {\n                    if (tag == 'alignment') {\n                        if (/^(?:left|center|right|justify)$/.test(attrs.horizontal)) {\n                            xf.textAlign = attrs.horizontal;\n                        }\n                        if (/^(?:top|center|bottom)$/.test(attrs.vertical)) {\n                            xf.verticalAlign = attrs.vertical;\n                        }\n                        if (attrs.wrapText != null) {\n                            xf.wrapText = bool(attrs.wrapText);\n                        }\n                    }\n                }\n            },\n            leave: function (tag) {\n                if (this.is(SEL_FONT)) {\n                    font = null;\n                } else if (this.is(SEL_FILL)) {\n                    fill = null;\n                } else if (this.is(SEL_BORDER)) {\n                    border = null;\n                } else if (tag == 'xf') {\n                    xf = null;\n                }\n            }\n        });\n        function getXf(attrs) {\n            var xf = {\n                borderId: integer(attrs.borderId),\n                fillId: integer(attrs.fillId),\n                fontId: integer(attrs.fontId),\n                numFmtId: integer(attrs.numFmtId),\n                pivotButton: bool(attrs.pivotButton),\n                quotePrefix: bool(attrs.quotePrefix),\n                xfId: integer(attrs.xfId)\n            };\n            addBool('applyAlignment');\n            addBool('applyBorder');\n            addBool('applyFill');\n            addBool('applyFont');\n            addBool('applyNumberFormat');\n            addBool('applyProtection');\n            function addBool(name) {\n                if (attrs[name] != null) {\n                    xf[name] = bool(attrs[name]);\n                }\n            }\n            return xf;\n        }\n        function getColor(attrs) {\n            if (attrs.rgb) {\n                return toCSSColor(attrs.rgb);\n            } else if (attrs.indexed) {\n                return INDEXED_COLORS[integer(attrs.indexed)];\n            } else if (attrs.theme) {\n                var themeColor = theme.colorScheme[integer(attrs.theme)];\n                var color = kendo.parseColor(themeColor);\n                if (attrs.tint) {\n                    color = color.toHSL();\n                    var tint = parseFloat(attrs.tint);\n                    if (tint < 0) {\n                        color.l = color.l * (1 + tint);\n                    } else {\n                        color.l = color.l * (1 - tint) + (100 - 100 * (1 - tint));\n                    }\n                }\n                return color.toCssRgba();\n            }\n        }\n        return styles;\n    }\n    var SEL_SCHEME_RGBCLR = [\n        'a:clrScheme',\n        '*',\n        'a:srgbClr'\n    ];\n    var SEL_SCHEME_SYSCLR = [\n        'a:clrScheme',\n        '*',\n        'a:sysClr'\n    ];\n    function readTheme(zip, rel) {\n        var scheme = [];\n        var theme = { colorScheme: scheme };\n        var file = 'xl/' + rel;\n        if (zip.files[file]) {\n            parse(zip, file, {\n                enter: function (tag, attrs) {\n                    if (this.is(SEL_SCHEME_SYSCLR)) {\n                        scheme.push(toCSSColor(attrs.val == 'window' ? 'FFFFFFFF' : 'FF000000'));\n                    } else if (this.is(SEL_SCHEME_RGBCLR)) {\n                        scheme.push(toCSSColor('FF' + attrs.val));\n                    }\n                }\n            });\n            if (scheme.length > 3) {\n                swap(scheme, 0, 1);\n                swap(scheme, 2, 3);\n            }\n        }\n        function swap(arr, a, b) {\n            var tmp = arr[a];\n            arr[a] = arr[b];\n            arr[b] = tmp;\n        }\n        return theme;\n    }\n    function integer(val) {\n        return val == null ? null : parseInt(val, 10);\n    }\n    function bool(val, def) {\n        if (val == null) {\n            return def;\n        }\n        return val == 'true' || val === true || val == 1;\n    }\n    function toCSSColor(rgb) {\n        var m = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(rgb);\n        return 'rgba(' + parseInt(m[2], 16) + ', ' + parseInt(m[3], 16) + ', ' + parseInt(m[4], 16) + ', ' + parseInt(m[1], 16) / 255 + ')';\n    }\n    kendo.spreadsheet.readExcel = readExcel;\n    kendo.spreadsheet._readSheet = readSheet;\n    kendo.spreadsheet._readStrings = readStrings;\n    kendo.spreadsheet._readStyles = readStyles;\n    kendo.spreadsheet._readTheme = readTheme;\n    kendo.spreadsheet._readWorkbook = readWorkbook;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/workbook', [\n        'kendo.core',\n        'spreadsheet/runtime',\n        'spreadsheet/references',\n        'spreadsheet/excel-reader'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Workbook = kendo.Observable.extend({\n            init: function (options, view) {\n                kendo.Observable.fn.init.call(this);\n                this.options = options;\n                this._view = view;\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._sheet = this.insertSheet({\n                    rows: this.options.rows,\n                    columns: this.options.columns,\n                    rowHeight: this.options.rowHeight,\n                    columnWidth: this.options.columnWidth,\n                    headerHeight: this.options.headerHeight,\n                    headerWidth: this.options.headerWidth,\n                    dataSource: this.options.dataSource\n                });\n                this.undoRedoStack = new kendo.util.UndoRedoStack();\n                this.undoRedoStack.bind([\n                    'undo',\n                    'redo'\n                ], this._onUndoRedo.bind(this));\n                this._context = new kendo.spreadsheet.FormulaContext(this);\n                this._validationContext = new kendo.spreadsheet.ValidationFormulaContext(this);\n                this._names = Object.create(null);\n                this.fromJSON(this.options);\n            },\n            clipboard: function () {\n                if (!this._clipboard) {\n                    this._clipboard = new kendo.spreadsheet.Clipboard(this);\n                }\n                return this._clipboard;\n            },\n            destroy: function () {\n                this.unbind();\n                if (this._clipboard) {\n                    this._clipboard.destroy();\n                }\n            },\n            events: [\n                'change',\n                'excelImport',\n                'excelExport'\n            ],\n            _sheetChange: function (e) {\n                this.trigger('change', e);\n            },\n            _inputForRef: function (ref) {\n                return new kendo.spreadsheet.Range(ref, this._sheet).input();\n            },\n            _onUndoRedo: function (e) {\n                e.command.range().select();\n            },\n            execute: function (options) {\n                var commandOptions = $.extend({ workbook: this }, options.options);\n                var command = new kendo.spreadsheet[options.command](commandOptions);\n                var sheet = this.activeSheet();\n                if (commandOptions.origin) {\n                    command.origin(commandOptions.origin);\n                }\n                if (commandOptions.operatingRange) {\n                    command.range(commandOptions.operatingRange);\n                } else if (commandOptions.editActiveCell) {\n                    command.range(sheet.activeCellSelection());\n                } else {\n                    command.range(sheet.selection());\n                }\n                var result = command.exec();\n                if (!result || result.reason !== 'error') {\n                    this.undoRedoStack.push(command);\n                }\n                return result;\n            },\n            resetFormulas: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetFormulas();\n                });\n            },\n            resetValidations: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetValidations();\n                });\n            },\n            refresh: function (reason) {\n                if (reason.recalc) {\n                    this.resetFormulas();\n                    this.resetValidations();\n                    this._sheet.recalc(this._context);\n                    this._sheet.revalidate(this._validationContext);\n                }\n            },\n            activeSheet: function (sheet) {\n                if (sheet === undefined) {\n                    return this._sheet;\n                }\n                if (!this.sheetByName(sheet.name())) {\n                    return;\n                }\n                this._sheet = sheet;\n                sheet.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            moveSheetToIndex: function (sheet, toIndex) {\n                var fromIndex = this.sheetIndex(sheet);\n                var sheets = this._sheets;\n                if (fromIndex === -1) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheets.splice(toIndex, 0, sheets.splice(fromIndex, 1)[0]);\n                this.trigger('change', { sheetSelection: true });\n            },\n            insertSheet: function (options) {\n                options = options || {};\n                var that = this;\n                var insertIndex = typeof options.index === 'number' ? options.index : that._sheets.length;\n                var sheetName;\n                var sheets = that._sheets;\n                var getUniqueSheetName = function (sheetNameSuffix) {\n                    sheetNameSuffix = sheetNameSuffix ? sheetNameSuffix : 1;\n                    var name = 'Sheet' + sheetNameSuffix;\n                    if (!that.sheetByName(name)) {\n                        return name;\n                    }\n                    return getUniqueSheetName(sheetNameSuffix + 1);\n                };\n                if (options.name && that.sheetByName(options.name)) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheetName = options.name || getUniqueSheetName();\n                var sheet = new kendo.spreadsheet.Sheet(options.rows || this.options.rows, options.columns || this.options.columns, options.rowHeight || this.options.rowHeight, options.columnWidth || this.options.columnWidth, options.headerHeight || this.options.headerHeight, options.headerWidth || this.options.headerWidth);\n                sheet._workbook = this;\n                sheet._name(sheetName);\n                sheet.bind('change', this._sheetChange.bind(this));\n                sheets.splice(insertIndex, 0, sheet);\n                if (options.data) {\n                    sheet.fromJSON(options.data);\n                }\n                if (options.dataSource) {\n                    sheet.setDataSource(options.dataSource);\n                }\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            sheets: function () {\n                return this._sheets.slice();\n            },\n            sheetByName: function (sheetName) {\n                return this._sheets[this.sheetIndex(sheetName)];\n            },\n            sheetByIndex: function (index) {\n                return this._sheets[index];\n            },\n            sheetIndex: function (sheet) {\n                var sheets = this._sheets;\n                var sheetName = (typeof sheet == 'string' ? sheet : sheet.name()).toLowerCase();\n                var idx = this._sheetsSearchCache[sheetName];\n                if (idx >= 0) {\n                    return idx;\n                }\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var name = sheets[idx].name().toLowerCase();\n                    this._sheetsSearchCache[name] = idx;\n                    if (name === sheetName) {\n                        return idx;\n                    }\n                }\n                return -1;\n            },\n            renameSheet: function (sheet, newSheetName) {\n                var oldSheetName = sheet.name();\n                if (!newSheetName || oldSheetName === newSheetName) {\n                    return;\n                }\n                sheet = this.sheetByName(oldSheetName);\n                if (!sheet) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                this._sheets.forEach(function (sheet) {\n                    sheet._forFormulas(function (formula) {\n                        formula.renameSheet(oldSheetName, newSheetName);\n                    });\n                });\n                sheet._name(newSheetName);\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            removeSheet: function (sheet) {\n                var that = this;\n                var sheets = that._sheets;\n                var name = sheet.name();\n                var index = that.sheetIndex(sheet);\n                if (sheets.length === 1) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                if (index > -1) {\n                    sheet.unbind();\n                    sheets.splice(index, 1);\n                    if (that.activeSheet().name() === name) {\n                        var newSheet = sheets[index === sheets.length ? index - 1 : index];\n                        that.activeSheet(newSheet);\n                    } else {\n                        this.trigger('change', {\n                            recalc: true,\n                            sheetSelection: true\n                        });\n                    }\n                }\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    for (var idx = 0; idx < json.sheets.length; idx++) {\n                        var sheet = this.sheetByIndex(idx);\n                        if (!sheet) {\n                            sheet = this.insertSheet();\n                        }\n                        sheet.fromJSON(json.sheets[idx]);\n                        var dataSource = json.sheets[idx].dataSource;\n                        if (dataSource) {\n                            sheet.setDataSource(dataSource);\n                        }\n                    }\n                }\n                if (json.activeSheet) {\n                    this.activeSheet(this.sheetByName(json.activeSheet));\n                }\n            },\n            toJSON: function () {\n                this.resetFormulas();\n                this.resetValidations();\n                return {\n                    activeSheet: this.activeSheet().name(),\n                    sheets: this._sheets.map(function (sheet) {\n                        sheet.recalc(this._context);\n                        return sheet.toJSON();\n                    }, this)\n                };\n            },\n            fromFile: function (file) {\n                var deferred = new $.Deferred();\n                var promise = deferred.promise();\n                var args = {\n                    file: file,\n                    promise: promise\n                };\n                if (file && !this.trigger('excelImport', args)) {\n                    for (var i = 0; i < this._sheets.length; i++) {\n                        this._sheets[i].unbind();\n                    }\n                    this._sheets = [];\n                    this._sheetsSearchCache = {};\n                    kendo.spreadsheet.readExcel(file, this, deferred);\n                } else {\n                    deferred.reject();\n                }\n                return promise;\n            },\n            saveAsExcel: function (options) {\n                options = $.extend({}, this.options.excel, options);\n                var data = this.toJSON();\n                if (!this.trigger('excelExport', { workbook: data })) {\n                    var workbook = new kendo.ooxml.Workbook(data);\n                    kendo.saveAs({\n                        dataURI: workbook.toDataURL(),\n                        fileName: data.fileName || options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy\n                    });\n                }\n            },\n            draw: function (options, callback) {\n                if (typeof options == 'function' && !callback) {\n                    callback = options;\n                    options = {};\n                }\n                var parts = [], sheets = this._sheets;\n                (function loop(i) {\n                    if (i < sheets.length) {\n                        sheets[i].draw(kendo.spreadsheet.SHEETREF, options, function (group) {\n                            parts.push(group);\n                            loop(i + 1);\n                        });\n                    } else {\n                        var group = parts[0];\n                        for (i = 1; i < parts.length; ++i) {\n                            group.children = group.children.concat(parts[i].children);\n                        }\n                        callback(group);\n                    }\n                }(0));\n            },\n            defineName: function (name, value, hidden) {\n                this._names[name] = {\n                    value: value,\n                    hidden: hidden\n                };\n            },\n            undefineName: function (name) {\n                delete this._names[name];\n            },\n            nameValue: function (name) {\n                if (name in this._names) {\n                    return this._names[name].value;\n                }\n                return null;\n            },\n            adjustNames: function (affectedSheet, forRow, start, delta) {\n                affectedSheet = affectedSheet.toLowerCase();\n                Object.keys(this._names).forEach(function (name) {\n                    var ref = this.nameValue(name);\n                    if (ref instanceof kendo.spreadsheet.Ref && ref.sheet.toLowerCase() == affectedSheet) {\n                        ref = ref.adjust(null, null, null, null, forRow, start, delta);\n                        this.defineName(name, ref);\n                    }\n                }, this);\n            },\n            options: {}\n        });\n        kendo.spreadsheet.Workbook = Workbook;\n        if (kendo.PDFMixin) {\n            kendo.PDFMixin.extend(Workbook.prototype);\n            Workbook.prototype.saveAsPDF = function (options) {\n                var progress = new $.Deferred();\n                var promise = progress.promise();\n                var args = { promise: promise };\n                if (this.trigger('pdfExport', args)) {\n                    return;\n                }\n                this._drawPDF(options, progress).then(function (root) {\n                    return kendo.drawing.exportPDF(root);\n                }).done(function (dataURI) {\n                    kendo.saveAs({\n                        dataURI: dataURI,\n                        fileName: options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy,\n                        proxyTarget: options.proxyTarget\n                    });\n                    progress.resolve();\n                }).fail(function (err) {\n                    progress.reject(err);\n                });\n                return promise;\n            };\n            Workbook.prototype._drawPDF = function (options) {\n                var result = new $.Deferred();\n                var callback = function (group) {\n                    result.resolve(group);\n                };\n                switch (options.area) {\n                case 'workbook':\n                    options.workbook.draw(options, callback);\n                    break;\n                case 'sheet':\n                    options.workbook.activeSheet().draw(options, callback);\n                    break;\n                case 'selection':\n                    options.workbook.activeSheet().selection().draw(options, callback);\n                    break;\n                }\n                return result.promise();\n            };\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulacontext', ['kendo.core'], f);\n}(function () {\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NameRef = spreadsheet.NameRef;\n    var Ref = spreadsheet.Ref;\n    var FormulaContext = kendo.Class.extend({\n        init: function (workbook) {\n            this.workbook = workbook;\n        },\n        getRefCells: function (ref, hiddenInfo) {\n            var sheet, formula, value, i;\n            if (ref instanceof CellRef) {\n                sheet = this.workbook.sheetByName(ref.sheet);\n                if (!sheet || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                formula = sheet.formula(ref);\n                value = sheet.range(ref.row, ref.col).value();\n                if (formula != null || value != null) {\n                    return [{\n                            formula: formula,\n                            value: value,\n                            row: ref.row,\n                            col: ref.col,\n                            sheet: ref.sheet,\n                            hidden: hiddenInfo ? sheet.columnWidth(ref.col) === 0 || sheet.rowHeight(ref.row) === 0 : false\n                        }];\n                } else {\n                    return [];\n                }\n            }\n            if (ref instanceof RangeRef) {\n                i = this.workbook.sheetIndex(ref.sheet);\n                var states = [], n = i;\n                if (ref.endSheet) {\n                    n = this.workbook.sheetIndex(ref.endSheet);\n                    if (i > n) {\n                        var tmp = i;\n                        i = n;\n                        n = tmp;\n                    }\n                }\n                if (i < 0 || n < 0 || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                while (i <= n) {\n                    sheet = this.workbook.sheetByIndex(i++);\n                    var tl = sheet._grid.normalize(ref.topLeft);\n                    var br = sheet._grid.normalize(ref.bottomRight);\n                    var startCellIndex = sheet._grid.cellRefIndex(tl);\n                    var endCellIndex = sheet._grid.cellRefIndex(br);\n                    var values = sheet._properties.iterator('value', startCellIndex, endCellIndex);\n                    for (var col = tl.col; col <= br.col; ++col) {\n                        for (var row = tl.row; row <= br.row; ++row) {\n                            var index = sheet._grid.index(row, col);\n                            formula = sheet._properties.get('formula', index);\n                            value = values.at(index);\n                            if (formula != null || value != null) {\n                                states.push({\n                                    formula: formula,\n                                    value: value,\n                                    row: row,\n                                    col: col,\n                                    sheet: sheet.name(),\n                                    hidden: hiddenInfo ? sheet.columnWidth(col) === 0 || sheet.rowHeight(row) === 0 : false\n                                });\n                            }\n                        }\n                    }\n                }\n                return states;\n            }\n            if (ref instanceof UnionRef) {\n                var a = [];\n                for (i = 0; i < ref.refs.length; ++i) {\n                    a = a.concat(this.getRefCells(ref.refs[i], hiddenInfo));\n                }\n                return a;\n            }\n            if (ref instanceof NameRef) {\n                var val = this.workbook.nameValue(ref.name);\n                if (val instanceof Ref) {\n                    return this.getRefCells(val, hiddenInfo);\n                }\n                return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('NAME') }];\n            }\n            return [];\n        },\n        getData: function (ref) {\n            var single = ref instanceof CellRef;\n            if (ref instanceof NameRef) {\n                single = this.workbook.nameValue(ref) instanceof CellRef;\n            }\n            var data = this.getRefCells(ref).map(function (cell) {\n                return cell.value;\n            });\n            return single ? data[0] : data;\n        },\n        onFormula: function (f) {\n            var sheet = this.workbook.sheetByName(f.sheet);\n            var row = f.row, col = f.col, value = f.value;\n            var currentFormula = sheet.formula({\n                row: row,\n                col: col\n            });\n            if (currentFormula !== f) {\n                return false;\n            }\n            if (value instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                value.each(function (value, r, c) {\n                    sheet._value(row + r, col + c, value);\n                });\n            } else {\n                sheet._value(row, col, value);\n            }\n            return true;\n        }\n    });\n    var ValidationFormulaContext = FormulaContext.extend({\n        onFormula: function () {\n            return true;\n        }\n    });\n    spreadsheet.FormulaContext = FormulaContext;\n    spreadsheet.ValidationFormulaContext = ValidationFormulaContext;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/controller', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var alphaNumRegExp = /:alphanum$/;\n        var ACTIONS = {\n            'up': 'up',\n            'down': 'down',\n            'left': 'left',\n            'right': 'right',\n            'home': 'first-col',\n            'ctrl+left': 'first-col',\n            'end': 'last-col',\n            'ctrl+right': 'last-col',\n            'ctrl+up': 'first-row',\n            'ctrl+down': 'last-row',\n            'ctrl+home': 'first',\n            'ctrl+end': 'last',\n            'pageup': 'prev-page',\n            'pagedown': 'next-page'\n        };\n        var ENTRY_ACTIONS = {\n            'tab': 'next',\n            'shift+tab': 'previous',\n            'enter': 'lower',\n            'shift+enter': 'upper',\n            'delete': 'clearContents',\n            'backspace': 'clearContents',\n            'shift+:alphanum': 'edit',\n            ':alphanum': 'edit',\n            'ctrl+:alphanum': 'ctrl',\n            ':edit': 'edit'\n        };\n        var CONTAINER_EVENTS = {\n            'wheel': 'onWheel',\n            '*+mousedown': 'onMouseDown',\n            'contextmenu': 'onContextMenu',\n            '*+mousedrag': 'onMouseDrag',\n            '*+mouseup': 'onMouseUp',\n            '*+dblclick': 'onDblClick',\n            'mousemove': 'onMouseMove'\n        };\n        var CLIPBOARD_EVENTS = {\n            '*+pageup': 'onPageUp',\n            '*+pagedown': 'onPageDown',\n            'mouseup': 'onMouseUp',\n            '*+cut': 'onCut',\n            '*+paste': 'onPaste',\n            '*+copy': 'onCopy'\n        };\n        var EDITOR_EVENTS = {\n            'esc': 'onEditorEsc',\n            'enter': 'onEditorBlur',\n            'shift+enter': 'onEditorBlur',\n            'tab': 'onEditorBlur',\n            'shift+tab': 'onEditorBlur'\n        };\n        var FORMULABAR_EVENTS = $.extend({ focus: 'onEditorBarFocus' }, EDITOR_EVENTS);\n        var FORMULAINPUT_EVENTS = $.extend({ focus: 'onEditorCellFocus' }, EDITOR_EVENTS);\n        var SELECTION_MODES = {\n            cell: 'range',\n            rowheader: 'row',\n            columnheader: 'column',\n            topcorner: 'sheet',\n            autofill: 'autofill'\n        };\n        function toActionSelector(selectors) {\n            return selectors.map(function (action) {\n                return '[data-action=\"' + action + '\"]';\n            }).join(',');\n        }\n        var COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector([\n            'cut',\n            'copy',\n            'paste',\n            'insert-left',\n            'insert-right',\n            'insert-above',\n            'insert-below'\n        ]);\n        var UNHIDE_ACTION_SELECTORS = toActionSelector([\n            'unhide-row',\n            'unhide-column'\n        ]);\n        var ACTION_KEYS = [];\n        var SHIFT_ACTION_KEYS = [];\n        var ENTRY_ACTION_KEYS = [];\n        for (var key in ACTIONS) {\n            ACTION_KEYS.push(key);\n            SHIFT_ACTION_KEYS.push('shift+' + key);\n        }\n        for (key in ENTRY_ACTIONS) {\n            ENTRY_ACTION_KEYS.push(key);\n        }\n        CLIPBOARD_EVENTS[ACTION_KEYS] = 'onAction';\n        CLIPBOARD_EVENTS[SHIFT_ACTION_KEYS] = 'onShiftAction';\n        CLIPBOARD_EVENTS[ENTRY_ACTION_KEYS] = 'onEntryAction';\n        FORMULAINPUT_EVENTS[ACTION_KEYS] = 'onEditorAction';\n        FORMULAINPUT_EVENTS[SHIFT_ACTION_KEYS] = 'onEditorShiftAction';\n        var Controller = kendo.Class.extend({\n            init: function (view, workbook) {\n                this.view = view;\n                this.workbook(workbook);\n                this.container = $(view.container);\n                this.clipboardElement = $(view.clipboard);\n                this.cellContextMenu = view.cellContextMenu;\n                this.rowHeaderContextMenu = view.rowHeaderContextMenu;\n                this.colHeaderContextMenu = view.colHeaderContextMenu;\n                this.scroller = view.scroller;\n                this.tabstrip = view.tabstrip;\n                this.sheetsbar = view.sheetsbar;\n                this.editor = view.editor;\n                this.editor.bind('change', this.onEditorChange.bind(this));\n                this.editor.bind('activate', this.onEditorActivate.bind(this));\n                this.editor.bind('deactivate', this.onEditorDeactivate.bind(this));\n                this.editor.bind('update', this.onEditorUpdate.bind(this));\n                $(view.scroller).on('scroll', this.onScroll.bind(this));\n                this.listener = new kendo.spreadsheet.EventListener(this.container, this, CONTAINER_EVENTS);\n                this.keyListener = new kendo.spreadsheet.EventListener(this.clipboardElement, this, CLIPBOARD_EVENTS);\n                this.barKeyListener = new kendo.spreadsheet.EventListener(this.editor.barElement(), this, FORMULABAR_EVENTS);\n                this.inputKeyListener = new kendo.spreadsheet.EventListener(this.editor.cellElement(), this, FORMULAINPUT_EVENTS);\n                if (this.sheetsbar) {\n                    this.sheetsbar.bind('select', this.onSheetBarSelect.bind(this));\n                    this.sheetsbar.bind('reorder', this.onSheetBarReorder.bind(this));\n                    this.sheetsbar.bind('rename', this.onSheetBarRename.bind(this));\n                    this.sheetsbar.bind('remove', this.onSheetBarRemove.bind(this));\n                }\n                this.cellContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.rowHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.colHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).on('contextmenu', false);\n                if (this.tabstrip) {\n                    this.tabstrip.bind('action', this.onCommandRequest.bind(this));\n                    this.tabstrip.bind('dialog', this.onDialogRequest.bind(this));\n                }\n            },\n            _execute: function (options) {\n                var result = this._workbook.execute(options);\n                if (options.command === 'EditCommand' && !result) {\n                    this._workbook.trigger('change', { editorClose: true });\n                }\n                if (result) {\n                    if (result.reason === 'error') {\n                        this.view.showError(result);\n                    } else {\n                        this.view.openDialog(result.reason);\n                    }\n                }\n                return result;\n            },\n            _activeTooltip: function () {\n                return this._workbook.activeSheet().activeCell().simplify().toString();\n            },\n            onContextMenuSelect: function (e) {\n                var action = $(e.item).data('action');\n                var command;\n                switch (action) {\n                case 'cut':\n                    command = {\n                        command: 'ToolbarCutCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'copy':\n                    command = {\n                        command: 'ToolbarCopyCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'paste':\n                    command = {\n                        command: 'ToolbarPasteCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'unmerge':\n                    command = {\n                        command: 'MergeCellCommand',\n                        options: { value: 'unmerge' }\n                    };\n                    break;\n                case 'merge':\n                    this.view.openDialog('merge');\n                    break;\n                case 'hide-row':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'hide-column':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'unhide-row':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'unhide-column':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'delete-row':\n                    command = { command: 'DeleteRowCommand' };\n                    break;\n                case 'delete-column':\n                    command = { command: 'DeleteColumnCommand' };\n                    break;\n                }\n                if (command) {\n                    this._execute(command);\n                }\n            },\n            onSheetBarRemove: function (e) {\n                var sheet = this._workbook.sheetByName(e.name);\n                if (!sheet) {\n                    return;\n                }\n                this._workbook.removeSheet(sheet);\n            },\n            destroy: function () {\n                this.listener.destroy();\n                this.keyListener.destroy();\n                this.inputKeyListener.destroy();\n            },\n            onSheetBarSelect: function (e) {\n                var sheet;\n                var workbook = this._workbook;\n                if (e.isAddButton) {\n                    sheet = workbook.insertSheet();\n                } else {\n                    sheet = workbook.sheetByName(e.name);\n                }\n                if (workbook.activeSheet().name() !== sheet.name()) {\n                    workbook.activeSheet(sheet);\n                }\n            },\n            onSheetBarReorder: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.oldIndex);\n                this._workbook.moveSheetToIndex(sheet, e.newIndex);\n                this._workbook.activeSheet(sheet);\n            },\n            onSheetBarRename: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.sheetIndex);\n                this._workbook.renameSheet(sheet, e.name);\n                this.clipboardElement.focus();\n            },\n            sheet: function (sheet) {\n                this.navigator = sheet.navigator();\n                this.axisManager = sheet.axisManager();\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                this.clipboard = workbook.clipboard();\n            },\n            refresh: function () {\n                var editor = this.editor;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                this._viewPortHeight = this.view.scroller.clientHeight;\n                this.navigator.height(this._viewPortHeight);\n                if (!editor.isActive()) {\n                    editor.enable(sheet.selection().enable() !== false);\n                    editor.value(workbook._inputForRef(sheet.activeCell()));\n                }\n            },\n            onScroll: function () {\n                this.view.render();\n            },\n            onWheel: function (event) {\n                var deltaX = event.originalEvent.deltaX;\n                var deltaY = event.originalEvent.deltaY;\n                if (event.originalEvent.deltaMode === 1) {\n                    deltaX *= 10;\n                    deltaY *= 10;\n                }\n                this.scrollWith(deltaX, deltaY);\n                event.preventDefault();\n            },\n            onAction: function (event, action) {\n                this.navigator.moveActiveCell(ACTIONS[action]);\n                event.preventDefault();\n            },\n            onPageUp: function () {\n                this.scrollDown(-this._viewPortHeight);\n            },\n            onPageDown: function () {\n                this.scrollDown(this._viewPortHeight);\n            },\n            onEntryAction: function (event, action) {\n                if (event.mod) {\n                    var shouldPrevent = true;\n                    var key = String.fromCharCode(event.keyCode);\n                    switch (key) {\n                    case 'A':\n                        this.navigator.selectAll();\n                        break;\n                    case 'Y':\n                        this._workbook.undoRedoStack.redo();\n                        break;\n                    case 'Z':\n                        this._workbook.undoRedoStack.undo();\n                        break;\n                    default:\n                        shouldPrevent = false;\n                        break;\n                    }\n                    if (shouldPrevent) {\n                        event.preventDefault();\n                    }\n                } else {\n                    var disabled = this._workbook.activeSheet().selection().enable() === false;\n                    if (action == 'delete' || action == 'backspace') {\n                        if (disabled) {\n                            return;\n                        }\n                        this._execute({ command: 'ClearContentCommand' });\n                        event.preventDefault();\n                    } else if (alphaNumRegExp.test(action) || action === ':edit') {\n                        if (disabled) {\n                            return;\n                        }\n                        if (action !== ':edit') {\n                            this.editor.value('');\n                        }\n                        this.editor.activate({\n                            range: this._workbook.activeSheet()._viewActiveCell(),\n                            rect: this.view.activeCellRectangle(),\n                            tooltip: this._activeTooltip()\n                        }).focus();\n                    } else {\n                        this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                        event.preventDefault();\n                    }\n                }\n            },\n            onShiftAction: function (event, action) {\n                this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                event.preventDefault();\n            },\n            onMouseMove: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress() || sheet.selectionInProgress()) {\n                    return;\n                }\n                var object = this.objectAt(event);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.positionResizeHandle(object.ref);\n                } else {\n                    sheet.removeResizeHandle();\n                }\n            },\n            onMouseDown: function (event) {\n                var object = this.objectAt(event);\n                if (object.pane) {\n                    this.originFrame = object.pane;\n                }\n                if (this.editor.canInsertRef(false) && object.ref) {\n                    this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n                    this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection);\n                    event.preventDefault();\n                    return;\n                } else {\n                    this.editor.deactivate();\n                    if (this.editor.isActive()) {\n                        event.preventDefault();\n                        return;\n                    }\n                }\n                var sheet = this._workbook.activeSheet();\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.startResizing({\n                        x: object.x,\n                        y: object.y\n                    });\n                    event.preventDefault();\n                    return;\n                }\n                if (object.type === 'filtericon') {\n                    this.openFilterMenu(event.target);\n                    event.preventDefault();\n                    return;\n                }\n                this._selectionMode = SELECTION_MODES[object.type];\n                this.appendSelection = event.mod;\n                this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection);\n            },\n            onContextMenu: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    return;\n                }\n                event.preventDefault();\n                this.cellContextMenu.close();\n                this.colHeaderContextMenu.close();\n                this.rowHeaderContextMenu.close();\n                var menu;\n                var location = {\n                    pageX: event.pageX,\n                    pageY: event.pageY\n                };\n                var object = this.objectAt(location);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    return;\n                }\n                this.navigator.selectForContextMenu(object.ref, SELECTION_MODES[object.type]);\n                var isComposite = this.navigator._sheet.select() instanceof kendo.spreadsheet.UnionRef;\n                var showUnhide = false;\n                var showUnmerge = false;\n                if (object.type === 'cell') {\n                    menu = this.cellContextMenu;\n                    showUnmerge = this.navigator.selectionIncludesMergedCells();\n                } else if (object.type == 'columnheader') {\n                    menu = this.colHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenColumns();\n                } else if (object.type == 'rowheader') {\n                    menu = this.rowHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenRows();\n                }\n                menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n                menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n                menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n                setTimeout(function () {\n                    menu.open(event.pageX, event.pageY);\n                });\n            },\n            prevent: function (event) {\n                event.preventDefault();\n            },\n            constrainResize: function (type, ref) {\n                var sheet = this._workbook.activeSheet();\n                var resizeHandle = sheet.resizeHandlePosition();\n                return !resizeHandle || type === 'outside' || type === 'topcorner' || ref.col < resizeHandle.col || ref.row < resizeHandle.row;\n            },\n            onMouseDrag: function (event) {\n                if (this._selectionMode === 'sheet') {\n                    return;\n                }\n                var location = {\n                    pageX: event.pageX,\n                    pageY: event.pageY\n                };\n                var object = this.objectAt(location);\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    if (!this.constrainResize(object.type, object.ref)) {\n                        sheet.resizeHintPosition({\n                            x: object.x,\n                            y: object.y\n                        });\n                    }\n                    return;\n                }\n                if (object.type === 'outside') {\n                    this.startAutoScroll(object);\n                    return;\n                }\n                if (this.originFrame === object.pane) {\n                    this.selectToLocation(location);\n                } else {\n                    var frame = this.originFrame._grid;\n                    if (object.x > frame.right) {\n                        this.scrollLeft();\n                    }\n                    if (object.y > frame.bottom) {\n                        this.scrollTop();\n                    }\n                    if (object.y < frame.top || object.x < frame.left) {\n                        this.startAutoScroll(object, location);\n                    } else {\n                        this.selectToLocation(location);\n                    }\n                }\n                event.preventDefault();\n            },\n            onMouseUp: function (event) {\n                var sheet = this._workbook.activeSheet();\n                sheet.completeResizing();\n                this.navigator.completeSelection();\n                this.stopAutoScroll();\n                var editor = this.editor.activeEditor();\n                if (!editor) {\n                    return;\n                }\n                var el = event.target;\n                while (el) {\n                    if (el === editor.element[0]) {\n                        return;\n                    }\n                    el = el.parentNode;\n                }\n                var object = this.objectAt(event);\n                if (object && object.ref && editor.canInsertRef(false)) {\n                    editor.refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                }\n            },\n            onDblClick: function (event) {\n                var object = this.objectAt(event);\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (object.type !== 'cell' || disabled) {\n                    return;\n                }\n                this.editor.activate({\n                    range: this._workbook.activeSheet()._viewActiveCell(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                }).focus();\n                this.onEditorUpdate();\n            },\n            onCut: function (e) {\n                if (e) {\n                    var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                    this.clipboardElement.append(table.clone(false));\n                    setTimeout(function () {\n                        this.clipboardElement.empty().append(table);\n                    }.bind(this));\n                }\n                this._execute({\n                    command: 'CutCommand',\n                    options: { workbook: this.view._workbook }\n                });\n            },\n            clipBoardValue: function () {\n                return this.clipboardElement.html();\n            },\n            onPaste: function (e) {\n                var html = '';\n                var plain = '';\n                this.clipboard.menuInvoked = e === undefined;\n                if (e) {\n                    if (e.originalEvent.clipboardData && e.originalEvent.clipboardData.getData) {\n                        e.preventDefault();\n                        var hasHTML = false;\n                        var hasPlainText = false;\n                        if (window.DOMStringList && e.originalEvent.clipboardData.types instanceof window.DOMStringList) {\n                            hasHTML = e.originalEvent.clipboardData.types.contains('text/html');\n                            hasPlainText = e.originalEvent.clipboardData.types.contains('text/plain');\n                        } else {\n                            hasHTML = /text\\/html/.test(e.originalEvent.clipboardData.types);\n                            hasPlainText = /text\\/plain/.test(e.originalEvent.clipboardData.types);\n                        }\n                        if (hasHTML) {\n                            html = e.originalEvent.clipboardData.getData('text/html');\n                        }\n                        if (hasPlainText) {\n                            plain = e.originalEvent.clipboardData.getData('text/plain').trim();\n                        }\n                    } else {\n                        var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                        this.clipboardElement.empty();\n                        setTimeout(function () {\n                            this.clipboard.external({\n                                html: this.clipboardElement.html(),\n                                plain: window.clipboardData.getData('Text').trim()\n                            });\n                            this.clipboardElement.empty().append(table);\n                            this._execute({\n                                command: 'PasteCommand',\n                                options: { workbook: this.view._workbook }\n                            });\n                            this.clipboard.menuInvoked = true;\n                        }.bind(this));\n                        return;\n                    }\n                } else {\n                    if (kendo.support.browser.msie) {\n                        this.clipboardElement.focus().select();\n                        document.execCommand('paste');\n                        return;\n                    } else {\n                        this.clipboard.menuInvoked = true;\n                    }\n                }\n                this.clipboard.external({\n                    html: html,\n                    plain: plain\n                });\n                this._execute({\n                    command: 'PasteCommand',\n                    options: { workbook: this.view._workbook }\n                });\n            },\n            onCopy: function (e) {\n                this.clipboard.menuInvoked = e === undefined;\n                this._execute({\n                    command: 'CopyCommand',\n                    options: { workbook: this.view._workbook }\n                });\n            },\n            scrollTop: function () {\n                this.scroller.scrollTop = 0;\n            },\n            scrollLeft: function () {\n                this.scroller.scrollLeft = 0;\n            },\n            scrollDown: function (value) {\n                this.scroller.scrollTop += value;\n            },\n            scrollRight: function (value) {\n                this.scroller.scrollLeft += value;\n            },\n            scrollWith: function (right, down) {\n                this.scroller.scrollTop += down;\n                this.scroller.scrollLeft += right;\n            },\n            objectAt: function (location) {\n                var offset = this.container.offset();\n                var coordinates = {\n                    left: location.pageX - offset.left,\n                    top: location.pageY - offset.top\n                };\n                return this.view.objectAt(coordinates.left, coordinates.top);\n            },\n            selectToLocation: function (cellLocation) {\n                var object = this.objectAt(cellLocation);\n                if (object.pane) {\n                    this.extendSelection(object);\n                    this.lastKnownCellLocation = cellLocation;\n                    this.originFrame = object.pane;\n                }\n                this.stopAutoScroll();\n            },\n            extendSelection: function (object) {\n                this.navigator.extendSelection(object.ref, this._selectionMode, this.appendSelection);\n            },\n            autoScroll: function () {\n                var x = this._autoScrollTarget.x;\n                var y = this._autoScrollTarget.y;\n                var boundaries = this.originFrame._grid;\n                var scroller = this.view.scroller;\n                var scrollStep = 8;\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n                if (x < boundaries.left) {\n                    this.scrollRight(-scrollStep);\n                }\n                if (x > boundaries.right) {\n                    this.scrollRight(scrollStep);\n                }\n                if (y < boundaries.top) {\n                    this.scrollDown(-scrollStep);\n                }\n                if (y > boundaries.bottom) {\n                    this.scrollDown(scrollStep);\n                }\n                if (scrollTop === scroller.scrollTop && scrollLeft === scroller.scrollLeft) {\n                    this.selectToLocation(this.finalLocation);\n                } else {\n                    this.extendSelection(this.objectAt(this.lastKnownCellLocation));\n                }\n            },\n            startAutoScroll: function (viewObject, location) {\n                if (!this._scrollInterval) {\n                    this._scrollInterval = setInterval(this.autoScroll.bind(this), 50);\n                }\n                this.finalLocation = location || this.lastKnownCellLocation;\n                this._autoScrollTarget = viewObject;\n            },\n            stopAutoScroll: function () {\n                clearInterval(this._scrollInterval);\n                this._scrollInterval = null;\n            },\n            openFilterMenu: function (target) {\n                var button = $(target).closest('.k-spreadsheet-filter');\n                var filterMenu = this.view.createFilterMenu(button.data('column'));\n                filterMenu.bind('action', this.onCommandRequest.bind(this));\n                filterMenu.bind('action', filterMenu.close.bind(filterMenu));\n                filterMenu.openFor(target);\n            },\n            onEditorChange: function (e) {\n                this._workbook.activeSheet().isInEditMode(false);\n                var result = this._execute({\n                    command: 'EditCommand',\n                    options: {\n                        editActiveCell: true,\n                        value: e.value\n                    }\n                });\n                if (result && result.reason === 'error') {\n                    e.preventDefault();\n                }\n            },\n            onEditorActivate: function () {\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                sheet._setFormulaSelections(this.editor.highlightedRefs());\n                sheet.isInEditMode(true);\n            },\n            onEditorDeactivate: function () {\n                var sheet = this._workbook.activeSheet();\n                sheet.isInEditMode(false);\n                sheet._setFormulaSelections([]);\n            },\n            onEditorUpdate: function () {\n                this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n            },\n            onEditorBarFocus: function () {\n                this.editor.activate({\n                    range: this._workbook.activeSheet()._viewActiveCell(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                });\n            },\n            onEditorCellFocus: function () {\n                this.editor.scale();\n            },\n            onEditorEsc: function () {\n                this.editor.value(this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell()));\n                this.editor.deactivate();\n                this.clipboardElement.focus();\n            },\n            onEditorBlur: function (_, action) {\n                if (this.editor.isFiltered()) {\n                    return;\n                }\n                this.editor.deactivate();\n                if (!this.editor.isActive()) {\n                    this.clipboardElement.focus();\n                    this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                }\n            },\n            onEditorAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    editor.activeEditor().refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            onEditorShiftAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                    editor.activeEditor().refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            onCommandRequest: function (e) {\n                if (e.command) {\n                    this._execute(e);\n                } else {\n                    this._workbook.undoRedoStack[e.action]();\n                }\n            },\n            onDialogRequest: function (e) {\n                var exportOptions = {\n                    pdfExport: this._workbook.options.pdf,\n                    excelExport: this._workbook.options.excel\n                };\n                if (e.options) {\n                    $.extend(true, e.options, exportOptions);\n                } else {\n                    e.options = exportOptions;\n                }\n                this.view.openDialog(e.name, e.options);\n            }\n        });\n        kendo.spreadsheet.Controller = Controller;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/view', [\n        'kendo.core',\n        'kendo.menu',\n        'spreadsheet/sheetsbar'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var DOT = '.';\n        var RESIZE_HANDLE_WIDTH = 7;\n        var viewClassNames = {\n            view: 'k-spreadsheet-view',\n            fixedContainer: 'k-spreadsheet-fixed-container',\n            scroller: 'k-spreadsheet-scroller',\n            viewSize: 'k-spreadsheet-view-size',\n            clipboard: 'k-spreadsheet-clipboard',\n            cellEditor: 'k-spreadsheet-cell-editor',\n            barEditor: 'k-spreadsheet-editor',\n            topCorner: 'k-spreadsheet-top-corner',\n            filterHeadersWrapper: 'k-filter-wrapper',\n            filterRange: 'k-filter-range',\n            filterButton: 'k-spreadsheet-filter',\n            filterButtonActive: 'k-state-active',\n            icon: 'k-icon k-font-icon',\n            iconFilterDefault: 'k-i-arrow-s',\n            sheetsBar: 'k-spreadsheet-sheets-bar',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            cellContextMenu: 'k-spreadsheet-cell-context-menu',\n            rowHeaderContextMenu: 'k-spreadsheet-row-header-context-menu',\n            colHeaderContextMenu: 'k-spreadsheet-col-header-context-menu'\n        };\n        var VIEW_MESAGES = kendo.spreadsheet.messages.view = {\n            errors: {\n                openUnsupported: 'Unsupported format. Please select an .xlsx file.',\n                shiftingNonblankCells: 'Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.',\n                filterRangeContainingMerges: 'Cannot create a filter within a range containing merges',\n                sortRangeContainingMerges: 'Cannot sort a range containing merges',\n                validationError: 'The value that you entered violates the validation rules set on the cell.'\n            },\n            tabs: {\n                home: 'Home',\n                insert: 'Insert',\n                data: 'Data'\n            }\n        };\n        function selectElementContents(el) {\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            var range = document.createRange();\n            range.selectNodeContents(el);\n            sel.addRange(range);\n        }\n        function cellBefore(table, row) {\n            var cells = table.trs[row].children;\n            return cells[cells.length - 2];\n        }\n        function cellAbove(table, row) {\n            var prevRow = table.trs[row - 1];\n            var index = table.trs[row].children.length - 1;\n            if (prevRow && index >= 0) {\n                return prevRow.children[index];\n            }\n        }\n        function cellBorder(value) {\n            return [\n                'solid',\n                (value.size || 1) + 'px',\n                value.color || '#000'\n            ].join(' ');\n        }\n        function drawCell(collection, cell, cls, hBorders, vBorders, showGrid) {\n            if (!cls && !kendo.spreadsheet.draw.shouldDrawCell(cell)) {\n                return;\n            }\n            var left = cell.left;\n            var top = cell.top;\n            var width = cell.width + 1;\n            var height = cell.height + 1;\n            var style = {};\n            var background = cell.background;\n            var defaultBorder = null;\n            if (background) {\n                defaultBorder = background;\n                if (showGrid) {\n                    defaultBorder = kendo.parseColor(defaultBorder).toHSV();\n                    defaultBorder.v *= 0.9;\n                    defaultBorder = defaultBorder.toCssRgba();\n                }\n                defaultBorder = cellBorder({ color: defaultBorder });\n            }\n            if (background) {\n                style.backgroundColor = background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.wordBreak = 'break-all';\n            }\n            if (cell.borderLeft) {\n                style.borderLeft = cellBorder(cell.borderLeft);\n                if (vBorders) {\n                    vBorders[cell.left] = true;\n                }\n            } else if (defaultBorder && vBorders && !vBorders[cell.left]) {\n                style.borderLeft = defaultBorder;\n            } else {\n                left++;\n                width--;\n            }\n            if (cell.borderTop) {\n                style.borderTop = cellBorder(cell.borderTop);\n                if (hBorders) {\n                    hBorders[cell.top] = true;\n                }\n            } else if (defaultBorder && hBorders && !hBorders[cell.top]) {\n                style.borderTop = defaultBorder;\n            } else {\n                top++;\n                height--;\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n                if (vBorders) {\n                    vBorders[cell.right] = true;\n                }\n            } else if (defaultBorder && vBorders && !vBorders[cell.right]) {\n                style.borderRight = defaultBorder;\n            } else {\n                width--;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n                if (hBorders) {\n                    hBorders[cell.bottom] = true;\n                }\n            } else if (defaultBorder && hBorders && !hBorders[cell.bottom]) {\n                style.borderBottom = defaultBorder;\n            } else {\n                height--;\n            }\n            style.left = left + 'px';\n            style.top = top + 'px';\n            style.width = width + 'px';\n            style.height = height + 'px';\n            var data = cell.value, type = typeof data;\n            if (cell.format && data !== null) {\n                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            } else if (data !== null && data !== undefined) {\n                data = kendo.dom.text(data);\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var classNames = [paneClassNames.cell];\n            if (cls) {\n                classNames.push(cls);\n            }\n            if (cell.enable === false) {\n                classNames.push('k-state-disabled');\n            }\n            if (cell.merged) {\n                classNames.push('k-spreadsheet-merged-cell');\n            }\n            var verticalAlign = cell.verticalAlign || 'center';\n            if (verticalAlign && data) {\n                data = kendo.dom.element('div', { className: 'k-vertical-align-' + verticalAlign }, [data]);\n            }\n            var children = data ? [data] : [];\n            var properties = { style: style };\n            var validation = cell.validation;\n            if (validation && !validation.value) {\n                children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                classNames.push('k-dirty-cell');\n                properties.title = validation._getOptions().messageTemplate;\n            }\n            properties.className = classNames.join(' ');\n            var div = kendo.dom.element('div', properties, children);\n            collection.push(div);\n            return div;\n        }\n        function addCell(table, row, cell) {\n            var style = {};\n            if (cell.background) {\n                style.backgroundColor = cell.background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.verticalAlign) {\n                style.verticalAlign = cell.verticalAlign === 'center' ? 'middle' : cell.verticalAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.wordBreak = 'break-all';\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n            } else if (cell.background) {\n                style.borderRightColor = cell.background;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n            } else if (cell.background) {\n                style.borderBottomColor = cell.background;\n            }\n            var data = cell.value, type = typeof data;\n            if (cell.format && data !== null) {\n                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var className = null;\n            if (cell.enable === false) {\n                className = 'k-state-disabled';\n            }\n            var td = table.addCell(row, data, style, className, cell.validation);\n            var border, sibling;\n            if (cell.borderLeft) {\n                sibling = cellBefore(table, row);\n                border = cellBorder(cell.borderLeft);\n                if (sibling && border) {\n                    sibling.attr.style.borderRight = border;\n                }\n            } else if (cell.background) {\n                style.borderLeftColor = cell.background;\n            }\n            if (cell.borderTop) {\n                sibling = cellAbove(table, row);\n                border = cellBorder(cell.borderTop);\n                if (sibling && border) {\n                    sibling.attr.style.borderBottom = border;\n                }\n            } else if (cell.background) {\n                style.borderTopColor = cell.background;\n            }\n            return td;\n        }\n        var HtmlTable = kendo.Class.extend({\n            init: function () {\n                this.cols = [];\n                this.trs = [];\n                this._height = 0;\n                this._width = 0;\n            },\n            addColumn: function (width) {\n                this._width += width;\n                var col = kendo.dom.element('col', { style: { width: width + 'px' } });\n                col.visible = width > 0;\n                this.cols.push(col);\n            },\n            addRow: function (height) {\n                var attr = null;\n                attr = { style: { height: height + 'px' } };\n                this._height += height;\n                var tr = kendo.dom.element('tr', attr);\n                tr.visible = height > 0;\n                this.trs.push(tr);\n            },\n            addCell: function (rowIndex, text, style, className, validation) {\n                if (text === null || text === undefined) {\n                    text = '';\n                }\n                if (!(text instanceof kendo.dom.Node)) {\n                    text = kendo.dom.text(text);\n                }\n                var children = [text];\n                var properties = { style: style };\n                if (validation && !validation.value) {\n                    children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                    className = (className || '') + (className ? ' ' : '') + 'k-dirty-cell';\n                    properties.title = validation._getOptions().messageTemplate;\n                }\n                if (className) {\n                    properties.className = className;\n                }\n                var td = kendo.dom.element('td', properties, children);\n                this.trs[rowIndex].children.push(td);\n                return td;\n            },\n            toDomTree: function (x, y, className) {\n                this.trs = this.trs.filter(function (tr) {\n                    return tr.visible;\n                });\n                var offset = 0;\n                this.cols = this.cols.filter(function (col, ci) {\n                    if (!col.visible) {\n                        this.trs.forEach(function (tr) {\n                            tr.children.splice(ci - offset, 1);\n                        });\n                        offset++;\n                    }\n                    return col.visible;\n                }, this);\n                return kendo.dom.element('table', {\n                    style: {\n                        left: x + 'px',\n                        top: y + 'px',\n                        height: this._height + 'px',\n                        width: this._width + 'px'\n                    },\n                    className: className\n                }, [\n                    kendo.dom.element('colgroup', null, this.cols),\n                    kendo.dom.element('tbody', null, this.trs)\n                ]);\n            }\n        });\n        var CELL_CONTEXT_MENU = '<ul class=\"#=classNames.cellContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=merge>Merge</li>' + '<li data-action=unmerge>Unmerge</li>' + '</ul>';\n        var ROW_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.rowHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-row\">Delete</li>' + '<li data-action=\"hide-row\">Hide</li>' + '<li data-action=\"unhide-row\">Unhide</li>' + '</ul>';\n        var COL_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.colHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-column\">Delete</li>' + '<li data-action=\"hide-column\">Hide</li>' + '<li data-action=\"unhide-column\">Unhide</li>' + '</ul>';\n        kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n        var VIEW_CONTENTS = kendo.template('<div class=\"#=classNames.view#\"><div class=\"#=classNames.fixedContainer#\"></div><div class=\"#=classNames.scroller#\"><div class=\"#=classNames.viewSize#\"></div></div>' + '<div tabindex=\"0\" class=\"#=classNames.clipboard#\" contenteditable=true></div><div class=\"#=classNames.cellEditor#\"></div></div><div class=\"#=classNames.sheetsBar#\"></div>' + CELL_CONTEXT_MENU + ROW_HEADER_CONTEXT_MENU + COL_HEADER_CONTEXT_MENU);\n        function within(value, min, max) {\n            return value >= min && value <= max;\n        }\n        var View = kendo.Class.extend({\n            init: function (element, options) {\n                var classNames = View.classNames;\n                this.element = element;\n                this.options = $.extend(true, {}, this.options, options);\n                this._chrome();\n                this._dialogs = [];\n                element.append(VIEW_CONTENTS({ classNames: classNames }));\n                this._formulaInput();\n                this.wrapper = element.find(DOT + classNames.view);\n                this.container = element.find(DOT + classNames.fixedContainer)[0];\n                this.scroller = element.find(DOT + classNames.scroller)[0];\n                this.clipboard = element.find(DOT + classNames.clipboard);\n                this.viewSize = $(this.scroller.firstChild);\n                this.tree = new kendo.dom.Tree(this.container);\n                this.clipboardContents = new kendo.dom.Tree(this.clipboard[0]);\n                this.editor = new kendo.spreadsheet.SheetEditor(this);\n                this._sheetsbar();\n                var contextMenuConfig = {\n                    target: element,\n                    animation: false,\n                    showOn: 'never'\n                };\n                this.cellContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.cellContextMenu), contextMenuConfig);\n                this.colHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.colHeaderContextMenu), contextMenuConfig);\n                this.rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.rowHeaderContextMenu), contextMenuConfig);\n                var scrollbar = kendo.support.scrollbar();\n                $(this.container).css({\n                    width: this.wrapper[0].clientWidth - scrollbar,\n                    height: this.wrapper[0].clientHeight - scrollbar\n                });\n            },\n            _resize: function () {\n                var tabstripHeight = this.tabstrip ? this.tabstrip.element.outerHeight() : 0;\n                var formulaBarHeight = this.formulaBar ? this.formulaBar.element.outerHeight() : 0;\n                var sheetsBarHeight = this.sheetsbar ? this.sheetsbar.element.outerHeight() : 0;\n                this.wrapper.height(this.element.height() - (tabstripHeight + formulaBarHeight + sheetsBarHeight));\n                if (this.tabstrip) {\n                    this.tabstrip.quickAccessAdjust();\n                }\n            },\n            _chrome: function () {\n                var formulaBar = $('<div />').prependTo(this.element);\n                this.formulaBar = new kendo.spreadsheet.FormulaBar(formulaBar);\n                if (this.options.toolbar) {\n                    this._tabstrip();\n                }\n            },\n            _formulaInput: function () {\n                var editor = this.element.find(DOT + View.classNames.cellEditor);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput(editor, { autoScale: true });\n            },\n            _sheetsbar: function () {\n                if (this.options.sheetsbar) {\n                    this.sheetsbar = new kendo.spreadsheet.SheetsBar(this.element.find(DOT + View.classNames.sheetsBar), $.extend(true, {}, this.options.sheetsbar));\n                }\n            },\n            _tabstrip: function () {\n                var messages = VIEW_MESAGES.tabs;\n                var options = $.extend(true, {\n                    home: true,\n                    insert: true,\n                    data: true\n                }, this.options.toolbar);\n                var tabs = [];\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                    this.element.children('.k-tabstrip').remove();\n                }\n                for (var name in options) {\n                    if (options[name] === true || options[name] instanceof Array) {\n                        tabs.push({\n                            id: name,\n                            text: messages[name],\n                            content: ''\n                        });\n                    }\n                }\n                this.tabstrip = new kendo.spreadsheet.TabStrip($('<div />').prependTo(this.element), {\n                    animation: false,\n                    dataTextField: 'text',\n                    dataContentField: 'content',\n                    dataSource: tabs,\n                    toolbarOptions: options,\n                    view: this\n                });\n                this.tabstrip.select(0);\n            },\n            _executeCommand: function (e) {\n                this._workbook.execute(e);\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n            },\n            sheet: function (sheet) {\n                this._sheet = sheet;\n            },\n            activeCellRectangle: function () {\n                return this.cellRectangle(this._sheet._viewActiveCell());\n            },\n            _rectangle: function (pane, ref) {\n                return pane._grid.boundingRectangle(ref.toRangeRef());\n            },\n            isColumnResizer: function (x, pane, ref) {\n                var rectangle = this._rectangle(pane, ref);\n                x -= this._sheet._grid._headerWidth;\n                var handleWidth = RESIZE_HANDLE_WIDTH / 2;\n                var right = rectangle.right - this.scroller.scrollLeft;\n                return right - handleWidth <= x && x <= right + handleWidth;\n            },\n            isRowResizer: function (y, pane, ref) {\n                var rectangle = this._rectangle(pane, ref);\n                y -= this._sheet._grid._headerHeight;\n                var handleWidth = RESIZE_HANDLE_WIDTH / 2;\n                var bottom = rectangle.bottom - this.scroller.scrollTop;\n                return bottom - handleWidth <= y && y <= bottom + handleWidth;\n            },\n            isFilterIcon: function (x, y, pane, ref) {\n                var result = false;\n                x -= this._sheet._grid._headerWidth - this.scroller.scrollLeft;\n                y -= this._sheet._grid._headerHeight - this.scroller.scrollTop;\n                this._sheet.forEachFilterHeader(ref, function (ref) {\n                    var rect = this._rectangle(pane, ref);\n                    result = result || pane.filterIconRect(rect).intersects(x, y);\n                }.bind(this));\n                return result;\n            },\n            isAutoFill: function (x, y, pane) {\n                var selection = this._sheet.select();\n                if (selection.size > 1) {\n                    return false;\n                }\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n                var rectangle = this._rectangle(pane, selection);\n                return Math.abs(rectangle.right - x) < 8 && Math.abs(rectangle.bottom - y) < 8;\n            },\n            objectAt: function (x, y) {\n                var grid = this._sheet._grid;\n                var object, pane;\n                if (x < 0 || y < 0 || x > this.scroller.clientWidth || y > this.scroller.clientHeight) {\n                    object = { type: 'outside' };\n                } else if (x < grid._headerWidth && y < grid._headerHeight) {\n                    object = { type: 'topcorner' };\n                } else {\n                    pane = this.paneAt(x, y);\n                    var row = pane._grid.rows.index(y, this.scroller.scrollTop);\n                    var column = pane._grid.columns.index(x, this.scroller.scrollLeft);\n                    var type = 'cell';\n                    var ref = new CellRef(row, column);\n                    if (this.isAutoFill(x, y, pane)) {\n                        type = 'autofill';\n                    } else if (this.isFilterIcon(x, y, pane, ref)) {\n                        type = 'filtericon';\n                    } else if (x < grid._headerWidth) {\n                        ref = new CellRef(row, -Infinity);\n                        type = this.isRowResizer(y, pane, ref) ? 'rowresizehandle' : 'rowheader';\n                    } else if (y < grid._headerHeight) {\n                        ref = new CellRef(-Infinity, column);\n                        type = this.isColumnResizer(x, pane, ref) ? 'columnresizehandle' : 'columnheader';\n                    }\n                    object = {\n                        type: type,\n                        ref: ref\n                    };\n                }\n                object.pane = pane;\n                object.x = x;\n                object.y = y;\n                return object;\n            },\n            paneAt: function (x, y) {\n                return this.panes.filter(function paneLocationWithin(pane) {\n                    var grid = pane._grid;\n                    return within(y, grid.top, grid.bottom) && within(x, grid.left, grid.right);\n                })[0];\n            },\n            containingPane: function (cell) {\n                return this.panes.filter(function (pane) {\n                    if (pane._grid.contains(cell)) {\n                        return true;\n                    }\n                    return false;\n                })[0];\n            },\n            cellRectangle: function (cell) {\n                var theGrid = this.containingPane(cell)._grid;\n                var rectangle = this._sheet._grid.rectangle(cell);\n                return rectangle.offset(theGrid.headerWidth - this.scroller.scrollLeft, theGrid.headerHeight - this.scroller.scrollTop);\n            },\n            refresh: function (reason) {\n                var sheet = this._sheet;\n                if (this.tabstrip) {\n                    this.tabstrip.refreshTools(sheet.range(sheet.activeCell()));\n                }\n                if (reason.sheetSelection && this.sheetsbar) {\n                    this.sheetsbar.renderSheets(this._workbook.sheets(), this._workbook.sheetIndex(this._sheet));\n                }\n                this._resize();\n                this.viewSize[0].style.height = sheet._grid.totalHeight() + 'px';\n                this.viewSize[0].style.width = sheet._grid.totalWidth() + 'px';\n                if (reason.layout) {\n                    var frozenColumns = sheet.frozenColumns();\n                    var frozenRows = sheet.frozenRows();\n                    this.panes = [this._pane(frozenRows, frozenColumns)];\n                    if (frozenColumns > 0) {\n                        this.panes.push(this._pane(frozenRows, 0, null, frozenColumns));\n                    }\n                    if (frozenRows > 0) {\n                        this.panes.push(this._pane(0, frozenColumns, frozenRows, null));\n                    }\n                    if (frozenRows > 0 && frozenColumns > 0) {\n                        this.panes.push(this._pane(0, 0, frozenRows, frozenColumns));\n                    }\n                }\n                if (reason.filter) {\n                    this._destroyFilterMenu();\n                }\n                if (reason.activeCell) {\n                    this._focus = sheet.activeCell().toRangeRef();\n                }\n            },\n            createFilterMenu: function (column) {\n                if (this._filterMenu && this._filterMenu.options.column == column) {\n                    return this._filterMenu;\n                }\n                this._destroyFilterMenu();\n                var sheet = this._sheet;\n                var ref = sheet.filter().ref;\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var element = $('<div />').appendTo(this.element);\n                var options = {\n                    column: column,\n                    range: range\n                };\n                var filterMenu = new kendo.spreadsheet.FilterMenu(element, options);\n                this._filterMenu = filterMenu;\n                return filterMenu;\n            },\n            selectClipBoardContents: function () {\n                this.clipboard.focus();\n                selectElementContents(this.clipboard[0]);\n            },\n            scrollIntoView: function (cell) {\n                var willScroll = false;\n                var theGrid = this.containingPane(cell)._grid;\n                var boundaries = theGrid.scrollBoundaries(cell);\n                var scroller = this.scroller;\n                var scrollTop = theGrid.rows.frozen ? 0 : scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n                if (boundaries.top < scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollTop;\n                }\n                if (boundaries.bottom > scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollBottom;\n                }\n                if (boundaries.left < scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollLeft;\n                }\n                if (boundaries.right > scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollRight;\n                }\n                return willScroll;\n            },\n            _destroyDialog: function () {\n                this._dialogs.pop();\n            },\n            openDialog: function (name, options) {\n                var sheet = this._sheet;\n                var ref = sheet.activeCell();\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var dialog = kendo.spreadsheet.dialogs.create(name, options);\n                if (dialog) {\n                    dialog.bind('action', this._executeCommand.bind(this));\n                    dialog.bind('deactivate', this._destroyDialog.bind(this));\n                    this._dialogs.push(dialog);\n                    dialog.open(range);\n                    return dialog;\n                }\n            },\n            showError: function (options) {\n                var errorMessages = VIEW_MESAGES.errors;\n                this.openDialog('message', {\n                    title: options.title || 'Error',\n                    text: options.body ? options.body : errorMessages[options.type],\n                    activate: function () {\n                        this.dialog().element.find('.k-button').focus();\n                    },\n                    close: function () {\n                        this.editor.focusLastActive();\n                    }.bind(this)\n                });\n            },\n            destroy: function () {\n                this._dialogs.forEach(function (dialog) {\n                    dialog.destroy();\n                });\n                this.cellContextMenu.destroy();\n                this.rowHeaderContextMenu.destroy();\n                this.colHeaderContextMenu.destroy();\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                }\n                this._destroyFilterMenu();\n            },\n            _destroyFilterMenu: function () {\n                if (this._filterMenu) {\n                    this._filterMenu.destroy();\n                    this._filterMenu = undefined;\n                    this._filterMenuColumn = undefined;\n                }\n            },\n            render: function () {\n                if (!this.element.is(':visible')) {\n                    return;\n                }\n                var sheet = this._sheet;\n                var focus = sheet.focus();\n                if (focus && this.scrollIntoView(focus)) {\n                    return;\n                }\n                var grid = sheet._grid;\n                var scrollTop = this.scroller.scrollTop;\n                var scrollLeft = this.scroller.scrollLeft;\n                if (scrollTop < 0) {\n                    scrollTop = 0;\n                }\n                if (scrollLeft < 0) {\n                    scrollLeft = 0;\n                }\n                var result = this.panes.map(function (pane) {\n                    return pane.render(scrollLeft, scrollTop);\n                }, this);\n                var merged = [];\n                merged = Array.prototype.concat.apply(merged, result);\n                var topCorner = kendo.dom.element('div', {\n                    style: {\n                        width: grid._headerWidth + 'px',\n                        height: grid._headerHeight + 'px'\n                    },\n                    className: View.classNames.topCorner\n                });\n                merged.push(topCorner);\n                if (sheet.resizeHandlePosition() && sheet.resizeHintPosition()) {\n                    merged.push(this.renderResizeHint());\n                }\n                this.tree.render(merged);\n                if (this.editor.isActive()) {\n                    this.editor.toggleTooltip(this.activeCellRectangle());\n                } else if (!sheet.selectionInProgress() && !sheet.resizingInProgress() && !sheet.isInEditMode()) {\n                    this.renderClipboardContents();\n                }\n            },\n            renderResizeHint: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var horizontal = ref.col !== -Infinity;\n                var style;\n                if (horizontal) {\n                    style = {\n                        height: this.scroller.clientHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: sheet.resizeHintPosition().x + 'px',\n                        top: '0px'\n                    };\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this.scroller.clientWidth + 'px',\n                        top: sheet.resizeHintPosition().y + 'px',\n                        left: '0px'\n                    };\n                }\n                var classNames = Pane.classNames;\n                return kendo.dom.element('div', {\n                    className: classNames.resizeHint + (!horizontal ? ' ' + classNames.resizeHintVertical : ''),\n                    style: style\n                }, [\n                    kendo.dom.element('div', { className: classNames.resizeHintHandle }),\n                    kendo.dom.element('div', { className: classNames.resizeHintMarker })\n                ]);\n            },\n            renderClipboardContents: function () {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                var selection = sheet.select().toRangeRef();\n                var status = this._workbook.clipboard().canCopy();\n                if (status.canCopy === false && status.multiSelection) {\n                    this.clipboardContents.render([]);\n                    this.selectClipBoardContents();\n                    return;\n                }\n                selection = sheet.trim(selection);\n                var table = new HtmlTable();\n                var selectionView = grid.rangeDimensions(selection);\n                selectionView.rows.forEach(function (height) {\n                    table.addRow(height);\n                });\n                selectionView.columns.forEach(function (width) {\n                    table.addColumn(width);\n                });\n                var primaryMergedCells = {};\n                var secondaryMergedCells = {};\n                sheet.forEachMergedCell(selection, function (ref) {\n                    var topLeft = ref.topLeft;\n                    grid.forEach(ref, function (cellRef) {\n                        if (topLeft.eq(cellRef)) {\n                            primaryMergedCells[cellRef.print()] = ref;\n                        } else {\n                            secondaryMergedCells[cellRef.print()] = true;\n                        }\n                    });\n                });\n                sheet.forEach(selection, function (row, col, cell) {\n                    var location = new CellRef(row, col).print();\n                    if (!secondaryMergedCells[location]) {\n                        var td = addCell(table, row - selection.topLeft.row, cell);\n                        var mergedCell = primaryMergedCells[location];\n                        if (mergedCell) {\n                            td.attr.colspan = mergedCell.width();\n                            td.attr.rowspan = mergedCell.height();\n                        }\n                    }\n                });\n                this.clipboardContents.render([table.toDomTree(0, 0, 'kendo-clipboard-' + this._workbook.clipboard()._uid)]);\n                this.selectClipBoardContents();\n            },\n            _pane: function (row, column, rowCount, columnCount) {\n                var pane = new Pane(this._sheet, this._sheet._grid.pane({\n                    row: row,\n                    column: column,\n                    rowCount: rowCount,\n                    columnCount: columnCount\n                }));\n                pane.refresh(this.scroller.clientWidth, this.scroller.clientHeight);\n                return pane;\n            }\n        });\n        var paneClassNames = {\n            cell: 'k-spreadsheet-cell',\n            vaxis: 'k-spreadsheet-vaxis',\n            haxis: 'k-spreadsheet-haxis',\n            rowHeader: 'k-spreadsheet-row-header',\n            columnHeader: 'k-spreadsheet-column-header',\n            pane: 'k-spreadsheet-pane',\n            data: 'k-spreadsheet-data',\n            mergedCell: 'k-spreadsheet-merged-cell',\n            mergedCellsWrapper: 'k-merged-cells-wrapper',\n            activeCell: 'k-spreadsheet-active-cell',\n            selection: 'k-spreadsheet-selection',\n            selectionWrapper: 'k-selection-wrapper',\n            autoFillWrapper: 'k-auto-fill-wrapper',\n            single: 'k-single',\n            top: 'k-top',\n            right: 'k-right',\n            bottom: 'k-bottom',\n            left: 'k-left',\n            resizeHandle: 'k-resize-handle',\n            resizeHint: 'k-resize-hint',\n            resizeHintHandle: 'k-resize-hint-handle',\n            resizeHintMarker: 'k-resize-hint-marker',\n            resizeHintVertical: 'k-resize-hint-vertical',\n            selectionHighlight: 'k-spreadsheet-selection-highlight',\n            series: [\n                'k-series-a',\n                'k-series-b',\n                'k-series-c',\n                'k-series-d',\n                'k-series-e',\n                'k-series-f'\n            ]\n        };\n        var Pane = kendo.Class.extend({\n            init: function (sheet, grid) {\n                this._sheet = sheet;\n                this._grid = grid;\n            },\n            refresh: function (width, height) {\n                this._grid.refresh(width, height);\n            },\n            isVisible: function (scrollLeft, scrollTop, ref) {\n                return this._grid.view(scrollLeft, scrollTop).ref.intersects(ref);\n            },\n            render: function (scrollLeft, scrollTop) {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var grid = this._grid;\n                var view = grid.view(scrollLeft, scrollTop);\n                this._currentView = view;\n                this._currentRect = this._rectangle(view.ref);\n                this._selectedHeaders = sheet.selectedHeaders();\n                var children = [];\n                children.push(this.renderData());\n                children.push(this.renderSelection());\n                children.push(this.renderAutoFill());\n                children.push(this.renderEditorSelection());\n                children.push(this.renderFilterHeaders());\n                if (grid.hasRowHeader) {\n                    var rowHeader = kendo.dom.element('div', {\n                        className: classNames.rowHeader,\n                        style: {\n                            width: grid.headerWidth + 'px',\n                            top: view.rowOffset + 'px'\n                        }\n                    });\n                    children.push(rowHeader);\n                    sheet.forEach(view.ref.leftColumn(), function (row) {\n                        if (!sheet.isHiddenRow(row)) {\n                            var text = row + 1, height = sheet.rowHeight(row);\n                            rowHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(row, 'row'),\n                                style: {\n                                    width: grid.headerWidth + 'px',\n                                    height: height + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                        }\n                    }.bind(this));\n                }\n                if (grid.hasColumnHeader) {\n                    var columnHeader = kendo.dom.element('div', {\n                        className: classNames.columnHeader,\n                        style: {\n                            top: '0px',\n                            left: view.columnOffset + 'px',\n                            width: this._currentRect.width + 'px',\n                            height: grid.headerHeight + 'px'\n                        }\n                    });\n                    children.push(columnHeader);\n                    var left = 0;\n                    sheet.forEach(view.ref.topRow(), function (row, col) {\n                        if (!sheet.isHiddenColumn(col)) {\n                            var text = kendo.spreadsheet.Ref.display(null, Infinity, col), width = sheet.columnWidth(col);\n                            columnHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(col, 'col'),\n                                style: {\n                                    position: 'absolute',\n                                    left: left + 'px',\n                                    width: width + 'px',\n                                    height: grid.headerHeight + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                            left += width;\n                        }\n                    }.bind(this));\n                }\n                if (sheet.resizeHandlePosition() && (grid.hasColumnHeader || grid.hasRowHeader)) {\n                    var ref = sheet._grid.normalize(sheet.resizeHandlePosition());\n                    if (view.ref.intersects(ref)) {\n                        if (!sheet.resizeHintPosition()) {\n                            children.push(this.renderResizeHandler());\n                        }\n                    }\n                }\n                var paneClasses = [classNames.pane];\n                if (grid.hasColumnHeader) {\n                    paneClasses.push(classNames.top);\n                }\n                if (grid.hasRowHeader) {\n                    paneClasses.push(classNames.left);\n                }\n                return kendo.dom.element('div', {\n                    style: grid.style,\n                    className: paneClasses.join(' ')\n                }, children);\n            },\n            headerClassName: function (index, type) {\n                var selectedHeaders = this._selectedHeaders;\n                var itemSelection;\n                var allHeaders;\n                if (type === 'row') {\n                    itemSelection = selectedHeaders.rows[index];\n                    allHeaders = selectedHeaders.allRows;\n                } else {\n                    itemSelection = selectedHeaders.cols[index];\n                    allHeaders = selectedHeaders.allCols;\n                }\n                var className = itemSelection || (selectedHeaders.all ? 'full' : allHeaders ? 'partial' : 'none');\n                if (className) {\n                    className = 'k-selection-' + className;\n                }\n                return className;\n            },\n            renderData: function () {\n                var view = this._currentView;\n                var cont = kendo.dom.element('div', {\n                    className: Pane.classNames.data,\n                    style: {\n                        position: 'relative',\n                        left: view.columnOffset + 'px',\n                        top: view.rowOffset + 'px'\n                    }\n                });\n                var rect = this._currentRect;\n                var layout = kendo.spreadsheet.draw.doLayout(this._sheet, view.ref, { forScreen: true }), prev;\n                var showGridLines = this._sheet.options.showGridLines;\n                if (showGridLines) {\n                    prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        if (x !== prev) {\n                            prev = x;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.vaxis,\n                                style: {\n                                    left: x + 'px',\n                                    height: rect.height + 'px'\n                                }\n                            }));\n                        }\n                    });\n                    prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        if (y !== prev) {\n                            prev = y;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.haxis,\n                                style: {\n                                    top: y + 'px',\n                                    width: rect.width + 'px'\n                                }\n                            }));\n                        }\n                    });\n                }\n                var vBorders = {}, hBorders = {};\n                layout.cells.forEach(function (cell) {\n                    var hb = hBorders[cell.col] || (hBorders[cell.col] = {});\n                    var vb = vBorders[cell.row] || (vBorders[cell.row] = {});\n                    drawCell(cont.children, cell, null, hb, vb, showGridLines);\n                });\n                return cont;\n            },\n            renderResizeHandler: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var rectangle = this._rectangle(ref);\n                var style;\n                if (ref.col !== -Infinity) {\n                    style = {\n                        height: this._grid.headerHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: rectangle.right - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        top: '0px'\n                    };\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this._grid.headerWidth + 'px',\n                        top: rectangle.bottom - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        left: '0px'\n                    };\n                }\n                return kendo.dom.element('div', {\n                    className: Pane.classNames.resizeHandle,\n                    style: style\n                });\n            },\n            filterIconRect: function (rect) {\n                var BUTTON_SIZE = 16;\n                var BUTTON_OFFSET = 3;\n                return new kendo.spreadsheet.Rectangle(rect.right - BUTTON_SIZE - BUTTON_OFFSET, rect.top + BUTTON_OFFSET, BUTTON_SIZE, BUTTON_SIZE);\n            },\n            renderFilterHeaders: function () {\n                var sheet = this._sheet;\n                var children = [];\n                var classNames = View.classNames;\n                var index = 0;\n                var filter = sheet.filter();\n                function icon(className) {\n                    return kendo.dom.element('span', { className: classNames.icon + ' ' + className });\n                }\n                function filterButton(classNames, position, index) {\n                    var style = {\n                        left: position.left + 'px',\n                        top: position.top + 'px'\n                    };\n                    var filtered = filter && filter.columns.some(function (c) {\n                        return c.index === index;\n                    });\n                    var classes = classNames.filterButton;\n                    if (filtered) {\n                        classes += ' ' + classNames.filterButtonActive;\n                    }\n                    var button = kendo.dom.element('span', {\n                        className: classes,\n                        style: style,\n                        'data-column': index\n                    }, [icon(classNames.iconFilterDefault)]);\n                    return button;\n                }\n                if (filter) {\n                    this._addDiv(children, filter.ref, classNames.filterRange);\n                }\n                sheet.forEachFilterHeader(this._currentView.ref, function (ref) {\n                    var rect = this._rectangle(ref);\n                    var position = this.filterIconRect(rect);\n                    var button = filterButton(classNames, position, index);\n                    index++;\n                    children.push(button);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.filterHeadersWrapper }, children);\n            },\n            renderEditorSelection: function () {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var selections = [];\n                sheet._formulaSelections.forEach(function (range) {\n                    var ref = range.ref;\n                    if (ref === kendo.spreadsheet.NULLREF) {\n                        return;\n                    }\n                    this._addDiv(selections, ref, classNames.selectionHighlight + ' ' + range.colorClass);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderSelection: function () {\n                var classNames = Pane.classNames;\n                var selections = [];\n                var activeCellClasses = [classNames.activeCell];\n                var selectionClasses = [classNames.selection];\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell().toRangeRef();\n                var activeFormulaColor = this._activeFormulaColor();\n                var selection = sheet.select();\n                activeCellClasses = activeCellClasses.concat(activeFormulaColor, this._directionClasses(activeCell));\n                selectionClasses = selectionClasses.concat(activeFormulaColor);\n                if (sheet.singleCellSelection()) {\n                    activeCellClasses.push(classNames.single);\n                }\n                if (selection.size() === 1) {\n                    selectionClasses.push('k-single-selection');\n                }\n                if (this._sheet.autoFillPunch()) {\n                    selectionClasses.push('k-dim-auto-fill-handle');\n                }\n                selection.forEach(function (ref) {\n                    if (ref !== kendo.spreadsheet.NULLREF) {\n                        this._addDiv(selections, ref, selectionClasses.join(' '));\n                    }\n                }.bind(this));\n                this._addTable(selections, activeCell, activeCellClasses.join(' '));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderAutoFill: function () {\n                var autoFillRectangle = [];\n                if (this._sheet.autoFillInProgress()) {\n                    var autoFillRef = this._sheet.autoFillRef();\n                    var punch = this._sheet.autoFillPunch();\n                    var direction = this._sheet._autoFillDirection;\n                    this._addDiv(autoFillRectangle, autoFillRef, 'k-auto-fill');\n                    if (punch) {\n                        this._addDiv(autoFillRectangle, punch, 'k-auto-fill-punch');\n                    } else if (direction !== undefined) {\n                        var ref, cssClass;\n                        switch (direction) {\n                        case 0:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 1:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 2:\n                            ref = new CellRef(autoFillRef.topLeft.row, autoFillRef.bottomRight.col);\n                            cssClass = 'k-auto-fill-tr-hint';\n                            break;\n                        case 3:\n                            ref = new CellRef(autoFillRef.bottomRight.row, autoFillRef.topLeft.col);\n                            cssClass = 'k-auto-fill-bl-hint';\n                            break;\n                        }\n                        var hint = kendo.dom.element('span', { className: 'k-tooltip' }, [kendo.dom.text(this._sheet._autoFillHint)]);\n                        var rectangle = this._addDiv(autoFillRectangle, ref, cssClass);\n                        if (rectangle) {\n                            rectangle.children.push(hint);\n                        }\n                    }\n                }\n                return kendo.dom.element('div', { className: Pane.classNames.autoFillWrapper }, autoFillRectangle);\n            },\n            _addDiv: function (collection, ref, className) {\n                var view = this._currentView, div;\n                if (view.ref.intersects(ref)) {\n                    div = this._rectangle(ref).resize(1, 1).toDiv(className);\n                    collection.push(div);\n                }\n                return div;\n            },\n            _addTable: function (collection, ref, className) {\n                var sheet = this._sheet;\n                var view = this._currentView;\n                if (view.ref.intersects(ref)) {\n                    sheet.forEach(ref.collapse(), function (row, col, cell) {\n                        var rectangle = this._rectangle(ref);\n                        cell.left = rectangle.left;\n                        cell.top = rectangle.top;\n                        cell.width = rectangle.width;\n                        cell.height = rectangle.height;\n                        drawCell(collection, cell, className, null, null, true);\n                    }.bind(this));\n                }\n            },\n            _activeFormulaColor: function () {\n                var activeFormulaSelection;\n                var colorClasses = [];\n                if (this._sheet.isInEditMode()) {\n                    activeFormulaSelection = this._sheet._formulaSelections.filter(function (sel) {\n                        return sel.active && sel.type == 'ref';\n                    })[0];\n                    if (activeFormulaSelection) {\n                        colorClasses.push(activeFormulaSelection.colorClass);\n                    }\n                }\n                return colorClasses;\n            },\n            _directionClasses: function (cell) {\n                var cellClasses = [];\n                var classNames = Pane.classNames;\n                var view = this._currentView.ref;\n                if (!cell.move(0, -1).intersects(view)) {\n                    cellClasses.push(classNames.left);\n                }\n                if (!cell.move(-1, 0).intersects(view)) {\n                    cellClasses.push(classNames.top);\n                }\n                if (!cell.move(0, 1).intersects(view)) {\n                    cellClasses.push(classNames.right);\n                }\n                if (!cell.move(1, 0).intersects(view)) {\n                    cellClasses.push(classNames.bottom);\n                }\n                return cellClasses;\n            },\n            _rectangle: function (ref) {\n                return this._grid.boundingRectangle(ref.toRangeRef()).offset(-this._currentView.mergedCellLeft, -this._currentView.mergedCellTop);\n            }\n        });\n        kendo.spreadsheet.View = View;\n        kendo.spreadsheet.Pane = Pane;\n        kendo.spreadsheet.drawCell = drawCell;\n        $.extend(true, View, { classNames: viewClassNames });\n        $.extend(true, Pane, { classNames: paneClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/grid', [\n        'kendo.core',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var Rectangle = kendo.Class.extend({\n            init: function (left, top, width, height) {\n                this.left = left;\n                this.width = width;\n                this.right = left + width;\n                this.top = top;\n                this.height = height;\n                this.bottom = top + height;\n            },\n            offset: function (left, top) {\n                return new Rectangle(this.left + left, this.top + top, this.width, this.height);\n            },\n            resize: function (width, height) {\n                return new Rectangle(this.left, this.top, this.width + width, this.height + height);\n            },\n            intersects: function (x, y) {\n                return this.left < x && x < this.left + this.width && this.top < y && y < this.top + this.height;\n            },\n            toDiv: function (className) {\n                return kendo.dom.element('div', {\n                    className: className,\n                    style: {\n                        width: this.width + 'px',\n                        height: this.height + 'px',\n                        top: this.top + 'px',\n                        left: this.left + 'px'\n                    }\n                });\n            }\n        });\n        var Grid = kendo.Class.extend({\n            init: function (rows, columns, rowCount, columnCount, headerHeight, headerWidth) {\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this._columns = columns;\n                this._rows = rows;\n                this._headerHeight = headerHeight;\n                this._headerWidth = headerWidth;\n            },\n            isAxis: function (ref) {\n                ref = ref.toRangeRef();\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                return topLeft.row === 0 && bottomRight.row === this.rowCount - 1 || topLeft.col === 0 && bottomRight.col === this.columnCount - 1;\n            },\n            width: function (start, end) {\n                return this._columns.sum(start, end);\n            },\n            height: function (start, end) {\n                return this._rows.sum(start, end);\n            },\n            totalHeight: function () {\n                return this._rows.total + this._headerHeight;\n            },\n            totalWidth: function () {\n                return this._columns.total + this._headerWidth;\n            },\n            index: function (row, column) {\n                return column * this.rowCount + row;\n            },\n            cellRef: function (index) {\n                return new CellRef(index % this.rowCount, index / this.rowCount >> 0);\n            },\n            rowRef: function (row) {\n                return new RangeRef(new CellRef(row, 0), new CellRef(row, this.columnCount - 1));\n            },\n            colRef: function (col) {\n                return new RangeRef(new CellRef(0, col), new CellRef(this.rowCount - 1, col));\n            },\n            cellRefIndex: function (ref) {\n                return this.index(ref.row, ref.col);\n            },\n            normalize: function (ref) {\n                if (ref instanceof RangeRef) {\n                    return new RangeRef(this.normalize(ref.topLeft), this.normalize(ref.bottomRight)).setSheet(ref.sheet, ref.hasSheet());\n                }\n                if (ref instanceof UnionRef) {\n                    return ref.map(function (ref) {\n                        return this.normalize(ref);\n                    }, this);\n                }\n                var clone = ref.clone();\n                clone.col = Math.max(0, Math.min(this.columnCount - 1, ref.col));\n                clone.row = Math.max(0, Math.min(this.rowCount - 1, ref.row));\n                return clone;\n            },\n            rectangle: function (ref) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                return new Rectangle(this.width(0, topLeft.col - 1), this.height(0, topLeft.row - 1), this.width(topLeft.col, bottomRight.col), this.height(topLeft.row, bottomRight.row));\n            },\n            pane: function (options) {\n                return new PaneGrid(new kendo.spreadsheet.PaneAxis(this._rows, options.row, options.rowCount, this._headerHeight), new kendo.spreadsheet.PaneAxis(this._columns, options.column, options.columnCount, this._headerWidth), this);\n            },\n            rangeDimensions: function (rangeRef) {\n                return {\n                    rows: this._rows.values.iterator(rangeRef.topLeft.row, rangeRef.bottomRight.row),\n                    columns: this._columns.values.iterator(rangeRef.topLeft.col, rangeRef.bottomRight.col)\n                };\n            },\n            forEach: function (ref, callback) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    for (var ri = topLeft.row; ri <= bottomRight.row; ri++) {\n                        callback(new CellRef(ri, ci));\n                    }\n                }\n            },\n            trim: function (ref, property) {\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                var bottomRightRow = topLeft.row;\n                var bottomRightCol = topLeft.col;\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var start = this.index(topLeft.row, ci);\n                    var end = this.index(bottomRight.row, ci);\n                    var values = property.tree.intersecting(start, end);\n                    if (values.length) {\n                        var cell = this.cellRef(values[values.length - 1].end);\n                        bottomRightRow = Math.max(bottomRightRow, cell.row);\n                        bottomRightCol = ci;\n                    }\n                }\n                return new RangeRef(ref.topLeft, new CellRef(Math.min(bottomRightRow, ref.bottomRight.row), bottomRightCol));\n            }\n        });\n        var PaneGrid = kendo.Class.extend({\n            init: function (rows, columns, grid) {\n                this.rows = rows;\n                this.columns = columns;\n                this._grid = grid;\n                this.headerHeight = rows.headerSize;\n                this.headerWidth = columns.headerSize;\n                this.hasRowHeader = columns.hasHeader;\n                this.hasColumnHeader = rows.hasHeader;\n            },\n            refresh: function (width, height) {\n                this.columns.viewSize(width);\n                this.rows.viewSize(height);\n                var x = this.columns.paneSegment();\n                var y = this.rows.paneSegment();\n                this.left = x.offset;\n                this.top = y.offset;\n                this.right = x.offset + x.length;\n                this.bottom = y.offset + y.length;\n                this.style = {\n                    top: y.offset + 'px',\n                    left: x.offset + 'px',\n                    height: y.length + 'px',\n                    width: x.length + 'px'\n                };\n            },\n            view: function (left, top) {\n                var rows = this.rows.visible(top);\n                var columns = this.columns.visible(left);\n                return {\n                    rows: rows,\n                    columns: columns,\n                    rowOffset: rows.offset,\n                    columnOffset: columns.offset,\n                    mergedCellLeft: columns.start,\n                    mergedCellTop: rows.start,\n                    ref: new RangeRef(new CellRef(rows.values.start, columns.values.start), new CellRef(rows.values.end, columns.values.end))\n                };\n            },\n            contains: function (ref) {\n                return this.rows.contains(ref.topLeft.row, ref.bottomRight.row) && this.columns.contains(ref.topLeft.col, ref.bottomRight.col);\n            },\n            index: function (row, column) {\n                return this._grid.index(row, column);\n            },\n            boundingRectangle: function (ref) {\n                return this._grid.rectangle(ref);\n            },\n            cellRefIndex: function (ref) {\n                return this._grid.cellRefIndex(ref);\n            },\n            scrollBoundaries: function (cell) {\n                var position = this.boundingRectangle(cell);\n                var boundaries = {\n                    top: Math.max(0, position.top - this.top + (this.hasColumnHeader ? 0 : this.headerHeight)),\n                    left: Math.max(0, position.left - this.left + (this.hasRowHeader ? 0 : this.headerWidth)),\n                    right: position.right - this.columns._viewSize + this.headerWidth,\n                    bottom: position.bottom - this.rows._viewSize + this.headerHeight\n                };\n                var widthCompensation = this.columns.defaultValue / 2;\n                var heightCompensation = this.rows.defaultValue / 2;\n                boundaries.scrollTop = boundaries.top - heightCompensation;\n                boundaries.scrollBottom = boundaries.bottom + heightCompensation;\n                boundaries.scrollLeft = boundaries.left - widthCompensation;\n                boundaries.scrollRight = boundaries.right + widthCompensation;\n                return boundaries;\n            }\n        });\n        kendo.spreadsheet.Grid = Grid;\n        kendo.spreadsheet.PaneGrid = PaneGrid;\n        kendo.spreadsheet.Rectangle = Rectangle;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axis', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Axis = kendo.Class.extend({\n            init: function (count, value) {\n                this._value = value;\n                this._count = count;\n                this.values = new kendo.spreadsheet.RangeList(0, count - 1, value);\n                this._hidden = new kendo.spreadsheet.RangeList(0, count - 1, 0);\n                this.scrollBarSize = kendo.support.scrollbar();\n                this._refresh();\n            },\n            toJSON: function (field, positions) {\n                var values = [];\n                var iterator = this.values.iterator(0, this._count - 1);\n                for (var idx = 0; idx < this._count; idx++) {\n                    var value = iterator.at(idx);\n                    if (value === this._value) {\n                        continue;\n                    }\n                    var position = positions[idx];\n                    if (position === undefined) {\n                        position = values.length;\n                        var item = { index: idx };\n                        item[field] = value;\n                        values.push(item);\n                        positions[idx] = position;\n                    }\n                }\n                return values;\n            },\n            fromJSON: function (field, values) {\n                for (var idx = 0; idx < values.length; idx++) {\n                    var value = values[idx][field];\n                    var index = values[idx].index;\n                    if (index === undefined) {\n                        index = idx;\n                    }\n                    this.value(index, index, value);\n                }\n            },\n            hide: function (index) {\n                if (!this.hidden(index)) {\n                    var value = this.value(index, index);\n                    this._hidden.value(index, index, value);\n                    this.value(index, index, 0);\n                }\n            },\n            hidden: function (index) {\n                return this._hidden.value(index, index) !== 0;\n            },\n            includesHidden: function (start, end) {\n                return this._hidden.intersecting(start, end).length > 1;\n            },\n            nextVisible: function (index, overflow) {\n                var end = this._count - 1;\n                if (index === end) {\n                    return overflow ? index + 1 : index;\n                }\n                index += 1;\n                var range = this._hidden.intersecting(index, index)[0];\n                if (range.value !== 0) {\n                    if (range.end === end) {\n                        return index - 1;\n                    } else {\n                        return range.end + 1;\n                    }\n                } else {\n                    return index;\n                }\n            },\n            nextPage: function (index, pageSize) {\n                return this.index(this.sum(0, index - 1) + pageSize);\n            },\n            prevPage: function (index, pageSize) {\n                return this.index(this.sum(0, index) - pageSize);\n            },\n            firstVisible: function () {\n                var firstHidden = this._hidden.first();\n                if (firstHidden.value === 0) {\n                    return 0;\n                } else {\n                    return firstHidden.end + 1;\n                }\n            },\n            lastVisible: function () {\n                var lastHidden = this._hidden.last();\n                if (lastHidden.value === 0) {\n                    return this._count - 1;\n                } else {\n                    return lastHidden.start - 1;\n                }\n            },\n            prevVisible: function (index, overflow) {\n                if (index === 0) {\n                    return overflow ? -1 : 0;\n                }\n                index -= 1;\n                var range = this._hidden.intersecting(index, index)[0];\n                if (range.value !== 0) {\n                    if (range.start === 0) {\n                        return index + 1;\n                    } else {\n                        return range.start - 1;\n                    }\n                } else {\n                    return index;\n                }\n            },\n            unhide: function (index) {\n                if (this.hidden(index)) {\n                    var value = this._hidden.value(index, index);\n                    this._hidden.value(index, index, 0);\n                    this.value(index, index, value);\n                }\n            },\n            value: function (start, end, value) {\n                if (value !== undefined) {\n                    this.values.value(start, end, value);\n                    this._refresh();\n                } else {\n                    return this.values.iterator(start, end).at(0);\n                }\n            },\n            sum: function (start, end) {\n                var values = this.values.iterator(start, end);\n                var sum = 0;\n                for (var idx = start; idx <= end; idx++) {\n                    sum += values.at(idx);\n                }\n                return sum;\n            },\n            visible: function (start, end) {\n                var startSegment = null;\n                var endSegment = null;\n                var lastPage = false;\n                if (end >= this.total + this.scrollBarSize) {\n                    lastPage = true;\n                }\n                var ranges = this._pixelValues.intersecting(start, end);\n                startSegment = ranges[0];\n                endSegment = ranges[ranges.length - 1];\n                var startOffset = start - startSegment.start;\n                var startIndex = (startOffset / startSegment.value.value >> 0) + startSegment.value.start;\n                var offset = startOffset - (startIndex - startSegment.value.start) * startSegment.value.value;\n                var endOffset = end - endSegment.start;\n                var endIndex = (endOffset / endSegment.value.value >> 0) + endSegment.value.start;\n                if (endIndex > endSegment.value.end) {\n                    endIndex = endSegment.value.end;\n                }\n                if (lastPage) {\n                    offset += endSegment.value.value - (endOffset - (endIndex - endSegment.value.start) * endSegment.value.value);\n                }\n                offset = Math.min(-offset, 0);\n                return {\n                    values: this.values.iterator(startIndex, endIndex),\n                    offset: offset\n                };\n            },\n            index: function (value) {\n                var index = 0;\n                var iterator = this.values.iterator(0, this._count - 1);\n                var current = iterator.at(0);\n                while (current < value && index < this._count - 1) {\n                    current += iterator.at(++index);\n                }\n                return index;\n            },\n            _refresh: function () {\n                var current = 0;\n                this._pixelValues = this.values.map(function (range) {\n                    var start = current;\n                    current += (range.end - range.start + 1) * range.value;\n                    var end = current - 1;\n                    return new kendo.spreadsheet.ValueRange(start, end, range);\n                });\n                this.total = current;\n            },\n            getState: function () {\n                return {\n                    values: this.values.getState(),\n                    hidden: this._hidden.getState()\n                };\n            },\n            setState: function (state) {\n                this.values.setState(state.values);\n                this._hidden.setState(state.hidden);\n                this._refresh();\n            }\n        });\n        var PaneAxis = kendo.Class.extend({\n            init: function (axis, start, count, headerSize) {\n                this._axis = axis;\n                this._start = start;\n                this._count = count;\n                this.hasHeader = start === 0;\n                this.headerSize = headerSize;\n                this.defaultValue = axis._value;\n                this.frozen = count > 0;\n            },\n            viewSize: function (viewSize) {\n                this._viewSize = viewSize;\n            },\n            sum: function (start, end) {\n                return this._axis.sum(start, end - 1);\n            },\n            start: function () {\n                return this.sum(0, this._start);\n            },\n            size: function () {\n                return this.sum(this._start, this._start + this._count);\n            },\n            index: function (value, offset) {\n                return this._axis.index(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n            paneSegment: function () {\n                var offset = this.start();\n                var length;\n                if (!this.hasHeader) {\n                    offset += this.headerSize;\n                }\n                if (this.frozen) {\n                    length = this.size();\n                    if (this.hasHeader) {\n                        length += this.headerSize;\n                    } else {\n                        length -= this.headerSize;\n                    }\n                } else {\n                    length = this._viewSize - offset;\n                }\n                return {\n                    offset: offset,\n                    length: length\n                };\n            },\n            visible: function (offset) {\n                var start = this.start();\n                var size;\n                if (this.frozen) {\n                    size = this.size();\n                    if (!this.hasHeader) {\n                        size -= this.headerSize;\n                    }\n                } else {\n                    size = this._viewSize - start - this.headerSize;\n                    start += offset;\n                }\n                var result = this._axis.visible(start, start + size - 1);\n                if (this.frozen) {\n                    result.offset = 0;\n                }\n                result.start = start;\n                if (this.hasHeader) {\n                    result.offset += this.headerSize;\n                    result.start -= this.headerSize;\n                }\n                return result;\n            },\n            contains: function (start, end) {\n                if (this.frozen) {\n                    if (start > this._start + this._count) {\n                        return false;\n                    }\n                    if (end < this._start) {\n                        return false;\n                    }\n                    return true;\n                } else {\n                    return end >= this._start;\n                }\n            }\n        });\n        kendo.spreadsheet.Axis = Axis;\n        kendo.spreadsheet.PaneAxis = PaneAxis;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filter', [\n        'kendo.core',\n        'kendo.data'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Filter = kendo.spreadsheet.Filter = kendo.Class.extend({\n            prepare: function () {\n            },\n            value: function (cell) {\n                return cell.value;\n            },\n            matches: function () {\n                throw new Error('The \\'matches\\' method is not implemented.');\n            },\n            toJSON: function () {\n                throw new Error('The \\'toJSON\\' method is not implemented.');\n            }\n        });\n        Filter.create = function (options) {\n            var filter = options.filter;\n            if (!filter) {\n                throw new Error('Filter type not specified.');\n            }\n            var constructor = kendo.spreadsheet[filter.charAt(0).toUpperCase() + filter.substring(1) + 'Filter'];\n            if (!constructor) {\n                throw new Error('Filter type not recognized.');\n            }\n            return new constructor(options);\n        };\n        kendo.spreadsheet.ValueFilter = Filter.extend({\n            _values: [],\n            _dates: [],\n            _blanks: false,\n            init: function (options) {\n                if (options.values !== undefined) {\n                    this._values = options.values;\n                }\n                if (options.blanks !== undefined) {\n                    this._blanks = options.blanks;\n                }\n                if (options.dates !== undefined) {\n                    this._dates = options.dates;\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (this._dates.length > 0 && cell.format && typeof value === 'number') {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            matches: function (value) {\n                if (value === null || value === undefined) {\n                    return this._blanks;\n                }\n                if (value instanceof Date) {\n                    return this._dates.some(function (date) {\n                        return date.year === value.getFullYear() && (date.month === undefined || date.month === value.getMonth()) && (date.day === undefined || date.day === value.getDate()) && (date.hours === undefined || date.hours === value.getHours()) && (date.minutes === undefined || date.minutes === value.getMinutes()) && (date.seconds === undefined || date.seconds === value.getSeconds());\n                    });\n                }\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'value',\n                    values: this._values.slice(0)\n                };\n            }\n        });\n        kendo.spreadsheet.CustomFilter = Filter.extend({\n            _logic: 'and',\n            init: function (options) {\n                if (options.logic !== undefined) {\n                    this._logic = options.logic;\n                }\n                if (options.criteria === undefined) {\n                    throw new Error('Must specify criteria.');\n                }\n                this._criteria = options.criteria;\n                var expression = kendo.data.Query.filterExpr({\n                    logic: this._logic,\n                    filters: this._criteria\n                }).expression;\n                this._matches = new Function('d', 'return ' + expression);\n            },\n            matches: function (value) {\n                if (value === null) {\n                    return false;\n                }\n                return this._matches(value);\n            },\n            value: function (cell) {\n                var value = cell.value;\n                var criterionValue = this._criteria[0].value;\n                var criterionType = criterionValue instanceof Date ? 'date' : typeof criterionValue;\n                var valueType = typeof value;\n                if (cell.format) {\n                    valueType = kendo.spreadsheet.formatting.type(value, cell.format);\n                }\n                if (valueType != criterionType) {\n                    if (criterionType == 'string') {\n                        if (cell.format) {\n                            value = kendo.spreadsheet.formatting.text(value, cell.format);\n                        }\n                        value = value + '';\n                    }\n                } else if (valueType == 'date') {\n                    value = kendo.spreadsheet.numberToDate(value);\n                }\n                return value;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'custom',\n                    logic: this._logic,\n                    criteria: this._criteria\n                };\n            }\n        });\n        kendo.spreadsheet.TopFilter = Filter.extend({\n            init: function (options) {\n                this._type = options.type;\n                this._value = options.value;\n                this._values = [];\n            },\n            prepare: function (cells) {\n                var values = cells.map(this.value).sort().filter(function (value, index, array) {\n                    return index === 0 || value !== array[index - 1];\n                });\n                if (this._type === 'topNumber' || this._type == 'topPercent') {\n                    values.sort(function (x, y) {\n                        return y - x;\n                    });\n                } else {\n                    values.sort(function (x, y) {\n                        return x - y;\n                    });\n                }\n                var count = this._value;\n                if (this._type === 'topPercent' || this._type === 'bottomPercent') {\n                    count = values.length * count / 100 >> 0;\n                }\n                this._values = values.slice(0, count);\n            },\n            matches: function (value) {\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'top',\n                    type: this._type,\n                    value: this._value\n                };\n            }\n        });\n        kendo.spreadsheet.DynamicFilter = Filter.extend({\n            init: function (options) {\n                this._type = options.type;\n                this._predicate = this[options.type];\n                if (typeof this._predicate !== 'function') {\n                    throw new Error('DynamicFilter type \\'' + options.type + '\\' not recognized.');\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (cell.format) {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            prepare: function (cells) {\n                var sum = 0;\n                var count = 0;\n                for (var ci = 0; ci < cells.length; ci++) {\n                    var value = this.value(cells[ci]);\n                    if (typeof value === 'number') {\n                        sum += value;\n                        count++;\n                    }\n                }\n                if (count > 0) {\n                    this._average = sum / count;\n                } else {\n                    this._average = 0;\n                }\n            },\n            matches: function (value) {\n                return this._predicate(value);\n            },\n            aboveAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value > this._average;\n            },\n            belowAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value < this._average;\n            },\n            tomorrow: function (value) {\n                if (value instanceof Date) {\n                    var tomorrow = kendo.date.addDays(kendo.date.today(), 1);\n                    return kendo.date.getDate(value).getTime() === tomorrow.getTime();\n                }\n                return false;\n            },\n            today: function (value) {\n                if (value instanceof Date) {\n                    return kendo.date.isToday(value);\n                }\n                return false;\n            },\n            yesterday: function (value) {\n                if (value instanceof Date) {\n                    var yesterday = kendo.date.addDays(kendo.date.today(), -1);\n                    return kendo.date.getDate(value).getTime() === yesterday.getTime();\n                }\n                return false;\n            },\n            nextWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), 7), value);\n            },\n            thisWeek: function (value) {\n                return sameWeek(kendo.date.today(), value);\n            },\n            lastWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), -7), value);\n            },\n            nextMonth: function (value) {\n                return sameMonth(value, 1);\n            },\n            thisMonth: function (value) {\n                return sameMonth(value, 0);\n            },\n            lastMonth: function (value) {\n                return sameMonth(value, -1);\n            },\n            nextQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() + 1 === value.getFullYear();\n                }\n                return false;\n            },\n            thisQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 0 && today.getFullYear() === value.getFullYear();\n                }\n                return false;\n            },\n            lastQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(today) - quarter(value);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() - 1 === value.getFullYear();\n                }\n                return false;\n            },\n            nextYear: function (value) {\n                return sameYear(value, 1);\n            },\n            thisYear: function (value) {\n                return sameYear(value, 0);\n            },\n            lastYear: function (value) {\n                return sameYear(value, -1);\n            },\n            yearToDate: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    return value.getFullYear() === today.getFullYear() && value <= today;\n                }\n                return false;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'dynamic',\n                    type: this._type\n                };\n            }\n        });\n        [\n            1,\n            2,\n            3,\n            4\n        ].forEach(function (target) {\n            kendo.spreadsheet.DynamicFilter.prototype['quarter' + target] = function (value) {\n                if (value instanceof Date) {\n                    return quarter(value) === target;\n                }\n                return false;\n            };\n        });\n        kendo.cultures['en-US'].calendar.months.names.forEach(function (month, index) {\n            kendo.spreadsheet.DynamicFilter.prototype[month.toLowerCase()] = function (value) {\n                if (value instanceof Date) {\n                    return value.getMonth() === index;\n                }\n                return false;\n            };\n        });\n        function quarter(value) {\n            var month = value.getMonth() + 1;\n            if (month >= 1 && month <= 3) {\n                return 1;\n            } else if (month >= 4 && month <= 6) {\n                return 2;\n            } else if (month >= 7 && month <= 9) {\n                return 3;\n            } else {\n                return 4;\n            }\n        }\n        function sameYear(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n                today.setFullYear(today.getFullYear() + offset);\n                return today.getFullYear() === value.getFullYear();\n            }\n            return false;\n        }\n        function sameMonth(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.firstDayOfMonth(kendo.date.today());\n                today.setMonth(today.getMonth() + offset, 1);\n                return today.getTime() === kendo.date.firstDayOfMonth(value).getTime();\n            }\n            return false;\n        }\n        function sameWeek(a, b) {\n            if (b instanceof Date) {\n                var firstWeek = kendo.date.dayOfWeek(kendo.date.getDate(a), 1);\n                var secondWeek = kendo.date.dayOfWeek(kendo.date.getDate(b), 1);\n                return firstWeek.getTime() === secondWeek.getTime();\n            }\n            return false;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sorter', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Sorter = kendo.Class.extend({\n            init: function (grid, lists) {\n                this._grid = grid;\n                this._lists = lists;\n            },\n            indices: function (rangeRef, list, ascending, indices) {\n                var comparer = Sorter.ascendingComparer;\n                if (ascending === false) {\n                    comparer = Sorter.descendingComparer;\n                }\n                return list.sortedIndices(this._grid.cellRefIndex(rangeRef.topLeft), this._grid.cellRefIndex(rangeRef.bottomRight), comparer, indices);\n            },\n            sortBy: function (ref, column, list, ascending, indices) {\n                var sortedIndices = this.indices(ref.toColumn(column), list, ascending, indices);\n                for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col; ci++) {\n                    var start = this._grid.index(ref.topLeft.row, ci);\n                    var end = this._grid.index(ref.bottomRight.row, ci);\n                    for (var li = 0; li < this._lists.length; li++) {\n                        if (start < this._lists[li].lastRangeStart()) {\n                            this._lists[li].sort(start, end, sortedIndices);\n                        }\n                    }\n                }\n                return sortedIndices;\n            }\n        });\n        Sorter.ascendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            var typeA = typeof a;\n            var typeB = typeof b;\n            if (typeA === 'number') {\n                if (typeB === 'number') {\n                    return a - b;\n                } else {\n                    return -1;\n                }\n            }\n            if (typeA === 'string') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return a.localeCompare(b);\n                default:\n                    return -1;\n                }\n            }\n            if (typeA === 'boolean') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return 1;\n                case 'boolean':\n                    return a - b;\n                default:\n                    return -1;\n                }\n            }\n            if (a instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                if (b instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                    return 0;\n                } else {\n                    return 1;\n                }\n            }\n            throw new Error('Cannot compare ' + a + ' and ' + b);\n        };\n        Sorter.descendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            return Sorter.ascendingComparer(b, a);\n        };\n        kendo.spreadsheet.Sorter = Sorter;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/numformat', [\n        'spreadsheet/calc',\n        'kendo.dom'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = kendo.spreadsheet.calc;\n    var dom = kendo.dom;\n    var RX_COLORS = /^\\[(black|green|white|blue|magenta|yellow|cyan|red)\\]/i;\n    var RX_CONDITION = /^\\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\\]/;\n    function parse(input) {\n        input = calc.InputStream(input);\n        var sections = [], haveTimePart = false, haveConditional = false, decimalPart;\n        while (!input.eof()) {\n            var sec = readSection();\n            sections.push(sec);\n            if (sec.cond) {\n                haveConditional = true;\n            }\n        }\n        function addPlainText() {\n            sections.push({\n                cond: 'text',\n                body: [{ type: 'text' }]\n            });\n        }\n        if (haveConditional) {\n            addPlainText();\n        } else if (sections.length == 1) {\n            sections[0].cond = 'num';\n            addPlainText();\n        } else if (sections.length == 2) {\n            sections[0].cond = {\n                op: '>=',\n                value: 0\n            };\n            sections[1].cond = {\n                op: '<',\n                value: 0\n            };\n            addPlainText();\n        } else if (sections.length >= 3) {\n            sections[0].cond = {\n                op: '>',\n                value: 0\n            };\n            sections[1].cond = {\n                op: '<',\n                value: 0\n            };\n            sections[2].cond = {\n                op: '=',\n                value: 0\n            };\n            addPlainText();\n            if (sections.length > 3) {\n                sections[3].cond = 'text';\n                sections = sections.slice(0, 4);\n            }\n        }\n        return sections;\n        function maybeColor() {\n            var m = input.skip(RX_COLORS);\n            if (m) {\n                return m[1].toLowerCase();\n            }\n        }\n        function maybeCondition() {\n            var m = input.skip(RX_CONDITION);\n            if (m) {\n                var val = parseFloat(m[2]);\n                if (!isNaN(val)) {\n                    return {\n                        op: m[1],\n                        value: val\n                    };\n                }\n            }\n        }\n        function readFormat() {\n            var format = [], tok;\n            LOOP:\n                while (!input.eof() && (tok = readNext())) {\n                    format.push(tok);\n                }\n            return format;\n        }\n        function readNext() {\n            var ch, m;\n            if (m = input.skip(/^([#0?]+),([#0?]+)/)) {\n                return {\n                    type: 'digit',\n                    sep: true,\n                    format: m[1] + m[2],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^[#0?]+/)) {\n                return {\n                    type: 'digit',\n                    sep: false,\n                    format: m[0],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^(e)([+-])/i)) {\n                return {\n                    type: 'exp',\n                    ch: m[1],\n                    sign: m[2]\n                };\n            }\n            if (m = input.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i)) {\n                var type = 'date', m = m[1].toLowerCase();\n                if (haveTimePart && (m == 'm' || m == 'mm')) {\n                    type = 'time';\n                }\n                haveTimePart = false;\n                return {\n                    type: type,\n                    part: m.charAt(0),\n                    format: m.length\n                };\n            }\n            if (m = input.skip(/^(hh?|ss?)/i)) {\n                haveTimePart = true;\n                m = m[1].toLowerCase();\n                return {\n                    type: 'time',\n                    part: m.charAt(0),\n                    format: m.length\n                };\n            }\n            if (m = input.skip(/^\\[(hh?|mm?|ss?)\\]/i)) {\n                haveTimePart = true;\n                m = m[1].toLowerCase();\n                return {\n                    type: 'eltime',\n                    part: m.charAt(0),\n                    format: m.length\n                };\n            }\n            if (m = input.skip(/^(am\\/pm|a\\/p)/i)) {\n                m = m[1].split('/');\n                return {\n                    type: 'ampm',\n                    am: m[0],\n                    pm: m[1]\n                };\n            }\n            switch (ch = input.next()) {\n            case ';':\n                return null;\n            case '\\\\':\n                return {\n                    type: 'str',\n                    value: input.next()\n                };\n            case '\"':\n                return {\n                    type: 'str',\n                    value: input.readEscaped(ch)\n                };\n            case '@':\n                return { type: 'text' };\n            case '_':\n                return {\n                    type: 'space',\n                    value: input.next()\n                };\n            case '*':\n                return {\n                    type: 'fill',\n                    value: input.next()\n                };\n            case '.':\n                if (input.lookingAt(/^\\s*[#0?]/)) {\n                    decimalPart = true;\n                    return { type: 'dec' };\n                }\n                return {\n                    type: 'str',\n                    value: '.'\n                };\n            case '%':\n                return { type: 'percent' };\n            case ',':\n                return { type: 'comma' };\n            }\n            return {\n                type: 'str',\n                value: ch\n            };\n        }\n        function readSection() {\n            decimalPart = false;\n            var color = maybeColor(), cond = maybeCondition();\n            if (!color && cond) {\n                color = maybeColor();\n            }\n            return {\n                color: color,\n                cond: cond,\n                body: readFormat()\n            };\n        }\n    }\n    function print(sections) {\n        return sections.map(printSection).join(';');\n        function printSection(sec) {\n            var out = '';\n            if (sec.color) {\n                out += '[' + sec.color + ']';\n            }\n            if (sec.cond) {\n                if (!(sec.cond == 'text' || sec.cond == 'num')) {\n                    out += '[' + sec.cond.op + sec.cond.value + ']';\n                }\n            }\n            out += sec.body.map(printToken).join('');\n            return out;\n        }\n        function printToken(tok) {\n            if (tok.type == 'digit') {\n                if (tok.sep) {\n                    return tok.format.charAt(0) + ',' + tok.format.substr(1);\n                } else {\n                    return tok.format;\n                }\n            } else if (tok.type == 'exp') {\n                return tok.ch + tok.sign;\n            } else if (tok.type == 'date' || tok.type == 'time') {\n                return padLeft('', tok.format, tok.part);\n            } else if (tok.type == 'ampm') {\n                return tok.am + '/' + tok.pm;\n            } else if (tok.type == 'str') {\n                return JSON.stringify(tok.value);\n            } else if (tok.type == 'text') {\n                return '@';\n            } else if (tok.type == 'space') {\n                return '_' + tok.value;\n            } else if (tok.type == 'fill') {\n                return '*' + tok.value;\n            } else if (tok.type == 'dec') {\n                return '.';\n            } else if (tok.type == 'percent') {\n                return '%';\n            } else if (tok.type == 'comma') {\n                return ',';\n            }\n        }\n    }\n    function adjustDecimals(sections, x) {\n        sections.forEach(function (sec) {\n            var diff = x;\n            if (sec.cond == 'text') {\n                return;\n            }\n            var body = sec.body, adjusted = false, i = body.length;\n            while (diff !== 0 && --i >= 0) {\n                var tok = body[i];\n                if (tok.type == 'digit') {\n                    if (tok.decimal) {\n                        adjusted = true;\n                        if (diff > 0) {\n                            tok.format += padLeft('', diff, '0');\n                        } else if (diff < 0) {\n                            var tmp = tok.format.length;\n                            tok.format = tok.format.substr(0, tmp + diff);\n                            diff += tmp - tok.format.length;\n                        }\n                        if (tok.format.length === 0) {\n                            body.splice(i, 1);\n                            while (--i >= 0) {\n                                tok = body[i];\n                                if (tok.type == 'digit' && tok.decimal) {\n                                    ++i;\n                                    break;\n                                }\n                                if (tok.type == 'dec') {\n                                    body.splice(i, 1);\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (diff > 0) {\n                        break;\n                    }\n                }\n            }\n            if (!adjusted && diff > 0) {\n                body.splice(i + 1, 0, { type: 'dec' }, {\n                    type: 'digit',\n                    sep: false,\n                    decimal: true,\n                    format: padLeft('', diff, '0')\n                });\n            }\n        });\n    }\n    function TokenStream(parts) {\n        var index = 0;\n        return {\n            next: function () {\n                return parts[index++];\n            },\n            eof: function () {\n                return index >= parts.length;\n            },\n            ahead: function (n, f) {\n                if (index + n <= parts.length) {\n                    var val = f.apply(null, parts.slice(index, index + n));\n                    if (val) {\n                        index += n;\n                    }\n                    return val;\n                }\n            },\n            restart: function () {\n                index = 0;\n            }\n        };\n    }\n    function compileFormatPart(format) {\n        var input = TokenStream(format.body);\n        var hasDate = false;\n        var hasTime = false;\n        var hasAmpm = false;\n        var percentCount = 0;\n        var scaleCount = 0;\n        var code = '';\n        var separeThousands = false;\n        var declen = 0;\n        var intFormat = [], decFormat = [];\n        var condition = format.cond;\n        var preamble = '';\n        if (condition == 'text') {\n            preamble = 'if (typeof value == \\'string\\' || value instanceof kendo.spreadsheet.CalcError) { ';\n        } else if (condition == 'num') {\n            preamble = 'if (typeof value == \\'number\\') { ';\n        } else if (condition) {\n            var op = condition.op == '=' ? '==' : condition.op;\n            preamble = 'if (typeof value == \\'number\\' && value ' + op + ' ' + condition.value + ') { ';\n            code += 'value = Math.abs(value); ';\n        }\n        if (format.color) {\n            code += 'result.color = ' + JSON.stringify(format.color) + '; ';\n        }\n        function checkComma(a, b) {\n            if (a.type == 'digit' && b.type == 'comma' || a.type == 'comma' && a.hidden && b.type == 'comma') {\n                b.hidden = true;\n                scaleCount++;\n            }\n        }\n        while (!input.eof()) {\n            input.ahead(2, checkComma);\n            var tok = input.next();\n            if (tok.type == 'percent') {\n                percentCount++;\n            } else if (tok.type == 'digit') {\n                if (tok.decimal) {\n                    declen += tok.format.length;\n                    decFormat.push(tok.format);\n                } else {\n                    intFormat.push(tok.format);\n                    if (tok.sep) {\n                        separeThousands = true;\n                    }\n                }\n            } else if (tok.type == 'time') {\n                hasTime = true;\n            } else if (tok.type == 'date') {\n                hasDate = true;\n            } else if (tok.type == 'ampm') {\n                hasAmpm = hasTime = true;\n            }\n        }\n        if (percentCount > 0) {\n            code += 'value *= ' + Math.pow(100, percentCount) + '; ';\n        }\n        if (scaleCount > 0) {\n            code += 'value /= ' + Math.pow(1000, scaleCount) + '; ';\n        }\n        if (intFormat.length) {\n            code += 'var intPart = runtime.formatInt(culture, value, ' + JSON.stringify(intFormat) + ', ' + declen + ', ' + separeThousands + '); ';\n        }\n        if (decFormat.length) {\n            code += 'var decPart = runtime.formatDec(culture, value, ' + JSON.stringify(decFormat) + ', ' + declen + '); ';\n        }\n        if (intFormat.length || decFormat.length) {\n            code += 'type = \\'number\\'; ';\n        }\n        if (hasDate) {\n            code += 'var date = runtime.unpackDate(value); ';\n        }\n        if (hasTime) {\n            code += 'var time = runtime.unpackTime(value); ';\n        }\n        if (hasDate || hasTime) {\n            code += 'type = \\'date\\'; ';\n        }\n        if (percentCount > 0 || scaleCount > 0 || intFormat.length || decFormat.length || hasDate || hasTime) {\n            if (!preamble) {\n                preamble = 'if (typeof value == \\'number\\') { ';\n            }\n        }\n        input.restart();\n        while (!input.eof()) {\n            var tok = input.next();\n            if (tok.type == 'dec') {\n                code += 'output += culture.numberFormat[\\'.\\']; ';\n            } else if (tok.type == 'comma' && !tok.hidden) {\n                code += 'output += \\',\\'; ';\n            } else if (tok.type == 'percent') {\n                code += 'type = \\'percent\\'; ';\n                code += 'output += culture.numberFormat.percent.symbol; ';\n            } else if (tok.type == 'str') {\n                code += 'output += ' + JSON.stringify(tok.value) + '; ';\n            } else if (tok.type == 'text') {\n                code += 'type = \\'text\\'; ';\n                code += 'output += value; ';\n            } else if (tok.type == 'space') {\n                code += 'if (output) result.body.push(output); ';\n                code += 'output = \\'\\'; ';\n                code += 'result.body.push({ type: \\'space\\', value: ' + JSON.stringify(tok.value) + ' }); ';\n            } else if (tok.type == 'fill') {\n                code += 'output += runtime.fill(' + JSON.stringify(tok.value) + '); ';\n            } else if (tok.type == 'digit') {\n                code += 'output += ' + (tok.decimal ? 'decPart' : 'intPart') + '.shift(); ';\n            } else if (tok.type == 'date') {\n                code += 'output += runtime.date(culture, date, ' + JSON.stringify(tok.part) + ', ' + tok.format + '); ';\n            } else if (tok.type == 'time') {\n                code += 'output += runtime.time(culture, time, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + hasAmpm + '); ';\n            } else if (tok.type == 'eltime') {\n                code += 'output += runtime.eltime(culture, value, ' + JSON.stringify(tok.part) + ', ' + tok.format + '); ';\n            } else if (tok.type == 'ampm') {\n                code += 'output += time.hours < 12 ? ' + JSON.stringify(tok.am) + ' : ' + JSON.stringify(tok.pm) + '; ';\n            }\n        }\n        code += 'if (output) result.body.push(output); ';\n        code += 'result.type = type; ';\n        code += 'return result; ';\n        if (preamble) {\n            code = preamble + code + '}';\n        }\n        return code;\n    }\n    var CACHE = Object.create(null);\n    function compile(format) {\n        var f = CACHE[format];\n        if (!f) {\n            var tree = parse(format);\n            var code = tree.map(compileFormatPart).join('\\n');\n            code = '\\'use strict\\'; return function(value, culture){ ' + 'if (!culture) culture = kendo.culture(); ' + 'var output = \\'\\', type = null, result = { body: [] }; ' + code + '; return result; };';\n            f = CACHE[format] = new Function('runtime', code)(runtime);\n        }\n        return f;\n    }\n    var runtime = {\n        unpackDate: calc.runtime.unpackDate,\n        unpackTime: calc.runtime.unpackTime,\n        date: function (culture, d, part, length) {\n            switch (part) {\n            case 'd':\n                switch (length) {\n                case 1:\n                    return d.date;\n                case 2:\n                    return padLeft(d.date, 2, '0');\n                case 3:\n                    return culture.calendars.standard.days.namesAbbr[d.day];\n                case 4:\n                    return culture.calendars.standard.days.names[d.day];\n                }\n                break;\n            case 'm':\n                switch (length) {\n                case 1:\n                    return d.month + 1;\n                case 2:\n                    return padLeft(d.month + 1, 2, '0');\n                case 3:\n                    return culture.calendars.standard.months.namesAbbr[d.month];\n                case 4:\n                    return culture.calendars.standard.months.names[d.month];\n                case 5:\n                    return culture.calendars.standard.months.names[d.month].charAt(0);\n                }\n                break;\n            case 'y':\n                switch (length) {\n                case 2:\n                    return d.year % 100;\n                case 4:\n                    return d.year;\n                }\n                break;\n            }\n            return '##';\n        },\n        time: function (culture, t, part, length, ampm) {\n            switch (part) {\n            case 'h':\n                var h = ampm ? t.hours % 12 || 12 : t.hours;\n                switch (length) {\n                case 1:\n                    return h;\n                case 2:\n                    return padLeft(h, 2, '0');\n                }\n                break;\n            case 'm':\n                switch (length) {\n                case 1:\n                    return t.minutes;\n                case 2:\n                    return padLeft(t.minutes, 2, '0');\n                }\n                break;\n            case 's':\n                switch (length) {\n                case 1:\n                    return t.seconds;\n                case 2:\n                    return padLeft(t.seconds, 2, '0');\n                }\n                break;\n            }\n            return '##';\n        },\n        eltime: function (culture, value, part, length) {\n            switch (part) {\n            case 'h':\n                value = value * 24;\n                break;\n            case 'm':\n                value = value * 24 * 60;\n                break;\n            case 's':\n                value = value * 24 * 60 * 60;\n                break;\n            }\n            value |= 0;\n            switch (length) {\n            case 1:\n                return value;\n            case 2:\n                return padLeft(value, 2, '0');\n            }\n            return '##';\n        },\n        fill: function (ch) {\n            return ch;\n        },\n        formatInt: function (culture, value, parts, declen, sep) {\n            value = value.toFixed(declen).replace(/\\..*$/, '');\n            if (declen > 0) {\n                if (value === '0') {\n                    value = '';\n                } else if (value === '-0') {\n                    value = '-';\n                }\n            }\n            var iv = value.length - 1;\n            var result = [];\n            var len = 0, str;\n            function add(ch) {\n                if (sep && len && len % 3 === 0 && ch != ' ') {\n                    str = culture.numberFormat[','] + str;\n                }\n                str = ch + str;\n                len++;\n            }\n            for (var j = parts.length; --j >= 0;) {\n                var format = parts[j];\n                str = '';\n                for (var k = format.length; --k >= 0;) {\n                    var chf = format.charAt(k);\n                    if (iv < 0) {\n                        if (chf == '0') {\n                            add('0');\n                        } else if (chf == '?') {\n                            add(' ');\n                        }\n                    } else {\n                        add(value.charAt(iv--));\n                    }\n                }\n                if (j === 0) {\n                    while (iv >= 0) {\n                        add(value.charAt(iv--));\n                    }\n                }\n                result.unshift(str);\n            }\n            return result;\n        },\n        formatDec: function (culture, value, parts, declen) {\n            value = value.toFixed(declen);\n            var pos = value.indexOf('.');\n            if (pos >= 0) {\n                value = value.substr(pos + 1).replace(/0+$/, '');\n            } else {\n                value = '';\n            }\n            var iv = 0;\n            var result = [];\n            for (var j = 0; j < parts.length; ++j) {\n                var format = parts[j];\n                var str = '';\n                for (var k = 0; k < format.length; ++k) {\n                    var chf = format.charAt(k);\n                    if (iv < value.length) {\n                        str += value.charAt(iv++);\n                    } else if (chf == '0') {\n                        str += '0';\n                    } else if (chf == '?') {\n                        str += ' ';\n                    }\n                }\n                result.push(str);\n            }\n            return result;\n        }\n    };\n    function padLeft(val, width, ch) {\n        val += '';\n        while (val.length < width) {\n            val = ch + val;\n        }\n        return val;\n    }\n    function text(f) {\n        var a = f.body;\n        var text = '';\n        for (var i = 0; i < a.length; ++i) {\n            var el = a[i];\n            if (typeof el == 'string') {\n                text += el;\n            } else if (el.type == 'space') {\n                text += ' ';\n            }\n        }\n        return text;\n    }\n    kendo.spreadsheet.formatting = {\n        compile: compile,\n        parse: parse,\n        format: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            var span = dom.element('span');\n            span.__dataType = f.type;\n            var a = f.body;\n            if (f.color) {\n                span.attr.style = { color: f.color };\n            }\n            for (var i = 0; i < a.length; ++i) {\n                var el = a[i];\n                if (typeof el == 'string') {\n                    span.children.push(dom.text(el));\n                } else if (el.type == 'space') {\n                    span.children.push(dom.element('span', { style: { visibility: 'hidden' } }, [dom.text(el.value)]));\n                }\n            }\n            return span;\n        },\n        text: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return text(f);\n        },\n        textAndColor: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return {\n                text: text(f),\n                color: f.color,\n                type: f.type\n            };\n        },\n        type: function (value, format) {\n            return compile(format)(value).type;\n        },\n        adjustDecimals: function (format, diff) {\n            var ast = parse(format);\n            adjustDecimals(ast, diff);\n            return print(ast);\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions', [\n        'spreadsheet/runtime',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var defineAlias = runtime.defineAlias;\n    var CalcError = runtime.CalcError;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var Matrix = runtime.Matrix;\n    var Ref = spreadsheet.Ref;\n    var daysInMonth = runtime.daysInMonth;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var daysInYear = runtime.daysInYear;\n    [\n        'abs',\n        'cos',\n        'sin',\n        'acos',\n        'asin',\n        'tan',\n        'atan',\n        'exp',\n        'sqrt'\n    ].forEach(function (name) {\n        defineFunction(name, Math[name]).args([[\n                '*n',\n                'number'\n            ]]);\n    });\n    defineFunction('ln', Math.log).args([[\n            '*n',\n            'number'\n        ]]);\n    defineFunction('log', function (num, base) {\n        return Math.log(num) / Math.log(base);\n    }).args([\n        [\n            '*num',\n            'number++'\n        ],\n        [\n            '*base',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    10\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$base != 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('log10', function (num) {\n        return Math.log(num) / Math.log(10);\n    }).args([[\n            '*num',\n            'number++'\n        ]]);\n    defineFunction('pi', function () {\n        return Math.PI;\n    }).args([]);\n    defineFunction('sqrtpi', function (n) {\n        return Math.sqrt(n * Math.PI);\n    }).args([[\n            '*num',\n            'number+'\n        ]]);\n    defineFunction('degrees', function (rad) {\n        return 180 * rad / Math.PI % 360;\n    }).args([[\n            '*radians',\n            'number'\n        ]]);\n    defineFunction('radians', function (deg) {\n        return Math.PI * deg / 180;\n    }).args([[\n            '*degrees',\n            'number'\n        ]]);\n    function _cosh(n) {\n        return (Math.exp(n) + Math.exp(-n)) / 2;\n    }\n    defineFunction('cosh', _cosh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acosh', function (n) {\n        return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$num >= 1'\n            ]\n        ]\n    ]);\n    function _sinh(n) {\n        return (Math.exp(n) - Math.exp(-n)) / 2;\n    }\n    defineFunction('sinh', _sinh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('asinh', function (n) {\n        return Math.log(n + Math.sqrt(n * n + 1));\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sec', function (n) {\n        return 1 / Math.cos(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sech', function (n) {\n        return 1 / _cosh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csc', function (n) {\n        return 1 / Math.sin(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csch', function (n) {\n        return 1 / _sinh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atan2', function (x, y) {\n        return Math.atan(y / x);\n    }).args([\n        [\n            '*x',\n            'divisor'\n        ],\n        [\n            '*y',\n            'number'\n        ]\n    ]);\n    function _tanh(n) {\n        return _sinh(n) / _cosh(n);\n    }\n    defineFunction('tanh', _tanh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atanh', function (n) {\n        return Math.log(Math.sqrt(1 - n * n) / (1 - n));\n    }).args([[\n            '*num',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('cot', function (n) {\n        return 1 / Math.tan(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('coth', function (n) {\n        return 1 / _tanh(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('acot', function (n) {\n        return Math.PI / 2 - Math.atan(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acoth', function (n) {\n        return Math.log((n + 1) / (n - 1)) / 2;\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'or',\n                [\n                    'assert',\n                    '$num < -1'\n                ],\n                [\n                    'assert',\n                    '$num > 1'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('power', function (a, b) {\n        return Math.pow(a, b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'number'\n        ]\n    ]);\n    defineFunction('mod', function (a, b) {\n        return a % b;\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('quotient', function (a, b) {\n        return Math.floor(a / b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('ceiling', function (num, s) {\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('ceiling.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('iso.ceiling', 'ceiling.precise');\n    defineFunction('ceiling.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor', function (num, s) {\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('floor.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('int', Math.floor).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('mround', function (num, mult) {\n        return mult ? mult * Math.round(num / mult) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*multiple',\n            'number'\n        ]\n    ]);\n    defineFunction('round', function (num, digits) {\n        var sign = num < 0 ? -1 : 1;\n        if (sign < 0) {\n            num = -num;\n        }\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = Math.round(num);\n        return sign * num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('roundup', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('rounddown', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.ceil(num) : Math.floor(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('even', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('odd', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n : n + (n < 0 ? -1 : 1);\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('sign', function (num) {\n        return num < 0 ? -1 : num > 0 ? 1 : 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    function _gcd(a, b) {\n        while (b) {\n            var r = a % b;\n            a = b;\n            b = r;\n        }\n        return a;\n    }\n    function _lcm(a, b) {\n        return Math.abs(a * b) / _gcd(a, b);\n    }\n    defineFunction('gcd', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _gcd(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('lcm', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _lcm(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sum', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('product', function (numbers) {\n        return numbers.reduce(function (prod, num) {\n            return prod * num;\n        }, 1);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumproduct', function (a) {\n        var sum = 0;\n        a[0].each(function (p, row, col) {\n            if (typeof p == 'number') {\n                for (var i = 1; i < a.length; ++i) {\n                    var v = a[i].get(row, col);\n                    if (typeof v != 'number') {\n                        return;\n                    }\n                    p *= v;\n                }\n                sum += p;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a1',\n            'matrix'\n        ],\n        [\n            '+',\n            [\n                'a2',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$a2.width == $a1.width'\n                    ],\n                    [\n                        'assert',\n                        '$a2.height == $a1.height'\n                    ]\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumsq', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num * num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumx2my2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x - y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumx2py2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x + y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumxmy2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += (x - y) * (x - y);\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('seriessum', function (x, n, m, a) {\n        var sum = 0;\n        a.each(function (coef) {\n            if (typeof coef != 'number') {\n                throw new CalcError('VALUE');\n            }\n            sum += coef * Math.pow(x, n);\n            n += m;\n        });\n        return sum;\n    }).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'y',\n            'number'\n        ],\n        [\n            'm',\n            'number'\n        ],\n        [\n            'a',\n            'matrix'\n        ]\n    ]);\n    defineFunction('min', function (numbers) {\n        return Math.min.apply(Math, numbers);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('max', function (numbers) {\n        return Math.max.apply(Math, numbers);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('counta', function (values) {\n        return values.length;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('count', function (numbers) {\n        return numbers.length;\n    }).args([[\n            'numbers',\n            [\n                '#collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('countunique', function (values) {\n        var count = 0, seen = [];\n        values.forEach(function (val) {\n            if (seen.indexOf(val) < 0) {\n                count++;\n                seen.push(val);\n            }\n        });\n        return count;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('countblank', function (a) {\n        var count = 0;\n        function add(val) {\n            if (val == null || val === '') {\n                count++;\n            }\n        }\n        function loop(args) {\n            for (var i = 0; i < args.length; ++i) {\n                var x = args[i];\n                if (x instanceof Matrix) {\n                    x.each(add, true);\n                } else {\n                    add(x);\n                }\n            }\n        }\n        loop(a);\n        return count;\n    }).args([[\n            '+',\n            [\n                'args',\n                [\n                    'or',\n                    'matrix',\n                    'anyvalue'\n                ]\n            ]\n        ]]);\n    defineFunction('iseven', function (num) {\n        return num % 2 === 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('isodd', function (num) {\n        return num % 2 !== 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('n', function (val) {\n        if (typeof val == 'boolean') {\n            return val ? 1 : 0;\n        }\n        if (typeof val == 'number') {\n            return val;\n        }\n        return 0;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('na', function () {\n        return new CalcError('N/A');\n    }).args([]);\n    function forIFS(args, f) {\n        var chunks = [], i = 0, matrix = args[0];\n        while (i < args.length) {\n            chunks.push({\n                matrix: args[i++],\n                pred: parseCriteria(args[i++])\n            });\n        }\n        ROW:\n            for (var row = 0; row < matrix.height; ++row) {\n                COL:\n                    for (var col = 0; col < matrix.width; ++col) {\n                        for (i = 0; i < chunks.length; ++i) {\n                            var val = chunks[i].matrix.get(row, col);\n                            if (!chunks[i].pred(val == null || val === '' ? 0 : val)) {\n                                continue COL;\n                            }\n                        }\n                        f(row, col);\n                    }\n            }\n    }\n    var ARGS_COUNTIFS = [\n        [\n            'm1',\n            'matrix'\n        ],\n        [\n            'c1',\n            'anyvalue'\n        ],\n        [\n            [\n                'm2',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$m1.width == $m2.width'\n                    ],\n                    [\n                        'assert',\n                        '$m1.height == $m2.height'\n                    ]\n                ]\n            ],\n            [\n                'c2',\n                'anyvalue'\n            ]\n        ]\n    ];\n    defineFunction('countifs', function (m1, c1, rest) {\n        var count = 0;\n        rest.unshift(m1, c1);\n        forIFS(rest, function () {\n            count++;\n        });\n        return count;\n    }).args(ARGS_COUNTIFS);\n    var ARGS_SUMIFS = [[\n            'range',\n            'matrix'\n        ]].concat(ARGS_COUNTIFS);\n    defineFunction('sumifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val) {\n                sum += val;\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIFS);\n    defineFunction('averageifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0, count = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val == null || val === '') {\n                val = 0;\n            }\n            sum += val;\n            count++;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIFS);\n    defineFunction('countif', function (matrix, criteria) {\n        criteria = parseCriteria(criteria);\n        var count = 0;\n        matrix.each(function (val) {\n            if (criteria(val)) {\n                count++;\n            }\n        });\n        return count;\n    }).args([\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ]\n    ]);\n    var ARGS_SUMIF = [\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ],\n        [\n            'sumRange',\n            [\n                'or',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$sumRange.width == $range.width'\n                    ],\n                    [\n                        'assert',\n                        '$sumRange.height == $range.height'\n                    ]\n                ],\n                [\n                    'null',\n                    '$range'\n                ]\n            ]\n        ]\n    ];\n    defineFunction('sumif', function (range, criteria, sumRange) {\n        var sum = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                }\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIF);\n    defineFunction('averageif', function (range, criteria, sumRange) {\n        var sum = 0, count = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                    count++;\n                }\n            }\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIF);\n    (function (def) {\n        def('large', function (numbers, nth) {\n            return numbers.sort(descending)[nth];\n        });\n        def('small', function (numbers, nth) {\n            return numbers.sort(ascending)[nth];\n        });\n    }(function (name, handler) {\n        defineFunction(name, function (matrix, nth) {\n            var numbers = [];\n            var error = matrix.each(function (val) {\n                if (val instanceof CalcError) {\n                    return val;\n                }\n                if (typeof val == 'number') {\n                    numbers.push(val);\n                }\n            });\n            if (error) {\n                return error;\n            }\n            if (nth > numbers.length) {\n                return new CalcError('NUM');\n            }\n            return handler(numbers, nth - 1);\n        }).args([\n            [\n                'array',\n                'matrix'\n            ],\n            [\n                '*nth',\n                'number++'\n            ]\n        ]);\n    }));\n    function _avg(numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n    }\n    function _var_sp(numbers, divisor, avg) {\n        if (avg == null) {\n            avg = _avg(numbers);\n        }\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.pow(num - avg, 2);\n        }, 0) / divisor;\n    }\n    function _stdev_sp(numbers, divisor) {\n        return Math.sqrt(_var_sp(numbers, divisor));\n    }\n    defineFunction('stdev.s', function (numbers) {\n        return _stdev_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('stdev.p', function (numbers) {\n        return _stdev_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.s', function (numbers) {\n        return _var_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.p', function (numbers) {\n        return _var_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('median', function (numbers) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        if (n % 2) {\n            return numbers[n >> 1];\n        }\n        return (numbers[n >> 1] + numbers[n >> 1 + 1]) / 2;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('mode.sngl', function (numbers) {\n        numbers.sort(ascending);\n        var prev = null, count = 0, max = 1, mode = null;\n        for (var i = 0; i < numbers.length; ++i) {\n            var n = numbers[i];\n            if (n != prev) {\n                count = 1;\n                prev = n;\n            } else {\n                count++;\n            }\n            if (count > max) {\n                max = count;\n                mode = n;\n            }\n        }\n        return mode == null ? new CalcError('N/A') : mode;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('mode.mult', function (numbers) {\n        var seen = Object.create(null), max = 2, res = [];\n        numbers.forEach(function (num) {\n            var s = seen[num] || 0;\n            seen[num] = ++s;\n            if (s == max) {\n                res.push(num);\n            } else if (s > max) {\n                max = s;\n                res = [num];\n            }\n        });\n        var m = new Matrix(this);\n        res.forEach(function (num, i) {\n            m.set(i, 0, num);\n        });\n        return m;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('geomean', function (numbers) {\n        var n = numbers.length;\n        var p = numbers.reduce(function (p, num) {\n            if (num < 0) {\n                throw new CalcError('NUM');\n            }\n            return p * num;\n        }, 1);\n        return Math.pow(p, 1 / n);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('harmean', function (numbers) {\n        var n = numbers.length;\n        var s = numbers.reduce(function (s, num) {\n            if (!num) {\n                throw new CalcError('DIV/0');\n            }\n            return s + 1 / num;\n        }, 0);\n        return n / s;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('trimmean', function (numbers, p) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        var discard = Math.floor(n * p);\n        if (discard % 2) {\n            --discard;\n        }\n        discard /= 2;\n        var sum = 0;\n        for (var i = discard; i < n - discard; ++i) {\n            sum += numbers[i];\n        }\n        return sum / (n - discard * 2);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'percent',\n            [\n                'and',\n                'number',\n                [\n                    '[between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('frequency', function (data, bins) {\n        data.sort(ascending);\n        bins.sort(ascending);\n        var prev = -Infinity;\n        var i = 0;\n        function count(max) {\n            var n = 0;\n            while (i < data.length && data[i] > prev && data[i] <= max) {\n                ++n;\n                ++i;\n            }\n            return n;\n        }\n        var m = new Matrix(this);\n        bins.forEach(function (val, i) {\n            var n = count(val);\n            prev = val;\n            m.set(i, 0, n);\n        });\n        m.set(m.height, 0, data.length - i);\n        return m;\n    }).args([\n        [\n            'data',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'bins',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ]\n    ]);\n    defineFunction('rank.eq', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        return pos < 0 ? new CalcError('N/A') : pos + 1;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('rank', 'rank.eq');\n    defineFunction('rank.avg', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        if (pos < 0) {\n            return new CalcError('N/A');\n        }\n        for (var i = pos; numbers[i] == val; ++i) {\n        }\n        return (pos + i + 1) / 2;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('kurt', function (numbers) {\n        var n = numbers.length;\n        var avg = _avg(numbers);\n        var variance = _var_sp(numbers, n - 1, avg);\n        var stddev = Math.sqrt(variance);\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + Math.pow((num - avg) / stddev, 4);\n        }, 0);\n        return n * (n + 1) / ((n - 1) * (n - 2) * (n - 3)) * sum - 3 * Math.pow(n - 1, 2) / ((n - 2) * (n - 3));\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 4',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _percentrank(numbers, x, exc) {\n        var nlt = 0, ngt = 0, left = null, right = null, found = false;\n        numbers.forEach(function (num) {\n            if (num < x) {\n                nlt++;\n                left = left == null ? num : Math.max(left, num);\n            } else if (num > x) {\n                ngt++;\n                right = right == null ? num : Math.min(right, num);\n            } else {\n                found = true;\n            }\n        });\n        if (!nlt && !ngt) {\n            return new CalcError('N/A');\n        }\n        if (found) {\n            if (exc) {\n                return (nlt + 1) / (numbers.length + 1);\n            }\n            return nlt / (nlt + ngt);\n        }\n        return ((right - x) * _percentrank(numbers, left, exc) + (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n    }\n    var ARGS_PERCENTRANK = [\n        [\n            'array',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'x',\n            'number'\n        ],\n        [\n            'significance',\n            [\n                'or',\n                [\n                    'null',\n                    3\n                ],\n                'integer++'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array.length > 0',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('percentrank.inc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 0);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineFunction('percentrank.exc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 1);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineAlias('percentrank', 'percentrank.inc');\n    function _covariance(x, y, divisor) {\n        var sum = 0;\n        var ax = _avg(x);\n        var ay = _avg(y);\n        var n = x.length;\n        for (var i = 0; i < n; ++i) {\n            sum += (x[i] - ax) * (y[i] - ay);\n        }\n        return sum / divisor;\n    }\n    defineFunction('covariance.p', function (x, y) {\n        return _covariance(x, y, x.length);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('covariance.s', function (x, y) {\n        return _covariance(x, y, x.length - 1);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineAlias('covar', 'covariance.p');\n    var _fact = util.memoize(function (n) {\n        for (var i = 2, fact = 1; i <= n; ++i) {\n            fact *= i;\n        }\n        return fact;\n    });\n    defineFunction('fact', _fact).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('factdouble', function (n) {\n        for (var i = 2 + (n & 1), fact = 1; i <= n; i += 2) {\n            fact *= i;\n        }\n        return fact;\n    }).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('multinomial', function (numbers) {\n        var div = 1, sum = 0;\n        numbers.forEach(function (n) {\n            if (n < 0) {\n                throw new CalcError('NUM');\n            }\n            sum += n;\n            div *= _fact(n);\n        });\n        return _fact(sum) / div;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    var _combinations = util.memoize(function (n, k) {\n        for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n            p1 *= f1;\n            p2 *= f2;\n        }\n        return p1 / p2;\n    });\n    defineFunction('combin', _combinations).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('combina', function (n, k) {\n        return _combinations(n + k - 1, n - 1);\n    }).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    1,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('average', function (numbers) {\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n        return sum / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                [\n                    'and',\n                    'number',\n                    [\n                        'not',\n                        'boolean'\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('averagea', function (values) {\n        var sum = 0, count = 0;\n        values.forEach(function (num) {\n            if (typeof num != 'string') {\n                sum += num;\n            }\n            ++count;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args([[\n            'values',\n            [\n                'collect',\n                'anyvalue'\n            ]\n        ]]);\n    function _percentile(numbers, rank) {\n        numbers.sort(ascending);\n        var n = numbers.length;\n        var k = rank | 0, d = rank - k;\n        if (k === 0) {\n            return numbers[0];\n        }\n        if (k >= n) {\n            return numbers[n - 1];\n        }\n        --k;\n        return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n    }\n    function _percentile_inc(numbers, p) {\n        var rank = p * (numbers.length - 1) + 1;\n        return _percentile(numbers, rank);\n    }\n    function _percentile_exc(numbers, p) {\n        var rank = p * (numbers.length + 1);\n        return _percentile(numbers, rank);\n    }\n    defineFunction('percentile.inc', _percentile_inc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('percentile.exc', _percentile_exc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('quartile.inc', function (numbers, quarter) {\n        return _percentile_inc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineFunction('quartile.exc', function (numbers, quarter) {\n        return _percentile_exc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineAlias('quartile', 'quartile.inc');\n    defineAlias('percentile', 'percentile.inc');\n    var AGGREGATE_FUNCS = [\n        'AVERAGE',\n        'COUNT',\n        'COUNTA',\n        'MAX',\n        'MIN',\n        'PRODUCT',\n        'STDEV.S',\n        'STDEV.P',\n        'SUM',\n        'VAR.S',\n        'VAR.P',\n        'MEDIAN',\n        'MODE.SNGL',\n        'LARGE',\n        'SMALL',\n        'PERCENTILE.INC',\n        'QUARTILE.INC',\n        'PERCENTILE.EXC',\n        'QUARTILE.EXC'\n    ];\n    function fetchValuesForAggregate(self, args, options) {\n        var values = [];\n        var opt_ignore_hidden_rows = 1;\n        var opt_ignore_errors = 2;\n        var opt_use_aggregates = 4;\n        (function fetchValues(args) {\n            if (args instanceof Ref) {\n                self.getRefCells(args, true).forEach(function (cell) {\n                    var value = cell.value;\n                    if (options & opt_ignore_hidden_rows && cell.hidden) {\n                        return;\n                    }\n                    if (cell.formula) {\n                        var str = cell.formula.print(cell.row, cell.col);\n                        if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                            if (!(options & opt_use_aggregates)) {\n                                return;\n                            }\n                        }\n                        if ('value' in cell.formula) {\n                            value = cell.formula.value;\n                        }\n                    }\n                    if (options & opt_ignore_errors && value instanceof CalcError) {\n                        return;\n                    }\n                    if (typeof value == 'number' || value instanceof CalcError) {\n                        values.push(value);\n                    }\n                });\n            } else if (Array.isArray(args)) {\n                for (var i = 0; i < args.length; ++i) {\n                    fetchValues(args[i]);\n                }\n            } else if (args instanceof Matrix) {\n                args.each(fetchValues);\n            } else if (typeof args == 'number') {\n                values.push(args);\n            } else if (args instanceof CalcError && !(options & opt_ignore_errors)) {\n                values.push(args);\n            }\n        }(args));\n        return values;\n    }\n    defineFunction('aggregate', function (callback, funcId, options, args) {\n        var self = this;\n        self.resolveCells(args, function () {\n            var values;\n            if (funcId > 12) {\n                values = fetchValuesForAggregate(self, args[0], options);\n                var k = args[1];\n                if (k instanceof CellRef) {\n                    k = self.getRefData(k);\n                }\n                if (typeof k != 'number') {\n                    return callback(new CalcError('VALUE'));\n                }\n            } else {\n                values = fetchValuesForAggregate(self, args, options);\n            }\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                12,\n                13,\n                14,\n                15,\n                16,\n                17,\n                18,\n                19\n            ]\n        ],\n        [\n            'options',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4,\n                    5,\n                    6,\n                    7\n                ]\n            ]\n        ],\n        [\n            'args',\n            'rest'\n        ]\n    ]);\n    defineFunction('subtotal', function (callback, funcId) {\n        var self = this;\n        var ignoreHidden = funcId > 100;\n        if (ignoreHidden) {\n            funcId -= 100;\n        }\n        var args = [];\n        for (var i = 2; i < arguments.length; ++i) {\n            args.push(arguments[i]);\n        }\n        self.resolveCells(args, function () {\n            var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                101,\n                102,\n                103,\n                104,\n                105,\n                106,\n                107,\n                108,\n                109,\n                110,\n                111\n            ]\n        ],\n        [\n            '+',\n            [\n                'ref',\n                [\n                    'or',\n                    'ref',\n                    '#matrix'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('avedev', function (numbers) {\n        var avg = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.abs(num - avg);\n        }, 0) / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _binom_dist(x, n, p, cumulative) {\n        if (!cumulative) {\n            return _combinations(n, x) * Math.pow(p, x) * Math.pow(1 - p, n - x);\n        } else {\n            var sum = 0;\n            for (var j = 0; j <= x; ++j) {\n                sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1 - p, n - j);\n            }\n            return sum;\n        }\n    }\n    defineFunction('binom.dist', _binom_dist).args([\n        [\n            'successes',\n            'integer+'\n        ],\n        [\n            'trials',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$trials >= $successes'\n                ]\n            ]\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('binomdist', 'binom.dist');\n    defineFunction('binom.inv', function (n, p, alpha) {\n        for (var x = 0; x <= n; ++x) {\n            if (_binom_dist(x, n, p, true) >= alpha) {\n                return x;\n            }\n        }\n        return new CalcError('N/A');\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('critbinom', 'binom.inv');\n    defineFunction('binom.dist.range', function (n, p, s, s2) {\n        var sum = 0;\n        for (var k = s; k <= s2; ++k) {\n            sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);\n        }\n        return sum;\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'successes_min',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$trials'\n                ]\n            ]\n        ],\n        [\n            'successes_max',\n            [\n                'or',\n                [\n                    'and',\n                    'integer',\n                    [\n                        '[between]',\n                        '$successes_min',\n                        '$trials'\n                    ]\n                ],\n                [\n                    'null',\n                    '$successes_min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('negbinom.dist', function (x, k, p, cumulative) {\n        if (cumulative) {\n            var sum = 0;\n            while (x >= 0) {\n                sum += _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n                x--;\n            }\n            return sum;\n        }\n        return _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n    }).args([\n        [\n            'number_f',\n            'integer+'\n        ],\n        [\n            'number_s',\n            'integer+'\n        ],\n        [\n            'probability_s',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('negbinomdist', 'negbinom.dist');\n    defineFunction('address', function (row, col, abs, a1, sheet) {\n        var cell = new CellRef(row - 1, col - 1, abs - 1);\n        if (sheet) {\n            cell.setSheet(sheet, true);\n        }\n        return a1 ? cell.print(0, 0) : cell.print();\n    }).args([\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'abs',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ],\n        [\n            'a1',\n            [\n                'or',\n                [\n                    'null',\n                    true\n                ],\n                'logical'\n            ]\n        ],\n        [\n            'sheet',\n            [\n                'or',\n                'null',\n                'string'\n            ]\n        ]\n    ]);\n    defineFunction('areas', function (ref) {\n        var count = 0;\n        (function loop(x) {\n            if (x instanceof CellRef || x instanceof RangeRef) {\n                count++;\n            } else if (x instanceof UnionRef) {\n                x.refs.forEach(loop);\n            }\n        }(ref));\n        return count;\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('choose', function (index, args) {\n        if (index > args.length) {\n            return new CalcError('N/A');\n        } else {\n            return args[index - 1];\n        }\n    }).args([\n        [\n            '*index',\n            'integer'\n        ],\n        [\n            '+',\n            [\n                'value',\n                'anything'\n            ]\n        ]\n    ]);\n    defineFunction('column', function (ref) {\n        if (!ref) {\n            return this.formula.col + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.col + 1;\n        }\n        return this.asMatrix(ref).mapCol(function (col) {\n            return col + ref.topLeft.col + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('columns', function (m) {\n        return m instanceof Ref ? m.width() : m.width;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('formulatext', function (ref) {\n        var cell = this.getRefCells(ref)[0];\n        if (!cell.formula) {\n            return new CalcError('N/A');\n        }\n        return cell.formula.print(cell.row, cell.col);\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('hlookup', function (value, m, row, approx) {\n        var resultCol = null;\n        m.eachCol(function (col) {\n            var data = m.get(0, col);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultCol = col;\n            } else if (data === value) {\n                resultCol = col;\n                return true;\n            }\n        });\n        if (resultCol == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(row - 1, resultCol);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('index', function (m, row, col) {\n        if (row == null && col == null) {\n            return new CalcError('N/A');\n        }\n        if (m.width > 1 && m.height > 1) {\n            if (row != null && col != null) {\n                return m.get(row - 1, col - 1);\n            }\n            if (row == null) {\n                return m.mapRow(function (row) {\n                    return m.get(row, col - 1);\n                });\n            }\n            if (col == null) {\n                return m.mapCol(function (col) {\n                    return m.get(row - 1, col);\n                });\n            }\n        }\n        if (m.width == 1) {\n            return m.get(row - 1, 0);\n        }\n        if (m.height == 1) {\n            return m.get(0, col - 1);\n        }\n        return new CalcError('REF');\n    }).args([\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'row',\n            [\n                'or',\n                'integer++',\n                'null'\n            ]\n        ],\n        [\n            'col',\n            [\n                'or',\n                'integer++',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('indirect', function (thing) {\n        try {\n            var f = this.formula;\n            var exp = calc.parseFormula(f.sheet, f.row, f.col, thing);\n            if (!(exp.ast instanceof Ref)) {\n                throw 1;\n            }\n            return exp.ast.absolute(f.row, f.col);\n        } catch (ex) {\n            return new CalcError('REF');\n        }\n    }).args([[\n            'thing',\n            'string'\n        ]]);\n    defineFunction('match', function (val, m, type) {\n        var index = 1, cmp;\n        if (type === 0) {\n            cmp = parseCriteria(val);\n        } else if (type === -1) {\n            cmp = parseCriteria('<=' + val);\n        } else if (type === 1) {\n            cmp = parseCriteria('>=' + val);\n        }\n        if (m.each(function (el) {\n                if (el != null && cmp(el)) {\n                    if (type !== 0 && val != el) {\n                        --index;\n                    }\n                    return true;\n                }\n                index++;\n            }, true) && index > 0) {\n            return index;\n        } else {\n            return new CalcError('N/A');\n        }\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    -1,\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('offset', function (ref, rows, cols, height, width) {\n        var topLeft = (ref instanceof CellRef ? ref : ref.topLeft).clone();\n        topLeft.row += rows;\n        topLeft.col += cols;\n        if (topLeft.row < 0 || topLeft.col < 0) {\n            return new CalcError('VALUE');\n        }\n        if (height > 1 || width > 1) {\n            return new RangeRef(topLeft, new CellRef(topLeft.row + height - 1, topLeft.col + width - 1)).setSheet(ref.sheet, ref.hasSheet());\n        }\n        return topLeft;\n    }).args([\n        [\n            'ref',\n            'area'\n        ],\n        [\n            '*rows',\n            'integer'\n        ],\n        [\n            '*cols',\n            'integer'\n        ],\n        [\n            '*height',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.height()'\n                ]\n            ]\n        ],\n        [\n            '*width',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.width()'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('row', function (ref) {\n        if (!ref) {\n            return this.formula.row + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.row + 1;\n        }\n        return this.asMatrix(ref).mapRow(function (row) {\n            return row + ref.topLeft.row + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('rows', function (m) {\n        return m instanceof Ref ? m.height() : m.height;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('vlookup', function (value, m, col, approx) {\n        var resultRow = null;\n        m.eachRow(function (row) {\n            var data = m.get(row, 0);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultRow = row;\n            } else if (data === value) {\n                resultRow = row;\n                return true;\n            }\n        });\n        if (resultRow == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(resultRow, col - 1);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('date', function (year, month, date) {\n        return packDate(year, month - 1, date);\n    }).args([\n        [\n            '*year',\n            'integer'\n        ],\n        [\n            '*month',\n            'integer'\n        ],\n        [\n            '*date',\n            'integer'\n        ]\n    ]);\n    defineFunction('day', function (date) {\n        return unpackDate(date).date;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('month', function (date) {\n        return unpackDate(date).month + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('year', function (date) {\n        return unpackDate(date).year;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weekday', function (date) {\n        return unpackDate(date).day + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weeknum', function (date, type) {\n        var fw = packDate(unpackDate(date).year, 0, 1);\n        var sy = unpackDate(fw);\n        var diff;\n        if (type == 21) {\n            diff = 3 - (sy.day + 6) % 7;\n            if (diff < 0) {\n                diff += 7;\n            }\n            fw += diff;\n            sy.date += diff;\n            sy.day = 4;\n            type = 1;\n        } else {\n            if (type == 1) {\n                type = 0;\n            } else if (type == 2) {\n                type = 1;\n            } else {\n                type = (type - 10) % 7;\n            }\n        }\n        diff = sy.day - type;\n        if (diff < 0) {\n            diff += 7;\n        }\n        fw -= diff;\n        return Math.ceil((date + 1 - fw) / 7);\n    }).args([\n        [\n            '*date',\n            'date'\n        ],\n        [\n            '*type',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    11,\n                    12,\n                    13,\n                    14,\n                    15,\n                    16,\n                    17,\n                    21\n                ]\n            ]\n        ]\n    ]);\n    function weeksInYear(year) {\n        var d = unpackDate(packDate(year, 0, 1));\n        if (d.day == 4 || d.day == 3 && runtime.isLeapYear(year)) {\n            return 53;\n        }\n        return 52;\n    }\n    defineFunction('isoweeknum', function isoweeknum(date) {\n        var d = unpackDate(date);\n        var dow = d.day || 7;\n        var wk = Math.floor((d.ord - dow + 10) / 7);\n        if (wk < 1) {\n            return weeksInYear(d.year - 1);\n        } else if (wk == 53 && wk > weeksInYear(d.year)) {\n            return 1;\n        }\n        return wk;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('now', function () {\n        return runtime.dateToSerial(new Date());\n    }).args([]);\n    defineFunction('today', function () {\n        return runtime.dateToSerial(new Date()) | 0;\n    }).args([]);\n    defineFunction('time', function (hh, mm, ss) {\n        return runtime.packTime(hh, mm, ss, 0);\n    }).args([\n        [\n            '*hours',\n            'integer'\n        ],\n        [\n            '*minutes',\n            'integer'\n        ],\n        [\n            '*seconds',\n            'integer'\n        ]\n    ]);\n    defineFunction('hour', function (time) {\n        return runtime.unpackTime(time).hours;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('minute', function (time) {\n        return runtime.unpackTime(time).minutes;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('second', function (time) {\n        return runtime.unpackTime(time).seconds;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('edate', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('eomonth', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = daysInMonth(y, m);\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('workday', function (date, n, holidays) {\n        var inc = n > 0 ? 1 : -1;\n        n = Math.abs(n);\n        var dow = unpackDate(date).day;\n        while (n > 0) {\n            date += inc;\n            dow = (dow + inc) % 7;\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                --n;\n            }\n        }\n        return date;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'days',\n            'integer'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('networkdays', function (date, end, holidays) {\n        if (date > end) {\n            var tmp = date;\n            date = end;\n            end = tmp;\n        }\n        var count = 0;\n        var dow = unpackDate(date).day;\n        while (date <= end) {\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                count++;\n            }\n            date++;\n            dow = (dow + 1) % 7;\n        }\n        return count;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'end_date',\n            'date'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('days', function (start, end) {\n        return end - start;\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ]\n    ]);\n    function _days_360(start, end, method) {\n        var d1 = unpackDate(start);\n        var d2 = unpackDate(end);\n        if (method) {\n            if (d1.date == 31) {\n                d1.date = 30;\n            }\n            if (d2.date == 31) {\n                d2.date = 30;\n            }\n        } else {\n            if (d1.month == 1 && d2.month == 1 && d1.date == daysInMonth(d1.year, 1) && d2.date == daysInMonth(d2.year, 1)) {\n                d2.date = 30;\n            }\n            if (d1.date == daysInMonth(d1.year, d1.month)) {\n                d1.date = 30;\n                if (d2.date == 31) {\n                    d2.date = 30;\n                }\n            } else {\n                if (d1.date == 30 && d2.date == 31) {\n                    d2.date = 30;\n                }\n            }\n        }\n        return 360 * (d2.year - d1.year) + 30 * (d2.month - d1.month) + (d2.date - d1.date);\n    }\n    runtime._days_360 = _days_360;\n    defineFunction('days360', _days_360).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    'false'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('yearfrac', function (start, end, method) {\n        switch (method) {\n        case 0:\n            return _days_360(start, end, false) / 360;\n        case 1:\n            return (end - start) / daysInYear(unpackDate(start).year);\n        case 2:\n            return (end - start) / 360;\n        case 3:\n            return (end - start) / 365;\n        case 4:\n            return _days_360(start, end, true) / 360;\n        }\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('datevalue', function (text) {\n        var date = runtime.parseDate(text);\n        if (date) {\n            return runtime.dateToSerial(date);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('timevalue', function (text) {\n        var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n        if (m) {\n            var hh = parseFloat(m[1]);\n            var mm = parseFloat(m[2]);\n            var ss = m[3] ? parseFloat(m[4]) : 0;\n            var ampm = m[7];\n            if (ampm && (hh > 12 || hh < 1)) {\n                return new CalcError('VALUE');\n            }\n            if (/^p/.test(ampm)) {\n                hh += 12;\n            }\n            return runtime.packTime(hh, mm, ss, 0);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mdeterm', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.determinant();\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('transpose', function (m) {\n        return m.transpose();\n    }).args([[\n            'range',\n            'matrix'\n        ]]);\n    defineFunction('mmult', function (a, b) {\n        return a.multiply(b);\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.height == $a.width'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('munit', function (n) {\n        return new Matrix(this).unit(n);\n    }).args([[\n            'n',\n            'integer+'\n        ]]);\n    defineFunction('minverse', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.inverse() || new CalcError('VALUE');\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('rand', function () {\n        return Math.random();\n    }).args([]);\n    defineFunction('randbetween', function (min, max) {\n        return min + Math.floor((max - min + 1) * Math.random());\n    }).args([\n        [\n            'min',\n            'integer'\n        ],\n        [\n            'max',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$max >= $min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('true', function () {\n        return true;\n    }).args([]);\n    defineFunction('false', function () {\n        return true;\n    }).args([]);\n    defineFunction('roman', function (num) {\n        return util.arabicToRoman(num).toUpperCase();\n    }).args([[\n            '*number',\n            'integer'\n        ]]);\n    defineFunction('arabic', function (rom) {\n        var num = util.romanToArabic(rom);\n        return num == null ? new CalcError('VALUE') : num;\n    }).args([[\n            '*roman',\n            'string'\n        ]]);\n    defineFunction('base', function (number, radix, minLen) {\n        var str = number.toString(radix).toUpperCase();\n        while (str.length < minLen) {\n            str = '0' + str;\n        }\n        return str;\n    }).args([\n        [\n            '*number',\n            'integer'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ],\n        [\n            '*minLen',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('decimal', function (text, radix) {\n        text = text.toUpperCase();\n        var val = 0;\n        for (var i = 0; i < text.length; ++i) {\n            var d = text.charCodeAt(i);\n            if (d >= 48 && d <= 57) {\n                d -= 48;\n            } else if (d >= 65 && d < 55 + radix) {\n                d -= 55;\n            } else {\n                return new CalcError('VALUE');\n            }\n            val = val * radix + d;\n        }\n        return val;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('char', function (code) {\n        return String.fromCharCode(code);\n    }).args([[\n            '*code',\n            'integer+'\n        ]]);\n    var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n    defineFunction('clean', function (text) {\n        return text.replace(RX_NON_PRINTABLE, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('code', function (text) {\n        return text.charAt(0);\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineAlias('unichar', 'char');\n    defineAlias('unicode', 'code');\n    defineFunction('concatenate', function () {\n        var out = '';\n        for (var i = 0; i < arguments.length; ++i) {\n            out += arguments[i];\n        }\n        return out;\n    }).args([[\n            '+',\n            [\n                '*text',\n                'string'\n            ]\n        ]]);\n    defineFunction('dollar', function (number, decimals) {\n        var format = '$#,##0.DECIMALS;($#,##0.DECIMALS)';\n        var dec = '';\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('exact', function (a, b) {\n        return a === b;\n    }).args([\n        [\n            '*text1',\n            'string'\n        ],\n        [\n            '*text2',\n            'string'\n        ]\n    ]);\n    defineFunction('find', function (substring, string, start) {\n        var pos = string.indexOf(substring, start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('fixed', function (number, decimals, noCommas) {\n        var format = noCommas ? '0.DECIMALS' : '#,##0.DECIMALS';\n        var dec = '';\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            '*noCommas',\n            [\n                'or',\n                'boolean',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('left', function (text, length) {\n        return text.substr(0, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('right', function (text, length) {\n        return text.substr(-length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('len', function (text) {\n        return text.length;\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('lower', function (text) {\n        return text.toLowerCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('upper', function (text) {\n        return text.toUpperCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('ltrim', function (text) {\n        return text.replace(/^\\s+/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('rtrim', function (text) {\n        return text.replace(/\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('trim', function (text) {\n        return text.replace(/^\\s+|\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mid', function (text, start, length) {\n        return text.substr(start - 1, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ]\n    ]);\n    defineFunction('proper', function (text) {\n        return text.toLowerCase().replace(/\\b./g, function (s) {\n            return s.toUpperCase();\n        });\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('replace', function (text, start, length, newText) {\n        return text.substr(0, --start) + newText + text.substr(start + length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ],\n        [\n            '*newText',\n            'string'\n        ]\n    ]);\n    defineFunction('rept', function (text, number) {\n        var out = '';\n        while (number-- > 0) {\n            out += text;\n        }\n        return out;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*number',\n            'integer+'\n        ]\n    ]);\n    defineFunction('search', function (substring, string, start) {\n        var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('substitute', function (text, oldText, newText, nth) {\n        if (oldText === newText) {\n            return text;\n        }\n        var pos = -1;\n        function replace() {\n            text = text.substring(0, pos) + newText + text.substring(pos + oldText.length);\n        }\n        while ((pos = text.indexOf(oldText, pos + 1)) >= 0) {\n            if (nth == null) {\n                replace();\n            } else if (--nth === 0) {\n                replace();\n                break;\n            }\n        }\n        return text;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*oldText',\n            'string'\n        ],\n        [\n            '*newText',\n            'string'\n        ],\n        [\n            '*nth',\n            [\n                'or',\n                'integer++',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('t', function (value) {\n        return typeof value == 'string' ? value : '';\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('text', function (value, format) {\n        return spreadsheet.formatting.text(value, format);\n    }).args([\n        [\n            '*value',\n            'anyvalue'\n        ],\n        [\n            '*format',\n            'string'\n        ]\n    ]);\n    defineFunction('value', function (value) {\n        if (typeof value == 'number') {\n            return value;\n        }\n        if (typeof value == 'boolean') {\n            return +value;\n        }\n        value = (value + '').replace(/[$,]/g, '');\n        value = parseFloat(value);\n        return isNaN(value) ? new CalcError('VALUE') : value;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('iferror', function (value, valueIfError) {\n        return value instanceof CalcError ? valueIfError : value;\n    }).args([\n        [\n            '*value',\n            'forced!'\n        ],\n        [\n            '*value_if_error',\n            'anyvalue'\n        ]\n    ]);\n    var parseCriteria = function () {\n        var RXCACHE = Object.create(null);\n        function makeComparator(cmp, x) {\n            if (typeof x == 'string') {\n                var num = parseFloat(x);\n                if (!isNaN(num)) {\n                    x = num;\n                }\n            }\n            return function (a) {\n                var b = x;\n                if (typeof a == 'string' && typeof b == 'string') {\n                    a = a.toLowerCase();\n                    b = b.toLowerCase();\n                }\n                return cmp(a, b);\n            };\n        }\n        function lc(a) {\n            if (typeof a == 'string') {\n                return a.toLowerCase();\n            }\n            return a;\n        }\n        function compLT(a, b) {\n            return lc(a) < lc(b);\n        }\n        function compLTE(a, b) {\n            return lc(a) <= lc(b);\n        }\n        function compGT(a, b) {\n            return lc(a) > lc(b);\n        }\n        function compGTE(a, b) {\n            return lc(a) >= lc(b);\n        }\n        function compNE(a, b) {\n            return lc(a) != lc(b);\n        }\n        function compEQ(a, b) {\n            if (b instanceof RegExp) {\n                return b.test(a);\n            }\n            return lc(a) == lc(b);\n        }\n        return function (cmp) {\n            if (typeof cmp == 'function') {\n                return cmp;\n            }\n            var m;\n            if (m = /^=(.*)$/.exec(cmp)) {\n                return makeComparator(compEQ, m[1]);\n            }\n            if (m = /^<>(.*)$/.exec(cmp)) {\n                return makeComparator(compNE, m[1]);\n            }\n            if (m = /^<=(.*)$/.exec(cmp)) {\n                return makeComparator(compLTE, m[1]);\n            }\n            if (m = /^<(.*)$/.exec(cmp)) {\n                return makeComparator(compLT, m[1]);\n            }\n            if (m = /^>=(.*)$/.exec(cmp)) {\n                return makeComparator(compGTE, m[1]);\n            }\n            if (m = /^>(.*)$/.exec(cmp)) {\n                return makeComparator(compGT, m[1]);\n            }\n            if (/[?*]/.exec(cmp)) {\n                var rx = RXCACHE[cmp];\n                if (!rx) {\n                    rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function (s) {\n                        switch (s) {\n                        case '~?':\n                            return '\\\\?';\n                        case '~*':\n                            return '\\\\*';\n                        case '?':\n                            return '.';\n                        case '*':\n                            return '.*';\n                        default:\n                            return '\\\\' + s;\n                        }\n                    });\n                    rx = RXCACHE[cmp] = new RegExp('^' + rx + '$', 'i');\n                }\n                return makeComparator(compEQ, rx);\n            }\n            return makeComparator(compEQ, cmp);\n        };\n    }();\n    function numericPredicate(val) {\n        return typeof val == 'number' || typeof val == 'boolean' || val == null || val === '';\n    }\n    function ascending(a, b) {\n        return a === b ? 0 : a < b ? -1 : 1;\n    }\n    function descending(a, b) {\n        return a === b ? 0 : a < b ? 1 : -1;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions.2', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var CalcError = runtime.CalcError;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var isLeapYear = runtime.isLeapYear;\n    var daysInMonth = runtime.daysInMonth;\n    var _days_360 = runtime._days_360;\n    defineFunction('ERF', function (ll, ul) {\n        if (ul == null) {\n            return ERF(ll);\n        }\n        return ERF(ul) - ERF(ll);\n    }).args([\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('ERFC', ERFC).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMALN', GAMMALN).args([[\n            'x',\n            'number++'\n        ]]);\n    defineFunction('GAMMA', GAMMA).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMA.DIST', GAMMA_DIST).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('GAMMA.INV', GAMMA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ]\n    ]);\n    defineFunction('NORM.S.DIST', NORM_S_DIST).args([\n        [\n            'z',\n            'number'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.S.INV', NORM_S_INV).args([[\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('NORM.DIST', NORM_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.INV', NORM_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ]\n    ]);\n    defineFunction('BETADIST', BETADIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.DIST', BETA_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.INV', BETA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CHISQ.DIST', chisq_left).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('CHISQ.DIST.RT', chisq_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV', chisq_left_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV.RT', chisq_right_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.TEST', function (ac, ex) {\n        return chisq_test(ac.data, ex.data);\n    }).args([\n        [\n            'actual_range',\n            'matrix'\n        ],\n        [\n            'expected_range',\n            'matrix'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.width == $expected_range.width'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.height == $expected_range.height'\n            ]\n        ]\n    ]);\n    defineFunction('EXPON.DIST', expon).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'lambda',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('POISSON.DIST', poisson).args([\n        [\n            'x',\n            'integer+'\n        ],\n        [\n            'mean',\n            'number+'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST', Fdist).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST.RT', Fdist_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV', Finv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV.RT', Finv_right).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.TEST', Ftest).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FISHER', fisher).args([[\n            'x',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('FISHERINV', fisherinv).args([[\n            'y',\n            'number'\n        ]]);\n    defineFunction('T.DIST', Tdist).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('T.DIST.RT', Tdist_right).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.DIST.2T', Tdist_2tail).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV', Tdist_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV.2T', Tdist_2tail_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.TEST', Tdist_test).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'tails',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    3\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$type != 1 || $array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.T', confidence_t).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++',\n                [\n                    'assert',\n                    '$size != 1',\n                    'DIV/0'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.NORM', confidence_norm).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++'\n            ]\n        ]\n    ]);\n    defineFunction('GAUSS', gauss).args([[\n            'z',\n            'number'\n        ]]);\n    defineFunction('PHI', phi).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('LOGNORM.DIST', lognorm_dist).args([\n        [\n            'x',\n            'number++'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('LOGNORM.INV', lognorm_inv).args([\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ]\n    ]);\n    defineFunction('PROB', prob).args([\n        [\n            'x_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'prob_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$lower_limit'\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$prob_range.length == $x_range.length',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('SLOPE', slope).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('INTERCEPT', intercept).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('PEARSON', pearson).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length == $array1.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length > 0 && $array1.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('RSQ', rsq).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length != 1 && $known_y.length != 1',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('STEYX', steyx).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length >= 3 && $known_y.length >= 3',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FORECAST', forecast).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('LINEST', linest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('LOGEST', logest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('TREND', trend).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('GROWTH', growth).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('FV', FV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $pv'\n            ]\n        ]\n    ]);\n    defineFunction('PV', PV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('PMT', PMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('NPER', NPER).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('RATE', RATE).args([\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    0.01\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('IPMT', IPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('PPMT', PPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('CUMPRINC', CUMPRINC).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('CUMIPMT', CUMIPMT).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('NPV', NPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('IRR', IRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('EFFECT', EFFECT).args([\n        [\n            'nominal_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('NOMINAL', NOMINAL).args([\n        [\n            'effect_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('XNPV', XNPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('XIRR', XIRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ISPMT', ISPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('DB', DB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'month',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    12\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('DDB', DDB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('SLN', SLN).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ]\n    ]);\n    defineFunction('SYD', SYD).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'per',\n            'number++'\n        ]\n    ]);\n    defineFunction('VDB', VDB).args([\n        [\n            'cost',\n            'number+'\n        ],\n        [\n            'salvage',\n            'number+'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number+'\n        ],\n        [\n            'end_period',\n            'number+'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number+',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            'no_switch',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    var COUPS_ARGS = [\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('COUPDAYBS', COUPDAYBS).args(COUPS_ARGS);\n    defineFunction('COUPDAYS', COUPDAYS).args(COUPS_ARGS);\n    defineFunction('COUPDAYSNC', COUPDAYSNC).args(COUPS_ARGS);\n    defineFunction('COUPPCD', COUPPCD).args(COUPS_ARGS);\n    defineFunction('COUPNCD', COUPNCD).args(COUPS_ARGS);\n    defineFunction('COUPNUM', COUPNUM).args(COUPS_ARGS);\n    defineFunction('ACCRINTM', ACCRINTM).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ACCRINT', ACCRINT).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'first_interest',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            'calc_method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('DISC', DISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'pr',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('INTRATE', INTRATE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('RECEIVED', RECEIVED).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICE', PRICE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'yld',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICEDISC', PRICEDISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    var MAX_IT = 300, EPS = 2.2204e-16, FP_MIN = 1e-30, f_abs = Math.abs;\n    function ERF(x) {\n        if (f_abs(x) >= 3.3) {\n            return 1 - ERFC(x);\n        }\n        var S = x > 0 ? 1 : -1;\n        if (S == -1) {\n            x = -x;\n        }\n        var m = 0, an = 1;\n        for (var n = 1; n < 100; n++) {\n            m += an;\n            an *= 2 * x * x / (2 * n + 1);\n        }\n        return S * 2 / Math.sqrt(Math.PI) * x * Math.exp(-x * x) * m;\n    }\n    function ERFC(x) {\n        if (f_abs(x) < 3.3) {\n            return 1 - ERF(x);\n        }\n        var s = 1;\n        if (x < 0) {\n            s = -1;\n            x = -x;\n        }\n        var frac = x;\n        for (var n = 8; n >= 1; n -= 0.5) {\n            frac = x + n / frac;\n        }\n        frac = 1 / (x + frac);\n        return s == 1 ? Math.exp(-x * x) / Math.sqrt(Math.PI) * frac : 2 - Math.exp(-x * x) / Math.sqrt(Math.PI) * frac;\n    }\n    function GAMMALN(x) {\n        var cof = [\n            1.000000000190015,\n            76.18009172947146,\n            -86.50532032941678,\n            24.01409824083091,\n            -1.231739572450155,\n            0.001208650973866179,\n            -0.000005395239384953\n        ];\n        var y = x, tmp = x + 5.5, ser = cof[0];\n        tmp -= (x + 0.5) * Math.log(tmp);\n        for (var j = 1; j <= 6; j++) {\n            y += 1;\n            ser += cof[j] / y;\n        }\n        return -tmp + Math.log(Math.sqrt(2 * Math.PI) * ser / x);\n    }\n    function GAMMA(x) {\n        if (x > 0) {\n            return Math.exp(GAMMALN(x));\n        }\n        var pi = Math.PI, y = -x;\n        return -pi / (y * GAMMA(y) * Math.sin(pi * y));\n    }\n    function BETALN(a, b) {\n        return GAMMALN(a) + GAMMALN(b) - GAMMALN(a + b);\n    }\n    function BETA(a, b) {\n        return Math.exp(BETALN(a, b));\n    }\n    function gamma_inc(a, x) {\n        return x < a + 1 ? g_series(a, x) : 1 - g_contfrac(a, x);\n    }\n    function g_series(a, x) {\n        var sum = 1 / a, frac = sum, ap = a;\n        var gln = GAMMALN(a), n;\n        for (n = 1; n <= MAX_IT; n++) {\n            ap++;\n            frac *= x / ap;\n            sum += frac;\n            if (f_abs(frac) < f_abs(sum) * EPS) {\n                break;\n            }\n        }\n        return sum * Math.exp(-x + a * Math.log(x) - gln);\n    }\n    function g_contfrac(a, x) {\n        var f = FP_MIN, c = f, d = 0, aj = 1, bj = x + 1 - a;\n        var gln = GAMMALN(a);\n        for (var i = 1; i <= MAX_IT; i++) {\n            d = bj + aj * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = bj + aj / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            var delta = c * d;\n            f *= delta;\n            if (f_abs(delta - 1) < EPS) {\n                break;\n            }\n            bj += 2;\n            aj = -i * (i - a);\n        }\n        return f * Math.exp(-x - gln + a * Math.log(x));\n    }\n    function GAMMA_DIST(x, a, b, cumulative) {\n        if (!cumulative) {\n            return Math.pow(x / b, a - 1) * Math.exp(-x / b) / (b * GAMMA(a));\n        }\n        return gamma_inc(a, x / b);\n    }\n    function GAMMA_INV(p, a, b) {\n        if (p === 0) {\n            return 0;\n        }\n        if (p == 1) {\n            return Infinity;\n        }\n        var m = 0, M = 10, x = 0, ab = a * b;\n        if (ab > 1) {\n            M *= ab;\n        }\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = GAMMA_DIST(x, a, b, true);\n            if (f_abs(p - q) < 1e-16) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function NORM_S_DIST(x, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-x * x / 2) / Math.sqrt(2 * Math.PI);\n        }\n        return 0.5 + 0.5 * ERF(x / Math.sqrt(2));\n    }\n    function NORM_S_INV(p) {\n        var a = [\n                -39.69683028665376,\n                220.9460984245205,\n                -275.9285104469687,\n                138.357751867269,\n                -30.66479806614716,\n                2.506628277459239\n            ], b = [\n                -54.47609879822406,\n                161.5858368580409,\n                -155.6989798598866,\n                66.80131188771972,\n                -13.28068155288572\n            ], c = [\n                -0.007784894002430293,\n                -0.3223964580411365,\n                -2.400758277161838,\n                -2.549732539343734,\n                4.374664141464968,\n                2.938163982698783\n            ], d = [\n                0.007784695709041462,\n                0.3224671290700398,\n                2.445134137142996,\n                3.754408661907416\n            ];\n        var plow = 0.02425, phigh = 1 - plow;\n        var q, r;\n        if (p < plow) {\n            q = Math.sqrt(-2 * Math.log(p));\n            return (((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        if (phigh < p) {\n            q = Math.sqrt(-2 * Math.log(1 - p));\n            return -(((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        q = p - 0.5;\n        r = q * q;\n        return (((((a[0] * r + a[1]) * r + a[2]) * r + a[3]) * r + a[4]) * r + a[5]) * q / (((((b[0] * r + b[1]) * r + b[2]) * r + b[3]) * r + b[4]) * r + 1);\n    }\n    function NORM_DIST(x, m, s, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-(x - m) * (x - m) / (2 * s * s)) / (s * Math.sqrt(2 * Math.PI));\n        }\n        return NORM_S_DIST((x - m) / s, true);\n    }\n    function NORM_INV(p, m, s) {\n        return m + s * NORM_S_INV(p);\n    }\n    function betastd_pdf(x, a, b) {\n        return Math.exp((a - 1) * Math.log(x) + (b - 1) * Math.log(1 - x) - BETALN(a, b));\n    }\n    function betastd_cdf(x, a, b) {\n        var k = Math.exp(a * Math.log(x) + b * Math.log(1 - x) - BETALN(a, b));\n        return x < (a + 1) / (a + b + 2) ? k * beta_lentz(a, b, x) / a : 1 - k * beta_lentz(b, a, 1 - x) / b;\n    }\n    function beta_lentz(a, b, x) {\n        var m, m2;\n        var aa, c, d, del, h, qab, qam, qap;\n        qab = a + b;\n        qap = a + 1;\n        qam = a - 1;\n        c = 1;\n        d = 1 - qab * x / qap;\n        if (f_abs(d) < FP_MIN) {\n            d = FP_MIN;\n        }\n        d = 1 / d;\n        h = d;\n        for (m = 1; m <= MAX_IT; m++) {\n            m2 = 2 * m;\n            aa = m * (b - m) * x / ((qam + m2) * (a + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            h *= d * c;\n            aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            del = d * c;\n            h *= del;\n            if (f_abs(del - 1) < EPS) {\n                break;\n            }\n        }\n        return h;\n    }\n    function betastd_inv(p, a, b) {\n        var m = 0, M = 1, x = 0;\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = betastd_cdf(x, a, b);\n            if (f_abs(p - q) < EPS) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function BETADIST(x, a, b, m, M) {\n        return betastd_cdf((x - m) / (M - m), a, b);\n    }\n    function BETA_DIST(x, a, b, cdf, m, M) {\n        if (cdf) {\n            return betastd_cdf((x - m) / (M - m), a, b);\n        }\n        return betastd_pdf((x - m) / (M - m), a, b) / (M - m);\n    }\n    function BETA_INV(p, a, b, m, M) {\n        return m + (M - m) * betastd_inv(p, a, b);\n    }\n    function chisq_left(x, n, cds) {\n        return GAMMA_DIST(x, n / 2, 2, cds);\n    }\n    function chisq_right(x, n) {\n        return 1 - chisq_left(x, n, true);\n    }\n    function chisq_left_inv(p, n) {\n        return GAMMA_INV(p, n / 2, 2);\n    }\n    function chisq_right_inv(p, n) {\n        return chisq_left_inv(1 - p, n);\n    }\n    function chisq_test(obsv, expect) {\n        var rows = obsv.length, cols = obsv[0].length;\n        var x = 0, i, j;\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                var eij = expect[i][j];\n                var delta = obsv[i][j] - eij;\n                delta *= delta;\n                x += delta / eij;\n            }\n        }\n        var n = (rows - 1) * (cols - 1);\n        return chisq_right(x, n);\n    }\n    function expon(x, r, cdf) {\n        if (cdf) {\n            return 1 - Math.exp(-r * x);\n        }\n        return r * Math.exp(-r * x);\n    }\n    function poisson(k, m, cdf) {\n        if (cdf) {\n            return 1 - chisq_left(2 * m, 2 * (k + 1), true);\n        }\n        var lnf = 0;\n        for (var i = 2; i <= k; i++) {\n            lnf += Math.log(i);\n        }\n        return Math.exp(k * Math.log(m) - m - lnf);\n    }\n    function Fdist(x, n, d, cdf) {\n        if (cdf) {\n            return betastd_cdf(n * x / (d + n * x), n / 2, d / 2);\n        }\n        var u = n / d;\n        n /= 2;\n        d /= 2;\n        return u / BETA(n, d) * Math.pow(u * x, n - 1) / Math.pow(1 + u * x, n + d);\n    }\n    function Fdist_right(x, n, d) {\n        return 1 - Fdist(x, n, d, true);\n    }\n    function Finv_right(p, n, d) {\n        return d / n * (1 / BETA_INV(p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function Finv(p, n, d) {\n        return d / n * (1 / BETA_INV(1 - p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function _mean(arr) {\n        var me = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            me += arr[i];\n        }\n        return me / n;\n    }\n    function _var_sq(arr, m) {\n        var v = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            var delta = arr[i] - m;\n            v += delta * delta;\n        }\n        return v / (n - 1);\n    }\n    function Ftest(arr1, arr2) {\n        var n1 = arr1.length - 1, n2 = arr2.length - 1;\n        var va1 = _var_sq(arr1, _mean(arr1)), va2 = _var_sq(arr2, _mean(arr2));\n        if (!va1 || !va2) {\n            throw new CalcError('DIV/0');\n        }\n        return 2 * Fdist(va1 / va2, n1, n2, true);\n    }\n    function fisher(x) {\n        return 0.5 * Math.log((1 + x) / (1 - x));\n    }\n    function fisherinv(x) {\n        var e2 = Math.exp(2 * x);\n        return (e2 - 1) / (e2 + 1);\n    }\n    function Tdist(x, n, cdf) {\n        if (cdf) {\n            return 1 - 0.5 * betastd_cdf(n / (x * x + n), n / 2, 0.5);\n        }\n        return 1 / (Math.sqrt(n) * BETA(0.5, n / 2)) * Math.pow(1 + x * x / n, -(n + 1) / 2);\n    }\n    function Tdist_right(x, n) {\n        return 1 - Tdist(x, n, true);\n    }\n    function Tdist_2tail(x, n) {\n        if (x < 0) {\n            x = -x;\n        }\n        return 2 * Tdist_right(x, n);\n    }\n    function Tdist_inv(p, n) {\n        var x = betastd_inv(2 * Math.min(p, 1 - p), n / 2, 0.5);\n        x = Math.sqrt(n * (1 - x) / x);\n        return p > 0.5 ? x : -x;\n    }\n    function Tdist_2tail_inv(p, n) {\n        return Tdist_inv(1 - p / 2, n);\n    }\n    function Tdist_test(gr1, gr2, tail, type) {\n        var n1 = gr1.length, n2 = gr2.length;\n        var t_st, df;\n        if (type == 1) {\n            var d = 0, d2 = 0;\n            for (var i = 0; i < n1; i++) {\n                var delta = gr1[i] - gr2[i];\n                d += delta;\n                d2 += delta * delta;\n            }\n            var md = d / n1;\n            t_st = md / Math.sqrt((d2 - d * md) / (n1 * (n1 - 1)));\n            return tail == 1 ? Tdist_right(t_st, n1 - 1) : Tdist_2tail(t_st, n1 - 1);\n        }\n        var m1 = _mean(gr1), m2 = _mean(gr2), v1 = _var_sq(gr1, m1), v2 = _var_sq(gr2, m2);\n        if (type == 3) {\n            var u1 = v1 / n1, u2 = v2 / n2, u = u1 + u2;\n            var q1 = u1 / u, q2 = u2 / u;\n            df = 1 / (q1 * q1 / (n1 - 1) + q2 * q2 / (n2 - 1));\n            t_st = f_abs(m1 - m2) / Math.sqrt(u);\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        } else {\n            df = n1 + n2 - 2;\n            t_st = f_abs(m1 - m2) * Math.sqrt(df * n1 * n2 / ((n1 + n2) * ((n1 - 1) * v1 + (n2 - 1) * v2)));\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        }\n    }\n    function confidence_t(alpha, stddev, size) {\n        return -Tdist_inv(alpha / 2, size - 1) * stddev / Math.sqrt(size);\n    }\n    function confidence_norm(alpha, stddev, size) {\n        return -NORM_S_INV(alpha / 2) * stddev / Math.sqrt(size);\n    }\n    function gauss(z) {\n        return NORM_S_DIST(z, true) - 0.5;\n    }\n    function phi(x) {\n        return NORM_S_DIST(x);\n    }\n    function lognorm_dist(x, m, s, cumulative) {\n        if (cumulative) {\n            return 0.5 + 0.5 * ERF((Math.log(x) - m) / (s * Math.sqrt(2)));\n        }\n        var t = Math.log(x) - m;\n        return Math.exp(-t * t / (2 * s * s)) / (x * s * Math.sqrt(2 * Math.PI));\n    }\n    function lognorm_inv(p, m, s) {\n        return Math.exp(NORM_INV(p, m, s));\n    }\n    function prob(x_, p_, lw, up) {\n        var n = x_.length;\n        var s = 0, i;\n        for (i = 0; i < n; i++) {\n            if (p_[i] <= 0 || p_[i] > 1) {\n                throw new CalcError('NUM');\n            }\n            s += p_[i];\n        }\n        if (s != 1) {\n            throw new CalcError('NUM');\n        }\n        var res = 0;\n        for (i = 0; i < n; i++) {\n            var x = x_[i];\n            if (x >= lw && x <= up) {\n                res += p_[i];\n            }\n        }\n        return res;\n    }\n    function slope(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_), b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return b1 / b2;\n    }\n    function intercept(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return my - b1 * mx / b2;\n    }\n    function pearson(x_, y_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n            s3 += t2 * t2;\n        }\n        return s1 / Math.sqrt(s2 * s3);\n    }\n    function rsq(x_, y_) {\n        var r = pearson(x_, y_);\n        return r * r;\n    }\n    function steyx(y_, x_) {\n        var n = x_.length;\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t2 * t2;\n            s2 += t1 * t2;\n            s3 += t1 * t1;\n        }\n        return Math.sqrt((s1 - s2 * s2 / s3) / (n - 2));\n    }\n    function forecast(x, y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (s2 === 0) {\n            throw new CalcError('N/A');\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return a + b * x;\n    }\n    function _mat_mean(Mat) {\n        var n = Mat.height, sum = 0;\n        for (var i = 0; i < n; i++) {\n            sum += Mat.data[i][0];\n        }\n        return sum / n;\n    }\n    function _mat_devsq(Mat, mean) {\n        var n = Mat.height, sq = 0;\n        for (var i = 0; i < n; i++) {\n            var x = Mat.data[i][0] - mean;\n            sq += x * x;\n        }\n        return sq;\n    }\n    function linest(Y, X, konst, stats) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        var line_1 = [];\n        for (i = B.height - 1; i >= 0; i--) {\n            line_1.push(B.data[i][0]);\n        }\n        if (!konst) {\n            line_1.push(0);\n        }\n        if (!stats) {\n            return this.asMatrix([line_1]);\n        }\n        var Y1 = X.multiply(B);\n        var y_y1 = Y.adds(Y1, true);\n        var mp = !konst ? 0 : _mat_mean(Y1);\n        var SSreg = _mat_devsq(Y1, mp);\n        var me = !konst ? 0 : _mat_mean(y_y1);\n        var SSresid = _mat_devsq(y_y1, me);\n        var line_5 = [];\n        line_5.push(SSreg, SSresid);\n        var R2 = SSreg / (SSreg + SSresid);\n        var degfre = Y.height - X.width;\n        var err_est = Math.sqrt(SSresid / degfre);\n        var line_3 = [];\n        line_3.push(R2, err_est);\n        var F_sta = !konst ? R2 / X.width / ((1 - R2) / degfre) : SSreg / (X.width - 1) / (SSresid / degfre);\n        var line_4 = [];\n        line_4.push(F_sta, degfre);\n        var SCP = Xt.multiply(X).inverse();\n        var line_2 = [];\n        for (i = SCP.height - 1; i >= 0; i--) {\n            line_2.push(Math.sqrt(SCP.data[i][i] * SSresid / degfre));\n        }\n        return this.asMatrix([\n            line_1,\n            line_2,\n            line_3,\n            line_4,\n            line_5\n        ]);\n    }\n    function logest(Y, X, konst, stats) {\n        return linest.call(this, Y.map(Math.log), X, konst, stats).map(Math.exp);\n    }\n    function trend(Y, X, W, konst) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        if (!W) {\n            W = X;\n        } else {\n            if (konst) {\n                W = W.clone();\n                W.eachRow(function (row) {\n                    W.data[row].unshift(1);\n                });\n                ++W.width;\n            }\n        }\n        return W.multiply(B);\n    }\n    function growth(Y, X, new_X, konst) {\n        return trend.call(this, Y.map(Math.log), X, new_X, konst).map(Math.exp);\n    }\n    function root_newton(func, guess, max_it, eps) {\n        var MAX_IT = max_it || 20, EPS = eps || 1e-7;\n        var root = guess;\n        for (var j = 1; j <= MAX_IT; j++) {\n            var f_d = func(root), f = f_d[0], df = f_d[1];\n            var dx = f / df;\n            root -= dx;\n            if (Math.abs(dx) < EPS) {\n                return root;\n            }\n        }\n        return new CalcError('NUM');\n    }\n    function FV(rate, nper, pmt, pv, type) {\n        var h1 = Math.pow(1 + rate, nper);\n        var h2 = rate ? (h1 - 1) / rate : nper;\n        return -(pv * h1 + pmt * h2 * (1 + rate * type));\n    }\n    function PV(rate, nper, pmt, fv, type) {\n        if (!rate) {\n            return -fv - pmt * nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -(fv + pmt * (h1 - 1) / rate * (1 + rate * type)) / h1;\n    }\n    function PMT(rate, nper, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -rate * (fv + pv * h1) / ((1 + rate * type) * (h1 - 1));\n    }\n    function NPER(rate, pmt, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / pmt;\n        }\n        var h1 = pmt * (1 + rate * type);\n        return Math.log((h1 - fv * rate) / (h1 + pv * rate)) / Math.log(1 + rate);\n    }\n    function RATE(nper, pmt, pv, fv, type, guess) {\n        function xfd(x) {\n            var h2 = Math.pow(1 + x, nper - 1), h1 = h2 * (1 + x);\n            return [\n                pv * h1 + pmt * (1 / x + type) * (h1 - 1) + fv,\n                nper * pv * h2 + pmt * (-(h1 - 1) / (x * x) + (1 / x + type) * nper * h2)\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function IPMT(rate, per, nper, pv, fv, type) {\n        if (type == 1 && per == 1) {\n            return 0;\n        }\n        var pmt = PMT(rate, nper, pv, fv, type);\n        var ipmt = FV(rate, per - 1, pmt, pv, type) * rate;\n        return type ? ipmt / (1 + rate) : ipmt;\n    }\n    function PPMT(rate, per, nper, pv, fv, type) {\n        var pmt = PMT(rate, nper, pv, fv, type);\n        return pmt - IPMT(rate, per, nper, pv, fv, type);\n    }\n    function CUMPRINC(rate, nper, pv, start, end, type) {\n        if (type == 1) {\n            start--;\n            end--;\n        }\n        var tn = Math.pow(1 + rate, nper), ts = Math.pow(1 + rate, start - 1), te = Math.pow(1 + rate, end);\n        var monthlyPayment = rate * pv * tn / (tn - 1);\n        var remainingBalanceAtStart = ts * pv - (ts - 1) / rate * monthlyPayment;\n        var remainingBalanceAtEnd = te * pv - (te - 1) / rate * monthlyPayment;\n        return remainingBalanceAtEnd - remainingBalanceAtStart;\n    }\n    function CUMIPMT(rate, nper, pv, start, end, type) {\n        var cip = 0;\n        for (var i = start; i <= end; i++) {\n            cip += IPMT(rate, i, nper, pv, 0, type);\n        }\n        return cip;\n    }\n    function NPV(rate, flows) {\n        var npv = 0;\n        for (var i = 0, n = flows.length; i < n; i++) {\n            npv += flows[i] * Math.pow(1 + rate, -i - 1);\n        }\n        return npv;\n    }\n    function IRR(flows, guess) {\n        function xfd(x) {\n            var npv = 0, npv1 = 0;\n            for (var j = 0, n = flows.length; j < n; j++) {\n                npv += flows[j] * Math.pow(1 + x, -j - 1);\n                npv1 += -j * flows[j] * Math.pow(1 + x, -j - 2);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function EFFECT(nominal_rate, npery) {\n        return Math.pow(1 + nominal_rate / npery, npery) - 1;\n    }\n    function NOMINAL(effect_rate, npery) {\n        return npery * (Math.pow(effect_rate + 1, 1 / npery) - 1);\n    }\n    function XNPV(rate, values, dates) {\n        var npv = 0;\n        for (var i = 0, n = values.length; i < n; i++) {\n            npv += values[i] * Math.pow(1 + rate, (dates[0] - dates[i]) / 365);\n        }\n        return npv;\n    }\n    function XIRR(values, dates, guess) {\n        function xfd(x) {\n            var npv = values[0], npv1 = 0;\n            for (var j = 1, n = values.length; j < n; j++) {\n                var delta = (dates[0] - dates[j]) / 365;\n                npv += values[j] * Math.pow(1 + x, delta);\n                npv1 += delta * values[j] * Math.pow(1 + x, delta - 1);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function ISPMT(rate, per, nper, pv) {\n        var tmp = -pv * rate;\n        return tmp * (1 - per / nper);\n    }\n    function DB(cost, salvage, life, period, month) {\n        var rate = 1 - Math.pow(salvage / cost, 1 / life);\n        rate = Math.floor(rate * 1000 + 0.5) / 1000;\n        var db = cost * rate * month / 12;\n        if (period == 1) {\n            return db;\n        }\n        for (var i = 1; i < life; i++) {\n            if (i == period - 1) {\n                return (cost - db) * rate;\n            }\n            db += (cost - db) * rate;\n        }\n        return (cost - db) * rate * (12 - month) / 12;\n    }\n    function DDB(cost, salvage, life, period, factor) {\n        var f = factor / life;\n        var prior = -cost * (Math.pow(1 - f, period - 1) - 1);\n        var dep = (cost - prior) * f;\n        dep = Math.min(dep, Math.max(0, cost - prior - salvage));\n        return dep;\n    }\n    function SLN(cost, salvage, life) {\n        return (cost - salvage) / life;\n    }\n    function SYD(cost, salvage, life, per) {\n        return (cost - salvage) * (life - per + 1) * 2 / (life * (life + 1));\n    }\n    function VDB(cost, salvage, life, start, end, factor, no_switch) {\n        var interest = factor >= life ? 1 : factor / life;\n        function _getGDA(value, period) {\n            var gda, oldValue, newValue;\n            if (interest == 1) {\n                oldValue = period == 1 ? value : 0;\n            } else {\n                oldValue = value * Math.pow(1 - interest, period - 1);\n            }\n            newValue = value * Math.pow(1 - interest, period);\n            gda = newValue < salvage ? oldValue - salvage : oldValue - newValue;\n            return gda < 0 ? 0 : gda;\n        }\n        function _interVDB(cost, life1, period) {\n            var remValue = cost - salvage;\n            var intEnd = Math.ceil(period);\n            var term, lia = 0, vdb = 0, nowLia = false;\n            for (var i = 1; i <= intEnd; i++) {\n                if (!nowLia) {\n                    var gda = _getGDA(cost, i);\n                    lia = remValue / (life1 - i + 1);\n                    if (lia > gda) {\n                        term = lia;\n                        nowLia = true;\n                    } else {\n                        term = gda;\n                        remValue -= gda;\n                    }\n                } else {\n                    term = lia;\n                }\n                if (i == intEnd) {\n                    term *= period + 1 - intEnd;\n                }\n                vdb += term;\n            }\n            return vdb;\n        }\n        var intStart = Math.floor(start), intEnd = Math.ceil(end);\n        var vdb = 0;\n        if (no_switch) {\n            for (var i = intStart + 1; i <= intEnd; i++) {\n                var term = _getGDA(cost, i);\n                if (i == intStart + 1) {\n                    term *= Math.min(end, intStart + 1) - start;\n                } else {\n                    if (i == intEnd) {\n                        term *= end + 1 - intEnd;\n                    }\n                }\n                vdb += term;\n            }\n        } else {\n            var life1 = life;\n            if (start != Math.floor(start)) {\n                if (factor > 1) {\n                    if (start >= life / 2) {\n                        var part = start - life / 2;\n                        start = life / 2;\n                        end -= part;\n                        life1 += 1;\n                    }\n                }\n            }\n            cost -= _interVDB(cost, life1, start);\n            vdb = _interVDB(cost, life - start, end - start);\n        }\n        return vdb;\n    }\n    function _edate(base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }\n    function _daysBetween(from, to, basis) {\n        if (basis == 1 || basis == 2 || basis == 3) {\n            return to - from;\n        }\n        return _days_360(from, to, basis);\n    }\n    function _borderCoupons(settlement, maturity, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(maturity);\n        var periods = base.year - sett.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev, next, months = 12 / freq;\n        do {\n            periods++;\n            prev = _edate(maturity, -periods * months);\n        } while (settlement < prev);\n        periods--;\n        next = _edate(maturity, -periods * months);\n        return [\n            prev,\n            next\n        ];\n    }\n    function _borderCoupons_fw(first, settlement, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(first);\n        var periods = sett.year - base.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev = first, next, months = 12 / freq;\n        while (settlement > prev) {\n            next = prev;\n            periods++;\n            prev = _edate(first, periods * months);\n        }\n        return [\n            next,\n            prev\n        ];\n    }\n    function COUPDAYBS(settlement, maturity, frequency, basis) {\n        var prev = _borderCoupons(settlement, maturity, frequency)[0];\n        return _daysBetween(prev, settlement, basis);\n    }\n    function COUPDAYS(settl, matur, freq, basis) {\n        if (basis == 1) {\n            var borders = _borderCoupons(settl, matur, freq);\n            return _daysBetween(borders[0], borders[1], 1);\n        }\n        if (basis == 3) {\n            return 365 / freq;\n        }\n        return 360 / freq;\n    }\n    function COUPDAYSNC(settl, matur, freq, basis) {\n        var next = _borderCoupons(settl, matur, freq)[1];\n        return _daysBetween(settl, next, basis);\n    }\n    function COUPPCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[0];\n    }\n    function COUPNCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[1];\n    }\n    function COUPNUM(settl, matur, freq) {\n        var sett = unpackDate(settl), mat = unpackDate(matur);\n        var months = 12 * (mat.year - sett.year) + mat.month - sett.month;\n        return 1 + (months * freq / 12 | 0);\n    }\n    function daysInYear(yr, basis) {\n        if (basis == 3) {\n            return 365;\n        }\n        if (basis == 1) {\n            return isLeapYear(yr) ? 366 : 365;\n        }\n        return 360;\n    }\n    function ACCRINTM(issue, maturity, rate, par, basis) {\n        var year_days = daysInYear(unpackDate(maturity).year, basis);\n        return rate * par * _daysBetween(issue, maturity, basis) / year_days;\n    }\n    function ACCRINT(issue, first, settl, rate, par, freq, basis, calc) {\n        var accr = 0, cost = par * rate / freq;\n        var brace, prev, next, prev1, next1, nrc;\n        var annual = basis % 2 === 0 ? 360 : 365;\n        function _numCoupons(from, to) {\n            return (to - from) * freq / annual | 0;\n        }\n        if (settl <= first) {\n            brace = _borderCoupons(settl, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            if (prev <= issue) {\n                return cost * _daysBetween(issue, settl, basis) / _daysBetween(prev, next, basis);\n            }\n            brace = _borderCoupons(issue, prev, freq);\n            prev1 = brace[0];\n            next1 = brace[1];\n            nrc = _numCoupons(next1, settl);\n            return cost * (nrc + _daysBetween(issue, next1, basis) / _daysBetween(prev1, next1, basis) + (settl < next ? _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis) : 0));\n        } else {\n            brace = _borderCoupons_fw(first, settl, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(first, settl);\n            if (next == settl) {\n                accr = cost * nrc;\n            } else {\n                accr = cost * (nrc + _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis));\n            }\n            if (!calc) {\n                return accr;\n            }\n            brace = _borderCoupons(issue, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(issue, first);\n            accr += cost * (nrc + _daysBetween(issue, next, basis) / _daysBetween(prev, next, basis));\n            return accr;\n        }\n    }\n    function DISC(settl, matur, pr, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - pr) / redemption * annual / _daysBetween(settl, matur, basis);\n    }\n    function INTRATE(settl, matur, investment, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - investment) / investment * annual / _daysBetween(settl, matur, basis);\n    }\n    function RECEIVED(settl, matur, investment, discount, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return investment / (1 - discount * _daysBetween(settl, matur, basis) / annual);\n    }\n    function PRICE(settl, matur, rate, yld, redemption, freq, basis) {\n        var N = 1 + ((matur - settl) * freq / (basis % 2 === 0 ? 360 : 365) | 0);\n        var brace = _borderCoupons(settl, matur, freq), prev = brace[0], next = brace[1];\n        var beg_settl = _daysBetween(prev, settl, basis), settl_end = _daysBetween(settl, next, basis), beg_end = _daysBetween(prev, next, basis);\n        var den = 100 * rate / freq, yf = yld / freq, frac = settl_end / beg_end;\n        if (N == 1) {\n            return (redemption + den) / (1 + frac * yf) - beg_settl / beg_end * den;\n        }\n        return redemption / Math.pow(1 + yf, N - 1 + frac) + den * Math.pow(1 + yf, 1 - N - frac) * (Math.pow(1 + yf, N) - 1) / yf - beg_settl / beg_end * den;\n    }\n    function PRICEDISC(settl, matur, discount, redemption, basis) {\n        var dsm = _daysBetween(settl, matur, basis), dy = daysInYear(unpackDate(matur).year, basis);\n        return redemption - discount * redemption * dsm / dy;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/borderpalette', [\n        'kendo.core',\n        'kendo.colorpicker',\n        'kendo.popup'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var BORDER_TYPES = [\n            'allBorders',\n            'insideBorders',\n            'insideHorizontalBorders',\n            'insideVerticalBorders',\n            'outsideBorders',\n            'leftBorder',\n            'topBorder',\n            'rightBorder',\n            'bottomBorder',\n            'noBorders'\n        ];\n        var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n            allBorders: 'All borders',\n            insideBorders: 'Inside borders',\n            insideHorizontalBorders: 'Inside horizontal borders',\n            insideVerticalBorders: 'Inside vertical borders',\n            outsideBorders: 'Outside borders',\n            leftBorder: 'Left border',\n            topBorder: 'Top border',\n            rightBorder: 'Right border',\n            bottomBorder: 'Bottom border',\n            noBorders: 'No border',\n            reset: 'Reset color',\n            customColor: 'Custom color...',\n            apply: 'Apply',\n            cancel: 'Cancel'\n        };\n        var ColorChooser = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = options.color;\n                this._resetButton();\n                this._colorPalette();\n                this._customColorPalette();\n                this._customColorButton();\n                this.resetButton.on('click', this.resetColor.bind(this));\n                this.customColorButton.on('click', this.customColor.bind(this));\n            },\n            options: { name: 'ColorChooser' },\n            events: ['change'],\n            destroy: function () {\n                kendo.unbind(this.dialog.element.find('.k-action-buttons'));\n                this.dialog.destroy();\n                this.colorPalette.destroy();\n                this.resetButton.off('click');\n                this.customColorButton.off('click');\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.color = value;\n                    this.customColorButton.find('.k-icon').css('background-color', this.color);\n                    this.colorPalette.value(null);\n                    this.flatColorPicker.value(this.color);\n                } else {\n                    return this.color;\n                }\n            },\n            _change: function (value) {\n                this.color = value;\n                this.trigger('change', { value: value });\n            },\n            _colorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-color-palette' });\n                var colorPalette = this.colorPalette = $('<div />').kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    value: this.color,\n                    change: function (e) {\n                        this.customColorButton.find('.k-icon').css('background-color', 'transparent');\n                        this.flatColorPicker.value(null);\n                        this._change(e.value);\n                    }.bind(this)\n                }).data('kendoColorPalette');\n                element.append(colorPalette.wrapper).appendTo(this.element);\n            },\n            _customColorPalette: function () {\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-window',\n                    'html': '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + BORDER_PALETTE_MESSAGES.apply + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + BORDER_PALETTE_MESSAGES.cancel + '</button>' + '</div>'\n                });\n                var dialog = this.dialog = element.appendTo(document.body).kendoWindow({\n                    animation: false,\n                    scrollable: false,\n                    resizable: false,\n                    maximizable: false,\n                    modal: true,\n                    visible: false,\n                    width: 268,\n                    open: function () {\n                        this.center();\n                    }\n                }).data('kendoWindow');\n                dialog.one('activate', function () {\n                    this.element.find('[data-role=flatcolorpicker]').data('kendoFlatColorPicker')._hueSlider.resize();\n                });\n                var flatColorPicker = this.flatColorPicker = dialog.element.children().first().kendoFlatColorPicker().data('kendoFlatColorPicker');\n                var viewModel = kendo.observable({\n                    apply: function () {\n                        this.customColorButton.find('.k-icon').css('background-color', flatColorPicker.value());\n                        this.colorPalette.value(null);\n                        this._change(flatColorPicker.value());\n                        dialog.close();\n                    }.bind(this),\n                    close: function () {\n                        flatColorPicker.value(null);\n                        dialog.close();\n                    }\n                });\n                kendo.bind(dialog.element.find('.k-action-buttons'), viewModel);\n            },\n            _resetButton: function () {\n                this.resetButton = $('<a class=\\'k-button k-reset-color\\' href=\\'#\\'>' + '<span class=\\'k-icon k-font-icon k-i-reset-color\\'></span>' + BORDER_PALETTE_MESSAGES.reset + '</a>').appendTo(this.element);\n            },\n            _customColorButton: function () {\n                this.customColorButton = $('<a class=\\'k-button k-custom-color\\' href=\\'#\\'>' + '<span class=\\'k-icon\\'></span>' + BORDER_PALETTE_MESSAGES.customColor + '</a>').appendTo(this.element);\n            },\n            resetColor: function () {\n                this.colorPalette.value(null);\n                this.flatColorPicker.value(null);\n                this._change(null);\n            },\n            customColor: function () {\n                this.dialog.open();\n            }\n        });\n        var BorderPalette = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = '#000';\n                this.element.addClass('k-spreadsheet-border-palette');\n                this._borderTypePalette();\n                this._borderColorPalette();\n                this.element.on('click', '.k-spreadsheet-border-type-palette .k-button', this._click.bind(this));\n            },\n            options: { name: 'BorderPalette' },\n            events: ['change'],\n            destroy: function () {\n                this.colorChooser.destroy();\n                this.element.off('click');\n            },\n            _borderTypePalette: function () {\n                var messages = BORDER_PALETTE_MESSAGES;\n                var buttons = BORDER_TYPES.map(function (type) {\n                    return '<a title=\"' + messages[type] + '\" href=\"#\" data-border-type=\"' + type + '\" class=\"k-button k-button-icon\">' + '<span class=\"k-sprite k-font-icon k-icon k-i-' + kendo.toHyphens(type) + '\"></span>' + '</a>';\n                }).join('');\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-border-type-palette',\n                    'html': buttons\n                });\n                element.appendTo(this.element);\n            },\n            _borderColorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-border-color-palette' });\n                element.appendTo(this.element);\n                this.colorChooser = new ColorChooser(element, {\n                    color: this.color,\n                    change: this._colorChange.bind(this)\n                });\n            },\n            _click: function (e) {\n                this.type = $(e.currentTarget).data('borderType');\n                this.trigger('change', {\n                    type: this.type,\n                    color: this.color\n                });\n            },\n            _colorChange: function (e) {\n                this.color = e.value;\n                if (this.type) {\n                    this.trigger('change', {\n                        type: this.type,\n                        color: this.color\n                    });\n                }\n            }\n        });\n        kendo.spreadsheet.ColorChooser = ColorChooser;\n        kendo.spreadsheet.BorderPalette = BorderPalette;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/toolbar', [\n        'kendo.toolbar',\n        'kendo.colorpicker',\n        'kendo.combobox',\n        'kendo.dropdownlist',\n        'kendo.popup',\n        'spreadsheet/borderpalette'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ToolBar = kendo.ui.ToolBar;\n        var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n            addColumnLeft: 'Add column left',\n            addColumnRight: 'Add column right',\n            addRowAbove: 'Add row above',\n            addRowBelow: 'Add row below',\n            alignment: 'Alignment',\n            alignmentButtons: {\n                justtifyLeft: 'Align left',\n                justifyCenter: 'Center',\n                justifyRight: 'Align right',\n                justifyFull: 'Justify',\n                alignTop: 'Align top',\n                alignMiddle: 'Align middle',\n                alignBottom: 'Align bottom'\n            },\n            backgroundColor: 'Background',\n            bold: 'Bold',\n            borders: 'Borders',\n            colorPicker: {\n                reset: 'Reset color',\n                customColor: 'Custom color...'\n            },\n            copy: 'Copy',\n            cut: 'Cut',\n            deleteColumn: 'Delete column',\n            deleteRow: 'Delete row',\n            filter: 'Filter',\n            fontFamily: 'Font',\n            fontSize: 'Font size',\n            format: 'Custom format...',\n            formatTypes: {\n                automatic: 'Automatic',\n                number: 'Number',\n                percent: 'Percent',\n                financial: 'Financial',\n                currency: 'Currency',\n                date: 'Date',\n                time: 'Time',\n                dateTime: 'Date time',\n                duration: 'Duration',\n                moreFormats: 'More formats...'\n            },\n            formatDecreaseDecimal: 'Decrease decimal',\n            formatIncreaseDecimal: 'Increase decimal',\n            freeze: 'Freeze panes',\n            freezeButtons: {\n                freezePanes: 'Freeze panes',\n                freezeRows: 'Freeze rows',\n                freezeColumns: 'Freeze columns',\n                unfreeze: 'Unfreeze panes'\n            },\n            italic: 'Italic',\n            merge: 'Merge cells',\n            mergeButtons: {\n                mergeCells: 'Merge all',\n                mergeHorizontally: 'Merge horizontally',\n                mergeVertically: 'Merge vertically',\n                unmerge: 'Unmerge'\n            },\n            open: 'Open...',\n            paste: 'Paste',\n            quickAccess: {\n                redo: 'Redo',\n                undo: 'Undo'\n            },\n            exportAs: 'Export...',\n            sortAsc: 'Sort ascending',\n            sortDesc: 'Sort descending',\n            sortButtons: {\n                sortSheetAsc: 'Sort sheet A to Z',\n                sortSheetDesc: 'Sort sheet Z to A',\n                sortRangeAsc: 'Sort range A to Z',\n                sortRangeDesc: 'Sort range Z to A'\n            },\n            textColor: 'Text Color',\n            textWrap: 'Wrap text',\n            underline: 'Underline',\n            validation: 'Data validation...'\n        };\n        var defaultTools = {\n            home: [\n                'open',\n                'exportAs',\n                [\n                    'cut',\n                    'copy',\n                    'paste'\n                ],\n                [\n                    'bold',\n                    'italic',\n                    'underline'\n                ],\n                'backgroundColor',\n                'textColor',\n                'borders',\n                'fontSize',\n                'fontFamily',\n                'alignment',\n                'textWrap',\n                [\n                    'formatDecreaseDecimal',\n                    'formatIncreaseDecimal'\n                ],\n                'format',\n                'merge',\n                'freeze',\n                'filter'\n            ],\n            insert: [\n                [\n                    'addColumnLeft',\n                    'addColumnRight',\n                    'addRowBelow',\n                    'addRowAbove'\n                ],\n                [\n                    'deleteColumn',\n                    'deleteRow'\n                ]\n            ],\n            data: [\n                'sort',\n                'filter',\n                'validation'\n            ]\n        };\n        var toolDefaults = {\n            open: {\n                type: 'open',\n                overflow: 'never',\n                iconClass: 'xlsa'\n            },\n            exportAs: {\n                type: 'exportAsDialog',\n                dialogName: 'exportAs',\n                overflow: 'never',\n                text: '',\n                iconClass: 'xlsa'\n            },\n            bold: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'bold',\n                value: true,\n                iconClass: 'bold',\n                togglable: true\n            },\n            italic: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'italic',\n                value: true,\n                iconClass: 'italic',\n                togglable: true\n            },\n            underline: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'underline',\n                value: true,\n                iconClass: 'underline',\n                togglable: true\n            },\n            formatDecreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: -1,\n                iconClass: 'decrease-decimal'\n            },\n            formatIncreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: +1,\n                iconClass: 'increase-decimal'\n            },\n            textWrap: {\n                type: 'button',\n                command: 'TextWrapCommand',\n                property: 'wrap',\n                value: true,\n                iconClass: 'text-wrap',\n                togglable: true\n            },\n            cut: {\n                type: 'button',\n                command: 'ToolbarCutCommand',\n                iconClass: 'cut'\n            },\n            copy: {\n                type: 'button',\n                command: 'ToolbarCopyCommand',\n                iconClass: 'copy'\n            },\n            paste: {\n                type: 'button',\n                command: 'ToolbarPasteCommand',\n                iconClass: 'paste'\n            },\n            separator: { type: 'separator' },\n            alignment: {\n                type: 'alignment',\n                iconClass: 'justify-left'\n            },\n            backgroundColor: {\n                type: 'colorPicker',\n                property: 'background',\n                iconClass: 'background'\n            },\n            textColor: {\n                type: 'colorPicker',\n                property: 'color',\n                iconClass: 'text'\n            },\n            fontFamily: {\n                type: 'fontFamily',\n                property: 'fontFamily',\n                iconClass: 'text'\n            },\n            fontSize: {\n                type: 'fontSize',\n                property: 'fontSize',\n                iconClass: 'font-size'\n            },\n            format: {\n                type: 'format',\n                property: 'format',\n                iconClass: 'format-number'\n            },\n            filter: {\n                type: 'filter',\n                property: 'hasFilter',\n                iconClass: 'filter'\n            },\n            merge: {\n                type: 'merge',\n                iconClass: 'merge-cells'\n            },\n            freeze: {\n                type: 'freeze',\n                iconClass: 'freeze-panes'\n            },\n            borders: {\n                type: 'borders',\n                iconClass: 'all-borders'\n            },\n            formatCells: {\n                type: 'dialog',\n                dialogName: 'formatCells',\n                overflow: 'never'\n            },\n            addColumnLeft: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'left',\n                iconClass: 'add-column-left'\n            },\n            addColumnRight: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'right',\n                iconClass: 'add-column-right'\n            },\n            addRowBelow: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'below',\n                iconClass: 'add-row-below'\n            },\n            addRowAbove: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'above',\n                iconClass: 'add-row-above'\n            },\n            deleteColumn: {\n                type: 'button',\n                command: 'DeleteColumnCommand',\n                iconClass: 'delete-column'\n            },\n            deleteRow: {\n                type: 'button',\n                command: 'DeleteRowCommand',\n                iconClass: 'delete-row'\n            },\n            sort: {\n                type: 'sort',\n                iconClass: 'sort-desc'\n            },\n            validation: {\n                type: 'dialog',\n                dialogName: 'validation',\n                iconClass: 'exception',\n                overflow: 'never'\n            }\n        };\n        var SpreadsheetToolBar = ToolBar.extend({\n            init: function (element, options) {\n                options.items = this._expandTools(options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName]);\n                ToolBar.fn.init.call(this, element, options);\n                var handleClick = this._click.bind(this);\n                this.element.addClass('k-spreadsheet-toolbar');\n                this._addSeparators(this.element);\n                this.bind({\n                    click: handleClick,\n                    toggle: handleClick\n                });\n            },\n            _addSeparators: function (element) {\n                var groups = element.children('.k-widget, a.k-button, .k-button-group');\n                groups.before('<span class=\\'k-separator\\' />');\n            },\n            _expandTools: function (tools) {\n                function expandTool(toolName) {\n                    var options = $.isPlainObject(toolName) ? toolName : toolDefaults[toolName] || {};\n                    var spriteCssClass = 'k-icon k-font-icon k-i-' + options.iconClass;\n                    var type = options.type;\n                    var typeDefaults = {\n                        splitButton: { spriteCssClass: spriteCssClass },\n                        button: { showText: 'overflow' },\n                        colorPicker: { toolIcon: spriteCssClass }\n                    };\n                    var tool = $.extend({\n                        name: options.name || toolName,\n                        text: MESSAGES[options.name || toolName],\n                        spriteCssClass: spriteCssClass,\n                        attributes: { title: MESSAGES[options.name || toolName] }\n                    }, typeDefaults[type], options);\n                    if (type == 'splitButton') {\n                        tool.menuButtons = tool.menuButtons.map(expandTool);\n                    }\n                    tool.attributes['data-tool'] = toolName;\n                    if (options.property) {\n                        tool.attributes['data-property'] = options.property;\n                    }\n                    return tool;\n                }\n                return tools.reduce(function (tools, tool) {\n                    if ($.isArray(tool)) {\n                        tools.push({\n                            type: 'buttonGroup',\n                            buttons: tool.map(expandTool)\n                        });\n                    } else {\n                        tools.push(expandTool.call(this, tool));\n                    }\n                    return tools;\n                }, []);\n            },\n            _click: function (e) {\n                var toolName = e.target.attr('data-tool');\n                var tool = toolDefaults[toolName] || {};\n                var commandType = tool.command;\n                if (!commandType) {\n                    return;\n                }\n                var args = {\n                    command: commandType,\n                    options: {\n                        property: tool.property || null,\n                        value: tool.value || null\n                    }\n                };\n                if (typeof args.options.value === 'boolean') {\n                    args.options.value = e.checked ? true : null;\n                }\n                this.action(args);\n            },\n            events: [\n                'click',\n                'toggle',\n                'open',\n                'close',\n                'overflowOpen',\n                'overflowClose',\n                'action',\n                'dialog'\n            ],\n            options: {\n                name: 'SpreadsheetToolBar',\n                resizable: true,\n                tools: defaultTools\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refresh: function (activeCell) {\n                var range = activeCell;\n                var tools = this._tools();\n                function setToggle(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    var togglable = toolbar && toolbar.options.togglable || overflow && overflow.options.togglable;\n                    if (!togglable) {\n                        return;\n                    }\n                    var toggle = false;\n                    if (typeof value === 'boolean') {\n                        toggle = value;\n                    } else if (typeof value === 'string') {\n                        toggle = toolbar.options.value === value;\n                    }\n                    toolbar.toggle(toggle);\n                    if (overflow) {\n                        overflow.toggle(toggle);\n                    }\n                }\n                function update(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    if (toolbar && toolbar.update) {\n                        toolbar.update(value);\n                    }\n                    if (overflow && overflow.update) {\n                        overflow.update(value);\n                    }\n                }\n                for (var i = 0; i < tools.length; i++) {\n                    var property = tools[i].property;\n                    var tool = tools[i].tool;\n                    var value = kendo.isFunction(range[property]) ? range[property]() : range;\n                    if (tool.type === 'button') {\n                        setToggle(tool, value);\n                    } else {\n                        update(tool, value);\n                    }\n                }\n            },\n            _tools: function () {\n                return this.element.find('[data-property]').toArray().reduce(function (tools, element) {\n                    element = $(element);\n                    var property = element.attr('data-property');\n                    tools.push({\n                        property: property,\n                        tool: this._getItem(element)\n                    });\n                    return tools;\n                }.bind(this), []);\n            },\n            destroy: function () {\n                this.element.find('[data-command],.k-button').each(function () {\n                    var element = $(this);\n                    var instance = element.data('instance');\n                    if (instance && instance.destroy) {\n                        instance.destroy();\n                    }\n                });\n                ToolBar.fn.destroy.call(this);\n            }\n        });\n        kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n        var DropDownTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var dropDownList = $('<select />').kendoDropDownList({ height: 'auto' }).data('kendoDropDownList');\n                this.dropDownList = dropDownList;\n                this.element = dropDownList.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                dropDownList.bind('open', this._open.bind(this));\n                dropDownList.bind('change', this._change.bind(this));\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n            },\n            _open: function () {\n                var ddl = this.dropDownList;\n                var list = ddl.list;\n                var listWidth;\n                list.css({\n                    whiteSpace: 'nowrap',\n                    width: 'auto'\n                });\n                listWidth = list.width();\n                if (listWidth) {\n                    listWidth += 20;\n                } else {\n                    listWidth = ddl._listWidth;\n                }\n                list.css('width', listWidth + kendo.support.scrollbar());\n                ddl._listWidth = listWidth;\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var value = instance.value();\n                var dataItem = instance.dataItem();\n                var popupName = dataItem ? dataItem.popup : undefined;\n                if (popupName) {\n                    this.toolbar.dialog({ name: popupName });\n                } else {\n                    this.toolbar.action({\n                        command: 'PropertyChangeCommand',\n                        options: {\n                            property: this.options.property,\n                            value: value == 'null' ? null : value\n                        }\n                    });\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.dropDownList.value(value);\n                } else {\n                    return this.dropDownList.value();\n                }\n            }\n        });\n        var PopupTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.element = $('<a href=\\'#\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'' + options.spriteCssClass + '\\'>' + '</span><span class=\\'k-icon k-i-arrow-s\\'></span>' + '</a>');\n                this.element.on('click', this.open.bind(this)).attr('data-command', options.command);\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this._popup();\n            },\n            destroy: function () {\n                this.popup.destroy();\n            },\n            open: function () {\n                this.popup.toggle();\n            },\n            _popup: function () {\n                var element = this.element;\n                this.popup = $('<div class=\\'k-spreadsheet-popup\\' />').appendTo(element).kendoPopup({ anchor: element }).data('kendoPopup');\n            }\n        });\n        kendo.toolbar.registerComponent('dialog', kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this._dialogName = options.dialogName;\n                this.element.bind('click', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        kendo.toolbar.registerComponent('exportAsDialog', kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this._dialogName = options.dialogName;\n                this.toolbar = toolbar;\n                this.element = $('<button class=\\'k-button k-button-icon\\' title=\\'' + options.attributes.title + '\\'>' + '<span class=\\'k-icon k-font-icon k-i-xls\\' />' + '</button>').data('instance', this);\n                this.element.bind('click', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        var OverflowDialogButton = kendo.toolbar.OverflowButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.OverflowButton.fn.init.call(this, options, toolbar);\n                this.element.on('click', this._click.bind(this));\n                this.message = this.options.text;\n                var instance = this.element.data('button');\n                this.element.data(this.options.type, instance);\n            },\n            _click: $.noop\n        });\n        var ColorPicker = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.popup.element.addClass('k-spreadsheet-colorpicker');\n                this.colorChooser = new kendo.spreadsheet.ColorChooser(this.popup.element, { change: this._colorChange.bind(this) });\n                this.element.attr({ 'data-property': options.property });\n                this.element.data({\n                    type: 'colorPicker',\n                    colorPicker: this,\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.colorChooser.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (value) {\n                this.value(value);\n            },\n            value: function (value) {\n                this.colorChooser.value(value);\n            },\n            _colorChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: e.sender.value()\n                    }\n                });\n                this.popup.close();\n            }\n        });\n        var ColorPickerButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                options.iconName = 'text';\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n            },\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'colorPicker',\n                    options: {\n                        title: this.options.property,\n                        property: this.options.property\n                    }\n                });\n            }\n        });\n        kendo.toolbar.registerComponent('colorPicker', ColorPicker, ColorPickerButton);\n        var FONT_SIZES = [\n            8,\n            9,\n            10,\n            11,\n            12,\n            13,\n            14,\n            16,\n            18,\n            20,\n            22,\n            24,\n            26,\n            28,\n            36,\n            48,\n            72\n        ];\n        var DEFAULT_FONT_SIZE = 12;\n        var FontSize = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var comboBox = $('<input />').kendoComboBox({\n                    change: this._valueChange.bind(this),\n                    dataSource: options.fontSizes || FONT_SIZES,\n                    value: DEFAULT_FONT_SIZE\n                }).data('kendoComboBox');\n                this.comboBox = comboBox;\n                this.element = comboBox.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n                this.element.data({\n                    type: 'fontSize',\n                    fontSize: this\n                });\n            },\n            _valueChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: kendo.parseInt(e.sender.value())\n                    }\n                });\n            },\n            update: function (value) {\n                this.value(kendo.parseInt(value) || DEFAULT_FONT_SIZE);\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.comboBox.value(value);\n                } else {\n                    return this.comboBox.value();\n                }\n            }\n        });\n        var FontSizeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontSize',\n                    options: {\n                        sizes: FONT_SIZES,\n                        defaultSize: DEFAULT_FONT_SIZE\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_SIZE;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontSize', FontSize, FontSizeButton);\n        var FONT_FAMILIES = [\n            'Arial',\n            'Courier New',\n            'Georgia',\n            'Times New Roman',\n            'Trebuchet MS',\n            'Verdana'\n        ];\n        var DEFAULT_FONT_FAMILY = 'Arial';\n        var FontFamily = DropDownTool.extend({\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.setDataSource(options.fontFamilies || FONT_FAMILIES);\n                ddl.value(DEFAULT_FONT_FAMILY);\n                this.element.data({\n                    type: 'fontFamily',\n                    fontFamily: this\n                });\n            },\n            update: function (value) {\n                this.value(value || DEFAULT_FONT_FAMILY);\n            }\n        });\n        var FontFamilyButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontFamily',\n                    options: {\n                        fonts: FONT_FAMILIES,\n                        defaultFont: DEFAULT_FONT_FAMILY\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_FAMILY;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontFamily', FontFamily, FontFamilyButton);\n        var defaultFormats = kendo.spreadsheet.formats = {\n            automatic: null,\n            number: '#,0.00',\n            percent: '0.00%',\n            financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n            currency: '$#,##0.00;[Red]$#,##0.00',\n            date: 'm/d/yyyy',\n            time: 'h:mm:ss AM/PM',\n            dateTime: 'm/d/yyyy h:mm',\n            duration: '[h]:mm:ss'\n        };\n        var Format = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    dataValueField: 'format',\n                    dataTextField: 'name',\n                    dataValuePrimitive: true,\n                    valueTemplate: '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>',\n                    template: '# if (data.sample) { #' + '<span class=\\'k-spreadsheet-sample\\'>#: data.sample #</span>' + '# } #' + '#: data.name #'\n                });\n                ddl.setDataSource([\n                    {\n                        format: defaultFormats.automatic,\n                        name: MESSAGES.formatTypes.automatic\n                    },\n                    {\n                        format: defaultFormats.number,\n                        name: MESSAGES.formatTypes.number,\n                        sample: '1,499.99'\n                    },\n                    {\n                        format: defaultFormats.percent,\n                        name: MESSAGES.formatTypes.percent,\n                        sample: '14.50%'\n                    },\n                    {\n                        format: defaultFormats.financial,\n                        name: MESSAGES.formatTypes.financial,\n                        sample: '(1,000.12)'\n                    },\n                    {\n                        format: defaultFormats.currency,\n                        name: MESSAGES.formatTypes.currency,\n                        sample: '$1,499.99'\n                    },\n                    {\n                        format: defaultFormats.date,\n                        name: MESSAGES.formatTypes.date,\n                        sample: '4/21/2012'\n                    },\n                    {\n                        format: defaultFormats.time,\n                        name: MESSAGES.formatTypes.time,\n                        sample: '5:49:00 PM'\n                    },\n                    {\n                        format: defaultFormats.dateTime,\n                        name: MESSAGES.formatTypes.dateTime,\n                        sample: '4/21/2012 5:49:00'\n                    },\n                    {\n                        format: defaultFormats.duration,\n                        name: MESSAGES.formatTypes.duration,\n                        sample: '168:05:00'\n                    },\n                    {\n                        popup: 'formatCells',\n                        name: MESSAGES.formatTypes.moreFormats\n                    }\n                ]);\n                this.element.data({\n                    type: 'format',\n                    format: this\n                });\n            }\n        });\n        var FormatButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'formatCells' });\n            }\n        });\n        kendo.toolbar.registerComponent('format', Format, FormatButton);\n        var BorderChangeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._borderPalette();\n                this.element.data({\n                    type: 'borders',\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.borderPalette.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            _borderPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this._action.bind(this) });\n            },\n            _action: function (e) {\n                this.toolbar.action({\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: e.type,\n                        style: {\n                            size: 1,\n                            color: e.color\n                        }\n                    }\n                });\n            }\n        });\n        var BorderChangeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'borders' });\n            }\n        });\n        kendo.toolbar.registerComponent('borders', BorderChangeTool, BorderChangeButton);\n        var AlignmentTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.element.attr({ 'data-property': 'alignment' });\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'alignment',\n                    alignment: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    property: 'textAlign',\n                    value: 'left',\n                    iconClass: 'justify-left',\n                    text: MESSAGES.alignmentButtons.justtifyLeft\n                },\n                {\n                    property: 'textAlign',\n                    value: 'center',\n                    iconClass: 'justify-center',\n                    text: MESSAGES.alignmentButtons.justifyCenter\n                },\n                {\n                    property: 'textAlign',\n                    value: 'right',\n                    iconClass: 'justify-right',\n                    text: MESSAGES.alignmentButtons.justifyRight\n                },\n                {\n                    property: 'textAlign',\n                    value: 'justify',\n                    iconClass: 'justify-full',\n                    text: MESSAGES.alignmentButtons.justifyFull\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'top',\n                    iconClass: 'align-top',\n                    text: MESSAGES.alignmentButtons.alignTop\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'center',\n                    iconClass: 'align-middle',\n                    text: MESSAGES.alignmentButtons.alignMiddle\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'bottom',\n                    iconClass: 'align-bottom',\n                    text: MESSAGES.alignmentButtons.alignBottom\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (range) {\n                var textAlign = range.textAlign();\n                var verticalAlign = range.verticalAlign();\n                this.popup.element.find('.k-button').removeClass('k-state-active');\n                if (textAlign) {\n                    this.popup.element.find('.k-button[data-value=' + textAlign + ']').addClass('k-state-active');\n                }\n                if (verticalAlign) {\n                    this.popup.element.find('.k-button[data-value=' + verticalAlign + ']').addClass('k-state-active');\n                }\n            },\n            _commandPalette: function () {\n                var buttons = this.buttons;\n                var element = $('<div />').appendTo(this.popup.element);\n                buttons.forEach(function (options, index) {\n                    var button = '<a title=\\'' + options.text + '\\' data-property=\\'' + options.property + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\'></span>' + '</a>';\n                    if (index !== 0 && buttons[index - 1].property !== options.property) {\n                        element.append($('<span class=\\'k-separator\\' />'));\n                    }\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var property = button.attr('data-property');\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: property,\n                        value: value\n                    }\n                });\n            }\n        });\n        var AlignmentButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'alignment' });\n            }\n        });\n        kendo.toolbar.registerComponent('alignment', AlignmentTool, AlignmentButton);\n        var MergeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'merge',\n                    merge: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    value: 'cells',\n                    iconClass: 'merge-cells',\n                    text: MESSAGES.mergeButtons.mergeCells\n                },\n                {\n                    value: 'horizontally',\n                    iconClass: 'merge-horizontally',\n                    text: MESSAGES.mergeButtons.mergeHorizontally\n                },\n                {\n                    value: 'vertically',\n                    iconClass: 'merge-vertically',\n                    text: MESSAGES.mergeButtons.mergeVertically\n                },\n                {\n                    value: 'unmerge',\n                    iconClass: 'normal-layout',\n                    text: MESSAGES.mergeButtons.unmerge\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'MergeCellCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var MergeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'merge' });\n            }\n        });\n        kendo.toolbar.registerComponent('merge', MergeTool, MergeButton);\n        var FreezeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'freeze',\n                    freeze: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    value: 'panes',\n                    iconClass: 'freeze-panes',\n                    text: MESSAGES.freezeButtons.freezePanes\n                },\n                {\n                    value: 'rows',\n                    iconClass: 'freeze-row',\n                    text: MESSAGES.freezeButtons.freezeRows\n                },\n                {\n                    value: 'columns',\n                    iconClass: 'freeze-col',\n                    text: MESSAGES.freezeButtons.freezeColumns\n                },\n                {\n                    value: 'unfreeze',\n                    iconClass: 'normal-layout',\n                    text: MESSAGES.freezeButtons.unfreeze\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'FreezePanesCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var FreezeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'freeze' });\n            }\n        });\n        kendo.toolbar.registerComponent('freeze', FreezeTool, FreezeButton);\n        var Sort = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    valueTemplate: '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>',\n                    template: '<span class=\\'k-icon k-font-icon k-i-#= iconClass #\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>#=text#',\n                    dataTextField: 'text',\n                    dataValueField: 'value'\n                });\n                ddl.setDataSource([\n                    {\n                        value: 'asc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeAsc,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        value: 'desc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeDesc,\n                        iconClass: 'sort-desc'\n                    }\n                ]);\n                ddl.select(0);\n                this.element.data({\n                    type: 'sort',\n                    sort: this\n                });\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var dataItem = instance.dataItem();\n                if (dataItem) {\n                    this.toolbar.action({\n                        command: 'SortCommand',\n                        options: {\n                            value: dataItem.value,\n                            sheet: dataItem.sheet\n                        }\n                    });\n                }\n            },\n            value: $.noop\n        });\n        var SortButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'sort' });\n            }\n        });\n        kendo.toolbar.registerComponent('sort', Sort, SortButton);\n        var Filter = kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                options.showText = 'overflow';\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this.element.on('click', this._click.bind(this));\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        var FilterButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        kendo.toolbar.registerComponent('filter', Filter, FilterButton);\n        var Open = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.toolbar = toolbar;\n                this.element = $('<div class=\\'k-button k-upload-button k-button-icon\\'>' + '<span class=\\'k-icon k-font-icon k-i-folder-open\\' />' + '</div>').data('instance', this);\n                $('<input type=\\'file\\' autocomplete=\\'off\\' accept=\\'.xlsx\\'/>').attr('title', options.attributes.title).bind('change', this._change.bind(this)).appendTo($('<form>').appendTo(this.element));\n            },\n            _change: function (e) {\n                this.toolbar.action({\n                    command: 'OpenCommand',\n                    options: { file: e.target.files[0] }\n                });\n                e.target.parentNode.reset();\n            }\n        });\n        kendo.toolbar.registerComponent('open', Open);\n        kendo.spreadsheet.TabStrip = kendo.ui.TabStrip.extend({\n            init: function (element, options) {\n                kendo.ui.TabStrip.fn.init.call(this, element, options);\n                element.addClass('k-spreadsheet-tabstrip');\n                this._quickAccessButtons();\n                this.quickAccessToolBar.on('click', '.k-button', function (e) {\n                    var action = $(e.currentTarget).attr('title').toLowerCase();\n                    this.trigger('action', { action: action });\n                }.bind(this));\n                this.toolbars = {};\n                var tabs = options.dataSource;\n                this.contentElements.each(function (idx, element) {\n                    this._toolbar($(element), tabs[idx].id, options.toolbarOptions[tabs[idx].id]);\n                }.bind(this));\n                this.one('activate', function () {\n                    this.toolbars[this.options.dataSource[0].id].resize();\n                });\n            },\n            events: kendo.ui.TabStrip.fn.events.concat([\n                'action',\n                'dialog'\n            ]),\n            destroy: function () {\n                this.quickAccessToolBar.off('click');\n                kendo.ui.TabStrip.fn.destroy.call(this);\n                for (var name in this.toolbars) {\n                    this.toolbars[name].destroy();\n                }\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refreshTools: function (range) {\n                var toolbars = this.toolbars;\n                for (var name in toolbars) {\n                    if (toolbars.hasOwnProperty(name)) {\n                        toolbars[name].refresh(range);\n                    }\n                }\n            },\n            _quickAccessButtons: function () {\n                var buttons = [\n                    {\n                        title: MESSAGES.quickAccess.undo,\n                        iconClass: 'undo-large',\n                        action: 'undo'\n                    },\n                    {\n                        title: MESSAGES.quickAccess.redo,\n                        iconClass: 'redo-large',\n                        action: 'redo'\n                    }\n                ];\n                var buttonTemplate = kendo.template('<a href=\\'\\\\#\\' title=\\'#= title #\\' data-action=\\'#= action #\\' class=\\'k-button k-button-icon\\'><span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span></a>');\n                this.quickAccessToolBar = $('<div />', {\n                    'class': 'k-spreadsheet-quick-access-toolbar',\n                    'html': kendo.render(buttonTemplate, buttons)\n                }).insertBefore(this.wrapper);\n                this.quickAccessToolBar.on('click', '.k-button', function (e) {\n                    var action = $(e.currentTarget).attr('title').toLowerCase();\n                    this.action({ action: action });\n                }.bind(this));\n                this.quickAccessAdjust();\n            },\n            quickAccessAdjust: function () {\n                this.tabGroup.css('padding-left', this.quickAccessToolBar.outerWidth());\n            },\n            _toolbar: function (container, name, tools) {\n                var element;\n                var options;\n                if (this.toolbars[name]) {\n                    this.toolbars[name].destroy();\n                    container.children('.k-toolbar').remove();\n                }\n                if (tools) {\n                    element = container.html('<div />').children('div');\n                    options = {\n                        tools: typeof tools === 'boolean' ? undefined : tools,\n                        toolbarName: name,\n                        action: this.action.bind(this),\n                        dialog: this.dialog.bind(this)\n                    };\n                    this.toolbars[name] = new kendo.spreadsheet.ToolBar(element, options);\n                }\n            }\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/dialogs', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.validator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ObservableObject = kendo.data.ObservableObject;\n        var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n            apply: 'Apply',\n            save: 'Save',\n            cancel: 'Cancel',\n            remove: 'Remove',\n            okText: 'OK',\n            formatCellsDialog: {\n                title: 'Format',\n                categories: {\n                    number: 'Number',\n                    currency: 'Currency',\n                    date: 'Date'\n                }\n            },\n            fontFamilyDialog: { title: 'Font' },\n            fontSizeDialog: { title: 'Font size' },\n            bordersDialog: { title: 'Borders' },\n            alignmentDialog: {\n                title: 'Alignment',\n                buttons: {\n                    justtifyLeft: 'Align left',\n                    justifyCenter: 'Center',\n                    justifyRight: 'Align right',\n                    justifyFull: 'Justify',\n                    alignTop: 'Align top',\n                    alignMiddle: 'Align middle',\n                    alignBottom: 'Align bottom'\n                }\n            },\n            mergeDialog: {\n                title: 'Merge cells',\n                buttons: {\n                    mergeCells: 'Merge all',\n                    mergeHorizontally: 'Merge horizontally',\n                    mergeVertically: 'Merge vertically',\n                    unmerge: 'Unmerge'\n                }\n            },\n            freezeDialog: {\n                title: 'Freeze panes',\n                buttons: {\n                    freezePanes: 'Freeze panes',\n                    freezeRows: 'Freeze rows',\n                    freezeColumns: 'Freeze columns',\n                    unfreeze: 'Unfreeze panes'\n                }\n            },\n            validationDialog: {\n                title: 'Data Validation',\n                hintMessage: 'Please enter a valid {0} value {1}.',\n                hintTitle: 'Validation {0}',\n                criteria: {\n                    any: 'Any value',\n                    number: 'Number',\n                    text: 'Text',\n                    date: 'Date',\n                    custom: 'Custom Formula',\n                    list: 'List'\n                },\n                comparers: {\n                    greaterThan: 'greater than',\n                    lessThan: 'less than',\n                    between: 'between',\n                    notBetween: 'not between',\n                    equalTo: 'equal to',\n                    notEqualTo: 'not equal to',\n                    greaterThanOrEqualTo: 'greater than or equal to',\n                    lessThanOrEqualTo: 'less than or equal to'\n                },\n                comparerMessages: {\n                    greaterThan: 'greater than {0}',\n                    lessThan: 'less than {0}',\n                    between: 'between {0} and {1}',\n                    notBetween: 'not between {0} and {1}',\n                    equalTo: 'equal to {0}',\n                    notEqualTo: 'not equal to {0}',\n                    greaterThanOrEqualTo: 'greater than or equal to {0}',\n                    lessThanOrEqualTo: 'less than or equal to {0}',\n                    custom: 'that satisfies the formula: {0}'\n                },\n                labels: {\n                    criteria: 'Criteria',\n                    comparer: 'Comparer',\n                    min: 'Min',\n                    max: 'Max',\n                    value: 'Value',\n                    start: 'Start',\n                    end: 'End',\n                    onInvalidData: 'On invalid data',\n                    rejectInput: 'Reject input',\n                    showWarning: 'Show warning',\n                    showHint: 'Show hint',\n                    hintTitle: 'Hint title',\n                    hintMessage: 'Hint message',\n                    ignoreBlank: 'Ignore blank'\n                },\n                placeholders: {\n                    typeTitle: 'Type title',\n                    typeMessage: 'Type message'\n                }\n            },\n            exportAsDialog: {\n                title: 'Export...',\n                labels: {\n                    scale: 'Scale',\n                    fit: 'Fit to page',\n                    fileName: 'File name',\n                    saveAsType: 'Save as type',\n                    exportArea: 'Export',\n                    paperSize: 'Paper size',\n                    margins: 'Margins',\n                    orientation: 'Orientation',\n                    print: 'Print',\n                    guidelines: 'Guidelines',\n                    center: 'Center',\n                    horizontally: 'Horizontally',\n                    vertically: 'Vertically'\n                }\n            },\n            modifyMergedDialog: { errorMessage: 'Cannot change part of a merged cell.' },\n            useKeyboardDialog: {\n                title: 'Copying and pasting',\n                errorMessage: 'These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:',\n                labels: {\n                    forCopy: 'for copy',\n                    forCut: 'for cut',\n                    forPaste: 'for paste'\n                }\n            },\n            unsupportedSelectionDialog: { errorMessage: 'That action cannot be performed on multiple selection.' }\n        };\n        var registry = {};\n        kendo.spreadsheet.dialogs = {\n            register: function (name, dialogClass) {\n                registry[name] = dialogClass;\n            },\n            create: function (name, options) {\n                var dialogClass = registry[name];\n                if (dialogClass) {\n                    return new dialogClass(options);\n                }\n            }\n        };\n        var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.options = $.extend(true, {}, this.options, options);\n                this.bind(this.events, options);\n            },\n            events: [\n                'close',\n                'activate'\n            ],\n            dialog: function () {\n                if (!this._dialog) {\n                    this._dialog = $('<div class=\\'k-spreadsheet-window k-action-window\\' />').addClass(this.options.className || '').append(this.options.template).appendTo(document.body).kendoWindow({\n                        scrollable: false,\n                        resizable: false,\n                        maximizable: false,\n                        modal: true,\n                        visible: false,\n                        width: this.options.width || 320,\n                        title: this.options.title,\n                        open: function () {\n                            this.center();\n                        },\n                        close: this._onDialogClose.bind(this),\n                        activate: this._onDialogActivate.bind(this),\n                        deactivate: this._onDialogDeactivate.bind(this)\n                    }).data('kendoWindow');\n                }\n                return this._dialog;\n            },\n            _onDialogClose: function () {\n                this.trigger('close');\n            },\n            _onDialogActivate: function () {\n                this.trigger('activate');\n            },\n            _onDialogDeactivate: function () {\n                this.trigger('deactivate');\n                this.destroy();\n            },\n            destroy: function () {\n                if (this._dialog) {\n                    this._dialog.destroy();\n                    this._dialog = null;\n                }\n            },\n            open: function () {\n                this.dialog().open();\n            },\n            apply: function () {\n                this.close();\n            },\n            close: function () {\n                this.dialog().close();\n            }\n        });\n        function formattedValue(value, format) {\n            return kendo.spreadsheet.formatting.text(value, format);\n        }\n        var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.useCategory(this.category);\n            },\n            useCategory: function (category) {\n                var type = category && category.type || 'number';\n                var formatCurrency = type == 'currency';\n                this.category = category;\n                this.set('showCurrencyFilter', formatCurrency && this.currencies.length > 1);\n                if (!formatCurrency) {\n                    this.set('formats', this.allFormats[type + 'Formats']);\n                } else {\n                    this.currency(this.currencies[0]);\n                }\n                this.useFirstFormat();\n            },\n            useFirstFormat: function () {\n                if (this.formats.length) {\n                    this.set('format', this.formats[0].value);\n                }\n            },\n            currency: function (currency) {\n                if (currency !== undefined) {\n                    this._currency = currency;\n                    var info = currency.value;\n                    var formats = [\n                        {\n                            currency: info,\n                            decimals: true\n                        },\n                        {\n                            currency: info,\n                            decimals: true,\n                            iso: true\n                        },\n                        {\n                            currency: info,\n                            decimals: false\n                        }\n                    ];\n                    formats = formats.map(function (format) {\n                        format = FormatCellsViewModel.convert.currency(format);\n                        return {\n                            value: format,\n                            name: formattedValue(1000, format)\n                        };\n                    });\n                    this.set('formats', formats);\n                    this.useFirstFormat();\n                }\n                return this._currency || this.currencies[0];\n            },\n            categoryFilter: function (category) {\n                if (category !== undefined) {\n                    this.useCategory(category);\n                }\n                return this.category;\n            },\n            preview: function () {\n                var format = this.get('format');\n                var value = this.value || 0;\n                if (format && format.length) {\n                    return formattedValue(value, format);\n                } else {\n                    return value;\n                }\n            }\n        });\n        FormatCellsViewModel.convert = {\n            currency: function (options) {\n                function repeat(token, n) {\n                    return new Array(n + 1).join(token);\n                }\n                var info = options.currency;\n                var format = info.pattern[1];\n                if (options.decimals) {\n                    format = format.replace(/n/g, 'n' + info['.'] + repeat('0', info.decimals));\n                }\n                if (options.iso) {\n                    format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, '');\n                } else {\n                    format = format.replace(/\\$/g, info.symbol);\n                }\n                format = format.replace(/n/g, '?');\n                return format;\n            },\n            date: function (format) {\n                if (/T|Z/.test(format)) {\n                    return '';\n                }\n                return format.toLowerCase().replace(/tt/g, 'AM/PM').replace(/'/g, '\"');\n            }\n        };\n        function uniqueBy(field, array) {\n            var result = [];\n            var values = [];\n            for (var i = 0; i < array.length; i++) {\n                if ($.inArray(array[i][field], values) == -1) {\n                    result.push(array[i]);\n                    values.push(array[i][field]);\n                }\n            }\n            return result;\n        }\n        var FormatCellsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this._generateFormats();\n            },\n            options: {\n                title: MESSAGES.formatCellsDialog.title,\n                className: 'k-spreadsheet-format-cells',\n                categories: [\n                    {\n                        type: 'number',\n                        name: MESSAGES.formatCellsDialog.categories.number\n                    },\n                    {\n                        type: 'currency',\n                        name: MESSAGES.formatCellsDialog.categories.currency\n                    },\n                    {\n                        type: 'date',\n                        name: MESSAGES.formatCellsDialog.categories.date\n                    }\n                ],\n                template: '<div class=\\'k-root-tabs\\' data-role=\\'tabstrip\\' ' + 'data-text-field=\\'name\\' ' + 'data-bind=\\'source: categories, value: categoryFilter\\' ' + 'data-animation=\\'false\\' />' + '<div class=\\'k-spreadsheet-preview\\' data-bind=\\'text: preview\\' />' + '<script type=\\'text/x-kendo-template\\' id=\\'format-item-template\\'>' + '#: data.name #' + '</script>' + '<select data-role=\\'dropdownlist\\' class=\\'k-format-filter\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'value.name\\' ' + 'data-bind=\\'visible: showCurrencyFilter, value: currency, source: currencies\\' />' + '<ul data-role=\\'staticlist\\' tabindex=\\'0\\' ' + 'class=\\'k-list k-reset\\' ' + 'data-template=\\'format-item-template\\' ' + 'data-value-primitive=\\'true\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'source: formats, value: format\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + MESSAGES.apply + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + MESSAGES.cancel + '</button>' + '</div>'\n            },\n            _generateFormats: function () {\n                var options = this.options;\n                if (!options.currencies) {\n                    options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n                }\n                if (!options.numberFormats) {\n                    options.numberFormats = [\n                        {\n                            value: '#.00%',\n                            name: '100.00%'\n                        },\n                        {\n                            value: '#%',\n                            name: '100%'\n                        },\n                        {\n                            value: '#.00',\n                            name: '1024.00'\n                        },\n                        {\n                            value: '#,###.00',\n                            name: '1,024.00'\n                        }\n                    ];\n                }\n                if (!options.dateFormats) {\n                    var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n                    options.dateFormats = uniqueBy('value', $.map(calendarPatterns, function (format) {\n                        format = FormatCellsViewModel.convert.date(format);\n                        if (!format) {\n                            return;\n                        }\n                        return {\n                            value: format,\n                            name: formattedValue(34567.7678, format)\n                        };\n                    }));\n                }\n            },\n            open: function (range) {\n                var options = this.options;\n                var value = range.value();\n                var categories = options.categories.slice(0);\n                var element;\n                this.viewModel = new FormatCellsViewModel({\n                    currencies: options.currencies.slice(0),\n                    allFormats: {\n                        numberFormats: options.numberFormats.slice(0),\n                        dateFormats: options.dateFormats.slice(0)\n                    },\n                    categories: categories,\n                    format: range.format(),\n                    category: value instanceof Date ? categories[2] : categories[0],\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    value: value\n                });\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                kendo.bind(element, this.viewModel);\n                var currencyFilter = element.find('select.k-format-filter').data('kendoDropDownList');\n                if (options.currencies.length > 10) {\n                    currencyFilter.setOptions({ filter: 'contains' });\n                }\n                element.find(kendo.roleSelector('staticlist')).parent().addClass('k-list-wrapper');\n            },\n            apply: function () {\n                var format = this.viewModel.format;\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'format',\n                        value: format\n                    }\n                });\n            }\n        });\n        FormatCellsDialog.currenciesFrom = function (cultures) {\n            return uniqueBy('description', $.map(cultures, function (culture, name) {\n                if (!/-/.test(name)) {\n                    return;\n                }\n                var currency = culture.numberFormat.currency;\n                var description = kendo.format('{0} ({1}, {2})', currency.name, currency.abbr, currency.symbol);\n                return {\n                    description: description,\n                    value: currency\n                };\n            }));\n        };\n        kendo.spreadsheet.dialogs.register('formatCells', FormatCellsDialog);\n        kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n        var MessageDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close, text: okText\\' />' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                kendo.bind(this.dialog().element, {\n                    text: this.options.text,\n                    okText: MESSAGES.okText,\n                    close: this.close.bind(this)\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('message', MessageDialog);\n        var FontFamilyDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this._list();\n            },\n            options: {\n                title: MESSAGES.fontFamilyDialog.title,\n                template: '<ul class=\\'k-list k-reset\\'></ul>'\n            },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var fonts = this.options.fonts;\n                var defaultFont = this.options.defaultFont;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: fonts }),\n                    template: '#:data#',\n                    value: defaultFont,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontFamily',\n                        value: e.sender.value()[0]\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontFamily', FontFamilyDialog);\n        var FontSizeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this._list();\n            },\n            options: {\n                title: MESSAGES.fontSizeDialog.title,\n                template: '<ul class=\\'k-list k-reset\\'></ul>'\n            },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var sizes = this.options.sizes;\n                var defaultSize = this.options.defaultSize;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: sizes }),\n                    template: '#:data#',\n                    value: defaultSize,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontSize',\n                        value: kendo.parseInt(e.sender.value()[0])\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontSize', FontSizeDialog);\n        var BordersDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this.element = this.dialog().element;\n                this._borderPalette();\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: {\n                title: MESSAGES.bordersDialog.title,\n                width: 177,\n                template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + MESSAGES.apply + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + MESSAGES.cancel + '</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                var state = this.value();\n                this.trigger('action', {\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: state.type,\n                        style: {\n                            size: 1,\n                            color: state.color\n                        }\n                    }\n                });\n            },\n            _borderPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this.value.bind(this) });\n            },\n            value: function (state) {\n                if (state === undefined) {\n                    return this._state;\n                } else {\n                    this._state = state;\n                }\n            }\n        });\n        kendo.spreadsheet.dialogs.register('borders', BordersDialog);\n        var ColorChooser = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this.element = this.dialog().element;\n                this.property = options.property;\n                this.options.title = options.title;\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: { template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + MESSAGES.apply + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + MESSAGES.cancel + '</button>' + '</div>' },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.property,\n                        value: this.value()\n                    }\n                });\n            },\n            value: function (e) {\n                if (e === undefined) {\n                    return this._value;\n                } else {\n                    this._value = e.value;\n                }\n            }\n        });\n        var ColorPickerDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 177;\n                ColorChooser.fn.init.call(this, options);\n                this._colorPalette();\n            },\n            _colorPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPalette = element.kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    change: this.value.bind(this)\n                }).data('kendoColorPalette');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('colorPicker', ColorPickerDialog);\n        var CustomColorDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 268;\n                ColorChooser.fn.init.call(this, options);\n                this.dialog().setOptions({ animation: false });\n                this.dialog().one('activate', this._colorPicker.bind(this));\n            },\n            _colorPicker: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPicker = element.kendoFlatColorPicker({ change: this.value.bind(this) }).data('kendoFlatColorPicker');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('customColor', CustomColorDialog);\n        var AlignmentDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this._list();\n            },\n            options: {\n                title: 'Alignment',\n                template: '<ul class=\\'k-list k-reset\\'></ul>',\n                buttons: [\n                    {\n                        property: 'textAlign',\n                        value: 'left',\n                        iconClass: 'justify-left',\n                        text: MESSAGES.alignmentDialog.buttons.justtifyLeft\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'center',\n                        iconClass: 'justify-center',\n                        text: MESSAGES.alignmentDialog.buttons.justifyCenter\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'right',\n                        iconClass: 'justify-right',\n                        text: MESSAGES.alignmentDialog.buttons.justifyRight\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'justify',\n                        iconClass: 'justify-full',\n                        text: MESSAGES.alignmentDialog.buttons.justifyFull\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'top',\n                        iconClass: 'align-top',\n                        text: MESSAGES.alignmentDialog.buttons.alignTop\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'center',\n                        iconClass: 'align-middle',\n                        text: MESSAGES.alignmentDialog.buttons.alignMiddle\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'bottom',\n                        iconClass: 'align-bottom',\n                        text: MESSAGES.alignmentDialog.buttons.alignBottom\n                    }\n                ]\n            },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-property=\\'#=property#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>' + '#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: dataItem.property,\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('alignment', AlignmentDialog);\n        var MergeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this._list();\n            },\n            options: {\n                title: MESSAGES.mergeDialog.title,\n                template: '<ul class=\\'k-list k-reset\\'></ul>',\n                buttons: [\n                    {\n                        value: 'cells',\n                        iconClass: 'merge-cells',\n                        text: MESSAGES.mergeDialog.buttons.mergeCells\n                    },\n                    {\n                        value: 'horizontally',\n                        iconClass: 'merge-horizontally',\n                        text: MESSAGES.mergeDialog.buttons.mergeHorizontally\n                    },\n                    {\n                        value: 'vertically',\n                        iconClass: 'merge-vertically',\n                        text: MESSAGES.mergeDialog.buttons.mergeVertically\n                    },\n                    {\n                        value: 'unmerge',\n                        iconClass: 'normal-layout',\n                        text: MESSAGES.mergeDialog.buttons.unmerge\n                    }\n                ]\n            },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'MergeCellCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('merge', MergeDialog);\n        var FreezeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this._list();\n            },\n            options: {\n                title: MESSAGES.freezeDialog.title,\n                template: '<ul class=\\'k-list k-reset\\'></ul>',\n                buttons: [\n                    {\n                        value: 'panes',\n                        iconClass: 'freeze-panes',\n                        text: MESSAGES.freezeDialog.buttons.freezePanes\n                    },\n                    {\n                        value: 'rows',\n                        iconClass: 'freeze-row',\n                        text: MESSAGES.freezeDialog.buttons.freezeRows\n                    },\n                    {\n                        value: 'columns',\n                        iconClass: 'freeze-col',\n                        text: MESSAGES.freezeDialog.buttons.freezeColumns\n                    },\n                    {\n                        value: 'unfreeze',\n                        iconClass: 'normal-layout',\n                        text: MESSAGES.freezeDialog.buttons.unfreeze\n                    }\n                ]\n            },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'FreezePanesCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('freeze', FreezeDialog);\n        var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.bind('change', function (e) {\n                    if (e.field === 'criterion') {\n                        this.reset();\n                        if (this.criterion === 'custom' || this.criterion === 'list') {\n                            this.setHintMessageTemplate();\n                        }\n                    }\n                    if (e.field === 'comparer') {\n                        this.setHintMessageTemplate();\n                    }\n                    if ((e.field == 'hintMessage' || e.field == 'hintTitle') && !this._mute) {\n                        this.shouldBuild = false;\n                    }\n                    if ((e.field == 'from' || e.field == 'to' || e.field == 'hintMessageTemplate' || e.field == 'type') && this.shouldBuild) {\n                        this.buildMessages();\n                    }\n                }.bind(this));\n                this.reset();\n            },\n            buildMessages: function () {\n                this._mute = true;\n                this.set('hintTitle', this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : '');\n                this.set('hintMessage', this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : '');\n                this._mute = false;\n            },\n            reset: function () {\n                this.setComparers();\n                this.set('comparer', this.comparers[0].type);\n                this.set('from', null);\n                this.set('to', null);\n                this.set('useCustomMessages', false);\n                this.shouldBuild = true;\n                this.hintTitleTemplate = this.defaultHintTitle;\n                this.buildMessages();\n            },\n            setComparers: function () {\n                var all = this.defaultComparers;\n                var comparers = [];\n                if (this.criterion === 'text') {\n                    var text_comparers = [\n                        'equalTo',\n                        'notEqualTo'\n                    ];\n                    for (var idx = 0; idx < all.length; idx++) {\n                        if (text_comparers[0] == all[idx].type) {\n                            comparers.push(all[idx]);\n                            text_comparers.shift();\n                        }\n                    }\n                } else {\n                    comparers = all.slice();\n                }\n                this.set('comparers', comparers);\n            },\n            setHintMessageTemplate: function () {\n                if (this.criterion !== 'custom' && this.criterion !== 'list') {\n                    this.set('hintMessageTemplate', kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n                } else {\n                    this.set('hintMessageTemplate', '');\n                    this.set('hintMessage', '');\n                }\n            },\n            isAny: function () {\n                return this.get('criterion') === 'any';\n            },\n            isNumber: function () {\n                return this.get('criterion') === 'number';\n            },\n            showToForNumber: function () {\n                return this.showTo() && this.isNumber();\n            },\n            showToForDate: function () {\n                return this.showTo() && this.isDate();\n            },\n            isText: function () {\n                return this.get('criterion') === 'text';\n            },\n            isDate: function () {\n                return this.get('criterion') === 'date';\n            },\n            isList: function () {\n                return this.get('criterion') === 'list';\n            },\n            isCustom: function () {\n                return this.get('criterion') === 'custom';\n            },\n            showRemove: function () {\n                return this.get('hasValidation');\n            },\n            showTo: function () {\n                return this.get('comparer') == 'between' || this.get('comparer') == 'notBetween';\n            },\n            update: function (validation) {\n                this.set('hasValidation', !!validation);\n                if (validation) {\n                    this.fromValidationObject(validation);\n                }\n            },\n            fromValidationObject: function (validation) {\n                this.set('criterion', validation.dataType);\n                this.set('comparer', validation.comparerType);\n                this.set('from', validation.from);\n                this.set('to', validation.to);\n                this.set('type', validation.type);\n                this.set('ignoreBlank', validation.allowNulls);\n                if (validation.messageTemplate || validation.titleTemplate) {\n                    this.hintMessageTemplate = validation.messageTemplate;\n                    this.hintMessage = validation.messageTemplate;\n                    this.hintTitleTemplate = validation.titleTemplate;\n                    this.hintTitle = validation.titleTemplate;\n                    this.useCustomMessages = true;\n                    this.buildMessages();\n                } else {\n                    this.useCustomMessages = false;\n                }\n            },\n            toValidationObject: function () {\n                if (this.criterion === 'any') {\n                    return null;\n                }\n                var options = {\n                    type: this.type,\n                    dataType: this.criterion,\n                    comparerType: this.comparer,\n                    from: this.from,\n                    to: this.to,\n                    allowNulls: this.ignoreBlank\n                };\n                if (this.useCustomMessages) {\n                    options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                    options.titleTemplate = this.hintTitle;\n                }\n                return options;\n            }\n        });\n        var ValidationDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n            },\n            options: {\n                width: 420,\n                title: MESSAGES.validationDialog.title,\n                criterion: 'any',\n                type: 'reject',\n                ignoreBlank: true,\n                hintMessage: MESSAGES.validationDialog.hintMessage,\n                hintTitle: MESSAGES.validationDialog.hintTitle,\n                useCustomMessages: false,\n                criteria: [\n                    {\n                        type: 'any',\n                        name: 'Any value'\n                    },\n                    {\n                        type: 'number',\n                        name: 'Number'\n                    },\n                    {\n                        type: 'text',\n                        name: 'Text'\n                    },\n                    {\n                        type: 'date',\n                        name: 'Date'\n                    },\n                    {\n                        type: 'custom',\n                        name: 'Custom Formula'\n                    },\n                    {\n                        type: 'list',\n                        name: 'List'\n                    }\n                ],\n                comparers: [\n                    {\n                        type: 'greaterThan',\n                        name: MESSAGES.validationDialog.comparers.greaterThan\n                    },\n                    {\n                        type: 'lessThan',\n                        name: MESSAGES.validationDialog.comparers.lessThan\n                    },\n                    {\n                        type: 'between',\n                        name: MESSAGES.validationDialog.comparers.between\n                    },\n                    {\n                        type: 'notBetween',\n                        name: MESSAGES.validationDialog.comparers.notBetween\n                    },\n                    {\n                        type: 'equalTo',\n                        name: MESSAGES.validationDialog.comparers.equalTo\n                    },\n                    {\n                        type: 'notEqualTo',\n                        name: MESSAGES.validationDialog.comparers.notEqualTo\n                    },\n                    {\n                        type: 'greaterThanOrEqualTo',\n                        name: MESSAGES.validationDialog.comparers.greaterThanOrEqualTo\n                    },\n                    {\n                        type: 'lessThanOrEqualTo',\n                        name: MESSAGES.validationDialog.comparers.lessThanOrEqualTo\n                    }\n                ],\n                comparerMessages: MESSAGES.validationDialog.comparerMessages,\n                errorTemplate: '<div class=\"k-widget k-tooltip k-tooltip-validation\" style=\"margin:0.5em\"><span class=\"k-icon k-warning\"> </span>' + '#=message#<div class=\"k-callout k-callout-n\"></div></div>',\n                template: '<div class=\"k-edit-form-container\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.criteria + ':</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: criterion, source: criteria\" />' + '</div>' + '<div data-bind=\"visible: isNumber\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.comparer + ':</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.min + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"' + MESSAGES.validationDialog.labels.min + '\" placeholder=\"e.g. 10\" class=\"k-textbox\" data-bind=\"value: from, enabled: isNumber\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.max + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"' + MESSAGES.validationDialog.labels.max + '\" placeholder=\"e.g. 100\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForNumber\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isText\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.comparer + ':</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.value + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"' + MESSAGES.validationDialog.labels.value + '\" class=\"k-textbox\" data-bind=\"value: from, enabled: isText\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isDate\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.comparer + ':</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.start + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"' + MESSAGES.validationDialog.labels.start + '\" class=\"k-textbox\" data-bind=\"value: from, enabled: isDate\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.end + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"' + MESSAGES.validationDialog.labels.end + '\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForDate\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isCustom\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.value + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"' + MESSAGES.validationDialog.labels.value + '\" class=\"k-textbox\" data-bind=\"value: from, enabled: isCustom\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isList\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.value + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"' + MESSAGES.validationDialog.labels.value + '\" class=\"k-textbox\" data-bind=\"value: from, enabled: isList\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.ignoreBlank + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox\" data-bind=\"checked: ignoreBlank\"/>' + '<label class=\"k-checkbox-label\" for=\"ignoreBlank\"></label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-action-buttons\"></div>' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.onInvalidData + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"radio\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeReject\" class=\"k-radio-label\">' + MESSAGES.validationDialog.labels.rejectInput + '</label> ' + '<input type=\"radio\" id=\"validationTypeWarning\" name=\"validationType\" value=\"warning\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeWarning\" class=\"k-radio-label\">' + MESSAGES.validationDialog.labels.showWarning + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.showHint + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox\" data-bind=\"checked: useCustomMessages\" />' + '<label class=\"k-checkbox-label\" for=\"useCustomMessages\"></label>' + '</div>' + '<div data-bind=\"visible: useCustomMessages\">' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.hintTitle + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" placeholder=\"' + MESSAGES.validationDialog.placeholders.typeTitle + '\" data-bind=\"value: hintTitle\" />' + '</div>' + '<div class=\"k-edit-label\"><label>' + MESSAGES.validationDialog.labels.hintMessage + ':</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" placeholder=\"' + MESSAGES.validationDialog.placeholders.typeMessage + '\" data-bind=\"value: hintMessage\" />' + '</div>' + '</div>' + '</div>' + '<div class=\"k-action-buttons\">' + '<button class=\"k-button\" data-bind=\"visible: showRemove, click: remove\">' + MESSAGES.remove + '</button>' + '<button class=\"k-button k-primary\" data-bind=\"click: apply\">' + MESSAGES.apply + '</button>' + '<button class=\"k-button\" data-bind=\"click: close\">' + MESSAGES.cancel + '</button>' + '</div>' + '</div>'\n            },\n            open: function (range) {\n                var options = this.options;\n                var element;\n                this.viewModel = new ValidationViewModel({\n                    type: options.type,\n                    defaultHintMessage: options.hintMessage,\n                    defaultHintTitle: options.hintTitle,\n                    defaultComparers: options.comparers.slice(0),\n                    comparerMessages: options.comparerMessages,\n                    criteria: options.criteria.slice(0),\n                    criterion: options.criterion,\n                    ignoreBlank: options.ignoreBlank,\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    remove: this.remove.bind(this)\n                });\n                this.viewModel.update(range.validation());\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                if (this.validatable) {\n                    this.validatable.destroy();\n                }\n                kendo.bind(element, this.viewModel);\n                this.validatable = new kendo.ui.Validator(element.find('.k-edit-form-container'), {\n                    validateOnBlur: false,\n                    errorTemplate: this.options.errorTemplate || undefined\n                });\n            },\n            apply: function () {\n                if (this.validatable.validate()) {\n                    SpreadsheetDialog.fn.apply.call(this);\n                    this.trigger('action', {\n                        command: 'EditValidationCommand',\n                        options: { value: this.viewModel.toValidationObject() }\n                    });\n                }\n            },\n            remove: function () {\n                this.viewModel.set('criterion', 'any');\n                this.apply();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validation', ValidationDialog);\n        kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n        var ExportAsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this.viewModel = kendo.observable({\n                    title: this.options.title,\n                    name: this.options.name,\n                    extension: this.options.extension,\n                    fileFormats: this.options.fileFormats,\n                    excel: options.excelExport,\n                    pdf: {\n                        proxyURL: options.pdfExport.proxyURL,\n                        forceProxy: options.pdfExport.forceProxy,\n                        title: options.pdfExport.title,\n                        author: options.pdfExport.author,\n                        subject: options.pdfExport.subject,\n                        keywords: options.pdfExport.keywords,\n                        creator: options.pdfExport.creator,\n                        date: options.pdfExport.date,\n                        fitWidth: this.options.pdf.fitWidth,\n                        area: this.options.pdf.area,\n                        areas: this.options.pdf.areas,\n                        paperSize: this.options.pdf.paperSize,\n                        paperSizes: this.options.pdf.paperSizes,\n                        margin: this.options.pdf.margin,\n                        margins: this.options.pdf.margins,\n                        landscape: this.options.pdf.landscape,\n                        guidelines: this.options.pdf.guidelines,\n                        hCenter: this.options.pdf.hCenter,\n                        vCenter: this.options.pdf.vCenter\n                    },\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                this.viewModel.bind('change', function (e) {\n                    if (e.field === 'extension') {\n                        this.set('showPdfOptions', this.extension === '.pdf' ? true : false);\n                    }\n                });\n                kendo.bind(this.dialog().element, this.viewModel);\n            },\n            options: {\n                title: MESSAGES.exportAsDialog.title,\n                name: 'Workbook',\n                extension: '.xlsx',\n                fileFormats: [\n                    {\n                        description: 'Excel Workbook (.xlsx)',\n                        extension: '.xlsx'\n                    },\n                    {\n                        description: 'Portable Document Format(.pdf)',\n                        extension: '.pdf'\n                    }\n                ],\n                pdf: {\n                    fitWidth: true,\n                    area: 'workbook',\n                    areas: [\n                        {\n                            area: 'workbook',\n                            text: 'Entire Workbook'\n                        },\n                        {\n                            area: 'sheet',\n                            text: 'Active Sheet'\n                        },\n                        {\n                            area: 'selection',\n                            text: 'Selection'\n                        }\n                    ],\n                    paperSize: 'a4',\n                    paperSizes: [\n                        {\n                            value: 'a2',\n                            text: 'A2 (420 mm \\xD7 594 mm)     '\n                        },\n                        {\n                            value: 'a3',\n                            text: 'A3 (297 mm x 420 mm)     '\n                        },\n                        {\n                            value: 'a4',\n                            text: 'A4 (210 mm x 297 mm)     '\n                        },\n                        {\n                            value: 'a5',\n                            text: 'A5 (148 mm x 210 mm)     '\n                        },\n                        {\n                            value: 'b3',\n                            text: 'B3 (353 mm \\xD7 500 mm)     '\n                        },\n                        {\n                            value: 'b4',\n                            text: 'B4 (250 mm x 353 mm)     '\n                        },\n                        {\n                            value: 'b5',\n                            text: 'B5 (176 mm x 250 mm)     '\n                        },\n                        {\n                            value: 'folio',\n                            text: 'Folio (8.5\" x 13\")       '\n                        },\n                        {\n                            value: 'legal',\n                            text: 'Legal (8.5\" x 14\")       '\n                        },\n                        {\n                            value: 'letter',\n                            text: 'Letter (8.5\" x 11\")      '\n                        },\n                        {\n                            value: 'tabloid',\n                            text: 'Tabloid (11\" x 17\")      '\n                        },\n                        {\n                            value: 'executive',\n                            text: 'Executive (7.25\" x 10.5\")'\n                        }\n                    ],\n                    margin: {\n                        bottom: '0.75in',\n                        left: '0.7in',\n                        right: '0.7in',\n                        top: '0.75in'\n                    },\n                    margins: [\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.7in',\n                                right: '0.7in',\n                                top: '0.75in'\n                            },\n                            text: 'Normal'\n                        },\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.25in',\n                                right: '0.25in',\n                                top: '0.75in'\n                            },\n                            text: 'Narrow'\n                        },\n                        {\n                            value: {\n                                bottom: '1in',\n                                left: '1in',\n                                right: '1in',\n                                top: '1in'\n                            },\n                            text: 'Wide'\n                        }\n                    ],\n                    landscape: true,\n                    guidelines: true,\n                    hCenter: true,\n                    vCenter: true\n                },\n                width: 520,\n                template: '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.fileName + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-textbox\\' data-bind=\\'value: name\\' />' + '</div>' + '<div >' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.saveAsType + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'extension\\' ' + 'data-bind=\\'value: extension, source: fileFormats\\' />' + '</div>' + '</div>' + '<div class=\\'export-config\\' data-bind=\\'visible: showPdfOptions\\'>' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.exportArea + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'area\\' ' + 'data-bind=\\'value: pdf.area, source: pdf.areas\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.paperSize + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.paperSize, source: pdf.paperSizes\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.margins + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-value-primitive=\\'true\\'' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.margin, source: pdf.margins\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.orientation + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input type=\\'radio\\' id=\\'k-orientation-portrait\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'false\\' /><label class=\\'k-orientation-label k-orientation-portrait-label\\' for=\\'k-orientation-portrait\\'></label>' + '<input type=\\'radio\\' id=\\'k-orientation-landscape\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'true\\' /><label class=\\'k-orientation-label k-orientation-landscape-label\\' for=\\'k-orientation-landscape\\'></label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.print + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'guidelines\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.guidelines\\'/><label class=\\'k-checkbox-label\\' for=\\'guidelines\\'>' + MESSAGES.exportAsDialog.labels.guidelines + '</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.scale + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'fitWidth\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.fitWidth\\'/><label class=\\'k-checkbox-label\\' for=\\'fitWidth\\'>' + MESSAGES.exportAsDialog.labels.fit + '</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>' + MESSAGES.exportAsDialog.labels.center + ':</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'hCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.hCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'hCenter\\'>' + MESSAGES.exportAsDialog.labels.horizontally + '</label>' + '<input class=\\'k-checkbox\\' id=\\'vCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.vCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'vCenter\\'>' + MESSAGES.exportAsDialog.labels.vertically + '</label>' + '</div>' + '<div class=\\'k-page-orientation\\' data-bind=\\'css: {k-page-landscape: pdf.landscape}\\'>' + '<div class=\\'k-margins-horizontal\\'></div>' + '<div class=\\'k-margins-vertical\\'></div>' + '</div>' + '</div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + MESSAGES.save + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + MESSAGES.cancel + '</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'SaveAsCommand',\n                    options: this.viewModel\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('exportAs', ExportAsDialog);\n        var ModifyMergedDialog = MessageDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n            },\n            options: { template: MESSAGES.modifyMergedDialog.errorMessage + '<div class=\"k-action-buttons\">' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close, text: okText\\' />' + '</div>' }\n        });\n        kendo.spreadsheet.dialogs.register('modifyMerged', ModifyMergedDialog);\n        var UseKeyboardDialog = MessageDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n            },\n            options: {\n                title: MESSAGES.useKeyboardDialog.title,\n                template: MESSAGES.useKeyboardDialog.errorMessage + '<div>Ctrl+C ' + MESSAGES.useKeyboardDialog.labels.forCopy + '</div>' + '<div>Ctrl+X ' + MESSAGES.useKeyboardDialog.labels.forCut + '</div>' + '<div>Ctrl+V ' + MESSAGES.useKeyboardDialog.labels.forPaste + '</div>' + '<div class=\"k-action-buttons\">' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close, text: okText\\' />' + '</div>'\n            }\n        });\n        kendo.spreadsheet.dialogs.register('useKeyboard', UseKeyboardDialog);\n        var UnsupportedSelectionDialog = MessageDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n            },\n            options: { template: MESSAGES.unsupportedSelectionDialog.errorMessage + '<div class=\"k-action-buttons\">' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close, text: okText\\' />' + '</div>' }\n        });\n        kendo.spreadsheet.dialogs.register('unsupportedSelection', UnsupportedSelectionDialog);\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetbinder', [\n        'kendo.core',\n        'kendo.data',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var SheetDataSourceBinder = kendo.Class.extend({\n            init: function (options) {\n                this.options = $.extend({}, this.options, options);\n                this.columns = this._normalizeColumns(this.options.columns);\n                this._sheet();\n                this._dataSource();\n                this._header();\n                this.dataSource.fetch();\n            },\n            _sheet: function () {\n                this.sheet = this.options.sheet;\n                this._sheetChangeHandler = this._sheetChange.bind(this);\n                this._sheetDeleteRowHandler = this._sheetDeleteRow.bind(this);\n                this._sheetInsertRowHandler = this._sheetInsertRow.bind(this);\n                this.sheet.bind('change', this._sheetChangeHandler).bind('deleteRow', this._sheetDeleteRowHandler).bind('insertRow', this._sheetInsertRowHandler);\n            },\n            _sheetInsertRow: function (e) {\n                if (e.index !== undefined) {\n                    this.dataSource.insert(Math.max(e.index - 1, 0), {});\n                }\n            },\n            _sheetDeleteRow: function (e) {\n                if (e.index !== undefined) {\n                    var dataSource = this.dataSource;\n                    var model = dataSource.view()[e.index - 1];\n                    if (model) {\n                        dataSource.remove(model);\n                    }\n                }\n            },\n            _header: function () {\n                this.sheet.batch(function () {\n                    this.columns.forEach(function (column, index) {\n                        this.sheet.range(0, index).value(column.title);\n                    }.bind(this));\n                }.bind(this));\n            },\n            _sheetChange: function (e) {\n                if (e.recalc && e.ref) {\n                    var dataSource = this.dataSource;\n                    var data = dataSource.view();\n                    var columns = this.columns;\n                    if (!columns.length && data.length) {\n                        columns = Object.keys(data[0].toJSON());\n                    }\n                    this._skipRebind = true;\n                    e.ref.forEach(function (ref) {\n                        ref = ref.toRangeRef();\n                        for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                            var record = data[ri - 1];\n                            if (!record) {\n                                record = dataSource.insert(ri - 1, {});\n                                data = dataSource.view();\n                            }\n                            for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col && ci < columns.length; ci++) {\n                                record.set(columns[ci].field, e.value);\n                            }\n                        }\n                    });\n                    this._skipRebind = false;\n                }\n            },\n            _normalizeColumns: function (columns) {\n                return columns.map(function (column) {\n                    var field = column.field || column;\n                    return {\n                        field: field,\n                        title: column.title || field\n                    };\n                });\n            },\n            _dataSource: function () {\n                var options = this.options;\n                var dataSource = options.dataSource;\n                dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n                if (this.dataSource && this._changeHandler) {\n                    this.dataSource.unbind('change', this._changeHandler);\n                } else {\n                    this._changeHandler = this._change.bind(this);\n                }\n                this.dataSource = kendo.data.DataSource.create(dataSource).bind('change', this._changeHandler);\n            },\n            _change: function () {\n                if (this._skipRebind) {\n                    return;\n                }\n                var data = this.dataSource.view();\n                var columns = this.columns;\n                if (!columns.length && data.length) {\n                    this.columns = columns = this._normalizeColumns(Object.keys(data[0].toJSON()));\n                    this._header();\n                }\n                var getters = columns.map(function (column) {\n                    return kendo.getter(column.field);\n                });\n                this.sheet.batch(function () {\n                    for (var idx = 0, length = data.length; idx < length; idx++) {\n                        for (var getterIdx = 0; getterIdx < getters.length; getterIdx++) {\n                            this.sheet.range(idx + 1, getterIdx).value(getters[getterIdx](data[idx]));\n                        }\n                    }\n                }.bind(this));\n            },\n            destroy: function () {\n                this.dataSource.unbind('change', this._changeHandler);\n                this.sheet.unbind('change', this._sheetChangeHandler).unbind('deleteRow', this._sheetDeleteRowHandler).unbind('insertRow', this._sheetInsertRowHandler);\n            },\n            options: { columns: [] }\n        });\n        kendo.spreadsheet.SheetDataSourceBinder = SheetDataSourceBinder;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filtermenu', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.treeview',\n        'kendo.numerictextbox',\n        'kendo.datepicker',\n        'kendo.datetimepicker'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var classNames = {\n            details: 'k-details',\n            button: 'k-button',\n            detailsSummary: 'k-details-summary',\n            detailsContent: 'k-details-content',\n            icon: 'k-icon k-font-icon',\n            iconCollapse: 'k-i-collapse-se',\n            iconExpand: 'k-i-expand-e',\n            iconSearch: 'k-i-search',\n            textbox: 'k-textbox',\n            wrapper: 'k-spreadsheet-filter-menu',\n            filterByCondition: 'k-spreadsheet-condition-filter',\n            filterByValue: 'k-spreadsheet-value-filter',\n            valuesTreeViewWrapper: 'k-spreadsheet-value-treeview-wrapper',\n            actionButtons: 'k-action-buttons'\n        };\n        var Details = Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.details);\n                this._summary = this.element.find('.' + FilterMenu.classNames.detailsSummary).on('click', this._toggle.bind(this));\n                var iconClass = options.expanded ? FilterMenu.classNames.iconCollapse : FilterMenu.classNames.iconExpand;\n                this._icon = $('<span />', { 'class': FilterMenu.classNames.icon + ' ' + iconClass }).prependTo(this._summary);\n                this._container = kendo.wrap(this._summary.next(), true);\n                if (!options.expanded) {\n                    this._container.hide();\n                }\n            },\n            options: { name: 'Details' },\n            events: ['toggle'],\n            visible: function () {\n                return this.options.expanded;\n            },\n            toggle: function (show) {\n                var animation = kendo.fx(this._container).expand('vertical');\n                animation.stop()[show ? 'reverse' : 'play']();\n                this._icon.toggleClass(FilterMenu.classNames.iconExpand, show).toggleClass(FilterMenu.classNames.iconCollapse, !show);\n                this.options.expanded = !show;\n            },\n            _toggle: function () {\n                var show = this.visible();\n                this.toggle(show);\n                this.trigger('toggle', { show: show });\n            }\n        });\n        var FILTERMENU_MESSAGES = kendo.spreadsheet.messages.filterMenu = {\n            sortAscending: 'Sort range A to Z',\n            sortDescending: 'Sort range Z to A',\n            filterByValue: 'Filter by value',\n            filterByCondition: 'Filter by condition',\n            apply: 'Apply',\n            search: 'Search',\n            addToCurrent: 'Add to current selection',\n            clear: 'Clear',\n            blanks: '(Blanks)',\n            operatorNone: 'None',\n            and: 'AND',\n            or: 'OR',\n            operators: {\n                string: {\n                    contains: 'Text contains',\n                    doesnotcontain: 'Text does not contain',\n                    startswith: 'Text starts with',\n                    endswith: 'Text ends with'\n                },\n                date: {\n                    eq: 'Date is',\n                    neq: 'Date is not',\n                    lt: 'Date is before',\n                    gt: 'Date is after'\n                },\n                number: {\n                    eq: 'Is equal to',\n                    neq: 'Is not equal to',\n                    gte: 'Is greater than or equal to',\n                    gt: 'Is greater than',\n                    lte: 'Is less than or equal to',\n                    lt: 'Is less than'\n                }\n            }\n        };\n        kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (element, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, element, bindings, options);\n                this._change = $.proxy(this.change, this);\n                $(this.element).on('change', this._change);\n            },\n            refresh: function () {\n                var that = this, value = that.bindings.spreadsheetFilterValue.get();\n                $(that.element).val(value instanceof Date ? '' : value);\n            },\n            change: function () {\n                var value = this.element.value;\n                this.bindings.spreadsheetFilterValue.set(value);\n            }\n        });\n        kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (widget, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n                this.widget = widget;\n                this._change = $.proxy(this.change, this);\n                this.widget.first('change', this._change);\n            },\n            refresh: function () {\n                var binding = this.bindings.spreadsheetFilterValue, value = binding.get(), type = $(this.widget.element).data('filterType');\n                if (type === 'date' && value instanceof Date || type === 'number' && !isNaN(value)) {\n                    this.widget.value(value);\n                } else {\n                    this.widget.value(null);\n                }\n            },\n            change: function () {\n                var value = this.widget.value(), binding = this.bindings.spreadsheetFilterValue;\n                binding.set(value);\n            }\n        });\n        var templates = {\n            filterByValue: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByValue #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div class=\\'k-textbox k-space-right\\'>' + '<input placeholder=\\'#= messages.search #\\' data-#=ns#bind=\\'events: { input: filterValues }\\' />' + '<span class=\\'k-icon k-font-icon k-i-search\\' />' + '</div>' + '<div data-#=ns#bind=\\'visible: hasActiveSearch\\'><input class=\\'k-checkbox\\' type=\\'checkbox\\' data-#=ns#bind=\\'checked: appendToSearch\\' id=\\'_#=guid#\\' /><label class=\\'k-checkbox-label\\' for=\\'_#=guid#\\'>#= messages.addToCurrent #</label></div>' + '<div class=\\'' + classNames.valuesTreeViewWrapper + '\\'>' + '<div data-#=ns#role=\\'treeview\\' ' + 'data-#=ns#checkboxes=\\'{ checkChildren: true }\\' ' + 'data-#=ns#bind=\\'source: valuesDataSource, events: { check: valuesChange, select: valueSelect }\\' ' + '/>' + '</div>' + '</div>',\n            filterByCondition: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByCondition #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div>' + '<select ' + 'data-#=ns#role=\"dropdownlist\"' + 'data-#=ns#bind=\"value: operator, source: operators, events: { change: operatorChange } \"' + 'data-value-primitive=\"false\"' + 'data-option-label=\"#=messages.operatorNone#\"' + 'data-height=\"auto\"' + 'data-text-field=\"text\"' + 'data-value-field=\"unique\">' + '</select>' + '</div>' + '<div data-#=ns#bind=\"visible: isString\">' + '<input data-filter-type=\"string\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isNumber\">' + '<input data-filter-type=\"number\" data-#=ns#role=\"numerictextbox\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isDate\">' + '<input data-filter-type=\"date\" data-#=ns#role=\"datepicker\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '</div>',\n            menuItem: '<li data-command=\\'#=command#\\' data-dir=\\'#=dir#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>#=text#' + '</li>',\n            actionButtons: '<button data-#=ns#bind=\\'click: apply\\' class=\\'k-button k-primary\\'>#=messages.apply#</button>' + '<button data-#=ns#bind=\\'click: clear\\' class=\\'k-button\\'>#=messages.clear#</button>'\n        };\n        function distinctValues(values) {\n            var hash = {};\n            var result = [];\n            for (var i = 0; i < values.length; i++) {\n                if (!hash[values[i].value]) {\n                    hash[values[i].value] = values[i];\n                    result.push(values[i]);\n                } else if (!hash[values[i].value].checked && values[i].checked) {\n                    hash[values[i].value].checked = true;\n                }\n            }\n            return result;\n        }\n        function filter(dataSource, query) {\n            var hasVisibleChildren = false;\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                var text = item.text.toLowerCase();\n                var itemVisible = query === true || query === '' || text.indexOf(query) >= 0;\n                var anyVisibleChildren = filter(item.children, itemVisible || query);\n                hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                item.hidden = !itemVisible && !anyVisibleChildren;\n                item.checked = !item.hidden;\n            }\n            if (data) {\n                dataSource.filter({\n                    field: 'hidden',\n                    operator: 'neq',\n                    value: true\n                });\n            }\n            return hasVisibleChildren;\n        }\n        function uncheckAll(dataSource) {\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                item.checked = false;\n                if (item.hasChildren) {\n                    uncheckAll(item.children);\n                }\n            }\n        }\n        var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n            valuesChange: function (e) {\n                var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                var checked = function (item) {\n                    return item.checked && item.value;\n                };\n                var value = function (item) {\n                    return item.dataType === 'date' ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                };\n                var unique = function (value, index, array) {\n                    return array.lastIndexOf(value) === index;\n                };\n                var data = dataSource.data();\n                var values = data[0].children.data().toJSON();\n                var blanks = values.filter(function (item) {\n                    return item.dataType === 'blank';\n                });\n                blanks = blanks.length ? blanks[0].checked : false;\n                values = values.filter(checked).map(value);\n                if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                    values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                }\n                this.set('valueFilter', {\n                    values: values,\n                    blanks: blanks\n                });\n            },\n            valueSelect: function (e) {\n                e.preventDefault();\n                var node = e.sender.dataItem(e.node);\n                node.set('checked', !node.checked);\n            },\n            hasActiveSearch: false,\n            appendToSearch: false,\n            filterValues: function (e) {\n                var query = typeof e == 'string' ? e : $(e.target).val().toLowerCase();\n                var dataSource = this.valuesDataSource;\n                this.set('hasActiveSearch', !!query);\n                uncheckAll(dataSource);\n                filter(dataSource, query);\n            },\n            reset: function () {\n                this.set('customFilter', {\n                    logic: 'and',\n                    criteria: [{\n                            operator: null,\n                            value: null\n                        }]\n                });\n                this.set('valueFilter', { values: [] });\n            },\n            operatorChange: function (e) {\n                var dataItem = e.sender.dataItem();\n                this.set('operatorType', dataItem.type);\n                this.set('customFilter.criteria[0].operator', dataItem.value);\n            },\n            isNone: function () {\n                return this.get('operatorType') === undefined;\n            },\n            isString: function () {\n                return this.get('operatorType') === 'string';\n            },\n            isNumber: function () {\n                return this.get('operatorType') === 'number';\n            },\n            isDate: function () {\n                return this.get('operatorType') === 'date';\n            }\n        });\n        function flattenOperators(operators) {\n            var messages = FILTERMENU_MESSAGES.operators;\n            var result = [];\n            for (var type in operators) {\n                if (!operators.hasOwnProperty(type)) {\n                    continue;\n                }\n                for (var operator in operators[type]) {\n                    if (!operators[type].hasOwnProperty(operator)) {\n                        continue;\n                    }\n                    result.push({\n                        text: messages[type][operator],\n                        value: operator,\n                        unique: type + '_' + operator,\n                        type: type\n                    });\n                }\n            }\n            return result;\n        }\n        var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n            valuesTree: function (range, column) {\n                return [{\n                        text: 'All',\n                        expanded: true,\n                        checked: true,\n                        items: this.values(range.resize({ top: 1 }), column)\n                    }];\n            },\n            values: function (range, column) {\n                var values = [];\n                var messages = FILTERMENU_MESSAGES;\n                var columnRange = range.column(column);\n                var sheet = range.sheet();\n                columnRange.forEachCell(function (row, col, cell) {\n                    if (cell.value === undefined) {\n                        cell.dataType = 'blank';\n                    } else if (cell.format) {\n                        cell.dataType = kendo.spreadsheet.formatting.type(cell.value, cell.format);\n                    } else {\n                        cell.dataType = typeof cell.value;\n                    }\n                    if (cell.value !== null && cell.format) {\n                        cell.text = kendo.spreadsheet.formatting.text(cell.value, cell.format);\n                    } else {\n                        cell.text = cell.value ? cell.value : messages.blanks;\n                    }\n                    if (cell.dataType === 'percent') {\n                        cell.dataType = 'number';\n                    }\n                    if (cell.dataType === 'date') {\n                        cell.value = kendo.spreadsheet.numberToDate(cell.value);\n                    }\n                    if (cell.hasOwnProperty('wrap')) {\n                        delete cell.wrap;\n                    }\n                    cell.checked = !sheet.isHiddenRow(row);\n                    values.push(cell);\n                });\n                values = distinctValues(values);\n                values.sort(function (a, b) {\n                    if (a.dataType === b.dataType) {\n                        return 0;\n                    }\n                    if (a.dataType === 'blank' || b.dataType === 'blank') {\n                        return a.dataType === 'blank' ? -1 : 1;\n                    }\n                    if (a.dataType === 'number' || b.dataType === 'number') {\n                        return a.dataType === 'number' ? -1 : 1;\n                    }\n                    if (a.dataType === 'date' || b.dataType === 'date') {\n                        return a.dataType === 'date' ? -1 : 1;\n                    }\n                    return 0;\n                });\n                return values;\n            },\n            filterType: function (range, column) {\n                var sheet = range.sheet();\n                var filter = this.filterForColumn(column, sheet);\n                var type;\n                filter = filter && filter.filter.toJSON();\n                if (filter && filter.filter == 'custom') {\n                    var value = filter.criteria[0].value;\n                    if (value instanceof Date) {\n                        type = 'date';\n                    } else if (typeof value == 'string') {\n                        type = 'string';\n                    } else if (typeof value == 'number') {\n                        type = 'number';\n                    }\n                }\n                if (!type) {\n                    var topValue = this.values(range.row(1), column)[0];\n                    type = topValue && topValue.dataType;\n                    if (type == 'blank') {\n                        type = null;\n                    }\n                }\n                return type;\n            },\n            filterForColumn: function (column, sheet) {\n                var allFilters = sheet.filter();\n                var filters;\n                if (allFilters) {\n                    filters = allFilters.columns.filter(function (item) {\n                        return item.index === column;\n                    })[0];\n                }\n                return filters;\n            },\n            filter: function (column, sheet) {\n                var columnFilters = this.filterForColumn(column, sheet);\n                if (!columnFilters) {\n                    return;\n                }\n                var options = columnFilters.filter.toJSON();\n                var type = options.filter;\n                delete options.filter;\n                var result = {\n                    type: type,\n                    options: options\n                };\n                var criteria = options.criteria;\n                if (criteria && criteria.length) {\n                    result.operator = criteria[0].operator;\n                }\n                return result;\n            }\n        };\n        var FilterMenu = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.wrapper);\n                this.viewModel = new FilterMenuViewModel({\n                    active: 'value',\n                    operator: null,\n                    operators: flattenOperators(this.options.operators),\n                    clear: this.clear.bind(this),\n                    apply: this.apply.bind(this)\n                });\n                this._filterInit();\n                this._popup();\n                this._sort();\n                this._filterByCondition();\n                this._filterByValue();\n                this._actionButtons();\n            },\n            options: {\n                name: 'FilterMenu',\n                column: 0,\n                range: null,\n                operators: {\n                    string: {\n                        contains: 'Text contains',\n                        doesnotcontain: 'Text does not contain',\n                        startswith: 'Text starts with',\n                        endswith: 'Text ends with'\n                    },\n                    date: {\n                        eq: 'Date is',\n                        neq: 'Date is not',\n                        lt: 'Date is before',\n                        gt: 'Date is after'\n                    },\n                    number: {\n                        eq: 'Is equal to',\n                        neq: 'Is not equal to',\n                        gte: 'Is greater than or equal to',\n                        gt: 'Is greater than',\n                        lte: 'Is less than or equal to',\n                        lt: 'Is less than'\n                    }\n                }\n            },\n            events: ['action'],\n            destroy: function () {\n                Widget.fn.destroy.call(this);\n                this.menu.destroy();\n                this.valuesTreeView.destroy();\n                this.popup.destroy();\n            },\n            openFor: function (anchor) {\n                this.popup.setOptions({ anchor: anchor });\n                this.popup.open();\n            },\n            close: function () {\n                this.popup.close();\n            },\n            clear: function () {\n                this.action({\n                    command: 'ClearFilterCommand',\n                    options: { column: this.options.column }\n                });\n                this.viewModel.reset();\n                this.close();\n            },\n            apply: function () {\n                this._active();\n                var options = {\n                    operatingRange: this.options.range,\n                    column: this.options.column\n                };\n                var valueFilter;\n                var customFilter;\n                if (this.viewModel.active === 'value') {\n                    this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                    valueFilter = this.viewModel.valueFilter.toJSON();\n                    if (valueFilter.values && valueFilter.values.length) {\n                        options.valueFilter = valueFilter;\n                    }\n                } else if (this.viewModel.active === 'custom') {\n                    customFilter = this.viewModel.customFilter.toJSON();\n                    if (customFilter.criteria.length) {\n                        options.customFilter = customFilter;\n                    }\n                }\n                if (options.valueFilter || options.customFilter) {\n                    this.action({\n                        command: 'ApplyFilterCommand',\n                        options: options\n                    });\n                }\n            },\n            action: function (options) {\n                this.trigger('action', $.extend({}, options));\n            },\n            _filterInit: function () {\n                var column = this.options.column;\n                var range = this.options.range;\n                var sheet = range.sheet();\n                var activeFilter = FilterMenuController.filter(column, sheet);\n                if (activeFilter) {\n                    var filterType = FilterMenuController.filterType(range, column);\n                    this.viewModel.set('active', activeFilter.type);\n                    this.viewModel.set(activeFilter.type + 'Filter', activeFilter.options);\n                    if (activeFilter.type == 'custom') {\n                        this.viewModel.set('operator', filterType + '_' + activeFilter.operator);\n                        this.viewModel.set('operatorType', filterType);\n                    }\n                } else {\n                    this.viewModel.reset();\n                }\n            },\n            _popup: function () {\n                this.popup = this.element.kendoPopup({ copyAnchorStyles: false }).data('kendoPopup');\n            },\n            _sort: function () {\n                var template = kendo.template(FilterMenu.templates.menuItem);\n                var messages = FILTERMENU_MESSAGES;\n                var items = [\n                    {\n                        command: 'sort',\n                        dir: 'asc',\n                        text: messages.sortAscending,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        command: 'sort',\n                        dir: 'desc',\n                        text: messages.sortDescending,\n                        iconClass: 'sort-desc'\n                    }\n                ];\n                var ul = $('<ul />', { 'html': kendo.render(template, items) }).appendTo(this.element);\n                this.menu = ul.kendoMenu({\n                    orientation: 'vertical',\n                    select: function (e) {\n                        var dir = $(e.item).data('dir');\n                        var range = this.options.range.resize({ top: 1 });\n                        var options = {\n                            value: dir,\n                            sheet: false,\n                            operatingRange: range,\n                            column: this.options.column\n                        };\n                        if (range.isSortable()) {\n                            this.action({\n                                command: 'SortCommand',\n                                options: options\n                            });\n                        } else {\n                            this.close();\n                        }\n                    }.bind(this)\n                }).data('kendoMenu');\n            },\n            _appendTemplate: function (template, className, details, expanded) {\n                var compiledTemplate = kendo.template(template);\n                var wrapper = $('<div class=\\'' + className + '\\'/>').html(compiledTemplate({\n                    messages: FILTERMENU_MESSAGES,\n                    guid: kendo.guid(),\n                    ns: kendo.ns\n                }));\n                this.element.append(wrapper);\n                if (details) {\n                    details = new Details(wrapper, {\n                        expanded: expanded,\n                        toggle: this._detailToggle.bind(this)\n                    });\n                }\n                kendo.bind(wrapper, this.viewModel);\n                return wrapper;\n            },\n            _detailToggle: function (e) {\n                this.element.find('[data-role=details]').not(e.sender.element).data('kendoDetails').toggle(!e.show);\n            },\n            _filterByCondition: function () {\n                var isExpanded = this.viewModel.active === 'custom';\n                this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n            },\n            _filterByValue: function () {\n                var isExpanded = this.viewModel.active === 'value';\n                var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n                this.valuesTreeView = wrapper.find('[data-role=treeview]').data('kendoTreeView');\n                var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n                this.viewModel.set('valuesDataSource', new kendo.data.HierarchicalDataSource({ data: values }));\n            },\n            _actionButtons: function () {\n                this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n            },\n            _active: function () {\n                var activeContainer = this.element.find('[data-role=details]').filter(function (index, element) {\n                    return $(element).data('kendoDetails').visible();\n                });\n                if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                    this.viewModel.set('active', 'value');\n                } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                    this.viewModel.set('active', 'custom');\n                }\n            }\n        });\n        kendo.spreadsheet.FilterMenu = FilterMenu;\n        $.extend(true, FilterMenu, {\n            classNames: classNames,\n            templates: templates\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/editor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var SheetEditor = kendo.Observable.extend({\n            init: function (view) {\n                kendo.Observable.fn.init.call(this);\n                this.view = view;\n                this.formulaBar = view.formulaBar;\n                this.barInput = view.formulaBar.formulaInput;\n                this.cellInput = view.formulaInput;\n                this.barInput.syncWith(this.cellInput);\n                this.cellInput.syncWith(this.barInput);\n                this.barInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.cellInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.barInput.bind('focus', this._focus.bind(this));\n                this.cellInput.bind('focus', this._focus.bind(this));\n            },\n            events: [\n                'activate',\n                'deactivate',\n                'change',\n                'update'\n            ],\n            _focus: function (e) {\n                this.lastActive = e.sender == this.barInput ? 'bar' : 'cell';\n            },\n            _triggerUpdate: function () {\n                this.trigger('update', { value: this.value() });\n            },\n            activeEditor: function () {\n                var editor = null;\n                var activeElement = kendo._activeElement();\n                if (this.barElement()[0] === activeElement) {\n                    editor = this.barInput;\n                } else if (this.cellElement()[0] === activeElement) {\n                    editor = this.cellInput;\n                }\n                return editor;\n            },\n            activate: function (options) {\n                this._active = true;\n                this._rect = options.rect;\n                this.cellInput.position(options.rect);\n                this.cellInput.resize(options.rect);\n                this.cellInput.tooltip(options.tooltip);\n                this.cellInput.activeCell = this.barInput.activeCell = options.range.topLeft;\n                this.trigger('activate');\n                return this;\n            },\n            deactivate: function () {\n                var cellInput = this.cellInput;\n                if (!this._active) {\n                    return;\n                }\n                if (cellInput.value() != this._value) {\n                    if (this.trigger('change', { value: cellInput.value() })) {\n                        return;\n                    }\n                }\n                this._active = false;\n                this._rect = null;\n                cellInput.hide();\n                this.trigger('deactivate');\n            },\n            enable: function (enable) {\n                this.barInput.enable(enable);\n            },\n            barElement: function () {\n                return this.barInput.element;\n            },\n            cellElement: function () {\n                return this.cellInput.element;\n            },\n            focusLastActive: function () {\n                this.focus(this.lastActive);\n            },\n            focus: function (inputType) {\n                inputType = inputType || 'cell';\n                if (inputType === 'cell') {\n                    this.cellInput.element.focus();\n                    this.cellInput.end();\n                } else {\n                    this.barInput.element.focus();\n                }\n            },\n            isActive: function () {\n                return this._active;\n            },\n            isFiltered: function () {\n                return this.barInput.popup.visible() || this.cellInput.popup.visible();\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var editor = this.activeEditor();\n                return editor && editor.canInsertRef(isKeyboardAction);\n            },\n            highlightedRefs: function () {\n                var editor = this.activeEditor();\n                var refs = [];\n                if (editor) {\n                    refs = editor.highlightedRefs();\n                }\n                return refs;\n            },\n            scale: function () {\n                this.cellInput.scale();\n            },\n            toggleTooltip: function (rect) {\n                this.cellInput.toggleTooltip(notEqual(this._rect, rect));\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    return this.barInput.value();\n                }\n                if (value === null) {\n                    value = '';\n                }\n                this._value = value;\n                this.barInput.value(value);\n                this.cellInput.value(value);\n            }\n        });\n        function notEqual(oldRect, newRect) {\n            return oldRect && (oldRect.top !== newRect.top || oldRect.left !== newRect.left);\n        }\n        kendo.spreadsheet.SheetEditor = SheetEditor;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofill', [\n        'spreadsheet/runtime',\n        'spreadsheet/range'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Range = spreadsheet.Range;\n    var runtime = spreadsheet.calc.runtime;\n    var Formula = runtime.Formula;\n    var MSG_INCOMPATIBLE = 'Incompatible ranges in fillFrom';\n    var MSG_NO_DIRECTION = 'Cannot determine fill direction';\n    Range.prototype._previewFillFrom = function (srcRange, direction) {\n        var destRange = this, sheet = destRange._sheet;\n        if (typeof srcRange == 'string') {\n            srcRange = sheet.range(srcRange);\n        }\n        var src = srcRange._ref.toRangeRef();\n        var dest = destRange._ref.toRangeRef();\n        if (src.intersects(dest)) {\n            if (src.eq(dest)) {\n                return null;\n            }\n            dest = dest.clone();\n            if (src.topLeft.eq(dest.topLeft)) {\n                if (src.width() == dest.width()) {\n                    dest.topLeft.row += src.height();\n                    direction = 0;\n                } else if (src.height() == dest.height()) {\n                    dest.topLeft.col += src.width();\n                    direction = 1;\n                } else {\n                    throw new Error(MSG_INCOMPATIBLE);\n                }\n            } else if (src.bottomRight.eq(dest.bottomRight)) {\n                if (src.width() == dest.width()) {\n                    dest.bottomRight.row -= src.height();\n                    direction = 2;\n                } else if (src.height() == dest.height()) {\n                    dest.bottomRight.col -= src.width();\n                    direction = 3;\n                } else {\n                    throw new Error(MSG_INCOMPATIBLE);\n                }\n            } else {\n                throw new Error(MSG_INCOMPATIBLE);\n            }\n            return sheet.range(dest)._previewFillFrom(srcRange, direction);\n        }\n        if (direction == null) {\n            if (src.topLeft.col == dest.topLeft.col) {\n                direction = src.topLeft.row < dest.topLeft.row ? 0 : 2;\n            } else if (src.topLeft.row == dest.topLeft.row) {\n                direction = src.topLeft.col < dest.topLeft.col ? 1 : 3;\n            } else {\n                throw new Error(MSG_NO_DIRECTION);\n            }\n        }\n        var horizontal = direction & 1;\n        var descending = direction & 2;\n        if (horizontal && src.height() != dest.height() || !horizontal && src.width() != dest.width()) {\n            throw new Error(MSG_INCOMPATIBLE);\n        }\n        var data = srcRange._properties(), n;\n        if (!horizontal) {\n            data = transpose(data);\n            n = dest.height();\n        } else {\n            n = dest.width();\n        }\n        var fill = new Array(data.length);\n        for (var i = 0; i < data.length; ++i) {\n            var s = data[i];\n            var f = findSeries(s);\n            var a = fill[i] = new Array(n);\n            for (var j = 0; j < n; ++j) {\n                var idx = descending ? -j - 1 : s.length + j;\n                var srcIdx = descending ? s.length - j % s.length - 1 : j % s.length;\n                a[descending ? n - j - 1 : j] = f(idx, srcIdx);\n            }\n        }\n        if (!horizontal) {\n            fill = transpose(fill);\n        }\n        return {\n            props: fill,\n            direction: direction,\n            dest: destRange\n        };\n    };\n    Range.prototype.fillFrom = function (srcRange, direction) {\n        var x = this._previewFillFrom(srcRange, direction);\n        x.dest._properties(x.props);\n        return x.dest;\n    };\n    function linearRegression(data) {\n        var N = data.length;\n        var mx = (N + 1) / 2, my = data.reduce(function (a, b) {\n                return a + b;\n            }, 0) / N;\n        var s1 = 0, s2 = 0;\n        for (var i = 0; i < N; i++) {\n            var t1 = i + 1 - mx, t2 = data[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (!s2) {\n            return function (N) {\n                return data[N % data.length];\n            };\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return function (N) {\n            return a + b * (N + 1);\n        };\n    }\n    function findSeries(properties) {\n        function findStep(a) {\n            var diff = a[1] - a[0];\n            for (var i = 2; i < a.length; ++i) {\n                if (a[i] - a[i - 1] != diff) {\n                    return null;\n                }\n            }\n            return diff;\n        }\n        function getData(a) {\n            return a.map(function (v) {\n                return v.number;\n            });\n        }\n        var series = [];\n        var data = properties.map(function (x) {\n            return x.formula || x.value;\n        });\n        forEachSeries(data, function (begin, end, type, a) {\n            var f, values;\n            if (type == 'number') {\n                values = getData(a);\n                if (values.length == 1 && (begin > 0 || end < data.length || formatType(values[0], properties[begin].format) == 'date')) {\n                    values.push(values[0] + 1);\n                }\n                f = linearRegression(values);\n            } else if (type == 'string' || type == 'formula' || type == 'boolean') {\n                f = function (N, i) {\n                    return data[i];\n                };\n            } else if (Array.isArray(type)) {\n                if (a.length == 1) {\n                    f = function (N) {\n                        return type[(a[0].number + N) % type.length];\n                    };\n                } else {\n                    var diff = findStep(getData(a));\n                    if (diff == null) {\n                        f = function (N) {\n                            return a[N % a.length].value;\n                        };\n                    } else {\n                        f = function (N) {\n                            var idx = a[0].number + diff * N;\n                            return type[idx % type.length];\n                        };\n                    }\n                }\n            } else if (type != 'null') {\n                values = getData(a);\n                if (values.length == 1) {\n                    values.push(values[0] + 1);\n                }\n                values = linearRegression(values);\n                f = function (N, i) {\n                    return data[i].replace(/^(.*\\D)\\d+/, '$1' + values(N, i));\n                };\n            } else {\n                f = function () {\n                    return null;\n                };\n            }\n            var s = {\n                f: f,\n                begin: begin,\n                end: end,\n                len: end - begin\n            };\n            for (var i = begin; i < end; ++i) {\n                series[i] = s;\n            }\n        });\n        return function (N, i) {\n            var s = series[i];\n            var q = N / data.length | 0;\n            var r = N % data.length;\n            var n = q * s.len + r - s.begin;\n            var value = s.f(n, i);\n            var props = clone(properties[i]);\n            if (value instanceof Formula) {\n                props.formula = value;\n            } else {\n                props.value = value;\n            }\n            return props;\n        };\n    }\n    function formatType(value, format) {\n        if (format != null) {\n            return spreadsheet.formatting.type(value, format);\n        }\n    }\n    function clone(obj) {\n        var copy = {};\n        Object.keys(obj || {}).forEach(function (key) {\n            copy[key] = obj[key];\n        });\n        return copy;\n    }\n    function forEachSeries(data, f) {\n        var prev = null, start = 0, a = [], type;\n        for (var i = 0; i < data.length; ++i) {\n            type = getType(data[i]);\n            a.push(type);\n            if (prev != null && type.type !== prev.type) {\n                f(start, i, prev.type, a.slice(start, i));\n                start = i;\n            }\n            prev = type;\n        }\n        f(start, i, prev.type, a.slice(start, i));\n    }\n    function getType(el) {\n        if (typeof el == 'number') {\n            return {\n                type: 'number',\n                number: el\n            };\n        }\n        if (typeof el == 'string') {\n            var lst = findStringList(el);\n            if (lst) {\n                return lst;\n            }\n            var m = /^(.*\\D)(\\d+)/.exec(el);\n            if (m) {\n                el = el.replace(/^(.*\\D)\\d+/, '$1-######');\n                return {\n                    type: el,\n                    match: m,\n                    number: parseFloat(m[2])\n                };\n            }\n            return { type: 'string' };\n        }\n        if (typeof el == 'boolean') {\n            return { type: 'boolean' };\n        }\n        if (el == null) {\n            return { type: 'null' };\n        }\n        if (el instanceof Formula) {\n            return { type: 'formula' };\n        }\n        window.console.error(el);\n        throw new Error('Cannot fill data');\n    }\n    function stringLists() {\n        var culture = kendo.culture();\n        return [\n            culture.calendars.standard.days.namesAbbr,\n            culture.calendars.standard.days.names,\n            culture.calendars.standard.months.namesAbbr,\n            culture.calendars.standard.months.names\n        ];\n    }\n    function findStringList(str) {\n        var strl = str.toLowerCase();\n        var lists = stringLists();\n        for (var i = 0; i < lists.length; ++i) {\n            var a = lists[i];\n            for (var j = a.length; --j >= 0;) {\n                var el = a[j].toLowerCase();\n                if (el == strl) {\n                    return {\n                        type: a,\n                        number: j,\n                        value: str\n                    };\n                }\n            }\n        }\n    }\n    function transpose(a) {\n        var height = a.length, width = a[0].length;\n        var t = [];\n        for (var i = 0; i < width; ++i) {\n            t[i] = [];\n            for (var j = 0; j < height; ++j) {\n                t[i][j] = a[j][i];\n            }\n        }\n        return t;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/print', [\n        'kendo.pdf',\n        'spreadsheet/sheet',\n        'spreadsheet/range',\n        'spreadsheet/references',\n        'spreadsheet/numformat',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    'use strict';\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var drawing = kendo.drawing;\n    var formatting = spreadsheet.formatting;\n    var geo = kendo.geometry;\n    var GUIDELINE_WIDTH = 0.8;\n    function distributeCoords(heights, pageHeight) {\n        var curr = 0;\n        var out = [];\n        var threshold = 0.2 * pageHeight;\n        var bottom = pageHeight;\n        heights.forEach(function (h) {\n            if (pageHeight && curr + h > bottom) {\n                if (bottom - curr < threshold) {\n                    curr = pageHeight * Math.ceil(curr / pageHeight);\n                }\n                bottom += pageHeight * Math.ceil(h / pageHeight);\n            }\n            out.push(curr);\n            curr += h;\n        });\n        out.push(curr);\n        return out;\n    }\n    function getMergedCells(sheet, range) {\n        var grid = sheet._grid;\n        var primary = {};\n        var secondary = {};\n        sheet.forEachMergedCell(range, function (ref) {\n            var topLeft = ref.topLeft;\n            grid.forEach(ref, function (cellRef) {\n                if (topLeft.eq(cellRef)) {\n                    primary[cellRef.print()] = ref;\n                } else if (range.contains(cellRef)) {\n                    secondary[cellRef.print()] = topLeft;\n                }\n            });\n        });\n        return {\n            primary: primary,\n            secondary: secondary\n        };\n    }\n    function doLayout(sheet, range, options) {\n        var cells = [];\n        var rowHeights = [];\n        var colWidths = [];\n        var mergedCells = getMergedCells(sheet, range);\n        var maxRow = -1, maxCol = -1;\n        sheet.forEach(range, function (row, col, cell) {\n            var relrow = row - range.topLeft.row;\n            var relcol = col - range.topLeft.col;\n            if (!relcol) {\n                rowHeights.push(sheet.rowHeight(row));\n            }\n            if (!relrow) {\n                colWidths.push(sheet.columnWidth(col));\n            }\n            if (sheet.isHiddenColumn(col) || sheet.isHiddenRow(row)) {\n                return;\n            }\n            var nonEmpty = options.forScreen || shouldDrawCell(cell);\n            if (!(options.emptyCells || nonEmpty)) {\n                return;\n            }\n            var id = new CellRef(row, col).print();\n            if (mergedCells.secondary[id]) {\n                return;\n            }\n            if (nonEmpty) {\n                maxRow = Math.max(maxRow, relrow);\n                maxCol = Math.max(maxCol, relcol);\n            } else {\n                cell.empty = true;\n            }\n            var m = mergedCells.primary[id];\n            if (m) {\n                delete mergedCells.primary[id];\n                cell.merged = true;\n                cell.rowspan = m.height();\n                cell.colspan = m.width();\n                if (options.forScreen) {\n                    cell.width = sheet._columns.sum(m.topLeft.col, m.bottomRight.col);\n                    cell.height = sheet._rows.sum(m.topLeft.row, m.bottomRight.row);\n                }\n            } else {\n                cell.rowspan = 1;\n                cell.colspan = 1;\n            }\n            cell.row = relrow;\n            cell.col = relcol;\n            cells.push(cell);\n        });\n        rowHeights = rowHeights.slice(0, maxRow + 1);\n        colWidths = colWidths.slice(0, maxCol + 1);\n        var pageWidth = options.pageWidth;\n        var pageHeight = options.pageHeight;\n        var scaleFactor = 1;\n        if (options.fitWidth) {\n            var width = colWidths.reduce(sum, 0);\n            if (width > pageWidth) {\n                scaleFactor = pageWidth / width;\n                pageWidth /= scaleFactor;\n                pageHeight /= scaleFactor;\n            }\n        }\n        var yCoords = distributeCoords(rowHeights, pageHeight || 0);\n        var xCoords = distributeCoords(colWidths, pageWidth || 0);\n        var boxWidth = 0;\n        var boxHeight = 0;\n        cells = cells.filter(function (cell) {\n            if (cell.empty && (cell.row > maxRow || cell.col > maxCol)) {\n                return false;\n            }\n            cell.left = xCoords[cell.col];\n            cell.top = yCoords[cell.row];\n            if (cell.merged) {\n                if (!options.forScreen) {\n                    cell.right = orlast(xCoords, cell.col + cell.colspan);\n                    cell.bottom = orlast(yCoords, cell.row + cell.rowspan);\n                    cell.width = cell.right - cell.left;\n                    cell.height = cell.bottom - cell.top;\n                } else {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                }\n            } else {\n                cell.width = colWidths[cell.col];\n                cell.height = rowHeights[cell.row];\n                cell.bottom = cell.top + cell.height;\n                cell.right = cell.left + cell.width;\n            }\n            boxWidth = Math.max(boxWidth, cell.right);\n            boxHeight = Math.max(boxHeight, cell.bottom);\n            return true;\n        });\n        Object.keys(mergedCells.primary).forEach(function (id) {\n            var ref = mergedCells.primary[id];\n            sheet.forEach(ref.topLeft.toRangeRef(), function (row, col, cell) {\n                var relrow = row - range.topLeft.row;\n                var relcol = col - range.topLeft.col;\n                cell.merged = true;\n                cell.colspan = ref.height();\n                cell.rowspan = ref.width();\n                if (relrow < 0) {\n                    cell.top = -sheet._rows.sum(row, row - relrow - 1);\n                } else {\n                    cell.top = yCoords[relrow];\n                }\n                if (relcol < 0) {\n                    cell.left = -sheet._columns.sum(col, col - relcol - 1);\n                } else {\n                    cell.left = xCoords[relcol];\n                }\n                cell.height = sheet._rows.sum(ref.topLeft.row, ref.bottomRight.row);\n                cell.width = sheet._columns.sum(ref.topLeft.col, ref.bottomRight.col);\n                cell.right = cell.left + cell.width;\n                cell.bottom = cell.top + cell.height;\n                cells.push(cell);\n            });\n        });\n        return {\n            width: boxWidth,\n            height: boxHeight,\n            cells: cells.sort(normalOrder),\n            scale: scaleFactor,\n            xCoords: xCoords,\n            yCoords: yCoords\n        };\n    }\n    function sum(a, b) {\n        return a + b;\n    }\n    function orlast(a, i) {\n        return i < a.length ? a[i] : a[a.length - 1];\n    }\n    function shouldDrawCell(cell) {\n        return cell.value != null || cell.merged || cell.background != null || cell.borderTop != null || cell.borderRight != null || cell.borderBottom != null || cell.borderLeft != null;\n    }\n    function normalOrder(a, b) {\n        if (a.top < b.top) {\n            return -1;\n        } else if (a.top == b.top) {\n            if (a.left < b.left) {\n                return -1;\n            } else if (a.left == b.left) {\n                return 0;\n            } else {\n                return 1;\n            }\n        } else {\n            return 1;\n        }\n    }\n    function drawLayout(layout, group, options) {\n        var ncols = Math.ceil(layout.width / options.pageWidth);\n        var nrows = Math.ceil(layout.height / options.pageHeight);\n        var pageWidth = options.pageWidth / layout.scale;\n        var pageHeight = options.pageHeight / layout.scale;\n        for (var i = 0; i < ncols; ++i) {\n            for (var j = 0; j < nrows; ++j) {\n                addPage(j, i);\n            }\n        }\n        function addPage(row, col) {\n            var left = col * pageWidth;\n            var right = left + pageWidth;\n            var top = row * pageHeight;\n            var bottom = top + pageHeight;\n            var endbottom = 0, endright = 0;\n            var cells = layout.cells.filter(function (cell) {\n                if (cell.right <= left || cell.left >= right || cell.bottom <= top || cell.top >= bottom) {\n                    return false;\n                }\n                endbottom = Math.max(cell.bottom, endbottom);\n                endright = Math.max(cell.right, endright);\n                return true;\n            });\n            if (cells.length > 0) {\n                var page = new drawing.Group();\n                group.append(page);\n                page.clip(drawing.Path.fromRect(new geo.Rect([\n                    0,\n                    0\n                ], [\n                    options.pageWidth,\n                    options.pageHeight\n                ])));\n                var content = new drawing.Group();\n                page.append(content);\n                var matrix = geo.Matrix.scale(layout.scale, layout.scale).multiplyCopy(geo.Matrix.translate(-left, -top));\n                if (options.hCenter || options.vCenter) {\n                    matrix = matrix.multiplyCopy(geo.Matrix.translate(options.hCenter ? (right - endright) / 2 : 0, options.vCenter ? (bottom - endbottom) / 2 : 0));\n                }\n                content.transform(matrix);\n                if (options.guidelines) {\n                    var prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        x = Math.min(x, endright);\n                        if (x !== prev && x >= left && x <= right) {\n                            prev = x;\n                            content.append(new drawing.Path().moveTo(x, top).lineTo(x, endbottom).close().stroke('#999', GUIDELINE_WIDTH));\n                        }\n                    });\n                    var prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        y = Math.min(y, endbottom);\n                        if (y !== prev && y >= top && y <= bottom) {\n                            prev = y;\n                            content.append(new drawing.Path().moveTo(left, y).lineTo(endright, y).close().stroke('#999', GUIDELINE_WIDTH));\n                        }\n                    });\n                }\n                var borders = new drawing.Group();\n                cells.forEach(function (cell) {\n                    drawCell(cell, content, borders, options);\n                });\n                content.append(borders);\n            }\n        }\n    }\n    function drawCell(cell, content, borders, options) {\n        var g = new drawing.Group();\n        content.append(g);\n        var rect = new geo.Rect([\n            cell.left,\n            cell.top\n        ], [\n            cell.width,\n            cell.height\n        ]);\n        if (cell.background || cell.merged) {\n            var r2d2 = rect;\n            if (options.guidelines) {\n                r2d2 = rect.clone();\n                r2d2.origin.x += GUIDELINE_WIDTH / 2;\n                r2d2.origin.y += GUIDELINE_WIDTH / 2;\n                r2d2.size.width -= GUIDELINE_WIDTH;\n                r2d2.size.height -= GUIDELINE_WIDTH;\n            }\n            g.append(new drawing.Rect(r2d2).fill(cell.background || '#fff').stroke(null));\n        }\n        if (cell.borderLeft) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.top).lineTo(cell.left, cell.bottom).close().stroke(cell.borderLeft.color, cell.borderLeft.size));\n        }\n        if (cell.borderTop) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.top).lineTo(cell.right, cell.top).close().stroke(cell.borderTop.color, cell.borderTop.size));\n        }\n        if (cell.borderRight) {\n            borders.append(new drawing.Path().moveTo(cell.right, cell.top).lineTo(cell.right, cell.bottom).close().stroke(cell.borderRight.color, cell.borderRight.size));\n        }\n        if (cell.borderBottom) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.bottom).lineTo(cell.right, cell.bottom).close().stroke(cell.borderBottom.color, cell.borderBottom.size));\n        }\n        var val = cell.value;\n        if (val != null) {\n            var type = typeof val == 'number' ? 'number' : null;\n            var clip = new drawing.Group();\n            clip.clip(drawing.Path.fromRect(rect));\n            g.append(clip);\n            var f;\n            if (cell.format) {\n                f = formatting.textAndColor(val, cell.format);\n                val = f.text;\n                if (f.type) {\n                    type = f.type;\n                }\n            } else {\n                val += '';\n            }\n            if (!cell.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    cell.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    cell.textAlign = 'center';\n                    break;\n                }\n            }\n            drawText(val, f && f.color || cell.color || '#000', cell, clip);\n        }\n    }\n    function drawText(text, color, cell, group) {\n        var rect_left = cell.left + 2;\n        var rect_top = cell.top + 2;\n        var rect_width = cell.width - 4;\n        var rect_height = cell.height - 4;\n        var font = makeFontDef(cell);\n        var style = { font: font };\n        var props = {\n            font: font,\n            fill: { color: color }\n        };\n        var lines = [], text_height = 0, top = rect_top;\n        if (cell.wrap) {\n            lineBreak(text, style, rect_width).forEach(function (line) {\n                var tmp = new drawing.Text(line.text, [\n                    rect_left,\n                    top\n                ], props);\n                top += line.box.height;\n                lines.push({\n                    el: tmp,\n                    box: line.box\n                });\n            });\n            text_height = top - rect_top;\n        } else {\n            var tmp = new drawing.Text(text, [\n                rect_left,\n                top\n            ], props);\n            var box = kendo.util.measureText(text, style);\n            lines.push({\n                el: tmp,\n                box: box\n            });\n            text_height = box.height;\n        }\n        var cont = new drawing.Group();\n        group.append(cont);\n        var vtrans = 0;\n        switch (cell.verticalAlign) {\n        case undefined:\n        case null:\n        case 'center':\n            vtrans = rect_height - text_height >> 1;\n            break;\n        case 'bottom':\n            vtrans = rect_height - text_height;\n            break;\n        }\n        if (vtrans < 0) {\n            vtrans = 0;\n        }\n        lines.forEach(function (line) {\n            cont.append(line.el);\n            var htrans = 0;\n            switch (cell.textAlign) {\n            case 'center':\n                htrans = rect_width - line.box.width >> 1;\n                break;\n            case 'right':\n                htrans = rect_width - line.box.width;\n                break;\n            }\n            if (htrans < 0) {\n                htrans = 0;\n            }\n            if (htrans || vtrans) {\n                line.el.transform(geo.Matrix.translate(htrans, vtrans));\n            }\n        });\n    }\n    function lineBreak(text, style, width) {\n        var lines = [];\n        var len = text.length;\n        var start = 0;\n        while (start < len) {\n            split(start, len, len);\n        }\n        return lines;\n        function split(min, eol, max) {\n            var sub = text.substring(start, eol).trim();\n            var box = kendo.util.measureText(sub, style);\n            if (box.width <= width) {\n                if (eol < max - 1) {\n                    split(eol, eol + max >> 1, max);\n                } else {\n                    lines.push({\n                        text: sub,\n                        box: box\n                    });\n                    start = eol;\n                }\n            } else if (min < eol) {\n                split(min, min + eol >> 1, eol);\n            }\n        }\n    }\n    function makeFontDef(cell) {\n        var font = [];\n        if (cell.italic) {\n            font.push('italic');\n        }\n        if (cell.bold) {\n            font.push('bold');\n        }\n        font.push((cell.fontSize || 12) + 'px');\n        font.push(cell.fontFamily || 'Arial');\n        return font.join(' ');\n    }\n    function draw(sheet, range, options, callback) {\n        if (options == null && callback == null) {\n            callback = range;\n            options = {};\n            range = spreadsheet.SHEETREF;\n        }\n        if (callback == null) {\n            callback = options;\n            if (range instanceof spreadsheet.Range || range instanceof spreadsheet.Ref || typeof range == 'string') {\n                options = {};\n            } else {\n                options = range;\n                range = spreadsheet.SHEETREF;\n            }\n        }\n        options = kendo.jQuery.extend({\n            paperSize: 'A4',\n            landscape: true,\n            margin: '1cm',\n            guidelines: true,\n            emptyCells: true,\n            fitWidth: false,\n            center: false\n        }, options);\n        var group = new drawing.Group();\n        var paper = kendo.pdf.getPaperOptions(options);\n        group.options.set('pdf', {\n            author: options.author,\n            creator: options.creator,\n            date: options.date,\n            keywords: options.keywords,\n            margin: paper.margin,\n            multiPage: true,\n            paperSize: paper.paperSize,\n            subject: options.subject,\n            title: options.title\n        });\n        var pageWidth = paper.paperSize[0];\n        var pageHeight = paper.paperSize[1];\n        if (paper.margin) {\n            pageWidth -= paper.margin.left + paper.margin.right;\n            pageHeight -= paper.margin.top + paper.margin.bottom;\n        }\n        options.pageWidth = pageWidth;\n        options.pageHeight = pageHeight;\n        var layout = doLayout(sheet, sheet._ref(range), options);\n        drawLayout(layout, group, options);\n        callback(group);\n    }\n    spreadsheet.Sheet.prototype.draw = function (range, options, callback) {\n        var sheet = this;\n        if (sheet._workbook) {\n            sheet.recalc(sheet._workbook._context, function () {\n                draw(sheet, range, options, callback);\n            });\n        } else {\n            draw(sheet, range, options, callback);\n        }\n    };\n    spreadsheet.draw = {\n        doLayout: doLayout,\n        drawLayout: drawLayout,\n        shouldDrawCell: shouldDrawCell\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('kendo.spreadsheet', [\n        'util/undoredostack',\n        'util/text-metrics',\n        'util/parse-xml',\n        'kendo.excel',\n        'kendo.progressbar',\n        'kendo.pdf',\n        'spreadsheet/commands',\n        'spreadsheet/formulabar',\n        'spreadsheet/formulainput',\n        'spreadsheet/eventlistener',\n        'spreadsheet/rangelist',\n        'spreadsheet/propertybag',\n        'spreadsheet/references',\n        'spreadsheet/navigator',\n        'spreadsheet/axismanager',\n        'spreadsheet/clipboard',\n        'spreadsheet/range',\n        'spreadsheet/sheet',\n        'spreadsheet/sheetsbar',\n        'spreadsheet/excel-reader',\n        'spreadsheet/workbook',\n        'spreadsheet/formulacontext',\n        'spreadsheet/controller',\n        'spreadsheet/view',\n        'spreadsheet/grid',\n        'spreadsheet/axis',\n        'spreadsheet/filter',\n        'spreadsheet/sorter',\n        'spreadsheet/runtime',\n        'spreadsheet/calc',\n        'spreadsheet/numformat',\n        'spreadsheet/runtime.functions',\n        'spreadsheet/runtime.functions.2',\n        'spreadsheet/toolbar',\n        'spreadsheet/dialogs',\n        'spreadsheet/sheetbinder',\n        'spreadsheet/filtermenu',\n        'spreadsheet/editor',\n        'spreadsheet/autofill',\n        'spreadsheet/print'\n    ], f);\n}(function () {\n    var __meta__ = {\n        id: 'spreadsheet',\n        name: 'Spreadsheet',\n        category: 'web',\n        description: 'Spreadsheet component',\n        depends: [\n            'core',\n            'binder',\n            'colorpicker',\n            'combobox',\n            'data',\n            'dom',\n            'dropdownlist',\n            'menu',\n            'ooxml',\n            'popup',\n            'sortable',\n            'tabstrip',\n            'toolbar',\n            'treeview',\n            'window',\n            'validator',\n            'excel',\n            'pdf',\n            'drawing'\n        ]\n    };\n    (function (kendo, undefined) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var Workbook = kendo.spreadsheet.Workbook;\n        var Controller = kendo.spreadsheet.Controller;\n        var View = kendo.spreadsheet.View;\n        var NS = '.kendoSpreadsheet';\n        var ALL_REASONS = {\n            recalc: true,\n            selection: true,\n            activeCell: true,\n            layout: true,\n            sheetSelection: true,\n            resize: true,\n            editorChange: false,\n            editorClose: false\n        };\n        var classNames = { wrapper: 'k-widget k-spreadsheet' };\n        var Spreadsheet = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(Spreadsheet.classNames.wrapper);\n                this._view = new View(this.element, {\n                    toolbar: this.options.toolbar,\n                    sheetsbar: this.options.sheetsbar\n                });\n                this._workbook = new Workbook(this.options, this._view);\n                this._controller = new Controller(this._view, this._workbook);\n                this._autoRefresh = true;\n                this._bindWorkbookEvents();\n                this._view.workbook(this._workbook);\n                this.refresh();\n                this._resizeHandler = function () {\n                    this.resize();\n                }.bind(this);\n                $(window).on('resize' + NS, this._resizeHandler);\n            },\n            _resize: function () {\n                this.refresh({ layout: true });\n            },\n            _workbookChange: function (e) {\n                if (this._autoRefresh) {\n                    this.refresh(e);\n                }\n            },\n            activeSheet: function (sheet) {\n                return this._workbook.activeSheet(sheet);\n            },\n            moveSheetToIndex: function (sheet, index) {\n                return this._workbook.moveSheetToIndex(sheet, index);\n            },\n            insertSheet: function (options) {\n                return this._workbook.insertSheet(options);\n            },\n            sheets: function () {\n                return this._workbook.sheets();\n            },\n            removeSheet: function (sheet) {\n                return this._workbook.removeSheet(sheet);\n            },\n            sheetByName: function (sheetName) {\n                return this._workbook.sheetByName(sheetName);\n            },\n            sheetIndex: function (sheet) {\n                return this._workbook.sheetIndex(sheet);\n            },\n            sheetByIndex: function (index) {\n                return this._workbook.sheetByIndex(index);\n            },\n            renameSheet: function (sheet, newSheetName) {\n                return this._workbook.renameSheet(sheet, newSheetName);\n            },\n            refresh: function (reason) {\n                if (!reason) {\n                    reason = ALL_REASONS;\n                }\n                if (!reason.editorClose) {\n                    this._view.sheet(this._workbook.activeSheet());\n                    this._controller.sheet(this._workbook.activeSheet());\n                    this._workbook.refresh(reason);\n                }\n                if (!reason.editorChange) {\n                    this._view.refresh(reason);\n                    this._controller.refresh();\n                    this._view.render();\n                    this.trigger('render');\n                }\n                return this;\n            },\n            openDialog: function (name, options) {\n                return this._view.openDialog(name, options);\n            },\n            autoRefresh: function (value) {\n                if (value !== undefined) {\n                    this._autoRefresh = value;\n                    if (value === true) {\n                        this.refresh();\n                    }\n                    return this;\n                }\n                return this._autoRefresh;\n            },\n            toJSON: function () {\n                return this._workbook.toJSON();\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._workbook.destroy();\n                    this._workbook = new Workbook($.extend({}, this.options, json));\n                    this._bindWorkbookEvents();\n                    this._view.workbook(this._workbook);\n                    this._controller.workbook(this._workbook);\n                    this.activeSheet(this.activeSheet());\n                } else {\n                    this.refresh();\n                }\n            },\n            fromFile: function (blob, name) {\n                return this._workbook.fromFile(blob, name);\n            },\n            saveAsPDF: function (options) {\n                this._workbook.saveAsPDF($.extend({}, this.options.pdf, options, { workbook: this._workbook }));\n            },\n            saveAsExcel: function (options) {\n                this._workbook.saveAsExcel(options);\n            },\n            draw: function (options, callback) {\n                this._workbook.draw(options, callback);\n            },\n            _workbookExcelExport: function (e) {\n                if (this.trigger('excelExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookExcelImport: function (e) {\n                if (this.trigger('excelImport', e)) {\n                    e.preventDefault();\n                } else {\n                    this._initProgress(e.promise);\n                }\n            },\n            _initProgress: function (deferred) {\n                var loading = $('<div class=\\'k-loading-mask\\' ' + 'style=\\'width: 100%; height: 100%; top: 0;\\'>' + '<div class=\\'k-loading-color\\'/>' + '</div>').appendTo(this.element);\n                var pb = $('<div class=\\'k-loading-progress\\'>').appendTo(loading).kendoProgressBar({\n                    type: 'chunk',\n                    chunkCount: 10,\n                    min: 0,\n                    max: 1,\n                    value: 0\n                }).data('kendoProgressBar');\n                deferred.progress(function (e) {\n                    pb.value(e.progress);\n                }).always(function () {\n                    kendo.destroy(loading);\n                    loading.remove();\n                });\n            },\n            _workbookPdfExport: function (e) {\n                if (this.trigger('pdfExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _bindWorkbookEvents: function () {\n                this._workbook.bind('change', this._workbookChange.bind(this));\n                this._workbook.bind('excelExport', this._workbookExcelExport.bind(this));\n                this._workbook.bind('excelImport', this._workbookExcelImport.bind(this));\n                this._workbook.bind('pdfExport', this._workbookPdfExport.bind(this));\n            },\n            destroy: function () {\n                kendo.ui.Widget.fn.destroy.call(this);\n                this._workbook.destroy();\n                this._controller.destroy();\n                this._view.destroy();\n                if (this._resizeHandler) {\n                    $(window).off('resize' + NS, this._resizeHandler);\n                }\n            },\n            options: {\n                name: 'Spreadsheet',\n                toolbar: true,\n                sheetsbar: true,\n                rows: 200,\n                columns: 50,\n                rowHeight: 20,\n                columnWidth: 64,\n                headerHeight: 20,\n                headerWidth: 32,\n                excel: {\n                    proxyURL: '',\n                    fileName: 'Workbook.xlsx'\n                },\n                pdf: {\n                    area: 'workbook',\n                    fileName: 'Workbook.pdf',\n                    proxyURL: '',\n                    paperSize: 'a4',\n                    landscape: true,\n                    margin: null,\n                    title: null,\n                    author: null,\n                    subject: null,\n                    keywords: null,\n                    creator: 'Kendo UI PDF Generator',\n                    date: null\n                }\n            },\n            events: [\n                'pdfExport',\n                'excelExport',\n                'excelImport',\n                'render'\n            ]\n        });\n        kendo.spreadsheet.ALL_REASONS = ALL_REASONS;\n        kendo.ui.plugin(Spreadsheet);\n        $.extend(true, Spreadsheet, { classNames: classNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));"],"sourceRoot":"/source/"}